<html>
<head>
<title>test_smoke.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_smoke.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">pickle</span>
<span class="s0">from </span><span class="s1">functools </span><span class="s0">import </span><span class="s1">partial</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">assert_equal</span><span class="s0">, </span><span class="s1">assert_</span><span class="s0">, </span><span class="s1">assert_array_equal</span>
<span class="s0">from </span><span class="s1">numpy.random </span><span class="s0">import </span><span class="s1">(Generator</span><span class="s0">, </span><span class="s1">MT19937</span><span class="s0">, </span><span class="s1">PCG64</span><span class="s0">, </span><span class="s1">PCG64DXSM</span><span class="s0">, </span><span class="s1">Philox</span><span class="s0">, </span><span class="s1">SFC64)</span>

<span class="s1">@pytest.fixture(scope=</span><span class="s2">'module'</span><span class="s0">,</span>
                <span class="s1">params=(np.bool_</span><span class="s0">, </span><span class="s1">np.int8</span><span class="s0">, </span><span class="s1">np.int16</span><span class="s0">, </span><span class="s1">np.int32</span><span class="s0">, </span><span class="s1">np.int64</span><span class="s0">,</span>
                        <span class="s1">np.uint8</span><span class="s0">, </span><span class="s1">np.uint16</span><span class="s0">, </span><span class="s1">np.uint32</span><span class="s0">, </span><span class="s1">np.uint64))</span>
<span class="s0">def </span><span class="s1">dtype(request):</span>
    <span class="s0">return </span><span class="s1">request.param</span>


<span class="s0">def </span><span class="s1">params_0(f):</span>
    <span class="s1">val = f()</span>
    <span class="s1">assert_(np.isscalar(val))</span>
    <span class="s1">val = f(</span><span class="s3">10</span><span class="s1">)</span>
    <span class="s1">assert_(val.shape == (</span><span class="s3">10</span><span class="s0">,</span><span class="s1">))</span>
    <span class="s1">val = f((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
    <span class="s1">assert_(val.shape == (</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
    <span class="s1">val = f((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
    <span class="s1">assert_(val.shape == (</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
    <span class="s1">val = f(size=(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">5</span><span class="s1">))</span>
    <span class="s1">assert_(val.shape == (</span><span class="s3">5</span><span class="s0">, </span><span class="s3">5</span><span class="s1">))</span>


<span class="s0">def </span><span class="s1">params_1(f</span><span class="s0">, </span><span class="s1">bounded=</span><span class="s0">False</span><span class="s1">):</span>
    <span class="s1">a = </span><span class="s3">5.0</span>
    <span class="s1">b = np.arange(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">12.0</span><span class="s1">)</span>
    <span class="s1">c = np.arange(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">102.0</span><span class="s1">).reshape((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
    <span class="s1">d = np.arange(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">1002.0</span><span class="s1">).reshape((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
    <span class="s1">e = np.array([</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">3.0</span><span class="s1">])</span>
    <span class="s1">g = np.arange(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">12.0</span><span class="s1">).reshape((</span><span class="s3">1</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
    <span class="s0">if </span><span class="s1">bounded:</span>
        <span class="s1">a = </span><span class="s3">0.5</span>
        <span class="s1">b = b / (</span><span class="s3">1.5 </span><span class="s1">* b.max())</span>
        <span class="s1">c = c / (</span><span class="s3">1.5 </span><span class="s1">* c.max())</span>
        <span class="s1">d = d / (</span><span class="s3">1.5 </span><span class="s1">* d.max())</span>
        <span class="s1">e = e / (</span><span class="s3">1.5 </span><span class="s1">* e.max())</span>
        <span class="s1">g = g / (</span><span class="s3">1.5 </span><span class="s1">* g.max())</span>

    <span class="s4"># Scalar</span>
    <span class="s1">f(a)</span>
    <span class="s4"># Scalar - size</span>
    <span class="s1">f(a</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
    <span class="s4"># 1d</span>
    <span class="s1">f(b)</span>
    <span class="s4"># 2d</span>
    <span class="s1">f(c)</span>
    <span class="s4"># 3d</span>
    <span class="s1">f(d)</span>
    <span class="s4"># 1d size</span>
    <span class="s1">f(b</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">)</span>
    <span class="s4"># 2d - size - broadcast</span>
    <span class="s1">f(e</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
    <span class="s4"># 3d - size</span>
    <span class="s1">f(g</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>


<span class="s0">def </span><span class="s1">comp_state(state1</span><span class="s0">, </span><span class="s1">state2):</span>
    <span class="s1">identical = </span><span class="s0">True</span>
    <span class="s0">if </span><span class="s1">isinstance(state1</span><span class="s0">, </span><span class="s1">dict):</span>
        <span class="s0">for </span><span class="s1">key </span><span class="s0">in </span><span class="s1">state1:</span>
            <span class="s1">identical &amp;= comp_state(state1[key]</span><span class="s0">, </span><span class="s1">state2[key])</span>
    <span class="s0">elif </span><span class="s1">type(state1) != type(state2):</span>
        <span class="s1">identical &amp;= type(state1) == type(state2)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">if </span><span class="s1">(isinstance(state1</span><span class="s0">, </span><span class="s1">(list</span><span class="s0">, </span><span class="s1">tuple</span><span class="s0">, </span><span class="s1">np.ndarray)) </span><span class="s0">and </span><span class="s1">isinstance(</span>
                <span class="s1">state2</span><span class="s0">, </span><span class="s1">(list</span><span class="s0">, </span><span class="s1">tuple</span><span class="s0">, </span><span class="s1">np.ndarray))):</span>
            <span class="s0">for </span><span class="s1">s1</span><span class="s0">, </span><span class="s1">s2 </span><span class="s0">in </span><span class="s1">zip(state1</span><span class="s0">, </span><span class="s1">state2):</span>
                <span class="s1">identical &amp;= comp_state(s1</span><span class="s0">, </span><span class="s1">s2)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">identical &amp;= state1 == state2</span>
    <span class="s0">return </span><span class="s1">identical</span>


<span class="s0">def </span><span class="s1">warmup(rg</span><span class="s0">, </span><span class="s1">n=</span><span class="s0">None</span><span class="s1">):</span>
    <span class="s0">if </span><span class="s1">n </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">n = </span><span class="s3">11 </span><span class="s1">+ np.random.randint(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
    <span class="s1">rg.standard_normal(n)</span>
    <span class="s1">rg.standard_normal(n)</span>
    <span class="s1">rg.standard_normal(n</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
    <span class="s1">rg.standard_normal(n</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
    <span class="s1">rg.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">** </span><span class="s3">24</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">dtype=np.uint64)</span>
    <span class="s1">rg.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">** </span><span class="s3">48</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">dtype=np.uint64)</span>
    <span class="s1">rg.standard_gamma(</span><span class="s3">11.0</span><span class="s0">, </span><span class="s1">n)</span>
    <span class="s1">rg.standard_gamma(</span><span class="s3">11.0</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
    <span class="s1">rg.random(n</span><span class="s0">, </span><span class="s1">dtype=np.float64)</span>
    <span class="s1">rg.random(n</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>


<span class="s0">class </span><span class="s1">RNG:</span>
    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">setup_class(cls):</span>
        <span class="s4"># Overridden in test classes. Place holder to silence IDE noise</span>
        <span class="s1">cls.bit_generator = PCG64</span>
        <span class="s1">cls.advance = </span><span class="s0">None</span>
        <span class="s1">cls.seed = [</span><span class="s3">12345</span><span class="s1">]</span>
        <span class="s1">cls.rg = Generator(cls.bit_generator(*cls.seed))</span>
        <span class="s1">cls.initial_state = cls.rg.bit_generator.state</span>
        <span class="s1">cls.seed_vector_bits = </span><span class="s3">64</span>
        <span class="s1">cls._extra_setup()</span>

    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">_extra_setup(cls):</span>
        <span class="s1">cls.vec_1d = np.arange(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">102.0</span><span class="s1">)</span>
        <span class="s1">cls.vec_2d = np.arange(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">102.0</span><span class="s1">)[</span><span class="s0">None, </span><span class="s1">:]</span>
        <span class="s1">cls.mat = np.arange(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">102.0</span><span class="s0">, </span><span class="s3">0.01</span><span class="s1">).reshape((</span><span class="s3">100</span><span class="s0">, </span><span class="s3">100</span><span class="s1">))</span>
        <span class="s1">cls.seed_error = TypeError</span>

    <span class="s0">def </span><span class="s1">_reset_state(self):</span>
        <span class="s1">self.rg.bit_generator.state = self.initial_state</span>

    <span class="s0">def </span><span class="s1">test_init(self):</span>
        <span class="s1">rg = Generator(self.bit_generator())</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">rg.standard_normal(</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">rg.standard_normal(</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">new_state = rg.bit_generator.state</span>
        <span class="s1">assert_(comp_state(state</span><span class="s0">, </span><span class="s1">new_state))</span>

    <span class="s0">def </span><span class="s1">test_advance(self):</span>
        <span class="s1">state = self.rg.bit_generator.state</span>
        <span class="s0">if </span><span class="s1">hasattr(self.rg.bit_generator</span><span class="s0">, </span><span class="s2">'advance'</span><span class="s1">):</span>
            <span class="s1">self.rg.bit_generator.advance(self.advance)</span>
            <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">comp_state(state</span><span class="s0">, </span><span class="s1">self.rg.bit_generator.state))</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">bitgen_name = self.rg.bit_generator.__class__.__name__</span>
            <span class="s1">pytest.skip(</span><span class="s2">f'Advance is not supported by </span><span class="s0">{</span><span class="s1">bitgen_name</span><span class="s0">}</span><span class="s2">'</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_jump(self):</span>
        <span class="s1">state = self.rg.bit_generator.state</span>
        <span class="s0">if </span><span class="s1">hasattr(self.rg.bit_generator</span><span class="s0">, </span><span class="s2">'jumped'</span><span class="s1">):</span>
            <span class="s1">bit_gen2 = self.rg.bit_generator.jumped()</span>
            <span class="s1">jumped_state = bit_gen2.state</span>
            <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">comp_state(state</span><span class="s0">, </span><span class="s1">jumped_state))</span>
            <span class="s1">self.rg.random(</span><span class="s3">2 </span><span class="s1">* </span><span class="s3">3 </span><span class="s1">* </span><span class="s3">5 </span><span class="s1">* </span><span class="s3">7 </span><span class="s1">* </span><span class="s3">11 </span><span class="s1">* </span><span class="s3">13 </span><span class="s1">* </span><span class="s3">17</span><span class="s1">)</span>
            <span class="s1">self.rg.bit_generator.state = state</span>
            <span class="s1">bit_gen3 = self.rg.bit_generator.jumped()</span>
            <span class="s1">rejumped_state = bit_gen3.state</span>
            <span class="s1">assert_(comp_state(jumped_state</span><span class="s0">, </span><span class="s1">rejumped_state))</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">bitgen_name = self.rg.bit_generator.__class__.__name__</span>
            <span class="s0">if </span><span class="s1">bitgen_name </span><span class="s0">not in </span><span class="s1">(</span><span class="s2">'SFC64'</span><span class="s0">,</span><span class="s1">):</span>
                <span class="s0">raise </span><span class="s1">AttributeError(</span><span class="s2">f'no &quot;jumped&quot; in </span><span class="s0">{</span><span class="s1">bitgen_name</span><span class="s0">}</span><span class="s2">'</span><span class="s1">)</span>
            <span class="s1">pytest.skip(</span><span class="s2">f'Jump is not supported by </span><span class="s0">{</span><span class="s1">bitgen_name</span><span class="s0">}</span><span class="s2">'</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uniform(self):</span>
        <span class="s1">r = self.rg.uniform(-</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(r) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_((r &gt; -</span><span class="s3">1</span><span class="s1">).all())</span>
        <span class="s1">assert_((r &lt;= </span><span class="s3">0</span><span class="s1">).all())</span>

    <span class="s0">def </span><span class="s1">test_uniform_array(self):</span>
        <span class="s1">r = self.rg.uniform(np.array([-</span><span class="s3">1.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(r) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_((r &gt; -</span><span class="s3">1</span><span class="s1">).all())</span>
        <span class="s1">assert_((r &lt;= </span><span class="s3">0</span><span class="s1">).all())</span>
        <span class="s1">r = self.rg.uniform(np.array([-</span><span class="s3">1.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">,</span>
                            <span class="s1">np.array([</span><span class="s3">0.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(r) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_((r &gt; -</span><span class="s3">1</span><span class="s1">).all())</span>
        <span class="s1">assert_((r &lt;= </span><span class="s3">0</span><span class="s1">).all())</span>
        <span class="s1">r = self.rg.uniform(-</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">0.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(r) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_((r &gt; -</span><span class="s3">1</span><span class="s1">).all())</span>
        <span class="s1">assert_((r &lt;= </span><span class="s3">0</span><span class="s1">).all())</span>

    <span class="s0">def </span><span class="s1">test_random(self):</span>
        <span class="s1">assert_(len(self.rg.random(</span><span class="s3">10</span><span class="s1">)) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_0(self.rg.random)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal_zig(self):</span>
        <span class="s1">assert_(len(self.rg.standard_normal(</span><span class="s3">10</span><span class="s1">)) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal(self):</span>
        <span class="s1">assert_(len(self.rg.standard_normal(</span><span class="s3">10</span><span class="s1">)) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_0(self.rg.standard_normal)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma(self):</span>
        <span class="s1">assert_(len(self.rg.standard_gamma(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(self.rg.standard_gamma(np.array([</span><span class="s3">10</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_1(self.rg.standard_gamma)</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential(self):</span>
        <span class="s1">assert_(len(self.rg.standard_exponential(</span><span class="s3">10</span><span class="s1">)) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_0(self.rg.standard_exponential)</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential_float(self):</span>
        <span class="s1">randoms = self.rg.standard_exponential(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'float32'</span><span class="s1">)</span>
        <span class="s1">assert_(len(randoms) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">randoms.dtype == np.float32</span>
        <span class="s1">params_0(partial(self.rg.standard_exponential</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'float32'</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential_float_log(self):</span>
        <span class="s1">randoms = self.rg.standard_exponential(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'float32'</span><span class="s0">,</span>
                                               <span class="s1">method=</span><span class="s2">'inv'</span><span class="s1">)</span>
        <span class="s1">assert_(len(randoms) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">randoms.dtype == np.float32</span>
        <span class="s1">params_0(partial(self.rg.standard_exponential</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'float32'</span><span class="s0">,</span>
                         <span class="s1">method=</span><span class="s2">'inv'</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_standard_cauchy(self):</span>
        <span class="s1">assert_(len(self.rg.standard_cauchy(</span><span class="s3">10</span><span class="s1">)) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_0(self.rg.standard_cauchy)</span>

    <span class="s0">def </span><span class="s1">test_standard_t(self):</span>
        <span class="s1">assert_(len(self.rg.standard_t(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_1(self.rg.standard_t)</span>

    <span class="s0">def </span><span class="s1">test_binomial(self):</span>
        <span class="s1">assert_(self.rg.binomial(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">.5</span><span class="s1">) &gt;= </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_(self.rg.binomial(</span><span class="s3">1000</span><span class="s0">, </span><span class="s3">.5</span><span class="s1">) &gt;= </span><span class="s3">0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_reset_state(self):</span>
        <span class="s1">state = self.rg.bit_generator.state</span>
        <span class="s1">int_1 = self.rg.integers(</span><span class="s3">2</span><span class="s1">**</span><span class="s3">31</span><span class="s1">)</span>
        <span class="s1">self.rg.bit_generator.state = state</span>
        <span class="s1">int_2 = self.rg.integers(</span><span class="s3">2</span><span class="s1">**</span><span class="s3">31</span><span class="s1">)</span>
        <span class="s1">assert_(int_1 == int_2)</span>

    <span class="s0">def </span><span class="s1">test_entropy_init(self):</span>
        <span class="s1">rg = Generator(self.bit_generator())</span>
        <span class="s1">rg2 = Generator(self.bit_generator())</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">comp_state(rg.bit_generator.state</span><span class="s0">,</span>
                               <span class="s1">rg2.bit_generator.state))</span>

    <span class="s0">def </span><span class="s1">test_seed(self):</span>
        <span class="s1">rg = Generator(self.bit_generator(*self.seed))</span>
        <span class="s1">rg2 = Generator(self.bit_generator(*self.seed))</span>
        <span class="s1">rg.random()</span>
        <span class="s1">rg2.random()</span>
        <span class="s1">assert_(comp_state(rg.bit_generator.state</span><span class="s0">, </span><span class="s1">rg2.bit_generator.state))</span>

    <span class="s0">def </span><span class="s1">test_reset_state_gauss(self):</span>
        <span class="s1">rg = Generator(self.bit_generator(*self.seed))</span>
        <span class="s1">rg.standard_normal()</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">n1 = rg.standard_normal(size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">rg2 = Generator(self.bit_generator())</span>
        <span class="s1">rg2.bit_generator.state = state</span>
        <span class="s1">n2 = rg2.standard_normal(size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(n1</span><span class="s0">, </span><span class="s1">n2)</span>

    <span class="s0">def </span><span class="s1">test_reset_state_uint32(self):</span>
        <span class="s1">rg = Generator(self.bit_generator(*self.seed))</span>
        <span class="s1">rg.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">** </span><span class="s3">24</span><span class="s0">, </span><span class="s3">120</span><span class="s0">, </span><span class="s1">dtype=np.uint32)</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">n1 = rg.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">** </span><span class="s3">24</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=np.uint32)</span>
        <span class="s1">rg2 = Generator(self.bit_generator())</span>
        <span class="s1">rg2.bit_generator.state = state</span>
        <span class="s1">n2 = rg2.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">** </span><span class="s3">24</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=np.uint32)</span>
        <span class="s1">assert_array_equal(n1</span><span class="s0">, </span><span class="s1">n2)</span>

    <span class="s0">def </span><span class="s1">test_reset_state_float(self):</span>
        <span class="s1">rg = Generator(self.bit_generator(*self.seed))</span>
        <span class="s1">rg.random(dtype=</span><span class="s2">'float32'</span><span class="s1">)</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">n1 = rg.random(size=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'float32'</span><span class="s1">)</span>
        <span class="s1">rg2 = Generator(self.bit_generator())</span>
        <span class="s1">rg2.bit_generator.state = state</span>
        <span class="s1">n2 = rg2.random(size=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'float32'</span><span class="s1">)</span>
        <span class="s1">assert_((n1 == n2).all())</span>

    <span class="s0">def </span><span class="s1">test_shuffle(self):</span>
        <span class="s1">original = np.arange(</span><span class="s3">200</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">permuted = self.rg.permutation(original)</span>
        <span class="s1">assert_((original != permuted).any())</span>

    <span class="s0">def </span><span class="s1">test_permutation(self):</span>
        <span class="s1">original = np.arange(</span><span class="s3">200</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">permuted = self.rg.permutation(original)</span>
        <span class="s1">assert_((original != permuted).any())</span>

    <span class="s0">def </span><span class="s1">test_beta(self):</span>
        <span class="s1">vals = self.rg.beta(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.beta(np.array([</span><span class="s3">2.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.beta(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">2.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">))</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.beta(np.array([</span><span class="s3">2.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">2.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">))</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.beta(np.array([</span><span class="s3">2.0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.array([[</span><span class="s3">2.0</span><span class="s1">]] * </span><span class="s3">10</span><span class="s1">))</span>
        <span class="s1">assert_(vals.shape == (</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_bytes(self):</span>
        <span class="s1">vals = self.rg.bytes(</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare(self):</span>
        <span class="s1">vals = self.rg.chisquare(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_1(self.rg.chisquare)</span>

    <span class="s0">def </span><span class="s1">test_exponential(self):</span>
        <span class="s1">vals = self.rg.exponential(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_1(self.rg.exponential)</span>

    <span class="s0">def </span><span class="s1">test_f(self):</span>
        <span class="s1">vals = self.rg.f(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1000</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma(self):</span>
        <span class="s1">vals = self.rg.gamma(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_geometric(self):</span>
        <span class="s1">vals = self.rg.geometric(</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_1(self.rg.exponential</span><span class="s0">, </span><span class="s1">bounded=</span><span class="s0">True</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel(self):</span>
        <span class="s1">vals = self.rg.gumbel(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_laplace(self):</span>
        <span class="s1">vals = self.rg.laplace(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logitic(self):</span>
        <span class="s1">vals = self.rg.logistic(</span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">2.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logseries(self):</span>
        <span class="s1">vals = self.rg.logseries(</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s1">vals = self.rg.negative_binomial(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare(self):</span>
        <span class="s1">vals = self.rg.noncentral_chisquare(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f(self):</span>
        <span class="s1">vals = self.rg.noncentral_f(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1000</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.noncentral_f(np.array([</span><span class="s3">3</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1000</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.noncentral_f(</span><span class="s3">3</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">1000</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.noncentral_f(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1000</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">2</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">))</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s1">vals = self.rg.normal(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_pareto(self):</span>
        <span class="s1">vals = self.rg.pareto(</span><span class="s3">3.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_poisson(self):</span>
        <span class="s1">vals = self.rg.poisson(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.poisson(np.array([</span><span class="s3">10</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">))</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_1(self.rg.poisson)</span>

    <span class="s0">def </span><span class="s1">test_power(self):</span>
        <span class="s1">vals = self.rg.power(</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_integers(self):</span>
        <span class="s1">vals = self.rg.integers(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh(self):</span>
        <span class="s1">vals = self.rg.rayleigh(</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">params_1(self.rg.rayleigh</span><span class="s0">, </span><span class="s1">bounded=</span><span class="s0">True</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises(self):</span>
        <span class="s1">vals = self.rg.vonmises(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_wald(self):</span>
        <span class="s1">vals = self.rg.wald(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull(self):</span>
        <span class="s1">vals = self.rg.weibull(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_zipf(self):</span>
        <span class="s1">vals = self.rg.zipf(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.zipf(self.vec_1d)</span>
        <span class="s1">assert_(len(vals) == </span><span class="s3">100</span><span class="s1">)</span>
        <span class="s1">vals = self.rg.zipf(self.vec_2d)</span>
        <span class="s1">assert_(vals.shape == (</span><span class="s3">1</span><span class="s0">, </span><span class="s3">100</span><span class="s1">))</span>
        <span class="s1">vals = self.rg.zipf(self.mat)</span>
        <span class="s1">assert_(vals.shape == (</span><span class="s3">100</span><span class="s0">, </span><span class="s3">100</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric(self):</span>
        <span class="s1">vals = self.rg.hypergeometric(</span><span class="s3">25</span><span class="s0">, </span><span class="s3">25</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
        <span class="s1">assert_(np.isscalar(vals))</span>
        <span class="s1">vals = self.rg.hypergeometric(np.array([</span><span class="s3">25</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s3">25</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
        <span class="s1">assert_(vals.shape == (</span><span class="s3">10</span><span class="s0">,</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_triangular(self):</span>
        <span class="s1">vals = self.rg.triangular(-</span><span class="s3">5</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)</span>
        <span class="s1">assert_(np.isscalar(vals))</span>
        <span class="s1">vals = self.rg.triangular(-</span><span class="s3">5</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">0</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)</span>
        <span class="s1">assert_(vals.shape == (</span><span class="s3">10</span><span class="s0">,</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_multivariate_normal(self):</span>
        <span class="s1">mean = [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">cov = [[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">100</span><span class="s1">]]  </span><span class="s4"># diagonal covariance</span>
        <span class="s1">x = self.rg.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s3">5000</span><span class="s1">)</span>
        <span class="s1">assert_(x.shape == (</span><span class="s3">5000</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">x_zig = self.rg.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s3">5000</span><span class="s1">)</span>
        <span class="s1">assert_(x.shape == (</span><span class="s3">5000</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">x_inv = self.rg.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s3">5000</span><span class="s1">)</span>
        <span class="s1">assert_(x.shape == (</span><span class="s3">5000</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_((x_zig != x_inv).any())</span>

    <span class="s0">def </span><span class="s1">test_multinomial(self):</span>
        <span class="s1">vals = self.rg.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1.0 </span><span class="s1">/ </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2.0 </span><span class="s1">/ </span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">assert_(vals.shape == (</span><span class="s3">2</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">vals = self.rg.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1.0 </span><span class="s1">/ </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2.0 </span><span class="s1">/ </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_(vals.shape == (</span><span class="s3">10</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet(self):</span>
        <span class="s1">s = self.rg.dirichlet((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
        <span class="s1">assert_(s.shape == (</span><span class="s3">20</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_pickle(self):</span>
        <span class="s1">pick = pickle.dumps(self.rg)</span>
        <span class="s1">unpick = pickle.loads(pick)</span>
        <span class="s1">assert_((type(self.rg) == type(unpick)))</span>
        <span class="s1">assert_(comp_state(self.rg.bit_generator.state</span><span class="s0">,</span>
                           <span class="s1">unpick.bit_generator.state))</span>

        <span class="s1">pick = pickle.dumps(self.rg)</span>
        <span class="s1">unpick = pickle.loads(pick)</span>
        <span class="s1">assert_((type(self.rg) == type(unpick)))</span>
        <span class="s1">assert_(comp_state(self.rg.bit_generator.state</span><span class="s0">,</span>
                           <span class="s1">unpick.bit_generator.state))</span>

    <span class="s0">def </span><span class="s1">test_seed_array(self):</span>
        <span class="s0">if </span><span class="s1">self.seed_vector_bits </span><span class="s0">is None</span><span class="s1">:</span>
            <span class="s1">bitgen_name = self.bit_generator.__name__</span>
            <span class="s1">pytest.skip(</span><span class="s2">f'Vector seeding is not supported by </span><span class="s0">{</span><span class="s1">bitgen_name</span><span class="s0">}</span><span class="s2">'</span><span class="s1">)</span>

        <span class="s0">if </span><span class="s1">self.seed_vector_bits == </span><span class="s3">32</span><span class="s1">:</span>
            <span class="s1">dtype = np.uint32</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">dtype = np.uint64</span>
        <span class="s1">seed = np.array([</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">bg = self.bit_generator(seed)</span>
        <span class="s1">state1 = bg.state</span>
        <span class="s1">bg = self.bit_generator(</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">state2 = bg.state</span>
        <span class="s1">assert_(comp_state(state1</span><span class="s0">, </span><span class="s1">state2))</span>

        <span class="s1">seed = np.arange(</span><span class="s3">4</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">bg = self.bit_generator(seed)</span>
        <span class="s1">state1 = bg.state</span>
        <span class="s1">bg = self.bit_generator(seed[</span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">state2 = bg.state</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">comp_state(state1</span><span class="s0">, </span><span class="s1">state2))</span>

        <span class="s1">seed = np.arange(</span><span class="s3">1500</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">bg = self.bit_generator(seed)</span>
        <span class="s1">state1 = bg.state</span>
        <span class="s1">bg = self.bit_generator(seed[</span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">state2 = bg.state</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">comp_state(state1</span><span class="s0">, </span><span class="s1">state2))</span>

        <span class="s1">seed = </span><span class="s3">2 </span><span class="s1">** np.mod(np.arange(</span><span class="s3">1500</span><span class="s0">, </span><span class="s1">dtype=dtype)</span><span class="s0">,</span>
                           <span class="s1">self.seed_vector_bits - </span><span class="s3">1</span><span class="s1">) + </span><span class="s3">1</span>
        <span class="s1">bg = self.bit_generator(seed)</span>
        <span class="s1">state1 = bg.state</span>
        <span class="s1">bg  = self.bit_generator(seed[</span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">state2 = bg.state</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">comp_state(state1</span><span class="s0">, </span><span class="s1">state2))</span>

    <span class="s0">def </span><span class="s1">test_uniform_float(self):</span>
        <span class="s1">rg = Generator(self.bit_generator(</span><span class="s3">12345</span><span class="s1">))</span>
        <span class="s1">warmup(rg)</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">r1 = rg.random(</span><span class="s3">11</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg2 = Generator(self.bit_generator())</span>
        <span class="s1">warmup(rg2)</span>
        <span class="s1">rg2.bit_generator.state = state</span>
        <span class="s1">r2 = rg2.random(</span><span class="s3">11</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_array_equal(r1</span><span class="s0">, </span><span class="s1">r2)</span>
        <span class="s1">assert_equal(r1.dtype</span><span class="s0">, </span><span class="s1">np.float32)</span>
        <span class="s1">assert_(comp_state(rg.bit_generator.state</span><span class="s0">, </span><span class="s1">rg2.bit_generator.state))</span>

    <span class="s0">def </span><span class="s1">test_gamma_floats(self):</span>
        <span class="s1">rg = Generator(self.bit_generator())</span>
        <span class="s1">warmup(rg)</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">r1 = rg.standard_gamma(</span><span class="s3">4.0</span><span class="s0">, </span><span class="s3">11</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg2 = Generator(self.bit_generator())</span>
        <span class="s1">warmup(rg2)</span>
        <span class="s1">rg2.bit_generator.state = state</span>
        <span class="s1">r2 = rg2.standard_gamma(</span><span class="s3">4.0</span><span class="s0">, </span><span class="s3">11</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_array_equal(r1</span><span class="s0">, </span><span class="s1">r2)</span>
        <span class="s1">assert_equal(r1.dtype</span><span class="s0">, </span><span class="s1">np.float32)</span>
        <span class="s1">assert_(comp_state(rg.bit_generator.state</span><span class="s0">, </span><span class="s1">rg2.bit_generator.state))</span>

    <span class="s0">def </span><span class="s1">test_normal_floats(self):</span>
        <span class="s1">rg = Generator(self.bit_generator())</span>
        <span class="s1">warmup(rg)</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">r1 = rg.standard_normal(</span><span class="s3">11</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg2 = Generator(self.bit_generator())</span>
        <span class="s1">warmup(rg2)</span>
        <span class="s1">rg2.bit_generator.state = state</span>
        <span class="s1">r2 = rg2.standard_normal(</span><span class="s3">11</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_array_equal(r1</span><span class="s0">, </span><span class="s1">r2)</span>
        <span class="s1">assert_equal(r1.dtype</span><span class="s0">, </span><span class="s1">np.float32)</span>
        <span class="s1">assert_(comp_state(rg.bit_generator.state</span><span class="s0">, </span><span class="s1">rg2.bit_generator.state))</span>

    <span class="s0">def </span><span class="s1">test_normal_zig_floats(self):</span>
        <span class="s1">rg = Generator(self.bit_generator())</span>
        <span class="s1">warmup(rg)</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">r1 = rg.standard_normal(</span><span class="s3">11</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg2 = Generator(self.bit_generator())</span>
        <span class="s1">warmup(rg2)</span>
        <span class="s1">rg2.bit_generator.state = state</span>
        <span class="s1">r2 = rg2.standard_normal(</span><span class="s3">11</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_array_equal(r1</span><span class="s0">, </span><span class="s1">r2)</span>
        <span class="s1">assert_equal(r1.dtype</span><span class="s0">, </span><span class="s1">np.float32)</span>
        <span class="s1">assert_(comp_state(rg.bit_generator.state</span><span class="s0">, </span><span class="s1">rg2.bit_generator.state))</span>

    <span class="s0">def </span><span class="s1">test_output_fill(self):</span>
        <span class="s1">rg = self.rg</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">size = (</span><span class="s3">31</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">97</span><span class="s1">)</span>
        <span class="s1">existing = np.empty(size)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_normal(out=existing)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.standard_normal(size=size)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

        <span class="s1">sized = np.empty(size)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_normal(out=sized</span><span class="s0">, </span><span class="s1">size=sized.shape)</span>

        <span class="s1">existing = np.empty(size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_normal(out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.standard_normal(size=size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

    <span class="s0">def </span><span class="s1">test_output_filling_uniform(self):</span>
        <span class="s1">rg = self.rg</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">size = (</span><span class="s3">31</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">97</span><span class="s1">)</span>
        <span class="s1">existing = np.empty(size)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.random(out=existing)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.random(size=size)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

        <span class="s1">existing = np.empty(size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.random(out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.random(size=size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

    <span class="s0">def </span><span class="s1">test_output_filling_exponential(self):</span>
        <span class="s1">rg = self.rg</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">size = (</span><span class="s3">31</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">97</span><span class="s1">)</span>
        <span class="s1">existing = np.empty(size)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_exponential(out=existing)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.standard_exponential(size=size)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

        <span class="s1">existing = np.empty(size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_exponential(out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.standard_exponential(size=size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

    <span class="s0">def </span><span class="s1">test_output_filling_gamma(self):</span>
        <span class="s1">rg = self.rg</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">size = (</span><span class="s3">31</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">97</span><span class="s1">)</span>
        <span class="s1">existing = np.zeros(size)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_gamma(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">out=existing)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.standard_gamma(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">size=size)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

        <span class="s1">existing = np.zeros(size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_gamma(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.standard_gamma(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">size=size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

    <span class="s0">def </span><span class="s1">test_output_filling_gamma_broadcast(self):</span>
        <span class="s1">rg = self.rg</span>
        <span class="s1">state = rg.bit_generator.state</span>
        <span class="s1">size = (</span><span class="s3">31</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">97</span><span class="s1">)</span>
        <span class="s1">mu = np.arange(</span><span class="s3">97.0</span><span class="s1">) + </span><span class="s3">1.0</span>
        <span class="s1">existing = np.zeros(size)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_gamma(mu</span><span class="s0">, </span><span class="s1">out=existing)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.standard_gamma(mu</span><span class="s0">, </span><span class="s1">size=size)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

        <span class="s1">existing = np.zeros(size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">rg.standard_gamma(mu</span><span class="s0">, </span><span class="s1">out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">rg.bit_generator.state = state</span>
        <span class="s1">direct = rg.standard_gamma(mu</span><span class="s0">, </span><span class="s1">size=size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_equal(direct</span><span class="s0">, </span><span class="s1">existing)</span>

    <span class="s0">def </span><span class="s1">test_output_fill_error(self):</span>
        <span class="s1">rg = self.rg</span>
        <span class="s1">size = (</span><span class="s3">31</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">97</span><span class="s1">)</span>
        <span class="s1">existing = np.empty(size)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(TypeError):</span>
            <span class="s1">rg.standard_normal(out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">rg.standard_normal(out=existing[::</span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">existing = np.empty(size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(TypeError):</span>
            <span class="s1">rg.standard_normal(out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float64)</span>

        <span class="s1">existing = np.zeros(size</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(TypeError):</span>
            <span class="s1">rg.standard_gamma(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float64)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">rg.standard_gamma(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">out=existing[::</span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">existing = np.zeros(size</span><span class="s0">, </span><span class="s1">dtype=np.float64)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(TypeError):</span>
            <span class="s1">rg.standard_gamma(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">out=existing</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">rg.standard_gamma(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s1">out=existing[::</span><span class="s3">3</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_integers_broadcast(self</span><span class="s0">, </span><span class="s1">dtype):</span>
        <span class="s0">if </span><span class="s1">dtype == np.bool_:</span>
            <span class="s1">upper = </span><span class="s3">2</span>
            <span class="s1">lower = </span><span class="s3">0</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">info = np.iinfo(dtype)</span>
            <span class="s1">upper = int(info.max) + </span><span class="s3">1</span>
            <span class="s1">lower = info.min</span>
        <span class="s1">self._reset_state()</span>
        <span class="s1">a = self.rg.integers(lower</span><span class="s0">, </span><span class="s1">[upper] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">self._reset_state()</span>
        <span class="s1">b = self.rg.integers([lower] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">upper</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">assert_equal(a</span><span class="s0">, </span><span class="s1">b)</span>
        <span class="s1">self._reset_state()</span>
        <span class="s1">c = self.rg.integers(lower</span><span class="s0">, </span><span class="s1">upper</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">assert_equal(a</span><span class="s0">, </span><span class="s1">c)</span>
        <span class="s1">self._reset_state()</span>
        <span class="s1">d = self.rg.integers(np.array(</span>
            <span class="s1">[lower] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.array([upper]</span><span class="s0">, </span><span class="s1">dtype=object)</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s0">,</span>
            <span class="s1">dtype=dtype)</span>
        <span class="s1">assert_equal(a</span><span class="s0">, </span><span class="s1">d)</span>
        <span class="s1">self._reset_state()</span>
        <span class="s1">e = self.rg.integers(</span>
            <span class="s1">np.array([lower] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.array([upper] * </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s0">,</span>
            <span class="s1">dtype=dtype)</span>
        <span class="s1">assert_equal(a</span><span class="s0">, </span><span class="s1">e)</span>

        <span class="s1">self._reset_state()</span>
        <span class="s1">a = self.rg.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">upper</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">self._reset_state()</span>
        <span class="s1">b = self.rg.integers([upper] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">assert_equal(a</span><span class="s0">, </span><span class="s1">b)</span>

    <span class="s0">def </span><span class="s1">test_integers_numpy(self</span><span class="s0">, </span><span class="s1">dtype):</span>
        <span class="s1">high = np.array([</span><span class="s3">1</span><span class="s1">])</span>
        <span class="s1">low = np.array([</span><span class="s3">0</span><span class="s1">])</span>

        <span class="s1">out = self.rg.integers(low</span><span class="s0">, </span><span class="s1">high</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s0">assert </span><span class="s1">out.shape == (</span><span class="s3">1</span><span class="s0">,</span><span class="s1">)</span>

        <span class="s1">out = self.rg.integers(low[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">high</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s0">assert </span><span class="s1">out.shape == (</span><span class="s3">1</span><span class="s0">,</span><span class="s1">)</span>

        <span class="s1">out = self.rg.integers(low</span><span class="s0">, </span><span class="s1">high[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s0">assert </span><span class="s1">out.shape == (</span><span class="s3">1</span><span class="s0">,</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_integers_broadcast_errors(self</span><span class="s0">, </span><span class="s1">dtype):</span>
        <span class="s0">if </span><span class="s1">dtype == np.bool_:</span>
            <span class="s1">upper = </span><span class="s3">2</span>
            <span class="s1">lower = </span><span class="s3">0</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">info = np.iinfo(dtype)</span>
            <span class="s1">upper = int(info.max) + </span><span class="s3">1</span>
            <span class="s1">lower = info.min</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">self.rg.integers(lower</span><span class="s0">, </span><span class="s1">[upper + </span><span class="s3">1</span><span class="s1">] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">self.rg.integers(lower - </span><span class="s3">1</span><span class="s0">, </span><span class="s1">[upper] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">self.rg.integers([lower - </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[upper] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">self.rg.integers([</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>


<span class="s0">class </span><span class="s1">TestMT19937(RNG):</span>
    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">cls.bit_generator = MT19937</span>
        <span class="s1">cls.advance = </span><span class="s0">None</span>
        <span class="s1">cls.seed = [</span><span class="s3">2 </span><span class="s1">** </span><span class="s3">21 </span><span class="s1">+ </span><span class="s3">2 </span><span class="s1">** </span><span class="s3">16 </span><span class="s1">+ </span><span class="s3">2 </span><span class="s1">** </span><span class="s3">5 </span><span class="s1">+ </span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">cls.rg = Generator(cls.bit_generator(*cls.seed))</span>
        <span class="s1">cls.initial_state = cls.rg.bit_generator.state</span>
        <span class="s1">cls.seed_vector_bits = </span><span class="s3">32</span>
        <span class="s1">cls._extra_setup()</span>
        <span class="s1">cls.seed_error = ValueError</span>

    <span class="s0">def </span><span class="s1">test_numpy_state(self):</span>
        <span class="s1">nprg = np.random.RandomState()</span>
        <span class="s1">nprg.standard_normal(</span><span class="s3">99</span><span class="s1">)</span>
        <span class="s1">state = nprg.get_state()</span>
        <span class="s1">self.rg.bit_generator.state = state</span>
        <span class="s1">state2 = self.rg.bit_generator.state</span>
        <span class="s1">assert_((state[</span><span class="s3">1</span><span class="s1">] == state2[</span><span class="s2">'state'</span><span class="s1">][</span><span class="s2">'key'</span><span class="s1">]).all())</span>
        <span class="s1">assert_((state[</span><span class="s3">2</span><span class="s1">] == state2[</span><span class="s2">'state'</span><span class="s1">][</span><span class="s2">'pos'</span><span class="s1">]))</span>


<span class="s0">class </span><span class="s1">TestPhilox(RNG):</span>
    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">cls.bit_generator = Philox</span>
        <span class="s1">cls.advance = </span><span class="s3">2</span><span class="s1">**</span><span class="s3">63 </span><span class="s1">+ </span><span class="s3">2</span><span class="s1">**</span><span class="s3">31 </span><span class="s1">+ </span><span class="s3">2</span><span class="s1">**</span><span class="s3">15 </span><span class="s1">+ </span><span class="s3">1</span>
        <span class="s1">cls.seed = [</span><span class="s3">12345</span><span class="s1">]</span>
        <span class="s1">cls.rg = Generator(cls.bit_generator(*cls.seed))</span>
        <span class="s1">cls.initial_state = cls.rg.bit_generator.state</span>
        <span class="s1">cls.seed_vector_bits = </span><span class="s3">64</span>
        <span class="s1">cls._extra_setup()</span>


<span class="s0">class </span><span class="s1">TestSFC64(RNG):</span>
    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">cls.bit_generator = SFC64</span>
        <span class="s1">cls.advance = </span><span class="s0">None</span>
        <span class="s1">cls.seed = [</span><span class="s3">12345</span><span class="s1">]</span>
        <span class="s1">cls.rg = Generator(cls.bit_generator(*cls.seed))</span>
        <span class="s1">cls.initial_state = cls.rg.bit_generator.state</span>
        <span class="s1">cls.seed_vector_bits = </span><span class="s3">192</span>
        <span class="s1">cls._extra_setup()</span>


<span class="s0">class </span><span class="s1">TestPCG64(RNG):</span>
    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">cls.bit_generator = PCG64</span>
        <span class="s1">cls.advance = </span><span class="s3">2</span><span class="s1">**</span><span class="s3">63 </span><span class="s1">+ </span><span class="s3">2</span><span class="s1">**</span><span class="s3">31 </span><span class="s1">+ </span><span class="s3">2</span><span class="s1">**</span><span class="s3">15 </span><span class="s1">+ </span><span class="s3">1</span>
        <span class="s1">cls.seed = [</span><span class="s3">12345</span><span class="s1">]</span>
        <span class="s1">cls.rg = Generator(cls.bit_generator(*cls.seed))</span>
        <span class="s1">cls.initial_state = cls.rg.bit_generator.state</span>
        <span class="s1">cls.seed_vector_bits = </span><span class="s3">64</span>
        <span class="s1">cls._extra_setup()</span>


<span class="s0">class </span><span class="s1">TestPCG64DXSM(RNG):</span>
    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">setup_class(cls):</span>
        <span class="s1">cls.bit_generator = PCG64DXSM</span>
        <span class="s1">cls.advance = </span><span class="s3">2</span><span class="s1">**</span><span class="s3">63 </span><span class="s1">+ </span><span class="s3">2</span><span class="s1">**</span><span class="s3">31 </span><span class="s1">+ </span><span class="s3">2</span><span class="s1">**</span><span class="s3">15 </span><span class="s1">+ </span><span class="s3">1</span>
        <span class="s1">cls.seed = [</span><span class="s3">12345</span><span class="s1">]</span>
        <span class="s1">cls.rg = Generator(cls.bit_generator(*cls.seed))</span>
        <span class="s1">cls.initial_state = cls.rg.bit_generator.state</span>
        <span class="s1">cls.seed_vector_bits = </span><span class="s3">64</span>
        <span class="s1">cls._extra_setup()</span>


<span class="s0">class </span><span class="s1">TestDefaultRNG(RNG):</span>
    <span class="s1">@classmethod</span>
    <span class="s0">def </span><span class="s1">setup_class(cls):</span>
        <span class="s4"># This will duplicate some tests that directly instantiate a fresh</span>
        <span class="s4"># Generator(), but that's okay.</span>
        <span class="s1">cls.bit_generator = PCG64</span>
        <span class="s1">cls.advance = </span><span class="s3">2</span><span class="s1">**</span><span class="s3">63 </span><span class="s1">+ </span><span class="s3">2</span><span class="s1">**</span><span class="s3">31 </span><span class="s1">+ </span><span class="s3">2</span><span class="s1">**</span><span class="s3">15 </span><span class="s1">+ </span><span class="s3">1</span>
        <span class="s1">cls.seed = [</span><span class="s3">12345</span><span class="s1">]</span>
        <span class="s1">cls.rg = np.random.default_rng(*cls.seed)</span>
        <span class="s1">cls.initial_state = cls.rg.bit_generator.state</span>
        <span class="s1">cls.seed_vector_bits = </span><span class="s3">64</span>
        <span class="s1">cls._extra_setup()</span>

    <span class="s0">def </span><span class="s1">test_default_is_pcg64(self):</span>
        <span class="s4"># In order to change the default BitGenerator, we'll go through</span>
        <span class="s4"># a deprecation cycle to move to a different function.</span>
        <span class="s1">assert_(isinstance(self.rg.bit_generator</span><span class="s0">, </span><span class="s1">PCG64))</span>

    <span class="s0">def </span><span class="s1">test_seed(self):</span>
        <span class="s1">np.random.default_rng()</span>
        <span class="s1">np.random.default_rng(</span><span class="s0">None</span><span class="s1">)</span>
        <span class="s1">np.random.default_rng(</span><span class="s3">12345</span><span class="s1">)</span>
        <span class="s1">np.random.default_rng(</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">np.random.default_rng(</span><span class="s3">43660444402423911716352051725018508569</span><span class="s1">)</span>
        <span class="s1">np.random.default_rng([</span><span class="s3">43660444402423911716352051725018508569</span><span class="s0">,</span>
                               <span class="s3">279705150948142787361475340226491943209</span><span class="s1">])</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">np.random.default_rng(-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">np.random.default_rng([</span><span class="s3">12345</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">])</span>
</pre>
</body>
</html>