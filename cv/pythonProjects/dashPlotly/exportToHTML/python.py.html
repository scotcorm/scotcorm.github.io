<html>
<head>
<title>python.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #808080;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
python.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
    pygments.lexers.python 
    ~~~~~~~~~~~~~~~~~~~~~~ 
 
    Lexers for Python and related languages. 
 
    :copyright: Copyright 2006-2021 by the Pygments team, see AUTHORS. 
    :license: BSD, see LICENSE for details. 
&quot;&quot;&quot;</span>

<span class="s2">import </span><span class="s1">re</span>
<span class="s2">import </span><span class="s1">keyword</span>

<span class="s2">from </span><span class="s1">pip._vendor.pygments.lexer </span><span class="s2">import </span><span class="s1">Lexer</span><span class="s2">, </span><span class="s1">RegexLexer</span><span class="s2">, </span><span class="s1">include</span><span class="s2">, </span><span class="s1">bygroups</span><span class="s2">, </span><span class="s1">using</span><span class="s2">, </span><span class="s1">\</span>
    <span class="s1">default</span><span class="s2">, </span><span class="s1">words</span><span class="s2">, </span><span class="s1">combined</span><span class="s2">, </span><span class="s1">do_insertions</span><span class="s2">, </span><span class="s1">this</span>
<span class="s2">from </span><span class="s1">pip._vendor.pygments.util </span><span class="s2">import </span><span class="s1">get_bool_opt</span><span class="s2">, </span><span class="s1">shebang_matches</span>
<span class="s2">from </span><span class="s1">pip._vendor.pygments.token </span><span class="s2">import </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Comment</span><span class="s2">, </span><span class="s1">Operator</span><span class="s2">, </span><span class="s1">Keyword</span><span class="s2">, </span><span class="s1">Name</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">\</span>
    <span class="s1">Number</span><span class="s2">, </span><span class="s1">Punctuation</span><span class="s2">, </span><span class="s1">Generic</span><span class="s2">, </span><span class="s1">Other</span><span class="s2">, </span><span class="s1">Error</span>
<span class="s2">from </span><span class="s1">pip._vendor.pygments </span><span class="s2">import </span><span class="s1">unistring </span><span class="s2">as </span><span class="s1">uni</span>

<span class="s1">__all__ = [</span><span class="s3">'PythonLexer'</span><span class="s2">, </span><span class="s3">'PythonConsoleLexer'</span><span class="s2">, </span><span class="s3">'PythonTracebackLexer'</span><span class="s2">,</span>
           <span class="s3">'Python2Lexer'</span><span class="s2">, </span><span class="s3">'Python2TracebackLexer'</span><span class="s2">,</span>
           <span class="s3">'CythonLexer'</span><span class="s2">, </span><span class="s3">'DgLexer'</span><span class="s2">, </span><span class="s3">'NumPyLexer'</span><span class="s1">]</span>

<span class="s1">line_re = re.compile(</span><span class="s3">'.*?</span><span class="s2">\n</span><span class="s3">'</span><span class="s1">)</span>


<span class="s2">class </span><span class="s1">PythonLexer(RegexLexer):</span>
    <span class="s0">&quot;&quot;&quot; 
    For `Python &lt;http://www.python.org&gt;`_ source code (version 3.x). 
 
    .. versionadded:: 0.10 
 
    .. versionchanged:: 2.5 
       This is now the default ``PythonLexer``.  It is still available as the 
       alias ``Python3Lexer``. 
    &quot;&quot;&quot;</span>

    <span class="s1">name = </span><span class="s3">'Python'</span>
    <span class="s1">aliases = [</span><span class="s3">'python'</span><span class="s2">, </span><span class="s3">'py'</span><span class="s2">, </span><span class="s3">'sage'</span><span class="s2">, </span><span class="s3">'python3'</span><span class="s2">, </span><span class="s3">'py3'</span><span class="s1">]</span>
    <span class="s1">filenames = [</span>
        <span class="s3">'*.py'</span><span class="s2">,</span>
        <span class="s3">'*.pyw'</span><span class="s2">,</span>
        <span class="s4"># Jython</span>
        <span class="s3">'*.jy'</span><span class="s2">,</span>
        <span class="s4"># Sage</span>
        <span class="s3">'*.sage'</span><span class="s2">,</span>
        <span class="s4"># SCons</span>
        <span class="s3">'*.sc'</span><span class="s2">,</span>
        <span class="s3">'SConstruct'</span><span class="s2">,</span>
        <span class="s3">'SConscript'</span><span class="s2">,</span>
        <span class="s4"># Skylark/Starlark (used by Bazel, Buck, and Pants)</span>
        <span class="s3">'*.bzl'</span><span class="s2">,</span>
        <span class="s3">'BUCK'</span><span class="s2">,</span>
        <span class="s3">'BUILD'</span><span class="s2">,</span>
        <span class="s3">'BUILD.bazel'</span><span class="s2">,</span>
        <span class="s3">'WORKSPACE'</span><span class="s2">,</span>
        <span class="s4"># Twisted Application infrastructure</span>
        <span class="s3">'*.tac'</span><span class="s2">,</span>
    <span class="s1">]</span>
    <span class="s1">mimetypes = [</span><span class="s3">'text/x-python'</span><span class="s2">, </span><span class="s3">'application/x-python'</span><span class="s2">,</span>
                 <span class="s3">'text/x-python3'</span><span class="s2">, </span><span class="s3">'application/x-python3'</span><span class="s1">]</span>

    <span class="s1">flags = re.MULTILINE | re.UNICODE</span>

    <span class="s1">uni_name = </span><span class="s3">&quot;[%s][%s]*&quot; </span><span class="s1">% (uni.xid_start</span><span class="s2">, </span><span class="s1">uni.xid_continue)</span>

    <span class="s2">def </span><span class="s1">innerstring_rules(ttype):</span>
        <span class="s2">return </span><span class="s1">[</span>
            <span class="s4"># the old style '%s' % (...) string formatting (still valid in Py3)</span>
            <span class="s1">(</span><span class="s3">r'%(\(\w+\))?[-#0 +]*([0-9]+|[*])?(\.([0-9]+|[*]))?'</span>
             <span class="s3">'[hlL]?[E-GXc-giorsaux%]'</span><span class="s2">, </span><span class="s1">String.Interpol)</span><span class="s2">,</span>
            <span class="s4"># the new style '{}'.format(...) string formatting</span>
            <span class="s1">(</span><span class="s3">r'\{'</span>
             <span class="s3">r'((\w+)((\.\w+)|(\[[^\]]+\]))*)?'  </span><span class="s4"># field name</span>
             <span class="s3">r'(\![sra])?'                       </span><span class="s4"># conversion</span>
             <span class="s3">r'(\:(.?[&lt;&gt;=\^])?[-+ ]?#?0?(\d+)?,?(\.\d+)?[E-GXb-gnosx%]?)?'</span>
             <span class="s3">r'\}'</span><span class="s2">, </span><span class="s1">String.Interpol)</span><span class="s2">,</span>

            <span class="s4"># backslashes, quotes and formatting signs must be parsed one at a time</span>
            <span class="s1">(</span><span class="s3">r'[^\\\'&quot;%{\n]+'</span><span class="s2">, </span><span class="s1">ttype)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[\'&quot;\\]'</span><span class="s2">, </span><span class="s1">ttype)</span><span class="s2">,</span>
            <span class="s4"># unhandled string formatting sign</span>
            <span class="s1">(</span><span class="s3">r'%|(\{{1,2})'</span><span class="s2">, </span><span class="s1">ttype)</span>
            <span class="s4"># newlines are an error (use &quot;nl&quot; state)</span>
        <span class="s1">]</span>

    <span class="s2">def </span><span class="s1">fstring_rules(ttype):</span>
        <span class="s2">return </span><span class="s1">[</span>
            <span class="s4"># Assuming that a '}' is the closing brace after format specifier.</span>
            <span class="s4"># Sadly, this means that we won't detect syntax error. But it's</span>
            <span class="s4"># more important to parse correct syntax correctly, than to</span>
            <span class="s4"># highlight invalid syntax.</span>
            <span class="s1">(</span><span class="s3">r'\}'</span><span class="s2">, </span><span class="s1">String.Interpol)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\{'</span><span class="s2">, </span><span class="s1">String.Interpol</span><span class="s2">, </span><span class="s3">'expr-inside-fstring'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s4"># backslashes, quotes and formatting signs must be parsed one at a time</span>
            <span class="s1">(</span><span class="s3">r'[^\\\'&quot;{}\n]+'</span><span class="s2">, </span><span class="s1">ttype)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[\'&quot;\\]'</span><span class="s2">, </span><span class="s1">ttype)</span><span class="s2">,</span>
            <span class="s4"># newlines are an error (use &quot;nl&quot; state)</span>
        <span class="s1">]</span>

    <span class="s1">tokens = {</span>
        <span class="s3">'root'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^(\s*)([rRuUbB]{,2})(&quot;&quot;&quot;(?:.|\n)*?&quot;&quot;&quot;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">String.Affix</span><span class="s2">, </span><span class="s1">String.Doc))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;^(\s*)([rRuUbB]{,2})('''(?:.|\n)*?''')&quot;</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">String.Affix</span><span class="s2">, </span><span class="s1">String.Doc))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\A#!.+$'</span><span class="s2">, </span><span class="s1">Comment.Hashbang)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'#.*$'</span><span class="s2">, </span><span class="s1">Comment.Single)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\\n'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'keywords'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'soft-keywords'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(def)((?:\s|\\\s)+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'funcname'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(class)((?:\s|\\\s)+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'classname'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(from)((?:\s|\\\s)+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword.Namespace</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
             <span class="s3">'fromimport'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(import)((?:\s|\\\s)+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword.Namespace</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
             <span class="s3">'import'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'expr'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'expr'</span><span class="s1">: [</span>
            <span class="s4"># raw f-strings</span>
            <span class="s1">(</span><span class="s3">'(?i)(rf|fr)(&quot;&quot;&quot;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'rfstringescape'</span><span class="s2">, </span><span class="s3">'tdqf'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;(?i)(rf|fr)(''')&quot;</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'rfstringescape'</span><span class="s2">, </span><span class="s3">'tsqf'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'(?i)(rf|fr)(&quot;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'rfstringescape'</span><span class="s2">, </span><span class="s3">'dqf'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;(?i)(rf|fr)(')&quot;</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'rfstringescape'</span><span class="s2">, </span><span class="s3">'sqf'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s4"># non-raw f-strings</span>
            <span class="s1">(</span><span class="s3">'([fF])(&quot;&quot;&quot;)'</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'fstringescape'</span><span class="s2">, </span><span class="s3">'tdqf'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;([fF])(''')&quot;</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'fstringescape'</span><span class="s2">, </span><span class="s3">'tsqf'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'([fF])(&quot;)'</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'fstringescape'</span><span class="s2">, </span><span class="s3">'dqf'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;([fF])(')&quot;</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'fstringescape'</span><span class="s2">, </span><span class="s3">'sqf'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s4"># raw strings</span>
            <span class="s1">(</span><span class="s3">'(?i)(rb|br|r)(&quot;&quot;&quot;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">, </span><span class="s3">'tdqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;(?i)(rb|br|r)(''')&quot;</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">, </span><span class="s3">'tsqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'(?i)(rb|br|r)(&quot;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">, </span><span class="s3">'dqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;(?i)(rb|br|r)(')&quot;</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">, </span><span class="s3">'sqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s4"># non-raw strings</span>
            <span class="s1">(</span><span class="s3">'([uUbB]?)(&quot;&quot;&quot;)'</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'tdqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;([uUbB]?)(''')&quot;</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'tsqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'([uUbB]?)(&quot;)'</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'dqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;([uUbB]?)(')&quot;</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'sqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[^\S\n]+'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'numbers'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'!=|==|&lt;&lt;|&gt;&gt;|:=|[-~+/*%=&lt;&gt;&amp;^|.]'</span><span class="s2">, </span><span class="s1">Operator)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[]{}:(),;[]'</span><span class="s2">, </span><span class="s1">Punctuation)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(in|is|and|or|not)\b'</span><span class="s2">, </span><span class="s1">Operator.Word)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'expr-keywords'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'builtins'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'magicfuncs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'magicvars'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'name'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'expr-inside-fstring'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'[{([]'</span><span class="s2">, </span><span class="s1">Punctuation</span><span class="s2">, </span><span class="s3">'expr-inside-fstring-inner'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s4"># without format specifier</span>
            <span class="s1">(</span><span class="s3">r'(=\s*)?'         </span><span class="s4"># debug (https://bugs.python.org/issue36817)</span>
             <span class="s3">r'(\![sraf])?'     </span><span class="s4"># conversion</span>
             <span class="s3">r'\}'</span><span class="s2">, </span><span class="s1">String.Interpol</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s4"># with format specifier</span>
            <span class="s4"># we'll catch the remaining '}' in the outer scope</span>
            <span class="s1">(</span><span class="s3">r'(=\s*)?'         </span><span class="s4"># debug (https://bugs.python.org/issue36817)</span>
             <span class="s3">r'(\![sraf])?'     </span><span class="s4"># conversion</span>
             <span class="s3">r':'</span><span class="s2">, </span><span class="s1">String.Interpol</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\s+'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,  </span><span class="s4"># allow new lines</span>
            <span class="s1">include(</span><span class="s3">'expr'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'expr-inside-fstring-inner'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'[{([]'</span><span class="s2">, </span><span class="s1">Punctuation</span><span class="s2">, </span><span class="s3">'expr-inside-fstring-inner'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[])}]'</span><span class="s2">, </span><span class="s1">Punctuation</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\s+'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,  </span><span class="s4"># allow new lines</span>
            <span class="s1">include(</span><span class="s3">'expr'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'expr-keywords'</span><span class="s1">: [</span>
            <span class="s4"># Based on https://docs.python.org/3/reference/expressions.html</span>
            <span class="s1">(words((</span>
                <span class="s3">'async for'</span><span class="s2">, </span><span class="s3">'await'</span><span class="s2">, </span><span class="s3">'else'</span><span class="s2">, </span><span class="s3">'for'</span><span class="s2">, </span><span class="s3">'if'</span><span class="s2">, </span><span class="s3">'lambda'</span><span class="s2">,</span>
                <span class="s3">'yield'</span><span class="s2">, </span><span class="s3">'yield from'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Keyword)</span><span class="s2">,</span>
            <span class="s1">(words((</span><span class="s3">'True'</span><span class="s2">, </span><span class="s3">'False'</span><span class="s2">, </span><span class="s3">'None'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">Keyword.Constant)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'keywords'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'assert'</span><span class="s2">, </span><span class="s3">'async'</span><span class="s2">, </span><span class="s3">'await'</span><span class="s2">, </span><span class="s3">'break'</span><span class="s2">, </span><span class="s3">'continue'</span><span class="s2">, </span><span class="s3">'del'</span><span class="s2">, </span><span class="s3">'elif'</span><span class="s2">,</span>
                <span class="s3">'else'</span><span class="s2">, </span><span class="s3">'except'</span><span class="s2">, </span><span class="s3">'finally'</span><span class="s2">, </span><span class="s3">'for'</span><span class="s2">, </span><span class="s3">'global'</span><span class="s2">, </span><span class="s3">'if'</span><span class="s2">, </span><span class="s3">'lambda'</span><span class="s2">,</span>
                <span class="s3">'pass'</span><span class="s2">, </span><span class="s3">'raise'</span><span class="s2">, </span><span class="s3">'nonlocal'</span><span class="s2">, </span><span class="s3">'return'</span><span class="s2">, </span><span class="s3">'try'</span><span class="s2">, </span><span class="s3">'while'</span><span class="s2">, </span><span class="s3">'yield'</span><span class="s2">,</span>
                <span class="s3">'yield from'</span><span class="s2">, </span><span class="s3">'as'</span><span class="s2">, </span><span class="s3">'with'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Keyword)</span><span class="s2">,</span>
            <span class="s1">(words((</span><span class="s3">'True'</span><span class="s2">, </span><span class="s3">'False'</span><span class="s2">, </span><span class="s3">'None'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">Keyword.Constant)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'soft-keywords'</span><span class="s1">: [</span>
            <span class="s4"># `match`, `case` and `_` soft keywords</span>
            <span class="s1">(</span><span class="s3">r'(^[ \t]*)'              </span><span class="s4"># at beginning of line + possible indentation</span>
             <span class="s3">r'(match|case)\b'         </span><span class="s4"># a possible keyword</span>
             <span class="s3">r'(?![ \t]*(?:'           </span><span class="s4"># not followed by...</span>
             <span class="s3">r'[:,;=^&amp;|@~)\]}]|(?:' </span><span class="s1">+  </span><span class="s4"># characters and keywords that mean this isn't </span>
             <span class="s3">r'|'</span><span class="s1">.join(keyword.kwlist) + </span><span class="s3">r')\b))'</span><span class="s2">,                 </span><span class="s4"># pattern matching</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Keyword)</span><span class="s2">, </span><span class="s3">'soft-keywords-inner'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'soft-keywords-inner'</span><span class="s1">: [</span>
            <span class="s4"># optional `_` keyword</span>
            <span class="s1">(</span><span class="s3">r'(\s+)([^\n_]*)(_\b)'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">using(this)</span><span class="s2">, </span><span class="s1">Keyword))</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'builtins'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'__import__'</span><span class="s2">, </span><span class="s3">'abs'</span><span class="s2">, </span><span class="s3">'all'</span><span class="s2">, </span><span class="s3">'any'</span><span class="s2">, </span><span class="s3">'bin'</span><span class="s2">, </span><span class="s3">'bool'</span><span class="s2">, </span><span class="s3">'bytearray'</span><span class="s2">,</span>
                <span class="s3">'breakpoint'</span><span class="s2">, </span><span class="s3">'bytes'</span><span class="s2">, </span><span class="s3">'chr'</span><span class="s2">, </span><span class="s3">'classmethod'</span><span class="s2">, </span><span class="s3">'compile'</span><span class="s2">, </span><span class="s3">'complex'</span><span class="s2">,</span>
                <span class="s3">'delattr'</span><span class="s2">, </span><span class="s3">'dict'</span><span class="s2">, </span><span class="s3">'dir'</span><span class="s2">, </span><span class="s3">'divmod'</span><span class="s2">, </span><span class="s3">'enumerate'</span><span class="s2">, </span><span class="s3">'eval'</span><span class="s2">, </span><span class="s3">'filter'</span><span class="s2">,</span>
                <span class="s3">'float'</span><span class="s2">, </span><span class="s3">'format'</span><span class="s2">, </span><span class="s3">'frozenset'</span><span class="s2">, </span><span class="s3">'getattr'</span><span class="s2">, </span><span class="s3">'globals'</span><span class="s2">, </span><span class="s3">'hasattr'</span><span class="s2">,</span>
                <span class="s3">'hash'</span><span class="s2">, </span><span class="s3">'hex'</span><span class="s2">, </span><span class="s3">'id'</span><span class="s2">, </span><span class="s3">'input'</span><span class="s2">, </span><span class="s3">'int'</span><span class="s2">, </span><span class="s3">'isinstance'</span><span class="s2">, </span><span class="s3">'issubclass'</span><span class="s2">,</span>
                <span class="s3">'iter'</span><span class="s2">, </span><span class="s3">'len'</span><span class="s2">, </span><span class="s3">'list'</span><span class="s2">, </span><span class="s3">'locals'</span><span class="s2">, </span><span class="s3">'map'</span><span class="s2">, </span><span class="s3">'max'</span><span class="s2">, </span><span class="s3">'memoryview'</span><span class="s2">,</span>
                <span class="s3">'min'</span><span class="s2">, </span><span class="s3">'next'</span><span class="s2">, </span><span class="s3">'object'</span><span class="s2">, </span><span class="s3">'oct'</span><span class="s2">, </span><span class="s3">'open'</span><span class="s2">, </span><span class="s3">'ord'</span><span class="s2">, </span><span class="s3">'pow'</span><span class="s2">, </span><span class="s3">'print'</span><span class="s2">,</span>
                <span class="s3">'property'</span><span class="s2">, </span><span class="s3">'range'</span><span class="s2">, </span><span class="s3">'repr'</span><span class="s2">, </span><span class="s3">'reversed'</span><span class="s2">, </span><span class="s3">'round'</span><span class="s2">, </span><span class="s3">'set'</span><span class="s2">, </span><span class="s3">'setattr'</span><span class="s2">,</span>
                <span class="s3">'slice'</span><span class="s2">, </span><span class="s3">'sorted'</span><span class="s2">, </span><span class="s3">'staticmethod'</span><span class="s2">, </span><span class="s3">'str'</span><span class="s2">, </span><span class="s3">'sum'</span><span class="s2">, </span><span class="s3">'super'</span><span class="s2">, </span><span class="s3">'tuple'</span><span class="s2">,</span>
                <span class="s3">'type'</span><span class="s2">, </span><span class="s3">'vars'</span><span class="s2">, </span><span class="s3">'zip'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">r'(?&lt;!\.)'</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Builtin)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?&lt;!\.)(self|Ellipsis|NotImplemented|cls)\b'</span><span class="s2">, </span><span class="s1">Name.Builtin.Pseudo)</span><span class="s2">,</span>
            <span class="s1">(words((</span>
                <span class="s3">'ArithmeticError'</span><span class="s2">, </span><span class="s3">'AssertionError'</span><span class="s2">, </span><span class="s3">'AttributeError'</span><span class="s2">,</span>
                <span class="s3">'BaseException'</span><span class="s2">, </span><span class="s3">'BufferError'</span><span class="s2">, </span><span class="s3">'BytesWarning'</span><span class="s2">, </span><span class="s3">'DeprecationWarning'</span><span class="s2">,</span>
                <span class="s3">'EOFError'</span><span class="s2">, </span><span class="s3">'EnvironmentError'</span><span class="s2">, </span><span class="s3">'Exception'</span><span class="s2">, </span><span class="s3">'FloatingPointError'</span><span class="s2">,</span>
                <span class="s3">'FutureWarning'</span><span class="s2">, </span><span class="s3">'GeneratorExit'</span><span class="s2">, </span><span class="s3">'IOError'</span><span class="s2">, </span><span class="s3">'ImportError'</span><span class="s2">,</span>
                <span class="s3">'ImportWarning'</span><span class="s2">, </span><span class="s3">'IndentationError'</span><span class="s2">, </span><span class="s3">'IndexError'</span><span class="s2">, </span><span class="s3">'KeyError'</span><span class="s2">,</span>
                <span class="s3">'KeyboardInterrupt'</span><span class="s2">, </span><span class="s3">'LookupError'</span><span class="s2">, </span><span class="s3">'MemoryError'</span><span class="s2">, </span><span class="s3">'NameError'</span><span class="s2">,</span>
                <span class="s3">'NotImplementedError'</span><span class="s2">, </span><span class="s3">'OSError'</span><span class="s2">, </span><span class="s3">'OverflowError'</span><span class="s2">,</span>
                <span class="s3">'PendingDeprecationWarning'</span><span class="s2">, </span><span class="s3">'ReferenceError'</span><span class="s2">, </span><span class="s3">'ResourceWarning'</span><span class="s2">,</span>
                <span class="s3">'RuntimeError'</span><span class="s2">, </span><span class="s3">'RuntimeWarning'</span><span class="s2">, </span><span class="s3">'StopIteration'</span><span class="s2">,</span>
                <span class="s3">'SyntaxError'</span><span class="s2">, </span><span class="s3">'SyntaxWarning'</span><span class="s2">, </span><span class="s3">'SystemError'</span><span class="s2">, </span><span class="s3">'SystemExit'</span><span class="s2">,</span>
                <span class="s3">'TabError'</span><span class="s2">, </span><span class="s3">'TypeError'</span><span class="s2">, </span><span class="s3">'UnboundLocalError'</span><span class="s2">, </span><span class="s3">'UnicodeDecodeError'</span><span class="s2">,</span>
                <span class="s3">'UnicodeEncodeError'</span><span class="s2">, </span><span class="s3">'UnicodeError'</span><span class="s2">, </span><span class="s3">'UnicodeTranslateError'</span><span class="s2">,</span>
                <span class="s3">'UnicodeWarning'</span><span class="s2">, </span><span class="s3">'UserWarning'</span><span class="s2">, </span><span class="s3">'ValueError'</span><span class="s2">, </span><span class="s3">'VMSError'</span><span class="s2">,</span>
                <span class="s3">'Warning'</span><span class="s2">, </span><span class="s3">'WindowsError'</span><span class="s2">, </span><span class="s3">'ZeroDivisionError'</span><span class="s2">,</span>
                <span class="s4"># new builtin exceptions from PEP 3151</span>
                <span class="s3">'BlockingIOError'</span><span class="s2">, </span><span class="s3">'ChildProcessError'</span><span class="s2">, </span><span class="s3">'ConnectionError'</span><span class="s2">,</span>
                <span class="s3">'BrokenPipeError'</span><span class="s2">, </span><span class="s3">'ConnectionAbortedError'</span><span class="s2">, </span><span class="s3">'ConnectionRefusedError'</span><span class="s2">,</span>
                <span class="s3">'ConnectionResetError'</span><span class="s2">, </span><span class="s3">'FileExistsError'</span><span class="s2">, </span><span class="s3">'FileNotFoundError'</span><span class="s2">,</span>
                <span class="s3">'InterruptedError'</span><span class="s2">, </span><span class="s3">'IsADirectoryError'</span><span class="s2">, </span><span class="s3">'NotADirectoryError'</span><span class="s2">,</span>
                <span class="s3">'PermissionError'</span><span class="s2">, </span><span class="s3">'ProcessLookupError'</span><span class="s2">, </span><span class="s3">'TimeoutError'</span><span class="s2">,</span>
                <span class="s4"># others new in Python 3</span>
                <span class="s3">'StopAsyncIteration'</span><span class="s2">, </span><span class="s3">'ModuleNotFoundError'</span><span class="s2">, </span><span class="s3">'RecursionError'</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">prefix=</span><span class="s3">r'(?&lt;!\.)'</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Exception)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'magicfuncs'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'__abs__'</span><span class="s2">, </span><span class="s3">'__add__'</span><span class="s2">, </span><span class="s3">'__aenter__'</span><span class="s2">, </span><span class="s3">'__aexit__'</span><span class="s2">, </span><span class="s3">'__aiter__'</span><span class="s2">,</span>
                <span class="s3">'__and__'</span><span class="s2">, </span><span class="s3">'__anext__'</span><span class="s2">, </span><span class="s3">'__await__'</span><span class="s2">, </span><span class="s3">'__bool__'</span><span class="s2">, </span><span class="s3">'__bytes__'</span><span class="s2">,</span>
                <span class="s3">'__call__'</span><span class="s2">, </span><span class="s3">'__complex__'</span><span class="s2">, </span><span class="s3">'__contains__'</span><span class="s2">, </span><span class="s3">'__del__'</span><span class="s2">, </span><span class="s3">'__delattr__'</span><span class="s2">,</span>
                <span class="s3">'__delete__'</span><span class="s2">, </span><span class="s3">'__delitem__'</span><span class="s2">, </span><span class="s3">'__dir__'</span><span class="s2">, </span><span class="s3">'__divmod__'</span><span class="s2">, </span><span class="s3">'__enter__'</span><span class="s2">,</span>
                <span class="s3">'__eq__'</span><span class="s2">, </span><span class="s3">'__exit__'</span><span class="s2">, </span><span class="s3">'__float__'</span><span class="s2">, </span><span class="s3">'__floordiv__'</span><span class="s2">, </span><span class="s3">'__format__'</span><span class="s2">,</span>
                <span class="s3">'__ge__'</span><span class="s2">, </span><span class="s3">'__get__'</span><span class="s2">, </span><span class="s3">'__getattr__'</span><span class="s2">, </span><span class="s3">'__getattribute__'</span><span class="s2">,</span>
                <span class="s3">'__getitem__'</span><span class="s2">, </span><span class="s3">'__gt__'</span><span class="s2">, </span><span class="s3">'__hash__'</span><span class="s2">, </span><span class="s3">'__iadd__'</span><span class="s2">, </span><span class="s3">'__iand__'</span><span class="s2">,</span>
                <span class="s3">'__ifloordiv__'</span><span class="s2">, </span><span class="s3">'__ilshift__'</span><span class="s2">, </span><span class="s3">'__imatmul__'</span><span class="s2">, </span><span class="s3">'__imod__'</span><span class="s2">,</span>
                <span class="s3">'__imul__'</span><span class="s2">, </span><span class="s3">'__index__'</span><span class="s2">, </span><span class="s3">'__init__'</span><span class="s2">, </span><span class="s3">'__instancecheck__'</span><span class="s2">,</span>
                <span class="s3">'__int__'</span><span class="s2">, </span><span class="s3">'__invert__'</span><span class="s2">, </span><span class="s3">'__ior__'</span><span class="s2">, </span><span class="s3">'__ipow__'</span><span class="s2">, </span><span class="s3">'__irshift__'</span><span class="s2">,</span>
                <span class="s3">'__isub__'</span><span class="s2">, </span><span class="s3">'__iter__'</span><span class="s2">, </span><span class="s3">'__itruediv__'</span><span class="s2">, </span><span class="s3">'__ixor__'</span><span class="s2">, </span><span class="s3">'__le__'</span><span class="s2">,</span>
                <span class="s3">'__len__'</span><span class="s2">, </span><span class="s3">'__length_hint__'</span><span class="s2">, </span><span class="s3">'__lshift__'</span><span class="s2">, </span><span class="s3">'__lt__'</span><span class="s2">, </span><span class="s3">'__matmul__'</span><span class="s2">,</span>
                <span class="s3">'__missing__'</span><span class="s2">, </span><span class="s3">'__mod__'</span><span class="s2">, </span><span class="s3">'__mul__'</span><span class="s2">, </span><span class="s3">'__ne__'</span><span class="s2">, </span><span class="s3">'__neg__'</span><span class="s2">,</span>
                <span class="s3">'__new__'</span><span class="s2">, </span><span class="s3">'__next__'</span><span class="s2">, </span><span class="s3">'__or__'</span><span class="s2">, </span><span class="s3">'__pos__'</span><span class="s2">, </span><span class="s3">'__pow__'</span><span class="s2">,</span>
                <span class="s3">'__prepare__'</span><span class="s2">, </span><span class="s3">'__radd__'</span><span class="s2">, </span><span class="s3">'__rand__'</span><span class="s2">, </span><span class="s3">'__rdivmod__'</span><span class="s2">, </span><span class="s3">'__repr__'</span><span class="s2">,</span>
                <span class="s3">'__reversed__'</span><span class="s2">, </span><span class="s3">'__rfloordiv__'</span><span class="s2">, </span><span class="s3">'__rlshift__'</span><span class="s2">, </span><span class="s3">'__rmatmul__'</span><span class="s2">,</span>
                <span class="s3">'__rmod__'</span><span class="s2">, </span><span class="s3">'__rmul__'</span><span class="s2">, </span><span class="s3">'__ror__'</span><span class="s2">, </span><span class="s3">'__round__'</span><span class="s2">, </span><span class="s3">'__rpow__'</span><span class="s2">,</span>
                <span class="s3">'__rrshift__'</span><span class="s2">, </span><span class="s3">'__rshift__'</span><span class="s2">, </span><span class="s3">'__rsub__'</span><span class="s2">, </span><span class="s3">'__rtruediv__'</span><span class="s2">,</span>
                <span class="s3">'__rxor__'</span><span class="s2">, </span><span class="s3">'__set__'</span><span class="s2">, </span><span class="s3">'__setattr__'</span><span class="s2">, </span><span class="s3">'__setitem__'</span><span class="s2">, </span><span class="s3">'__str__'</span><span class="s2">,</span>
                <span class="s3">'__sub__'</span><span class="s2">, </span><span class="s3">'__subclasscheck__'</span><span class="s2">, </span><span class="s3">'__truediv__'</span><span class="s2">,</span>
                <span class="s3">'__xor__'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Function.Magic)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'magicvars'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'__annotations__'</span><span class="s2">, </span><span class="s3">'__bases__'</span><span class="s2">, </span><span class="s3">'__class__'</span><span class="s2">, </span><span class="s3">'__closure__'</span><span class="s2">,</span>
                <span class="s3">'__code__'</span><span class="s2">, </span><span class="s3">'__defaults__'</span><span class="s2">, </span><span class="s3">'__dict__'</span><span class="s2">, </span><span class="s3">'__doc__'</span><span class="s2">, </span><span class="s3">'__file__'</span><span class="s2">,</span>
                <span class="s3">'__func__'</span><span class="s2">, </span><span class="s3">'__globals__'</span><span class="s2">, </span><span class="s3">'__kwdefaults__'</span><span class="s2">, </span><span class="s3">'__module__'</span><span class="s2">,</span>
                <span class="s3">'__mro__'</span><span class="s2">, </span><span class="s3">'__name__'</span><span class="s2">, </span><span class="s3">'__objclass__'</span><span class="s2">, </span><span class="s3">'__qualname__'</span><span class="s2">,</span>
                <span class="s3">'__self__'</span><span class="s2">, </span><span class="s3">'__slots__'</span><span class="s2">, </span><span class="s3">'__weakref__'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Variable.Magic)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'numbers'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(\d(?:_?\d)*\.(?:\d(?:_?\d)*)?|(?:\d(?:_?\d)*)?\.\d(?:_?\d)*)'</span>
             <span class="s3">r'([eE][+-]?\d(?:_?\d)*)?'</span><span class="s2">, </span><span class="s1">Number.Float)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\d(?:_?\d)*[eE][+-]?\d(?:_?\d)*j?'</span><span class="s2">, </span><span class="s1">Number.Float)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'0[oO](?:_?[0-7])+'</span><span class="s2">, </span><span class="s1">Number.Oct)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'0[bB](?:_?[01])+'</span><span class="s2">, </span><span class="s1">Number.Bin)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'0[xX](?:_?[a-fA-F0-9])+'</span><span class="s2">, </span><span class="s1">Number.Hex)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\d(?:_?\d)*'</span><span class="s2">, </span><span class="s1">Number.Integer)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'name'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'@' </span><span class="s1">+ uni_name</span><span class="s2">, </span><span class="s1">Name.Decorator)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'@'</span><span class="s2">, </span><span class="s1">Operator)</span><span class="s2">,  </span><span class="s4"># new matrix multiplication operator</span>
            <span class="s1">(uni_name</span><span class="s2">, </span><span class="s1">Name)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'funcname'</span><span class="s1">: [</span>
            <span class="s1">include(</span><span class="s3">'magicfuncs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(uni_name</span><span class="s2">, </span><span class="s1">Name.Function</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'classname'</span><span class="s1">: [</span>
            <span class="s1">(uni_name</span><span class="s2">, </span><span class="s1">Name.Class</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'import'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(\s+)(as)(\s+)'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Keyword</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\.'</span><span class="s2">, </span><span class="s1">Name.Namespace)</span><span class="s2">,</span>
            <span class="s1">(uni_name</span><span class="s2">, </span><span class="s1">Name.Namespace)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(\s*)(,)(\s*)'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Operator</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)  </span><span class="s4"># all else: go back</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'fromimport'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(\s+)(import)\b'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Keyword.Namespace)</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\.'</span><span class="s2">, </span><span class="s1">Name.Namespace)</span><span class="s2">,</span>
            <span class="s4"># if None occurs here, it's &quot;raise x from None&quot;, since None can</span>
            <span class="s4"># never be a module name</span>
            <span class="s1">(</span><span class="s3">r'None\b'</span><span class="s2">, </span><span class="s1">Name.Builtin.Pseudo</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(uni_name</span><span class="s2">, </span><span class="s1">Name.Namespace)</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'rfstringescape'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\{\{'</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\}\}'</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'fstringescape'</span><span class="s1">: [</span>
            <span class="s1">include(</span><span class="s3">'rfstringescape'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'stringescape'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'stringescape'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\\([\\abfnrtv&quot;\']|\n|N\{.*?\}|u[a-fA-F0-9]{4}|'</span>
             <span class="s3">r'U[a-fA-F0-9]{8}|x[a-fA-F0-9]{2}|[0-7]{1,3})'</span><span class="s2">, </span><span class="s1">String.Escape)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'fstrings-single'</span><span class="s1">: fstring_rules(String.Single)</span><span class="s2">,</span>
        <span class="s3">'fstrings-double'</span><span class="s1">: fstring_rules(String.Double)</span><span class="s2">,</span>
        <span class="s3">'strings-single'</span><span class="s1">: innerstring_rules(String.Single)</span><span class="s2">,</span>
        <span class="s3">'strings-double'</span><span class="s1">: innerstring_rules(String.Double)</span><span class="s2">,</span>
        <span class="s3">'dqf'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;'</span><span class="s2">, </span><span class="s1">String.Double</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\\\|\\&quot;|\\\n'</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,  </span><span class="s4"># included here for raw strings</span>
            <span class="s1">include(</span><span class="s3">'fstrings-double'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'sqf'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'&quot;</span><span class="s2">, </span><span class="s1">String.Single</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;\\\\|\\'|\\\n&quot;</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,  </span><span class="s4"># included here for raw strings</span>
            <span class="s1">include(</span><span class="s3">'fstrings-single'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'dqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;'</span><span class="s2">, </span><span class="s1">String.Double</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\\\|\\&quot;|\\\n'</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,  </span><span class="s4"># included here for raw strings</span>
            <span class="s1">include(</span><span class="s3">'strings-double'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'sqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'&quot;</span><span class="s2">, </span><span class="s1">String.Single</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;\\\\|\\'|\\\n&quot;</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,  </span><span class="s4"># included here for raw strings</span>
            <span class="s1">include(</span><span class="s3">'strings-single'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tdqf'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;&quot;&quot;'</span><span class="s2">, </span><span class="s1">String.Double</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'fstrings-double'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">String.Double)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tsqf'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'''&quot;</span><span class="s2">, </span><span class="s1">String.Single</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'fstrings-single'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">String.Single)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tdqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;&quot;&quot;'</span><span class="s2">, </span><span class="s1">String.Double</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'strings-double'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">String.Double)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tsqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'''&quot;</span><span class="s2">, </span><span class="s1">String.Single</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'strings-single'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">String.Single)</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">}</span>

    <span class="s2">def </span><span class="s1">analyse_text(text):</span>
        <span class="s2">return </span><span class="s1">shebang_matches(text</span><span class="s2">, </span><span class="s3">r'pythonw?(3(\.\d)?)?'</span><span class="s1">) </span><span class="s2">or </span><span class="s1">\</span>
            <span class="s3">'import ' </span><span class="s2">in </span><span class="s1">text[:</span><span class="s5">1000</span><span class="s1">]</span>


<span class="s1">Python3Lexer = PythonLexer</span>


<span class="s2">class </span><span class="s1">Python2Lexer(RegexLexer):</span>
    <span class="s0">&quot;&quot;&quot; 
    For `Python 2.x &lt;http://www.python.org&gt;`_ source code. 
 
    .. versionchanged:: 2.5 
       This class has been renamed from ``PythonLexer``.  ``PythonLexer`` now 
       refers to the Python 3 variant.  File name patterns like ``*.py`` have 
       been moved to Python 3 as well. 
    &quot;&quot;&quot;</span>

    <span class="s1">name = </span><span class="s3">'Python 2.x'</span>
    <span class="s1">aliases = [</span><span class="s3">'python2'</span><span class="s2">, </span><span class="s3">'py2'</span><span class="s1">]</span>
    <span class="s1">filenames = []  </span><span class="s4"># now taken over by PythonLexer (3.x)</span>
    <span class="s1">mimetypes = [</span><span class="s3">'text/x-python2'</span><span class="s2">, </span><span class="s3">'application/x-python2'</span><span class="s1">]</span>

    <span class="s2">def </span><span class="s1">innerstring_rules(ttype):</span>
        <span class="s2">return </span><span class="s1">[</span>
            <span class="s4"># the old style '%s' % (...) string formatting</span>
            <span class="s1">(</span><span class="s3">r'%(\(\w+\))?[-#0 +]*([0-9]+|[*])?(\.([0-9]+|[*]))?'</span>
             <span class="s3">'[hlL]?[E-GXc-giorsux%]'</span><span class="s2">, </span><span class="s1">String.Interpol)</span><span class="s2">,</span>
            <span class="s4"># backslashes, quotes and formatting signs must be parsed one at a time</span>
            <span class="s1">(</span><span class="s3">r'[^\\\'&quot;%\n]+'</span><span class="s2">, </span><span class="s1">ttype)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[\'&quot;\\]'</span><span class="s2">, </span><span class="s1">ttype)</span><span class="s2">,</span>
            <span class="s4"># unhandled string formatting sign</span>
            <span class="s1">(</span><span class="s3">r'%'</span><span class="s2">, </span><span class="s1">ttype)</span><span class="s2">,</span>
            <span class="s4"># newlines are an error (use &quot;nl&quot; state)</span>
        <span class="s1">]</span>

    <span class="s1">tokens = {</span>
        <span class="s3">'root'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^(\s*)([rRuUbB]{,2})(&quot;&quot;&quot;(?:.|\n)*?&quot;&quot;&quot;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">String.Affix</span><span class="s2">, </span><span class="s1">String.Doc))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;^(\s*)([rRuUbB]{,2})('''(?:.|\n)*?''')&quot;</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">String.Affix</span><span class="s2">, </span><span class="s1">String.Doc))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[^\S\n]+'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\A#!.+$'</span><span class="s2">, </span><span class="s1">Comment.Hashbang)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'#.*$'</span><span class="s2">, </span><span class="s1">Comment.Single)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[]{}:(),;[]'</span><span class="s2">, </span><span class="s1">Punctuation)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\\n'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(in|is|and|or|not)\b'</span><span class="s2">, </span><span class="s1">Operator.Word)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'!=|==|&lt;&lt;|&gt;&gt;|[-~+/*%=&lt;&gt;&amp;^|.]'</span><span class="s2">, </span><span class="s1">Operator)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'keywords'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(def)((?:\s|\\\s)+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'funcname'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(class)((?:\s|\\\s)+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'classname'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(from)((?:\s|\\\s)+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword.Namespace</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
             <span class="s3">'fromimport'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(import)((?:\s|\\\s)+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword.Namespace</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
             <span class="s3">'import'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'builtins'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'magicfuncs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'magicvars'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'backtick'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'([rR]|[uUbB][rR]|[rR][uUbB])(&quot;&quot;&quot;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">, </span><span class="s3">'tdqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;([rR]|[uUbB][rR]|[rR][uUbB])(''')&quot;</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">, </span><span class="s3">'tsqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'([rR]|[uUbB][rR]|[rR][uUbB])(&quot;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">, </span><span class="s3">'dqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;([rR]|[uUbB][rR]|[rR][uUbB])(')&quot;</span><span class="s2">,</span>
             <span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">, </span><span class="s3">'sqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'([uUbB]?)(&quot;&quot;&quot;)'</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'tdqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;([uUbB]?)(''')&quot;</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'tsqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'([uUbB]?)(&quot;)'</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Double)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'dqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;([uUbB]?)(')&quot;</span><span class="s2">, </span><span class="s1">bygroups(String.Affix</span><span class="s2">, </span><span class="s1">String.Single)</span><span class="s2">,</span>
             <span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'sqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'name'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'numbers'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'keywords'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'assert'</span><span class="s2">, </span><span class="s3">'break'</span><span class="s2">, </span><span class="s3">'continue'</span><span class="s2">, </span><span class="s3">'del'</span><span class="s2">, </span><span class="s3">'elif'</span><span class="s2">, </span><span class="s3">'else'</span><span class="s2">, </span><span class="s3">'except'</span><span class="s2">,</span>
                <span class="s3">'exec'</span><span class="s2">, </span><span class="s3">'finally'</span><span class="s2">, </span><span class="s3">'for'</span><span class="s2">, </span><span class="s3">'global'</span><span class="s2">, </span><span class="s3">'if'</span><span class="s2">, </span><span class="s3">'lambda'</span><span class="s2">, </span><span class="s3">'pass'</span><span class="s2">,</span>
                <span class="s3">'print'</span><span class="s2">, </span><span class="s3">'raise'</span><span class="s2">, </span><span class="s3">'return'</span><span class="s2">, </span><span class="s3">'try'</span><span class="s2">, </span><span class="s3">'while'</span><span class="s2">, </span><span class="s3">'yield'</span><span class="s2">,</span>
                <span class="s3">'yield from'</span><span class="s2">, </span><span class="s3">'as'</span><span class="s2">, </span><span class="s3">'with'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Keyword)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'builtins'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'__import__'</span><span class="s2">, </span><span class="s3">'abs'</span><span class="s2">, </span><span class="s3">'all'</span><span class="s2">, </span><span class="s3">'any'</span><span class="s2">, </span><span class="s3">'apply'</span><span class="s2">, </span><span class="s3">'basestring'</span><span class="s2">, </span><span class="s3">'bin'</span><span class="s2">,</span>
                <span class="s3">'bool'</span><span class="s2">, </span><span class="s3">'buffer'</span><span class="s2">, </span><span class="s3">'bytearray'</span><span class="s2">, </span><span class="s3">'bytes'</span><span class="s2">, </span><span class="s3">'callable'</span><span class="s2">, </span><span class="s3">'chr'</span><span class="s2">, </span><span class="s3">'classmethod'</span><span class="s2">,</span>
                <span class="s3">'cmp'</span><span class="s2">, </span><span class="s3">'coerce'</span><span class="s2">, </span><span class="s3">'compile'</span><span class="s2">, </span><span class="s3">'complex'</span><span class="s2">, </span><span class="s3">'delattr'</span><span class="s2">, </span><span class="s3">'dict'</span><span class="s2">, </span><span class="s3">'dir'</span><span class="s2">, </span><span class="s3">'divmod'</span><span class="s2">,</span>
                <span class="s3">'enumerate'</span><span class="s2">, </span><span class="s3">'eval'</span><span class="s2">, </span><span class="s3">'execfile'</span><span class="s2">, </span><span class="s3">'exit'</span><span class="s2">, </span><span class="s3">'file'</span><span class="s2">, </span><span class="s3">'filter'</span><span class="s2">, </span><span class="s3">'float'</span><span class="s2">,</span>
                <span class="s3">'frozenset'</span><span class="s2">, </span><span class="s3">'getattr'</span><span class="s2">, </span><span class="s3">'globals'</span><span class="s2">, </span><span class="s3">'hasattr'</span><span class="s2">, </span><span class="s3">'hash'</span><span class="s2">, </span><span class="s3">'hex'</span><span class="s2">, </span><span class="s3">'id'</span><span class="s2">,</span>
                <span class="s3">'input'</span><span class="s2">, </span><span class="s3">'int'</span><span class="s2">, </span><span class="s3">'intern'</span><span class="s2">, </span><span class="s3">'isinstance'</span><span class="s2">, </span><span class="s3">'issubclass'</span><span class="s2">, </span><span class="s3">'iter'</span><span class="s2">, </span><span class="s3">'len'</span><span class="s2">,</span>
                <span class="s3">'list'</span><span class="s2">, </span><span class="s3">'locals'</span><span class="s2">, </span><span class="s3">'long'</span><span class="s2">, </span><span class="s3">'map'</span><span class="s2">, </span><span class="s3">'max'</span><span class="s2">, </span><span class="s3">'min'</span><span class="s2">, </span><span class="s3">'next'</span><span class="s2">, </span><span class="s3">'object'</span><span class="s2">,</span>
                <span class="s3">'oct'</span><span class="s2">, </span><span class="s3">'open'</span><span class="s2">, </span><span class="s3">'ord'</span><span class="s2">, </span><span class="s3">'pow'</span><span class="s2">, </span><span class="s3">'property'</span><span class="s2">, </span><span class="s3">'range'</span><span class="s2">, </span><span class="s3">'raw_input'</span><span class="s2">, </span><span class="s3">'reduce'</span><span class="s2">,</span>
                <span class="s3">'reload'</span><span class="s2">, </span><span class="s3">'repr'</span><span class="s2">, </span><span class="s3">'reversed'</span><span class="s2">, </span><span class="s3">'round'</span><span class="s2">, </span><span class="s3">'set'</span><span class="s2">, </span><span class="s3">'setattr'</span><span class="s2">, </span><span class="s3">'slice'</span><span class="s2">,</span>
                <span class="s3">'sorted'</span><span class="s2">, </span><span class="s3">'staticmethod'</span><span class="s2">, </span><span class="s3">'str'</span><span class="s2">, </span><span class="s3">'sum'</span><span class="s2">, </span><span class="s3">'super'</span><span class="s2">, </span><span class="s3">'tuple'</span><span class="s2">, </span><span class="s3">'type'</span><span class="s2">,</span>
                <span class="s3">'unichr'</span><span class="s2">, </span><span class="s3">'unicode'</span><span class="s2">, </span><span class="s3">'vars'</span><span class="s2">, </span><span class="s3">'xrange'</span><span class="s2">, </span><span class="s3">'zip'</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">prefix=</span><span class="s3">r'(?&lt;!\.)'</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Builtin)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?&lt;!\.)(self|None|Ellipsis|NotImplemented|False|True|cls'</span>
             <span class="s3">r')\b'</span><span class="s2">, </span><span class="s1">Name.Builtin.Pseudo)</span><span class="s2">,</span>
            <span class="s1">(words((</span>
                <span class="s3">'ArithmeticError'</span><span class="s2">, </span><span class="s3">'AssertionError'</span><span class="s2">, </span><span class="s3">'AttributeError'</span><span class="s2">,</span>
                <span class="s3">'BaseException'</span><span class="s2">, </span><span class="s3">'DeprecationWarning'</span><span class="s2">, </span><span class="s3">'EOFError'</span><span class="s2">, </span><span class="s3">'EnvironmentError'</span><span class="s2">,</span>
                <span class="s3">'Exception'</span><span class="s2">, </span><span class="s3">'FloatingPointError'</span><span class="s2">, </span><span class="s3">'FutureWarning'</span><span class="s2">, </span><span class="s3">'GeneratorExit'</span><span class="s2">,</span>
                <span class="s3">'IOError'</span><span class="s2">, </span><span class="s3">'ImportError'</span><span class="s2">, </span><span class="s3">'ImportWarning'</span><span class="s2">, </span><span class="s3">'IndentationError'</span><span class="s2">,</span>
                <span class="s3">'IndexError'</span><span class="s2">, </span><span class="s3">'KeyError'</span><span class="s2">, </span><span class="s3">'KeyboardInterrupt'</span><span class="s2">, </span><span class="s3">'LookupError'</span><span class="s2">,</span>
                <span class="s3">'MemoryError'</span><span class="s2">, </span><span class="s3">'NameError'</span><span class="s2">,</span>
                <span class="s3">'NotImplementedError'</span><span class="s2">, </span><span class="s3">'OSError'</span><span class="s2">, </span><span class="s3">'OverflowError'</span><span class="s2">, </span><span class="s3">'OverflowWarning'</span><span class="s2">,</span>
                <span class="s3">'PendingDeprecationWarning'</span><span class="s2">, </span><span class="s3">'ReferenceError'</span><span class="s2">,</span>
                <span class="s3">'RuntimeError'</span><span class="s2">, </span><span class="s3">'RuntimeWarning'</span><span class="s2">, </span><span class="s3">'StandardError'</span><span class="s2">, </span><span class="s3">'StopIteration'</span><span class="s2">,</span>
                <span class="s3">'SyntaxError'</span><span class="s2">, </span><span class="s3">'SyntaxWarning'</span><span class="s2">, </span><span class="s3">'SystemError'</span><span class="s2">, </span><span class="s3">'SystemExit'</span><span class="s2">,</span>
                <span class="s3">'TabError'</span><span class="s2">, </span><span class="s3">'TypeError'</span><span class="s2">, </span><span class="s3">'UnboundLocalError'</span><span class="s2">, </span><span class="s3">'UnicodeDecodeError'</span><span class="s2">,</span>
                <span class="s3">'UnicodeEncodeError'</span><span class="s2">, </span><span class="s3">'UnicodeError'</span><span class="s2">, </span><span class="s3">'UnicodeTranslateError'</span><span class="s2">,</span>
                <span class="s3">'UnicodeWarning'</span><span class="s2">, </span><span class="s3">'UserWarning'</span><span class="s2">, </span><span class="s3">'ValueError'</span><span class="s2">, </span><span class="s3">'VMSError'</span><span class="s2">, </span><span class="s3">'Warning'</span><span class="s2">,</span>
                <span class="s3">'WindowsError'</span><span class="s2">, </span><span class="s3">'ZeroDivisionError'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">r'(?&lt;!\.)'</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Exception)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'magicfuncs'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'__abs__'</span><span class="s2">, </span><span class="s3">'__add__'</span><span class="s2">, </span><span class="s3">'__and__'</span><span class="s2">, </span><span class="s3">'__call__'</span><span class="s2">, </span><span class="s3">'__cmp__'</span><span class="s2">, </span><span class="s3">'__coerce__'</span><span class="s2">,</span>
                <span class="s3">'__complex__'</span><span class="s2">, </span><span class="s3">'__contains__'</span><span class="s2">, </span><span class="s3">'__del__'</span><span class="s2">, </span><span class="s3">'__delattr__'</span><span class="s2">, </span><span class="s3">'__delete__'</span><span class="s2">,</span>
                <span class="s3">'__delitem__'</span><span class="s2">, </span><span class="s3">'__delslice__'</span><span class="s2">, </span><span class="s3">'__div__'</span><span class="s2">, </span><span class="s3">'__divmod__'</span><span class="s2">, </span><span class="s3">'__enter__'</span><span class="s2">,</span>
                <span class="s3">'__eq__'</span><span class="s2">, </span><span class="s3">'__exit__'</span><span class="s2">, </span><span class="s3">'__float__'</span><span class="s2">, </span><span class="s3">'__floordiv__'</span><span class="s2">, </span><span class="s3">'__ge__'</span><span class="s2">, </span><span class="s3">'__get__'</span><span class="s2">,</span>
                <span class="s3">'__getattr__'</span><span class="s2">, </span><span class="s3">'__getattribute__'</span><span class="s2">, </span><span class="s3">'__getitem__'</span><span class="s2">, </span><span class="s3">'__getslice__'</span><span class="s2">, </span><span class="s3">'__gt__'</span><span class="s2">,</span>
                <span class="s3">'__hash__'</span><span class="s2">, </span><span class="s3">'__hex__'</span><span class="s2">, </span><span class="s3">'__iadd__'</span><span class="s2">, </span><span class="s3">'__iand__'</span><span class="s2">, </span><span class="s3">'__idiv__'</span><span class="s2">, </span><span class="s3">'__ifloordiv__'</span><span class="s2">,</span>
                <span class="s3">'__ilshift__'</span><span class="s2">, </span><span class="s3">'__imod__'</span><span class="s2">, </span><span class="s3">'__imul__'</span><span class="s2">, </span><span class="s3">'__index__'</span><span class="s2">, </span><span class="s3">'__init__'</span><span class="s2">,</span>
                <span class="s3">'__instancecheck__'</span><span class="s2">, </span><span class="s3">'__int__'</span><span class="s2">, </span><span class="s3">'__invert__'</span><span class="s2">, </span><span class="s3">'__iop__'</span><span class="s2">, </span><span class="s3">'__ior__'</span><span class="s2">,</span>
                <span class="s3">'__ipow__'</span><span class="s2">, </span><span class="s3">'__irshift__'</span><span class="s2">, </span><span class="s3">'__isub__'</span><span class="s2">, </span><span class="s3">'__iter__'</span><span class="s2">, </span><span class="s3">'__itruediv__'</span><span class="s2">,</span>
                <span class="s3">'__ixor__'</span><span class="s2">, </span><span class="s3">'__le__'</span><span class="s2">, </span><span class="s3">'__len__'</span><span class="s2">, </span><span class="s3">'__long__'</span><span class="s2">, </span><span class="s3">'__lshift__'</span><span class="s2">, </span><span class="s3">'__lt__'</span><span class="s2">,</span>
                <span class="s3">'__missing__'</span><span class="s2">, </span><span class="s3">'__mod__'</span><span class="s2">, </span><span class="s3">'__mul__'</span><span class="s2">, </span><span class="s3">'__ne__'</span><span class="s2">, </span><span class="s3">'__neg__'</span><span class="s2">, </span><span class="s3">'__new__'</span><span class="s2">,</span>
                <span class="s3">'__nonzero__'</span><span class="s2">, </span><span class="s3">'__oct__'</span><span class="s2">, </span><span class="s3">'__op__'</span><span class="s2">, </span><span class="s3">'__or__'</span><span class="s2">, </span><span class="s3">'__pos__'</span><span class="s2">, </span><span class="s3">'__pow__'</span><span class="s2">,</span>
                <span class="s3">'__radd__'</span><span class="s2">, </span><span class="s3">'__rand__'</span><span class="s2">, </span><span class="s3">'__rcmp__'</span><span class="s2">, </span><span class="s3">'__rdiv__'</span><span class="s2">, </span><span class="s3">'__rdivmod__'</span><span class="s2">, </span><span class="s3">'__repr__'</span><span class="s2">,</span>
                <span class="s3">'__reversed__'</span><span class="s2">, </span><span class="s3">'__rfloordiv__'</span><span class="s2">, </span><span class="s3">'__rlshift__'</span><span class="s2">, </span><span class="s3">'__rmod__'</span><span class="s2">, </span><span class="s3">'__rmul__'</span><span class="s2">,</span>
                <span class="s3">'__rop__'</span><span class="s2">, </span><span class="s3">'__ror__'</span><span class="s2">, </span><span class="s3">'__rpow__'</span><span class="s2">, </span><span class="s3">'__rrshift__'</span><span class="s2">, </span><span class="s3">'__rshift__'</span><span class="s2">, </span><span class="s3">'__rsub__'</span><span class="s2">,</span>
                <span class="s3">'__rtruediv__'</span><span class="s2">, </span><span class="s3">'__rxor__'</span><span class="s2">, </span><span class="s3">'__set__'</span><span class="s2">, </span><span class="s3">'__setattr__'</span><span class="s2">, </span><span class="s3">'__setitem__'</span><span class="s2">,</span>
                <span class="s3">'__setslice__'</span><span class="s2">, </span><span class="s3">'__str__'</span><span class="s2">, </span><span class="s3">'__sub__'</span><span class="s2">, </span><span class="s3">'__subclasscheck__'</span><span class="s2">, </span><span class="s3">'__truediv__'</span><span class="s2">,</span>
                <span class="s3">'__unicode__'</span><span class="s2">, </span><span class="s3">'__xor__'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Function.Magic)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'magicvars'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'__bases__'</span><span class="s2">, </span><span class="s3">'__class__'</span><span class="s2">, </span><span class="s3">'__closure__'</span><span class="s2">, </span><span class="s3">'__code__'</span><span class="s2">, </span><span class="s3">'__defaults__'</span><span class="s2">,</span>
                <span class="s3">'__dict__'</span><span class="s2">, </span><span class="s3">'__doc__'</span><span class="s2">, </span><span class="s3">'__file__'</span><span class="s2">, </span><span class="s3">'__func__'</span><span class="s2">, </span><span class="s3">'__globals__'</span><span class="s2">,</span>
                <span class="s3">'__metaclass__'</span><span class="s2">, </span><span class="s3">'__module__'</span><span class="s2">, </span><span class="s3">'__mro__'</span><span class="s2">, </span><span class="s3">'__name__'</span><span class="s2">, </span><span class="s3">'__self__'</span><span class="s2">,</span>
                <span class="s3">'__slots__'</span><span class="s2">, </span><span class="s3">'__weakref__'</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Variable.Magic)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'numbers'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(\d+\.\d*|\d*\.\d+)([eE][+-]?[0-9]+)?j?'</span><span class="s2">, </span><span class="s1">Number.Float)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\d+[eE][+-]?[0-9]+j?'</span><span class="s2">, </span><span class="s1">Number.Float)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'0[0-7]+j?'</span><span class="s2">, </span><span class="s1">Number.Oct)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'0[bB][01]+'</span><span class="s2">, </span><span class="s1">Number.Bin)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'0[xX][a-fA-F0-9]+'</span><span class="s2">, </span><span class="s1">Number.Hex)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\d+L'</span><span class="s2">, </span><span class="s1">Number.Integer.Long)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\d+j?'</span><span class="s2">, </span><span class="s1">Number.Integer)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'backtick'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">'`.*?`'</span><span class="s2">, </span><span class="s1">String.Backtick)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'name'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'@[\w.]+'</span><span class="s2">, </span><span class="s1">Name.Decorator)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_]\w*'</span><span class="s2">, </span><span class="s1">Name)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'funcname'</span><span class="s1">: [</span>
            <span class="s1">include(</span><span class="s3">'magicfuncs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_]\w*'</span><span class="s2">, </span><span class="s1">Name.Function</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'classname'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_]\w*'</span><span class="s2">, </span><span class="s1">Name.Class</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'import'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(?:[ \t]|\\\n)+'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'as\b'</span><span class="s2">, </span><span class="s1">Keyword.Namespace)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r','</span><span class="s2">, </span><span class="s1">Operator)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_][\w.]*'</span><span class="s2">, </span><span class="s1">Name.Namespace)</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)  </span><span class="s4"># all else: go back</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'fromimport'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(?:[ \t]|\\\n)+'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'import\b'</span><span class="s2">, </span><span class="s1">Keyword.Namespace</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s4"># if None occurs here, it's &quot;raise x from None&quot;, since None can</span>
            <span class="s4"># never be a module name</span>
            <span class="s1">(</span><span class="s3">r'None\b'</span><span class="s2">, </span><span class="s1">Name.Builtin.Pseudo</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s4"># sadly, in &quot;raise x from y&quot; y will be highlighted as namespace too</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_.][\w.]*'</span><span class="s2">, </span><span class="s1">Name.Namespace)</span><span class="s2">,</span>
            <span class="s4"># anything else here also means &quot;raise x from y&quot; and is therefore</span>
            <span class="s4"># not an error</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'stringescape'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\\([\\abfnrtv&quot;\']|\n|N\{.*?\}|u[a-fA-F0-9]{4}|'</span>
             <span class="s3">r'U[a-fA-F0-9]{8}|x[a-fA-F0-9]{2}|[0-7]{1,3})'</span><span class="s2">, </span><span class="s1">String.Escape)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'strings-single'</span><span class="s1">: innerstring_rules(String.Single)</span><span class="s2">,</span>
        <span class="s3">'strings-double'</span><span class="s1">: innerstring_rules(String.Double)</span><span class="s2">,</span>
        <span class="s3">'dqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;'</span><span class="s2">, </span><span class="s1">String.Double</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\\\|\\&quot;|\\\n'</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,  </span><span class="s4"># included here for raw strings</span>
            <span class="s1">include(</span><span class="s3">'strings-double'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'sqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'&quot;</span><span class="s2">, </span><span class="s1">String.Single</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;\\\\|\\'|\\\n&quot;</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,  </span><span class="s4"># included here for raw strings</span>
            <span class="s1">include(</span><span class="s3">'strings-single'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tdqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;&quot;&quot;'</span><span class="s2">, </span><span class="s1">String.Double</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'strings-double'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">String.Double)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tsqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'''&quot;</span><span class="s2">, </span><span class="s1">String.Single</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'strings-single'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">String.Single)</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">}</span>

    <span class="s2">def </span><span class="s1">analyse_text(text):</span>
        <span class="s2">return </span><span class="s1">shebang_matches(text</span><span class="s2">, </span><span class="s3">r'pythonw?2(\.\d)?'</span><span class="s1">)</span>


<span class="s2">class </span><span class="s1">PythonConsoleLexer(Lexer):</span>
    <span class="s0">&quot;&quot;&quot; 
    For Python console output or doctests, such as: 
 
    .. sourcecode:: pycon 
 
        &gt;&gt;&gt; a = 'foo' 
        &gt;&gt;&gt; print a 
        foo 
        &gt;&gt;&gt; 1 / 0 
        Traceback (most recent call last): 
          File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt; 
        ZeroDivisionError: integer division or modulo by zero 
 
    Additional options: 
 
    `python3` 
        Use Python 3 lexer for code.  Default is ``True``. 
 
        .. versionadded:: 1.0 
        .. versionchanged:: 2.5 
           Now defaults to ``True``. 
    &quot;&quot;&quot;</span>
    <span class="s1">name = </span><span class="s3">'Python console session'</span>
    <span class="s1">aliases = [</span><span class="s3">'pycon'</span><span class="s1">]</span>
    <span class="s1">mimetypes = [</span><span class="s3">'text/x-python-doctest'</span><span class="s1">]</span>

    <span class="s2">def </span><span class="s1">__init__(self</span><span class="s2">, </span><span class="s1">**options):</span>
        <span class="s1">self.python3 = get_bool_opt(options</span><span class="s2">, </span><span class="s3">'python3'</span><span class="s2">, True</span><span class="s1">)</span>
        <span class="s1">Lexer.__init__(self</span><span class="s2">, </span><span class="s1">**options)</span>

    <span class="s2">def </span><span class="s1">get_tokens_unprocessed(self</span><span class="s2">, </span><span class="s1">text):</span>
        <span class="s2">if </span><span class="s1">self.python3:</span>
            <span class="s1">pylexer = PythonLexer(**self.options)</span>
            <span class="s1">tblexer = PythonTracebackLexer(**self.options)</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">pylexer = Python2Lexer(**self.options)</span>
            <span class="s1">tblexer = Python2TracebackLexer(**self.options)</span>

        <span class="s1">curcode = </span><span class="s3">''</span>
        <span class="s1">insertions = []</span>
        <span class="s1">curtb = </span><span class="s3">''</span>
        <span class="s1">tbindex = </span><span class="s5">0</span>
        <span class="s1">tb = </span><span class="s5">0</span>
        <span class="s2">for </span><span class="s1">match </span><span class="s2">in </span><span class="s1">line_re.finditer(text):</span>
            <span class="s1">line = match.group()</span>
            <span class="s2">if </span><span class="s1">line.startswith(</span><span class="s3">'&gt;&gt;&gt; '</span><span class="s1">) </span><span class="s2">or </span><span class="s1">line.startswith(</span><span class="s3">'... '</span><span class="s1">):</span>
                <span class="s1">tb = </span><span class="s5">0</span>
                <span class="s1">insertions.append((len(curcode)</span><span class="s2">,</span>
                                   <span class="s1">[(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">Generic.Prompt</span><span class="s2">, </span><span class="s1">line[:</span><span class="s5">4</span><span class="s1">])]))</span>
                <span class="s1">curcode += line[</span><span class="s5">4</span><span class="s1">:]</span>
            <span class="s2">elif </span><span class="s1">line.rstrip() == </span><span class="s3">'...' </span><span class="s2">and not </span><span class="s1">tb:</span>
                <span class="s4"># only a new &gt;&gt;&gt; prompt can end an exception block</span>
                <span class="s4"># otherwise an ellipsis in place of the traceback frames</span>
                <span class="s4"># will be mishandled</span>
                <span class="s1">insertions.append((len(curcode)</span><span class="s2">,</span>
                                   <span class="s1">[(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">Generic.Prompt</span><span class="s2">, </span><span class="s3">'...'</span><span class="s1">)]))</span>
                <span class="s1">curcode += line[</span><span class="s5">3</span><span class="s1">:]</span>
            <span class="s2">else</span><span class="s1">:</span>
                <span class="s2">if </span><span class="s1">curcode:</span>
                    <span class="s2">yield from </span><span class="s1">do_insertions(</span>
                        <span class="s1">insertions</span><span class="s2">, </span><span class="s1">pylexer.get_tokens_unprocessed(curcode))</span>
                    <span class="s1">curcode = </span><span class="s3">''</span>
                    <span class="s1">insertions = []</span>
                <span class="s2">if </span><span class="s1">(line.startswith(</span><span class="s3">'Traceback (most recent call last):'</span><span class="s1">) </span><span class="s2">or</span>
                        <span class="s1">re.match(</span><span class="s3">'  File &quot;[^&quot;]+&quot;, line </span><span class="s2">\\</span><span class="s3">d+</span><span class="s2">\\</span><span class="s3">n$'</span><span class="s2">, </span><span class="s1">line)):</span>
                    <span class="s1">tb = </span><span class="s5">1</span>
                    <span class="s1">curtb = line</span>
                    <span class="s1">tbindex = match.start()</span>
                <span class="s2">elif </span><span class="s1">line == </span><span class="s3">'KeyboardInterrupt</span><span class="s2">\n</span><span class="s3">'</span><span class="s1">:</span>
                    <span class="s2">yield </span><span class="s1">match.start()</span><span class="s2">, </span><span class="s1">Name.Class</span><span class="s2">, </span><span class="s1">line</span>
                <span class="s2">elif </span><span class="s1">tb:</span>
                    <span class="s1">curtb += line</span>
                    <span class="s2">if not </span><span class="s1">(line.startswith(</span><span class="s3">' '</span><span class="s1">) </span><span class="s2">or </span><span class="s1">line.strip() == </span><span class="s3">'...'</span><span class="s1">):</span>
                        <span class="s1">tb = </span><span class="s5">0</span>
                        <span class="s2">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">t</span><span class="s2">, </span><span class="s1">v </span><span class="s2">in </span><span class="s1">tblexer.get_tokens_unprocessed(curtb):</span>
                            <span class="s2">yield </span><span class="s1">tbindex+i</span><span class="s2">, </span><span class="s1">t</span><span class="s2">, </span><span class="s1">v</span>
                        <span class="s1">curtb = </span><span class="s3">''</span>
                <span class="s2">else</span><span class="s1">:</span>
                    <span class="s2">yield </span><span class="s1">match.start()</span><span class="s2">, </span><span class="s1">Generic.Output</span><span class="s2">, </span><span class="s1">line</span>
        <span class="s2">if </span><span class="s1">curcode:</span>
            <span class="s2">yield from </span><span class="s1">do_insertions(insertions</span><span class="s2">,</span>
                                     <span class="s1">pylexer.get_tokens_unprocessed(curcode))</span>
        <span class="s2">if </span><span class="s1">curtb:</span>
            <span class="s2">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">t</span><span class="s2">, </span><span class="s1">v </span><span class="s2">in </span><span class="s1">tblexer.get_tokens_unprocessed(curtb):</span>
                <span class="s2">yield </span><span class="s1">tbindex+i</span><span class="s2">, </span><span class="s1">t</span><span class="s2">, </span><span class="s1">v</span>


<span class="s2">class </span><span class="s1">PythonTracebackLexer(RegexLexer):</span>
    <span class="s0">&quot;&quot;&quot; 
    For Python 3.x tracebacks, with support for chained exceptions. 
 
    .. versionadded:: 1.0 
 
    .. versionchanged:: 2.5 
       This is now the default ``PythonTracebackLexer``.  It is still available 
       as the alias ``Python3TracebackLexer``. 
    &quot;&quot;&quot;</span>

    <span class="s1">name = </span><span class="s3">'Python Traceback'</span>
    <span class="s1">aliases = [</span><span class="s3">'pytb'</span><span class="s2">, </span><span class="s3">'py3tb'</span><span class="s1">]</span>
    <span class="s1">filenames = [</span><span class="s3">'*.pytb'</span><span class="s2">, </span><span class="s3">'*.py3tb'</span><span class="s1">]</span>
    <span class="s1">mimetypes = [</span><span class="s3">'text/x-python-traceback'</span><span class="s2">, </span><span class="s3">'text/x-python3-traceback'</span><span class="s1">]</span>

    <span class="s1">tokens = {</span>
        <span class="s3">'root'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^Traceback \(most recent call last\):\n'</span><span class="s2">, </span><span class="s1">Generic.Traceback</span><span class="s2">, </span><span class="s3">'intb'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^During handling of the above exception, another '</span>
             <span class="s3">r'exception occurred:\n\n'</span><span class="s2">, </span><span class="s1">Generic.Traceback)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^The above exception was the direct cause of the '</span>
             <span class="s3">r'following exception:\n\n'</span><span class="s2">, </span><span class="s1">Generic.Traceback)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^(?=  File &quot;[^&quot;]+&quot;, line \d+)'</span><span class="s2">, </span><span class="s1">Generic.Traceback</span><span class="s2">, </span><span class="s3">'intb'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^.*\n'</span><span class="s2">, </span><span class="s1">Other)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'intb'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'^(  File )(&quot;[^&quot;]+&quot;)(, line )(\d+)(, in )(.+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Name.Builtin</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Number</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Name</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^(  File )(&quot;[^&quot;]+&quot;)(, line )(\d+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Name.Builtin</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Number</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^(    )(.+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">using(PythonLexer)</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'markers'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^([ \t]*)(\.\.\.)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Comment</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,  </span><span class="s4"># for doctests...</span>
            <span class="s1">(</span><span class="s3">r'^([^:]+)(: )(.+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Generic.Error</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Name</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^([a-zA-Z_][\w.]*)(:?\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Generic.Error</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'markers'</span><span class="s1">: [</span>
            <span class="s4"># Either `PEP 657 &lt;https://www.python.org/dev/peps/pep-0657/&gt;`</span>
            <span class="s4"># error locations in Python 3.11+, or single-caret markers</span>
            <span class="s4"># for syntax errors before that.</span>
            <span class="s1">(</span><span class="s3">r'^( {4,})([~^]+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Punctuation.Marker</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
             <span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">}</span>


<span class="s1">Python3TracebackLexer = PythonTracebackLexer</span>


<span class="s2">class </span><span class="s1">Python2TracebackLexer(RegexLexer):</span>
    <span class="s0">&quot;&quot;&quot; 
    For Python tracebacks. 
 
    .. versionadded:: 0.7 
 
    .. versionchanged:: 2.5 
       This class has been renamed from ``PythonTracebackLexer``. 
       ``PythonTracebackLexer`` now refers to the Python 3 variant. 
    &quot;&quot;&quot;</span>

    <span class="s1">name = </span><span class="s3">'Python 2.x Traceback'</span>
    <span class="s1">aliases = [</span><span class="s3">'py2tb'</span><span class="s1">]</span>
    <span class="s1">filenames = [</span><span class="s3">'*.py2tb'</span><span class="s1">]</span>
    <span class="s1">mimetypes = [</span><span class="s3">'text/x-python2-traceback'</span><span class="s1">]</span>

    <span class="s1">tokens = {</span>
        <span class="s3">'root'</span><span class="s1">: [</span>
            <span class="s4"># Cover both (most recent call last) and (innermost last)</span>
            <span class="s4"># The optional ^C allows us to catch keyboard interrupt signals.</span>
            <span class="s1">(</span><span class="s3">r'^(\^C)?(Traceback.*\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Generic.Traceback)</span><span class="s2">, </span><span class="s3">'intb'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s4"># SyntaxError starts with this.</span>
            <span class="s1">(</span><span class="s3">r'^(?=  File &quot;[^&quot;]+&quot;, line \d+)'</span><span class="s2">, </span><span class="s1">Generic.Traceback</span><span class="s2">, </span><span class="s3">'intb'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^.*\n'</span><span class="s2">, </span><span class="s1">Other)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'intb'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'^(  File )(&quot;[^&quot;]+&quot;)(, line )(\d+)(, in )(.+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Name.Builtin</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Number</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Name</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^(  File )(&quot;[^&quot;]+&quot;)(, line )(\d+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Name.Builtin</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Number</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^(    )(.+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">using(Python2Lexer)</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'marker'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^([ \t]*)(\.\.\.)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Comment</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,  </span><span class="s4"># for doctests...</span>
            <span class="s1">(</span><span class="s3">r'^([^:]+)(: )(.+)(\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Generic.Error</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Name</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^([a-zA-Z_]\w*)(:?\n)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Generic.Error</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'marker'</span><span class="s1">: [</span>
            <span class="s4"># For syntax errors.</span>
            <span class="s1">(</span><span class="s3">r'( {4,})(\^)'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Punctuation.Marker)</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">}</span>


<span class="s2">class </span><span class="s1">CythonLexer(RegexLexer):</span>
    <span class="s0">&quot;&quot;&quot; 
    For Pyrex and `Cython &lt;http://cython.org&gt;`_ source code. 
 
    .. versionadded:: 1.1 
    &quot;&quot;&quot;</span>

    <span class="s1">name = </span><span class="s3">'Cython'</span>
    <span class="s1">aliases = [</span><span class="s3">'cython'</span><span class="s2">, </span><span class="s3">'pyx'</span><span class="s2">, </span><span class="s3">'pyrex'</span><span class="s1">]</span>
    <span class="s1">filenames = [</span><span class="s3">'*.pyx'</span><span class="s2">, </span><span class="s3">'*.pxd'</span><span class="s2">, </span><span class="s3">'*.pxi'</span><span class="s1">]</span>
    <span class="s1">mimetypes = [</span><span class="s3">'text/x-cython'</span><span class="s2">, </span><span class="s3">'application/x-cython'</span><span class="s1">]</span>

    <span class="s1">tokens = {</span>
        <span class="s3">'root'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'^(\s*)(&quot;&quot;&quot;(?:.|\n)*?&quot;&quot;&quot;)'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">String.Doc))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;^(\s*)('''(?:.|\n)*?''')&quot;</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">String.Doc))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[^\S\n]+'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'#.*$'</span><span class="s2">, </span><span class="s1">Comment)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[]{}:(),;[]'</span><span class="s2">, </span><span class="s1">Punctuation)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\\n'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(in|is|and|or|not)\b'</span><span class="s2">, </span><span class="s1">Operator.Word)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(&lt;)([a-zA-Z0-9.?]+)(&gt;)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Punctuation</span><span class="s2">, </span><span class="s1">Keyword.Type</span><span class="s2">, </span><span class="s1">Punctuation))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'!=|==|&lt;&lt;|&gt;&gt;|[-~+/*%=&lt;&gt;&amp;^|.?]'</span><span class="s2">, </span><span class="s1">Operator)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(from)(\d+)(&lt;=)(\s+)(&lt;)(\d+)(:)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Number.Integer</span><span class="s2">, </span><span class="s1">Operator</span><span class="s2">, </span><span class="s1">Name</span><span class="s2">, </span><span class="s1">Operator</span><span class="s2">,</span>
                      <span class="s1">Name</span><span class="s2">, </span><span class="s1">Punctuation))</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'keywords'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(def|property)(\s+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'funcname'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(cp?def)(\s+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'cdef'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s4"># (should actually start a block with only cdefs)</span>
            <span class="s1">(</span><span class="s3">r'(cdef)(:)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Punctuation))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(class|struct)(\s+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'classname'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(from)(\s+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'fromimport'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(c?import)(\s+)'</span><span class="s2">, </span><span class="s1">bygroups(Keyword</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'import'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'builtins'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'backtick'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'(?:[rR]|[uU][rR]|[rR][uU])&quot;&quot;&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'tdqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;(?:[rR]|[uU][rR]|[rR][uU])'''&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'tsqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'(?:[rR]|[uU][rR]|[rR][uU])&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'dqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;(?:[rR]|[uU][rR]|[rR][uU])'&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'sqs'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'[uU]?&quot;&quot;&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'tdqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;[uU]?'''&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'tsqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">'[uU]?&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'dqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;[uU]?'&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'sqs'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'name'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'numbers'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'keywords'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'assert'</span><span class="s2">, </span><span class="s3">'async'</span><span class="s2">, </span><span class="s3">'await'</span><span class="s2">, </span><span class="s3">'break'</span><span class="s2">, </span><span class="s3">'by'</span><span class="s2">, </span><span class="s3">'continue'</span><span class="s2">, </span><span class="s3">'ctypedef'</span><span class="s2">, </span><span class="s3">'del'</span><span class="s2">, </span><span class="s3">'elif'</span><span class="s2">,</span>
                <span class="s3">'else'</span><span class="s2">, </span><span class="s3">'except'</span><span class="s2">, </span><span class="s3">'except?'</span><span class="s2">, </span><span class="s3">'exec'</span><span class="s2">, </span><span class="s3">'finally'</span><span class="s2">, </span><span class="s3">'for'</span><span class="s2">, </span><span class="s3">'fused'</span><span class="s2">, </span><span class="s3">'gil'</span><span class="s2">,</span>
                <span class="s3">'global'</span><span class="s2">, </span><span class="s3">'if'</span><span class="s2">, </span><span class="s3">'include'</span><span class="s2">, </span><span class="s3">'lambda'</span><span class="s2">, </span><span class="s3">'nogil'</span><span class="s2">, </span><span class="s3">'pass'</span><span class="s2">, </span><span class="s3">'print'</span><span class="s2">,</span>
                <span class="s3">'raise'</span><span class="s2">, </span><span class="s3">'return'</span><span class="s2">, </span><span class="s3">'try'</span><span class="s2">, </span><span class="s3">'while'</span><span class="s2">, </span><span class="s3">'yield'</span><span class="s2">, </span><span class="s3">'as'</span><span class="s2">, </span><span class="s3">'with'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Keyword)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(DEF|IF|ELIF|ELSE)\b'</span><span class="s2">, </span><span class="s1">Comment.Preproc)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'builtins'</span><span class="s1">: [</span>
            <span class="s1">(words((</span>
                <span class="s3">'__import__'</span><span class="s2">, </span><span class="s3">'abs'</span><span class="s2">, </span><span class="s3">'all'</span><span class="s2">, </span><span class="s3">'any'</span><span class="s2">, </span><span class="s3">'apply'</span><span class="s2">, </span><span class="s3">'basestring'</span><span class="s2">, </span><span class="s3">'bin'</span><span class="s2">, </span><span class="s3">'bint'</span><span class="s2">,</span>
                <span class="s3">'bool'</span><span class="s2">, </span><span class="s3">'buffer'</span><span class="s2">, </span><span class="s3">'bytearray'</span><span class="s2">, </span><span class="s3">'bytes'</span><span class="s2">, </span><span class="s3">'callable'</span><span class="s2">, </span><span class="s3">'chr'</span><span class="s2">,</span>
                <span class="s3">'classmethod'</span><span class="s2">, </span><span class="s3">'cmp'</span><span class="s2">, </span><span class="s3">'coerce'</span><span class="s2">, </span><span class="s3">'compile'</span><span class="s2">, </span><span class="s3">'complex'</span><span class="s2">, </span><span class="s3">'delattr'</span><span class="s2">,</span>
                <span class="s3">'dict'</span><span class="s2">, </span><span class="s3">'dir'</span><span class="s2">, </span><span class="s3">'divmod'</span><span class="s2">, </span><span class="s3">'enumerate'</span><span class="s2">, </span><span class="s3">'eval'</span><span class="s2">, </span><span class="s3">'execfile'</span><span class="s2">, </span><span class="s3">'exit'</span><span class="s2">,</span>
                <span class="s3">'file'</span><span class="s2">, </span><span class="s3">'filter'</span><span class="s2">, </span><span class="s3">'float'</span><span class="s2">, </span><span class="s3">'frozenset'</span><span class="s2">, </span><span class="s3">'getattr'</span><span class="s2">, </span><span class="s3">'globals'</span><span class="s2">,</span>
                <span class="s3">'hasattr'</span><span class="s2">, </span><span class="s3">'hash'</span><span class="s2">, </span><span class="s3">'hex'</span><span class="s2">, </span><span class="s3">'id'</span><span class="s2">, </span><span class="s3">'input'</span><span class="s2">, </span><span class="s3">'int'</span><span class="s2">, </span><span class="s3">'intern'</span><span class="s2">, </span><span class="s3">'isinstance'</span><span class="s2">,</span>
                <span class="s3">'issubclass'</span><span class="s2">, </span><span class="s3">'iter'</span><span class="s2">, </span><span class="s3">'len'</span><span class="s2">, </span><span class="s3">'list'</span><span class="s2">, </span><span class="s3">'locals'</span><span class="s2">, </span><span class="s3">'long'</span><span class="s2">, </span><span class="s3">'map'</span><span class="s2">, </span><span class="s3">'max'</span><span class="s2">,</span>
                <span class="s3">'min'</span><span class="s2">, </span><span class="s3">'next'</span><span class="s2">, </span><span class="s3">'object'</span><span class="s2">, </span><span class="s3">'oct'</span><span class="s2">, </span><span class="s3">'open'</span><span class="s2">, </span><span class="s3">'ord'</span><span class="s2">, </span><span class="s3">'pow'</span><span class="s2">, </span><span class="s3">'property'</span><span class="s2">, </span><span class="s3">'Py_ssize_t'</span><span class="s2">,</span>
                <span class="s3">'range'</span><span class="s2">, </span><span class="s3">'raw_input'</span><span class="s2">, </span><span class="s3">'reduce'</span><span class="s2">, </span><span class="s3">'reload'</span><span class="s2">, </span><span class="s3">'repr'</span><span class="s2">, </span><span class="s3">'reversed'</span><span class="s2">,</span>
                <span class="s3">'round'</span><span class="s2">, </span><span class="s3">'set'</span><span class="s2">, </span><span class="s3">'setattr'</span><span class="s2">, </span><span class="s3">'slice'</span><span class="s2">, </span><span class="s3">'sorted'</span><span class="s2">, </span><span class="s3">'staticmethod'</span><span class="s2">,</span>
                <span class="s3">'str'</span><span class="s2">, </span><span class="s3">'sum'</span><span class="s2">, </span><span class="s3">'super'</span><span class="s2">, </span><span class="s3">'tuple'</span><span class="s2">, </span><span class="s3">'type'</span><span class="s2">, </span><span class="s3">'unichr'</span><span class="s2">, </span><span class="s3">'unicode'</span><span class="s2">, </span><span class="s3">'unsigned'</span><span class="s2">,</span>
                <span class="s3">'vars'</span><span class="s2">, </span><span class="s3">'xrange'</span><span class="s2">, </span><span class="s3">'zip'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">r'(?&lt;!\.)'</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Builtin)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?&lt;!\.)(self|None|Ellipsis|NotImplemented|False|True|NULL'</span>
             <span class="s3">r')\b'</span><span class="s2">, </span><span class="s1">Name.Builtin.Pseudo)</span><span class="s2">,</span>
            <span class="s1">(words((</span>
                <span class="s3">'ArithmeticError'</span><span class="s2">, </span><span class="s3">'AssertionError'</span><span class="s2">, </span><span class="s3">'AttributeError'</span><span class="s2">,</span>
                <span class="s3">'BaseException'</span><span class="s2">, </span><span class="s3">'DeprecationWarning'</span><span class="s2">, </span><span class="s3">'EOFError'</span><span class="s2">, </span><span class="s3">'EnvironmentError'</span><span class="s2">,</span>
                <span class="s3">'Exception'</span><span class="s2">, </span><span class="s3">'FloatingPointError'</span><span class="s2">, </span><span class="s3">'FutureWarning'</span><span class="s2">, </span><span class="s3">'GeneratorExit'</span><span class="s2">,</span>
                <span class="s3">'IOError'</span><span class="s2">, </span><span class="s3">'ImportError'</span><span class="s2">, </span><span class="s3">'ImportWarning'</span><span class="s2">, </span><span class="s3">'IndentationError'</span><span class="s2">,</span>
                <span class="s3">'IndexError'</span><span class="s2">, </span><span class="s3">'KeyError'</span><span class="s2">, </span><span class="s3">'KeyboardInterrupt'</span><span class="s2">, </span><span class="s3">'LookupError'</span><span class="s2">,</span>
                <span class="s3">'MemoryError'</span><span class="s2">, </span><span class="s3">'NameError'</span><span class="s2">, </span><span class="s3">'NotImplemented'</span><span class="s2">, </span><span class="s3">'NotImplementedError'</span><span class="s2">,</span>
                <span class="s3">'OSError'</span><span class="s2">, </span><span class="s3">'OverflowError'</span><span class="s2">, </span><span class="s3">'OverflowWarning'</span><span class="s2">,</span>
                <span class="s3">'PendingDeprecationWarning'</span><span class="s2">, </span><span class="s3">'ReferenceError'</span><span class="s2">, </span><span class="s3">'RuntimeError'</span><span class="s2">,</span>
                <span class="s3">'RuntimeWarning'</span><span class="s2">, </span><span class="s3">'StandardError'</span><span class="s2">, </span><span class="s3">'StopIteration'</span><span class="s2">, </span><span class="s3">'SyntaxError'</span><span class="s2">,</span>
                <span class="s3">'SyntaxWarning'</span><span class="s2">, </span><span class="s3">'SystemError'</span><span class="s2">, </span><span class="s3">'SystemExit'</span><span class="s2">, </span><span class="s3">'TabError'</span><span class="s2">,</span>
                <span class="s3">'TypeError'</span><span class="s2">, </span><span class="s3">'UnboundLocalError'</span><span class="s2">, </span><span class="s3">'UnicodeDecodeError'</span><span class="s2">,</span>
                <span class="s3">'UnicodeEncodeError'</span><span class="s2">, </span><span class="s3">'UnicodeError'</span><span class="s2">, </span><span class="s3">'UnicodeTranslateError'</span><span class="s2">,</span>
                <span class="s3">'UnicodeWarning'</span><span class="s2">, </span><span class="s3">'UserWarning'</span><span class="s2">, </span><span class="s3">'ValueError'</span><span class="s2">, </span><span class="s3">'Warning'</span><span class="s2">,</span>
                <span class="s3">'ZeroDivisionError'</span><span class="s1">)</span><span class="s2">, </span><span class="s1">prefix=</span><span class="s3">r'(?&lt;!\.)'</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'\b'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Exception)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'numbers'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(\d+\.?\d*|\d*\.\d+)([eE][+-]?[0-9]+)?'</span><span class="s2">, </span><span class="s1">Number.Float)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'0\d+'</span><span class="s2">, </span><span class="s1">Number.Oct)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'0[xX][a-fA-F0-9]+'</span><span class="s2">, </span><span class="s1">Number.Hex)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\d+L'</span><span class="s2">, </span><span class="s1">Number.Integer.Long)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\d+'</span><span class="s2">, </span><span class="s1">Number.Integer)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'backtick'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">'`.*?`'</span><span class="s2">, </span><span class="s1">String.Backtick)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'name'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'@\w+'</span><span class="s2">, </span><span class="s1">Name.Decorator)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_]\w*'</span><span class="s2">, </span><span class="s1">Name)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'funcname'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_]\w*'</span><span class="s2">, </span><span class="s1">Name.Function</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'cdef'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(public|readonly|extern|api|inline)\b'</span><span class="s2">, </span><span class="s1">Keyword.Reserved)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(struct|enum|union|class)\b'</span><span class="s2">, </span><span class="s1">Keyword)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'([a-zA-Z_]\w*)(\s*)(?=[(:#=]|$)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Name.Function</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'([a-zA-Z_]\w*)(\s*)(,)'</span><span class="s2">,</span>
             <span class="s1">bygroups(Name.Function</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s1">Punctuation))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'from\b'</span><span class="s2">, </span><span class="s1">Keyword</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'as\b'</span><span class="s2">, </span><span class="s1">Keyword)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r':'</span><span class="s2">, </span><span class="s1">Punctuation</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?=[&quot;\'])'</span><span class="s2">, </span><span class="s1">Text</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_]\w*'</span><span class="s2">, </span><span class="s1">Keyword.Type)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'.'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'classname'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_]\w*'</span><span class="s2">, </span><span class="s1">Name.Class</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'import'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(\s+)(as)(\s+)'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Keyword</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_][\w.]*'</span><span class="s2">, </span><span class="s1">Name.Namespace)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(\s*)(,)(\s*)'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Operator</span><span class="s2">, </span><span class="s1">Text))</span><span class="s2">,</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)  </span><span class="s4"># all else: go back</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'fromimport'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'(\s+)(c?import)\b'</span><span class="s2">, </span><span class="s1">bygroups(Text</span><span class="s2">, </span><span class="s1">Keyword)</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[a-zA-Z_.][\w.]*'</span><span class="s2">, </span><span class="s1">Name.Namespace)</span><span class="s2">,</span>
            <span class="s4"># ``cdef foo from &quot;header&quot;``, or ``for foo from 0 &lt; i &lt; 10``</span>
            <span class="s1">default(</span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'stringescape'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\\([\\abfnrtv&quot;\']|\n|N\{.*?\}|u[a-fA-F0-9]{4}|'</span>
             <span class="s3">r'U[a-fA-F0-9]{8}|x[a-fA-F0-9]{2}|[0-7]{1,3})'</span><span class="s2">, </span><span class="s1">String.Escape)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'strings'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'%(\([a-zA-Z0-9]+\))?[-#0 +]*([0-9]+|[*])?(\.([0-9]+|[*]))?'</span>
             <span class="s3">'[hlL]?[E-GXc-giorsux%]'</span><span class="s2">, </span><span class="s1">String.Interpol)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[^\\\'&quot;%\n]+'</span><span class="s2">, </span><span class="s1">String)</span><span class="s2">,</span>
            <span class="s4"># quotes, percents and backslashes must be parsed one at a time</span>
            <span class="s1">(</span><span class="s3">r'[\'&quot;\\]'</span><span class="s2">, </span><span class="s1">String)</span><span class="s2">,</span>
            <span class="s4"># unhandled string formatting sign</span>
            <span class="s1">(</span><span class="s3">r'%'</span><span class="s2">, </span><span class="s1">String)</span>
            <span class="s4"># newlines are an error (use &quot;nl&quot; state)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'nl'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">String)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'dqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\\\\|\\&quot;|\\\n'</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,  </span><span class="s4"># included here again for raw strings</span>
            <span class="s1">include(</span><span class="s3">'strings'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'sqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;\\\\|\\'|\\\n&quot;</span><span class="s2">, </span><span class="s1">String.Escape)</span><span class="s2">,  </span><span class="s4"># included here again for raw strings</span>
            <span class="s1">include(</span><span class="s3">'strings'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tdqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;&quot;&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'strings'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'nl'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tsqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'''&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'strings'</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">include(</span><span class="s3">'nl'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">}</span>


<span class="s2">class </span><span class="s1">DgLexer(RegexLexer):</span>
    <span class="s0">&quot;&quot;&quot; 
    Lexer for `dg &lt;http://pyos.github.com/dg&gt;`_, 
    a functional and object-oriented programming language 
    running on the CPython 3 VM. 
 
    .. versionadded:: 1.6 
    &quot;&quot;&quot;</span>
    <span class="s1">name = </span><span class="s3">'dg'</span>
    <span class="s1">aliases = [</span><span class="s3">'dg'</span><span class="s1">]</span>
    <span class="s1">filenames = [</span><span class="s3">'*.dg'</span><span class="s1">]</span>
    <span class="s1">mimetypes = [</span><span class="s3">'text/x-dg'</span><span class="s1">]</span>

    <span class="s1">tokens = {</span>
        <span class="s3">'root'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\s+'</span><span class="s2">, </span><span class="s1">Text)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'#.*?$'</span><span class="s2">, </span><span class="s1">Comment.Single)</span><span class="s2">,</span>

            <span class="s1">(</span><span class="s3">r'(?i)0b[01]+'</span><span class="s2">, </span><span class="s1">Number.Bin)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?i)0o[0-7]+'</span><span class="s2">, </span><span class="s1">Number.Oct)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?i)0x[0-9a-f]+'</span><span class="s2">, </span><span class="s1">Number.Hex)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?i)[+-]?[0-9]+\.[0-9]+(e[+-]?[0-9]+)?j?'</span><span class="s2">, </span><span class="s1">Number.Float)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?i)[+-]?[0-9]+e[+-]?\d+j?'</span><span class="s2">, </span><span class="s1">Number.Float)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?i)[+-]?[0-9]+j?'</span><span class="s2">, </span><span class="s1">Number.Integer)</span><span class="s2">,</span>

            <span class="s1">(</span><span class="s3">r&quot;(?i)(br|r?b?)'''&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'tsqs'</span><span class="s2">, </span><span class="s3">'string'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?i)(br|r?b?)&quot;&quot;&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'tdqs'</span><span class="s2">, </span><span class="s3">'string'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;(?i)(br|r?b?)'&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'sqs'</span><span class="s2">, </span><span class="s3">'string'</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'(?i)(br|r?b?)&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s1">combined(</span><span class="s3">'stringescape'</span><span class="s2">, </span><span class="s3">'dqs'</span><span class="s2">, </span><span class="s3">'string'</span><span class="s1">))</span><span class="s2">,</span>

            <span class="s1">(</span><span class="s3">r&quot;`\w+'*`&quot;</span><span class="s2">, </span><span class="s1">Operator)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\b(and|in|is|or|where)\b'</span><span class="s2">, </span><span class="s1">Operator.Word)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[!$%&amp;*+\-./:&lt;-@\\^|~;,]+'</span><span class="s2">, </span><span class="s1">Operator)</span><span class="s2">,</span>

            <span class="s1">(words((</span>
                <span class="s3">'bool'</span><span class="s2">, </span><span class="s3">'bytearray'</span><span class="s2">, </span><span class="s3">'bytes'</span><span class="s2">, </span><span class="s3">'classmethod'</span><span class="s2">, </span><span class="s3">'complex'</span><span class="s2">, </span><span class="s3">'dict'</span><span class="s2">, </span><span class="s3">'dict</span><span class="s2">\'</span><span class="s3">'</span><span class="s2">,</span>
                <span class="s3">'float'</span><span class="s2">, </span><span class="s3">'frozenset'</span><span class="s2">, </span><span class="s3">'int'</span><span class="s2">, </span><span class="s3">'list'</span><span class="s2">, </span><span class="s3">'list</span><span class="s2">\'</span><span class="s3">'</span><span class="s2">, </span><span class="s3">'memoryview'</span><span class="s2">, </span><span class="s3">'object'</span><span class="s2">,</span>
                <span class="s3">'property'</span><span class="s2">, </span><span class="s3">'range'</span><span class="s2">, </span><span class="s3">'set'</span><span class="s2">, </span><span class="s3">'set</span><span class="s2">\'</span><span class="s3">'</span><span class="s2">, </span><span class="s3">'slice'</span><span class="s2">, </span><span class="s3">'staticmethod'</span><span class="s2">, </span><span class="s3">'str'</span><span class="s2">,</span>
                <span class="s3">'super'</span><span class="s2">, </span><span class="s3">'tuple'</span><span class="s2">, </span><span class="s3">'tuple</span><span class="s2">\'</span><span class="s3">'</span><span class="s2">, </span><span class="s3">'type'</span><span class="s1">)</span><span class="s2">,</span>
                   <span class="s1">prefix=</span><span class="s3">r'(?&lt;!\.)'</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'(?![\'\w])'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Builtin)</span><span class="s2">,</span>
            <span class="s1">(words((</span>
                <span class="s3">'__import__'</span><span class="s2">, </span><span class="s3">'abs'</span><span class="s2">, </span><span class="s3">'all'</span><span class="s2">, </span><span class="s3">'any'</span><span class="s2">, </span><span class="s3">'bin'</span><span class="s2">, </span><span class="s3">'bind'</span><span class="s2">, </span><span class="s3">'chr'</span><span class="s2">, </span><span class="s3">'cmp'</span><span class="s2">, </span><span class="s3">'compile'</span><span class="s2">,</span>
                <span class="s3">'complex'</span><span class="s2">, </span><span class="s3">'delattr'</span><span class="s2">, </span><span class="s3">'dir'</span><span class="s2">, </span><span class="s3">'divmod'</span><span class="s2">, </span><span class="s3">'drop'</span><span class="s2">, </span><span class="s3">'dropwhile'</span><span class="s2">, </span><span class="s3">'enumerate'</span><span class="s2">,</span>
                <span class="s3">'eval'</span><span class="s2">, </span><span class="s3">'exhaust'</span><span class="s2">, </span><span class="s3">'filter'</span><span class="s2">, </span><span class="s3">'flip'</span><span class="s2">, </span><span class="s3">'foldl1?'</span><span class="s2">, </span><span class="s3">'format'</span><span class="s2">, </span><span class="s3">'fst'</span><span class="s2">,</span>
                <span class="s3">'getattr'</span><span class="s2">, </span><span class="s3">'globals'</span><span class="s2">, </span><span class="s3">'hasattr'</span><span class="s2">, </span><span class="s3">'hash'</span><span class="s2">, </span><span class="s3">'head'</span><span class="s2">, </span><span class="s3">'hex'</span><span class="s2">, </span><span class="s3">'id'</span><span class="s2">, </span><span class="s3">'init'</span><span class="s2">,</span>
                <span class="s3">'input'</span><span class="s2">, </span><span class="s3">'isinstance'</span><span class="s2">, </span><span class="s3">'issubclass'</span><span class="s2">, </span><span class="s3">'iter'</span><span class="s2">, </span><span class="s3">'iterate'</span><span class="s2">, </span><span class="s3">'last'</span><span class="s2">, </span><span class="s3">'len'</span><span class="s2">,</span>
                <span class="s3">'locals'</span><span class="s2">, </span><span class="s3">'map'</span><span class="s2">, </span><span class="s3">'max'</span><span class="s2">, </span><span class="s3">'min'</span><span class="s2">, </span><span class="s3">'next'</span><span class="s2">, </span><span class="s3">'oct'</span><span class="s2">, </span><span class="s3">'open'</span><span class="s2">, </span><span class="s3">'ord'</span><span class="s2">, </span><span class="s3">'pow'</span><span class="s2">,</span>
                <span class="s3">'print'</span><span class="s2">, </span><span class="s3">'repr'</span><span class="s2">, </span><span class="s3">'reversed'</span><span class="s2">, </span><span class="s3">'round'</span><span class="s2">, </span><span class="s3">'setattr'</span><span class="s2">, </span><span class="s3">'scanl1?'</span><span class="s2">, </span><span class="s3">'snd'</span><span class="s2">,</span>
                <span class="s3">'sorted'</span><span class="s2">, </span><span class="s3">'sum'</span><span class="s2">, </span><span class="s3">'tail'</span><span class="s2">, </span><span class="s3">'take'</span><span class="s2">, </span><span class="s3">'takewhile'</span><span class="s2">, </span><span class="s3">'vars'</span><span class="s2">, </span><span class="s3">'zip'</span><span class="s1">)</span><span class="s2">,</span>
                   <span class="s1">prefix=</span><span class="s3">r'(?&lt;!\.)'</span><span class="s2">, </span><span class="s1">suffix=</span><span class="s3">r'(?![\'\w])'</span><span class="s1">)</span><span class="s2">,</span>
             <span class="s1">Name.Builtin)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;(?&lt;!\.)(self|Ellipsis|NotImplemented|None|True|False)(?!['\w])&quot;</span><span class="s2">,</span>
             <span class="s1">Name.Builtin.Pseudo)</span><span class="s2">,</span>

            <span class="s1">(</span><span class="s3">r&quot;(?&lt;!\.)[A-Z]\w*(Error|Exception|Warning)'*(?!['\w])&quot;</span><span class="s2">,</span>
             <span class="s1">Name.Exception)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;(?&lt;!\.)(Exception|GeneratorExit|KeyboardInterrupt|StopIteration|&quot;</span>
             <span class="s3">r&quot;SystemExit)(?!['\w])&quot;</span><span class="s2">, </span><span class="s1">Name.Exception)</span><span class="s2">,</span>

            <span class="s1">(</span><span class="s3">r&quot;(?&lt;![\w.])(except|finally|for|if|import|not|otherwise|raise|&quot;</span>
             <span class="s3">r&quot;subclass|while|with|yield)(?!['\w])&quot;</span><span class="s2">, </span><span class="s1">Keyword.Reserved)</span><span class="s2">,</span>

            <span class="s1">(</span><span class="s3">r&quot;[A-Z_]+'*(?!['\w])&quot;</span><span class="s2">, </span><span class="s1">Name)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;[A-Z]\w+'*(?!['\w])&quot;</span><span class="s2">, </span><span class="s1">Keyword.Type)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r&quot;\w+'*&quot;</span><span class="s2">, </span><span class="s1">Name)</span><span class="s2">,</span>

            <span class="s1">(</span><span class="s3">r'[()]'</span><span class="s2">, </span><span class="s1">Punctuation)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'.'</span><span class="s2">, </span><span class="s1">Error)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'stringescape'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'\\([\\abfnrtv&quot;\']|\n|N\{.*?\}|u[a-fA-F0-9]{4}|'</span>
             <span class="s3">r'U[a-fA-F0-9]{8}|x[a-fA-F0-9]{2}|[0-7]{1,3})'</span><span class="s2">, </span><span class="s1">String.Escape)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'string'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'%(\(\w+\))?[-#0 +]*([0-9]+|[*])?(\.([0-9]+|[*]))?'</span>
             <span class="s3">'[hlL]?[E-GXc-giorsux%]'</span><span class="s2">, </span><span class="s1">String.Interpol)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'[^\\\'&quot;%\n]+'</span><span class="s2">, </span><span class="s1">String)</span><span class="s2">,</span>
            <span class="s4"># quotes, percents and backslashes must be parsed one at a time</span>
            <span class="s1">(</span><span class="s3">r'[\'&quot;\\]'</span><span class="s2">, </span><span class="s1">String)</span><span class="s2">,</span>
            <span class="s4"># unhandled string formatting sign</span>
            <span class="s1">(</span><span class="s3">r'%'</span><span class="s2">, </span><span class="s1">String)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">r'\n'</span><span class="s2">, </span><span class="s1">String)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'dqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'sqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tdqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r'&quot;&quot;&quot;'</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
        <span class="s3">'tsqs'</span><span class="s1">: [</span>
            <span class="s1">(</span><span class="s3">r&quot;'''&quot;</span><span class="s2">, </span><span class="s1">String</span><span class="s2">, </span><span class="s3">'#pop'</span><span class="s1">)</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">}</span>


<span class="s2">class </span><span class="s1">NumPyLexer(PythonLexer):</span>
    <span class="s0">&quot;&quot;&quot; 
    A Python lexer recognizing Numerical Python builtins. 
 
    .. versionadded:: 0.10 
    &quot;&quot;&quot;</span>

    <span class="s1">name = </span><span class="s3">'NumPy'</span>
    <span class="s1">aliases = [</span><span class="s3">'numpy'</span><span class="s1">]</span>

    <span class="s4"># override the mimetypes to not inherit them from python</span>
    <span class="s1">mimetypes = []</span>
    <span class="s1">filenames = []</span>

    <span class="s1">EXTRA_KEYWORDS = {</span>
        <span class="s3">'abs'</span><span class="s2">, </span><span class="s3">'absolute'</span><span class="s2">, </span><span class="s3">'accumulate'</span><span class="s2">, </span><span class="s3">'add'</span><span class="s2">, </span><span class="s3">'alen'</span><span class="s2">, </span><span class="s3">'all'</span><span class="s2">, </span><span class="s3">'allclose'</span><span class="s2">,</span>
        <span class="s3">'alltrue'</span><span class="s2">, </span><span class="s3">'alterdot'</span><span class="s2">, </span><span class="s3">'amax'</span><span class="s2">, </span><span class="s3">'amin'</span><span class="s2">, </span><span class="s3">'angle'</span><span class="s2">, </span><span class="s3">'any'</span><span class="s2">, </span><span class="s3">'append'</span><span class="s2">,</span>
        <span class="s3">'apply_along_axis'</span><span class="s2">, </span><span class="s3">'apply_over_axes'</span><span class="s2">, </span><span class="s3">'arange'</span><span class="s2">, </span><span class="s3">'arccos'</span><span class="s2">, </span><span class="s3">'arccosh'</span><span class="s2">,</span>
        <span class="s3">'arcsin'</span><span class="s2">, </span><span class="s3">'arcsinh'</span><span class="s2">, </span><span class="s3">'arctan'</span><span class="s2">, </span><span class="s3">'arctan2'</span><span class="s2">, </span><span class="s3">'arctanh'</span><span class="s2">, </span><span class="s3">'argmax'</span><span class="s2">, </span><span class="s3">'argmin'</span><span class="s2">,</span>
        <span class="s3">'argsort'</span><span class="s2">, </span><span class="s3">'argwhere'</span><span class="s2">, </span><span class="s3">'around'</span><span class="s2">, </span><span class="s3">'array'</span><span class="s2">, </span><span class="s3">'array2string'</span><span class="s2">, </span><span class="s3">'array_equal'</span><span class="s2">,</span>
        <span class="s3">'array_equiv'</span><span class="s2">, </span><span class="s3">'array_repr'</span><span class="s2">, </span><span class="s3">'array_split'</span><span class="s2">, </span><span class="s3">'array_str'</span><span class="s2">, </span><span class="s3">'arrayrange'</span><span class="s2">,</span>
        <span class="s3">'asanyarray'</span><span class="s2">, </span><span class="s3">'asarray'</span><span class="s2">, </span><span class="s3">'asarray_chkfinite'</span><span class="s2">, </span><span class="s3">'ascontiguousarray'</span><span class="s2">,</span>
        <span class="s3">'asfarray'</span><span class="s2">, </span><span class="s3">'asfortranarray'</span><span class="s2">, </span><span class="s3">'asmatrix'</span><span class="s2">, </span><span class="s3">'asscalar'</span><span class="s2">, </span><span class="s3">'astype'</span><span class="s2">,</span>
        <span class="s3">'atleast_1d'</span><span class="s2">, </span><span class="s3">'atleast_2d'</span><span class="s2">, </span><span class="s3">'atleast_3d'</span><span class="s2">, </span><span class="s3">'average'</span><span class="s2">, </span><span class="s3">'bartlett'</span><span class="s2">,</span>
        <span class="s3">'base_repr'</span><span class="s2">, </span><span class="s3">'beta'</span><span class="s2">, </span><span class="s3">'binary_repr'</span><span class="s2">, </span><span class="s3">'bincount'</span><span class="s2">, </span><span class="s3">'binomial'</span><span class="s2">,</span>
        <span class="s3">'bitwise_and'</span><span class="s2">, </span><span class="s3">'bitwise_not'</span><span class="s2">, </span><span class="s3">'bitwise_or'</span><span class="s2">, </span><span class="s3">'bitwise_xor'</span><span class="s2">, </span><span class="s3">'blackman'</span><span class="s2">,</span>
        <span class="s3">'bmat'</span><span class="s2">, </span><span class="s3">'broadcast'</span><span class="s2">, </span><span class="s3">'byte_bounds'</span><span class="s2">, </span><span class="s3">'bytes'</span><span class="s2">, </span><span class="s3">'byteswap'</span><span class="s2">, </span><span class="s3">'c_'</span><span class="s2">,</span>
        <span class="s3">'can_cast'</span><span class="s2">, </span><span class="s3">'ceil'</span><span class="s2">, </span><span class="s3">'choose'</span><span class="s2">, </span><span class="s3">'clip'</span><span class="s2">, </span><span class="s3">'column_stack'</span><span class="s2">, </span><span class="s3">'common_type'</span><span class="s2">,</span>
        <span class="s3">'compare_chararrays'</span><span class="s2">, </span><span class="s3">'compress'</span><span class="s2">, </span><span class="s3">'concatenate'</span><span class="s2">, </span><span class="s3">'conj'</span><span class="s2">, </span><span class="s3">'conjugate'</span><span class="s2">,</span>
        <span class="s3">'convolve'</span><span class="s2">, </span><span class="s3">'copy'</span><span class="s2">, </span><span class="s3">'corrcoef'</span><span class="s2">, </span><span class="s3">'correlate'</span><span class="s2">, </span><span class="s3">'cos'</span><span class="s2">, </span><span class="s3">'cosh'</span><span class="s2">, </span><span class="s3">'cov'</span><span class="s2">,</span>
        <span class="s3">'cross'</span><span class="s2">, </span><span class="s3">'cumprod'</span><span class="s2">, </span><span class="s3">'cumproduct'</span><span class="s2">, </span><span class="s3">'cumsum'</span><span class="s2">, </span><span class="s3">'delete'</span><span class="s2">, </span><span class="s3">'deprecate'</span><span class="s2">,</span>
        <span class="s3">'diag'</span><span class="s2">, </span><span class="s3">'diagflat'</span><span class="s2">, </span><span class="s3">'diagonal'</span><span class="s2">, </span><span class="s3">'diff'</span><span class="s2">, </span><span class="s3">'digitize'</span><span class="s2">, </span><span class="s3">'disp'</span><span class="s2">, </span><span class="s3">'divide'</span><span class="s2">,</span>
        <span class="s3">'dot'</span><span class="s2">, </span><span class="s3">'dsplit'</span><span class="s2">, </span><span class="s3">'dstack'</span><span class="s2">, </span><span class="s3">'dtype'</span><span class="s2">, </span><span class="s3">'dump'</span><span class="s2">, </span><span class="s3">'dumps'</span><span class="s2">, </span><span class="s3">'ediff1d'</span><span class="s2">, </span><span class="s3">'empty'</span><span class="s2">,</span>
        <span class="s3">'empty_like'</span><span class="s2">, </span><span class="s3">'equal'</span><span class="s2">, </span><span class="s3">'exp'</span><span class="s2">, </span><span class="s3">'expand_dims'</span><span class="s2">, </span><span class="s3">'expm1'</span><span class="s2">, </span><span class="s3">'extract'</span><span class="s2">, </span><span class="s3">'eye'</span><span class="s2">,</span>
        <span class="s3">'fabs'</span><span class="s2">, </span><span class="s3">'fastCopyAndTranspose'</span><span class="s2">, </span><span class="s3">'fft'</span><span class="s2">, </span><span class="s3">'fftfreq'</span><span class="s2">, </span><span class="s3">'fftshift'</span><span class="s2">, </span><span class="s3">'fill'</span><span class="s2">,</span>
        <span class="s3">'finfo'</span><span class="s2">, </span><span class="s3">'fix'</span><span class="s2">, </span><span class="s3">'flat'</span><span class="s2">, </span><span class="s3">'flatnonzero'</span><span class="s2">, </span><span class="s3">'flatten'</span><span class="s2">, </span><span class="s3">'fliplr'</span><span class="s2">, </span><span class="s3">'flipud'</span><span class="s2">,</span>
        <span class="s3">'floor'</span><span class="s2">, </span><span class="s3">'floor_divide'</span><span class="s2">, </span><span class="s3">'fmod'</span><span class="s2">, </span><span class="s3">'frexp'</span><span class="s2">, </span><span class="s3">'fromarrays'</span><span class="s2">, </span><span class="s3">'frombuffer'</span><span class="s2">,</span>
        <span class="s3">'fromfile'</span><span class="s2">, </span><span class="s3">'fromfunction'</span><span class="s2">, </span><span class="s3">'fromiter'</span><span class="s2">, </span><span class="s3">'frompyfunc'</span><span class="s2">, </span><span class="s3">'fromstring'</span><span class="s2">,</span>
        <span class="s3">'generic'</span><span class="s2">, </span><span class="s3">'get_array_wrap'</span><span class="s2">, </span><span class="s3">'get_include'</span><span class="s2">, </span><span class="s3">'get_numarray_include'</span><span class="s2">,</span>
        <span class="s3">'get_numpy_include'</span><span class="s2">, </span><span class="s3">'get_printoptions'</span><span class="s2">, </span><span class="s3">'getbuffer'</span><span class="s2">, </span><span class="s3">'getbufsize'</span><span class="s2">,</span>
        <span class="s3">'geterr'</span><span class="s2">, </span><span class="s3">'geterrcall'</span><span class="s2">, </span><span class="s3">'geterrobj'</span><span class="s2">, </span><span class="s3">'getfield'</span><span class="s2">, </span><span class="s3">'gradient'</span><span class="s2">, </span><span class="s3">'greater'</span><span class="s2">,</span>
        <span class="s3">'greater_equal'</span><span class="s2">, </span><span class="s3">'gumbel'</span><span class="s2">, </span><span class="s3">'hamming'</span><span class="s2">, </span><span class="s3">'hanning'</span><span class="s2">, </span><span class="s3">'histogram'</span><span class="s2">,</span>
        <span class="s3">'histogram2d'</span><span class="s2">, </span><span class="s3">'histogramdd'</span><span class="s2">, </span><span class="s3">'hsplit'</span><span class="s2">, </span><span class="s3">'hstack'</span><span class="s2">, </span><span class="s3">'hypot'</span><span class="s2">, </span><span class="s3">'i0'</span><span class="s2">,</span>
        <span class="s3">'identity'</span><span class="s2">, </span><span class="s3">'ifft'</span><span class="s2">, </span><span class="s3">'imag'</span><span class="s2">, </span><span class="s3">'index_exp'</span><span class="s2">, </span><span class="s3">'indices'</span><span class="s2">, </span><span class="s3">'inf'</span><span class="s2">, </span><span class="s3">'info'</span><span class="s2">,</span>
        <span class="s3">'inner'</span><span class="s2">, </span><span class="s3">'insert'</span><span class="s2">, </span><span class="s3">'int_asbuffer'</span><span class="s2">, </span><span class="s3">'interp'</span><span class="s2">, </span><span class="s3">'intersect1d'</span><span class="s2">,</span>
        <span class="s3">'intersect1d_nu'</span><span class="s2">, </span><span class="s3">'inv'</span><span class="s2">, </span><span class="s3">'invert'</span><span class="s2">, </span><span class="s3">'iscomplex'</span><span class="s2">, </span><span class="s3">'iscomplexobj'</span><span class="s2">,</span>
        <span class="s3">'isfinite'</span><span class="s2">, </span><span class="s3">'isfortran'</span><span class="s2">, </span><span class="s3">'isinf'</span><span class="s2">, </span><span class="s3">'isnan'</span><span class="s2">, </span><span class="s3">'isneginf'</span><span class="s2">, </span><span class="s3">'isposinf'</span><span class="s2">,</span>
        <span class="s3">'isreal'</span><span class="s2">, </span><span class="s3">'isrealobj'</span><span class="s2">, </span><span class="s3">'isscalar'</span><span class="s2">, </span><span class="s3">'issctype'</span><span class="s2">, </span><span class="s3">'issubclass_'</span><span class="s2">,</span>
        <span class="s3">'issubdtype'</span><span class="s2">, </span><span class="s3">'issubsctype'</span><span class="s2">, </span><span class="s3">'item'</span><span class="s2">, </span><span class="s3">'itemset'</span><span class="s2">, </span><span class="s3">'iterable'</span><span class="s2">, </span><span class="s3">'ix_'</span><span class="s2">,</span>
        <span class="s3">'kaiser'</span><span class="s2">, </span><span class="s3">'kron'</span><span class="s2">, </span><span class="s3">'ldexp'</span><span class="s2">, </span><span class="s3">'left_shift'</span><span class="s2">, </span><span class="s3">'less'</span><span class="s2">, </span><span class="s3">'less_equal'</span><span class="s2">, </span><span class="s3">'lexsort'</span><span class="s2">,</span>
        <span class="s3">'linspace'</span><span class="s2">, </span><span class="s3">'load'</span><span class="s2">, </span><span class="s3">'loads'</span><span class="s2">, </span><span class="s3">'loadtxt'</span><span class="s2">, </span><span class="s3">'log'</span><span class="s2">, </span><span class="s3">'log10'</span><span class="s2">, </span><span class="s3">'log1p'</span><span class="s2">, </span><span class="s3">'log2'</span><span class="s2">,</span>
        <span class="s3">'logical_and'</span><span class="s2">, </span><span class="s3">'logical_not'</span><span class="s2">, </span><span class="s3">'logical_or'</span><span class="s2">, </span><span class="s3">'logical_xor'</span><span class="s2">, </span><span class="s3">'logspace'</span><span class="s2">,</span>
        <span class="s3">'lstsq'</span><span class="s2">, </span><span class="s3">'mat'</span><span class="s2">, </span><span class="s3">'matrix'</span><span class="s2">, </span><span class="s3">'max'</span><span class="s2">, </span><span class="s3">'maximum'</span><span class="s2">, </span><span class="s3">'maximum_sctype'</span><span class="s2">,</span>
        <span class="s3">'may_share_memory'</span><span class="s2">, </span><span class="s3">'mean'</span><span class="s2">, </span><span class="s3">'median'</span><span class="s2">, </span><span class="s3">'meshgrid'</span><span class="s2">, </span><span class="s3">'mgrid'</span><span class="s2">, </span><span class="s3">'min'</span><span class="s2">,</span>
        <span class="s3">'minimum'</span><span class="s2">, </span><span class="s3">'mintypecode'</span><span class="s2">, </span><span class="s3">'mod'</span><span class="s2">, </span><span class="s3">'modf'</span><span class="s2">, </span><span class="s3">'msort'</span><span class="s2">, </span><span class="s3">'multiply'</span><span class="s2">, </span><span class="s3">'nan'</span><span class="s2">,</span>
        <span class="s3">'nan_to_num'</span><span class="s2">, </span><span class="s3">'nanargmax'</span><span class="s2">, </span><span class="s3">'nanargmin'</span><span class="s2">, </span><span class="s3">'nanmax'</span><span class="s2">, </span><span class="s3">'nanmin'</span><span class="s2">, </span><span class="s3">'nansum'</span><span class="s2">,</span>
        <span class="s3">'ndenumerate'</span><span class="s2">, </span><span class="s3">'ndim'</span><span class="s2">, </span><span class="s3">'ndindex'</span><span class="s2">, </span><span class="s3">'negative'</span><span class="s2">, </span><span class="s3">'newaxis'</span><span class="s2">, </span><span class="s3">'newbuffer'</span><span class="s2">,</span>
        <span class="s3">'newbyteorder'</span><span class="s2">, </span><span class="s3">'nonzero'</span><span class="s2">, </span><span class="s3">'not_equal'</span><span class="s2">, </span><span class="s3">'obj2sctype'</span><span class="s2">, </span><span class="s3">'ogrid'</span><span class="s2">, </span><span class="s3">'ones'</span><span class="s2">,</span>
        <span class="s3">'ones_like'</span><span class="s2">, </span><span class="s3">'outer'</span><span class="s2">, </span><span class="s3">'permutation'</span><span class="s2">, </span><span class="s3">'piecewise'</span><span class="s2">, </span><span class="s3">'pinv'</span><span class="s2">, </span><span class="s3">'pkgload'</span><span class="s2">,</span>
        <span class="s3">'place'</span><span class="s2">, </span><span class="s3">'poisson'</span><span class="s2">, </span><span class="s3">'poly'</span><span class="s2">, </span><span class="s3">'poly1d'</span><span class="s2">, </span><span class="s3">'polyadd'</span><span class="s2">, </span><span class="s3">'polyder'</span><span class="s2">, </span><span class="s3">'polydiv'</span><span class="s2">,</span>
        <span class="s3">'polyfit'</span><span class="s2">, </span><span class="s3">'polyint'</span><span class="s2">, </span><span class="s3">'polymul'</span><span class="s2">, </span><span class="s3">'polysub'</span><span class="s2">, </span><span class="s3">'polyval'</span><span class="s2">, </span><span class="s3">'power'</span><span class="s2">, </span><span class="s3">'prod'</span><span class="s2">,</span>
        <span class="s3">'product'</span><span class="s2">, </span><span class="s3">'ptp'</span><span class="s2">, </span><span class="s3">'put'</span><span class="s2">, </span><span class="s3">'putmask'</span><span class="s2">, </span><span class="s3">'r_'</span><span class="s2">, </span><span class="s3">'randint'</span><span class="s2">, </span><span class="s3">'random_integers'</span><span class="s2">,</span>
        <span class="s3">'random_sample'</span><span class="s2">, </span><span class="s3">'ranf'</span><span class="s2">, </span><span class="s3">'rank'</span><span class="s2">, </span><span class="s3">'ravel'</span><span class="s2">, </span><span class="s3">'real'</span><span class="s2">, </span><span class="s3">'real_if_close'</span><span class="s2">,</span>
        <span class="s3">'recarray'</span><span class="s2">, </span><span class="s3">'reciprocal'</span><span class="s2">, </span><span class="s3">'reduce'</span><span class="s2">, </span><span class="s3">'remainder'</span><span class="s2">, </span><span class="s3">'repeat'</span><span class="s2">, </span><span class="s3">'require'</span><span class="s2">,</span>
        <span class="s3">'reshape'</span><span class="s2">, </span><span class="s3">'resize'</span><span class="s2">, </span><span class="s3">'restoredot'</span><span class="s2">, </span><span class="s3">'right_shift'</span><span class="s2">, </span><span class="s3">'rint'</span><span class="s2">, </span><span class="s3">'roll'</span><span class="s2">,</span>
        <span class="s3">'rollaxis'</span><span class="s2">, </span><span class="s3">'roots'</span><span class="s2">, </span><span class="s3">'rot90'</span><span class="s2">, </span><span class="s3">'round'</span><span class="s2">, </span><span class="s3">'round_'</span><span class="s2">, </span><span class="s3">'row_stack'</span><span class="s2">, </span><span class="s3">'s_'</span><span class="s2">,</span>
        <span class="s3">'sample'</span><span class="s2">, </span><span class="s3">'savetxt'</span><span class="s2">, </span><span class="s3">'sctype2char'</span><span class="s2">, </span><span class="s3">'searchsorted'</span><span class="s2">, </span><span class="s3">'seed'</span><span class="s2">, </span><span class="s3">'select'</span><span class="s2">,</span>
        <span class="s3">'set_numeric_ops'</span><span class="s2">, </span><span class="s3">'set_printoptions'</span><span class="s2">, </span><span class="s3">'set_string_function'</span><span class="s2">,</span>
        <span class="s3">'setbufsize'</span><span class="s2">, </span><span class="s3">'setdiff1d'</span><span class="s2">, </span><span class="s3">'seterr'</span><span class="s2">, </span><span class="s3">'seterrcall'</span><span class="s2">, </span><span class="s3">'seterrobj'</span><span class="s2">,</span>
        <span class="s3">'setfield'</span><span class="s2">, </span><span class="s3">'setflags'</span><span class="s2">, </span><span class="s3">'setmember1d'</span><span class="s2">, </span><span class="s3">'setxor1d'</span><span class="s2">, </span><span class="s3">'shape'</span><span class="s2">,</span>
        <span class="s3">'show_config'</span><span class="s2">, </span><span class="s3">'shuffle'</span><span class="s2">, </span><span class="s3">'sign'</span><span class="s2">, </span><span class="s3">'signbit'</span><span class="s2">, </span><span class="s3">'sin'</span><span class="s2">, </span><span class="s3">'sinc'</span><span class="s2">, </span><span class="s3">'sinh'</span><span class="s2">,</span>
        <span class="s3">'size'</span><span class="s2">, </span><span class="s3">'slice'</span><span class="s2">, </span><span class="s3">'solve'</span><span class="s2">, </span><span class="s3">'sometrue'</span><span class="s2">, </span><span class="s3">'sort'</span><span class="s2">, </span><span class="s3">'sort_complex'</span><span class="s2">, </span><span class="s3">'source'</span><span class="s2">,</span>
        <span class="s3">'split'</span><span class="s2">, </span><span class="s3">'sqrt'</span><span class="s2">, </span><span class="s3">'square'</span><span class="s2">, </span><span class="s3">'squeeze'</span><span class="s2">, </span><span class="s3">'standard_normal'</span><span class="s2">, </span><span class="s3">'std'</span><span class="s2">,</span>
        <span class="s3">'subtract'</span><span class="s2">, </span><span class="s3">'sum'</span><span class="s2">, </span><span class="s3">'svd'</span><span class="s2">, </span><span class="s3">'swapaxes'</span><span class="s2">, </span><span class="s3">'take'</span><span class="s2">, </span><span class="s3">'tan'</span><span class="s2">, </span><span class="s3">'tanh'</span><span class="s2">, </span><span class="s3">'tensordot'</span><span class="s2">,</span>
        <span class="s3">'test'</span><span class="s2">, </span><span class="s3">'tile'</span><span class="s2">, </span><span class="s3">'tofile'</span><span class="s2">, </span><span class="s3">'tolist'</span><span class="s2">, </span><span class="s3">'tostring'</span><span class="s2">, </span><span class="s3">'trace'</span><span class="s2">, </span><span class="s3">'transpose'</span><span class="s2">,</span>
        <span class="s3">'trapz'</span><span class="s2">, </span><span class="s3">'tri'</span><span class="s2">, </span><span class="s3">'tril'</span><span class="s2">, </span><span class="s3">'trim_zeros'</span><span class="s2">, </span><span class="s3">'triu'</span><span class="s2">, </span><span class="s3">'true_divide'</span><span class="s2">, </span><span class="s3">'typeDict'</span><span class="s2">,</span>
        <span class="s3">'typename'</span><span class="s2">, </span><span class="s3">'uniform'</span><span class="s2">, </span><span class="s3">'union1d'</span><span class="s2">, </span><span class="s3">'unique'</span><span class="s2">, </span><span class="s3">'unique1d'</span><span class="s2">, </span><span class="s3">'unravel_index'</span><span class="s2">,</span>
        <span class="s3">'unwrap'</span><span class="s2">, </span><span class="s3">'vander'</span><span class="s2">, </span><span class="s3">'var'</span><span class="s2">, </span><span class="s3">'vdot'</span><span class="s2">, </span><span class="s3">'vectorize'</span><span class="s2">, </span><span class="s3">'view'</span><span class="s2">, </span><span class="s3">'vonmises'</span><span class="s2">,</span>
        <span class="s3">'vsplit'</span><span class="s2">, </span><span class="s3">'vstack'</span><span class="s2">, </span><span class="s3">'weibull'</span><span class="s2">, </span><span class="s3">'where'</span><span class="s2">, </span><span class="s3">'who'</span><span class="s2">, </span><span class="s3">'zeros'</span><span class="s2">, </span><span class="s3">'zeros_like'</span>
    <span class="s1">}</span>

    <span class="s2">def </span><span class="s1">get_tokens_unprocessed(self</span><span class="s2">, </span><span class="s1">text):</span>
        <span class="s2">for </span><span class="s1">index</span><span class="s2">, </span><span class="s1">token</span><span class="s2">, </span><span class="s1">value </span><span class="s2">in </span><span class="s1">\</span>
                <span class="s1">PythonLexer.get_tokens_unprocessed(self</span><span class="s2">, </span><span class="s1">text):</span>
            <span class="s2">if </span><span class="s1">token </span><span class="s2">is </span><span class="s1">Name </span><span class="s2">and </span><span class="s1">value </span><span class="s2">in </span><span class="s1">self.EXTRA_KEYWORDS:</span>
                <span class="s2">yield </span><span class="s1">index</span><span class="s2">, </span><span class="s1">Keyword.Pseudo</span><span class="s2">, </span><span class="s1">value</span>
            <span class="s2">else</span><span class="s1">:</span>
                <span class="s2">yield </span><span class="s1">index</span><span class="s2">, </span><span class="s1">token</span><span class="s2">, </span><span class="s1">value</span>

    <span class="s2">def </span><span class="s1">analyse_text(text):</span>
        <span class="s1">ltext = text[:</span><span class="s5">1000</span><span class="s1">]</span>
        <span class="s2">return </span><span class="s1">(shebang_matches(text</span><span class="s2">, </span><span class="s3">r'pythonw?(3(\.\d)?)?'</span><span class="s1">) </span><span class="s2">or</span>
                <span class="s3">'import ' </span><span class="s2">in </span><span class="s1">ltext) \</span>
            <span class="s2">and </span><span class="s1">(</span><span class="s3">'import numpy' </span><span class="s2">in </span><span class="s1">ltext </span><span class="s2">or </span><span class="s3">'from numpy import' </span><span class="s2">in </span><span class="s1">ltext)</span>
</pre>
</body>
</html>