<html>
<head>
<title>test_finalize.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #808080;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_finalize.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
An exhaustive list of pandas methods exercising NDFrame.__finalize__. 
&quot;&quot;&quot;</span>
<span class="s2">import </span><span class="s1">operator</span>
<span class="s2">import </span><span class="s1">re</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>

<span class="s3"># TODO:</span>
<span class="s3"># * Binary methods (mul, div, etc.)</span>
<span class="s3"># * Binary outputs (align, etc.)</span>
<span class="s3"># * top-level methods (concat, merge, get_dummies, etc.)</span>
<span class="s3"># * window</span>
<span class="s3"># * cumulative reductions</span>

<span class="s1">not_implemented_mark = pytest.mark.xfail(reason=</span><span class="s4">&quot;not implemented&quot;</span><span class="s1">)</span>

<span class="s1">mi = pd.MultiIndex.from_product([[</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]]</span><span class="s2">, </span><span class="s1">names=[</span><span class="s4">&quot;A&quot;</span><span class="s2">, </span><span class="s4">&quot;B&quot;</span><span class="s1">])</span>

<span class="s1">frame_data = ({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}</span><span class="s2">,</span><span class="s1">)</span>
<span class="s1">frame_mi_data = ({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">mi)</span>


<span class="s3"># Tuple of</span>
<span class="s3"># - Callable: Constructor (Series, DataFrame)</span>
<span class="s3"># - Tuple: Constructor args</span>
<span class="s3"># - Callable: pass the constructed value with attrs set to this.</span>

<span class="s1">_all_methods = [</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">(np.array([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=</span><span class="s4">&quot;float64&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;view&quot;</span><span class="s2">, </span><span class="s4">&quot;int64&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;take&quot;</span><span class="s2">, </span><span class="s1">[]))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;__getitem__&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">True</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;repeat&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;reset_index&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=pytest.mark.xfail</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;reset_index&quot;</span><span class="s2">, </span><span class="s1">drop=</span><span class="s2">True</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;to_frame&quot;</span><span class="s1">))</span><span class="s2">, </span><span class="s1">marks=pytest.mark.xfail</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;drop_duplicates&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;duplicated&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;round&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;rename&quot;</span><span class="s2">, lambda </span><span class="s1">x: x + </span><span class="s5">1</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;rename&quot;</span><span class="s2">, </span><span class="s4">&quot;name&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;set_axis&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;reindex&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;drop&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">(pd.array([</span><span class="s5">0</span><span class="s2">, </span><span class="s1">pd.NA])</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;fillna&quot;</span><span class="s2">, </span><span class="s5">0</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;replace&quot;</span><span class="s2">, </span><span class="s1">{</span><span class="s5">0</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;shift&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;isin&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;between&quot;</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;isna&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;isnull&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;notna&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;notnull&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;add&quot;</span><span class="s2">, </span><span class="s1">pd.Series([</span><span class="s5">1</span><span class="s1">])))</span><span class="s2">,</span>
    <span class="s3"># TODO: mul, div, etc.</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">pd.period_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">1</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;to_timestamp&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">1</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;to_period&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;dot&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame(index=[</span><span class="s4">&quot;A&quot;</span><span class="s1">]))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=pytest.mark.xfail(reason=</span><span class="s4">&quot;Implement binary finalize&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;transpose&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;__getitem__&quot;</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;__getitem__&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;A&quot;</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;__getitem__&quot;</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s2">True</span><span class="s1">])))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">({(</span><span class="s4">&quot;A&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">): [</span><span class="s5">1</span><span class="s1">]}</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;__getitem__&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;A&quot;</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;query&quot;</span><span class="s2">, </span><span class="s4">&quot;A == 1&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;eval&quot;</span><span class="s2">, </span><span class="s4">&quot;A + 1&quot;</span><span class="s2">, </span><span class="s1">engine=</span><span class="s4">&quot;python&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;select_dtypes&quot;</span><span class="s2">, </span><span class="s1">include=</span><span class="s4">&quot;int&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;assign&quot;</span><span class="s2">, </span><span class="s1">b=</span><span class="s5">1</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;set_axis&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;A&quot;</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;reindex&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;drop&quot;</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s4">&quot;A&quot;</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;drop&quot;</span><span class="s2">, </span><span class="s1">index=[</span><span class="s5">0</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;rename&quot;</span><span class="s2">, </span><span class="s1">columns={</span><span class="s4">&quot;A&quot;</span><span class="s1">: </span><span class="s4">&quot;a&quot;</span><span class="s1">}))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;rename&quot;</span><span class="s2">, </span><span class="s1">index=</span><span class="s2">lambda </span><span class="s1">x: x))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;fillna&quot;</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;fillna&quot;</span><span class="s2">, </span><span class="s1">method=</span><span class="s4">&quot;ffill&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;set_index&quot;</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;reset_index&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;isna&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;isnull&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;notna&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;notnull&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;dropna&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;drop_duplicates&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;duplicated&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;sort_values&quot;</span><span class="s2">, </span><span class="s1">by=</span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;sort_index&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;nlargest&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;nsmallest&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_mi_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;swaplevel&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;add&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame(*frame_data))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3"># TODO: div, mul, etc.</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;combine&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame(*frame_data)</span><span class="s2">, </span><span class="s1">operator.add)</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;combine_first&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame(*frame_data))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;update&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame(*frame_data))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;pivot&quot;</span><span class="s2">, </span><span class="s1">columns=</span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s4">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}</span><span class="s2">,</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;pivot_table&quot;</span><span class="s2">, </span><span class="s1">columns=</span><span class="s4">&quot;A&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s4">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}</span><span class="s2">,</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;pivot_table&quot;</span><span class="s2">, </span><span class="s1">columns=</span><span class="s4">&quot;A&quot;</span><span class="s2">, </span><span class="s1">aggfunc=[</span><span class="s4">&quot;mean&quot;</span><span class="s2">, </span><span class="s4">&quot;sum&quot;</span><span class="s1">])</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;stack&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;explode&quot;</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_mi_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;unstack&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s2">, </span><span class="s4">&quot;c&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s4">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">5</span><span class="s1">]</span><span class="s2">, </span><span class="s4">&quot;C&quot;</span><span class="s1">: [</span><span class="s5">2</span><span class="s2">, </span><span class="s5">4</span><span class="s2">, </span><span class="s5">6</span><span class="s1">]}</span><span class="s2">,</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;melt&quot;</span><span class="s2">, </span><span class="s1">id_vars=[</span><span class="s4">&quot;A&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">value_vars=[</span><span class="s4">&quot;B&quot;</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;applymap&quot;</span><span class="s2">, lambda </span><span class="s1">x: x))</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;append&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=pytest.mark.filterwarnings(</span>
            <span class="s4">&quot;ignore:.*append method is deprecated.*:FutureWarning&quot;</span>
        <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;append&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=pytest.mark.filterwarnings(</span>
            <span class="s4">&quot;ignore:.*append method is deprecated.*:FutureWarning&quot;</span>
        <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;merge&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;round&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;corr&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;cov&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=[</span>
            <span class="s1">not_implemented_mark</span><span class="s2">,</span>
            <span class="s1">pytest.mark.filterwarnings(</span><span class="s4">&quot;ignore::RuntimeWarning&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;corrwith&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame(*frame_data))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;count&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_mi_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;count&quot;</span><span class="s2">, </span><span class="s1">level=</span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=[</span>
            <span class="s1">not_implemented_mark</span><span class="s2">,</span>
            <span class="s1">pytest.mark.filterwarnings(</span><span class="s4">&quot;ignore:Using the level keyword:FutureWarning&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;nunique&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;idxmin&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;idxmax&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;mode&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;mode&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;quantile&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;quantile&quot;</span><span class="s2">, </span><span class="s1">q=[</span><span class="s5">0.25</span><span class="s2">, </span><span class="s5">0.75</span><span class="s1">]))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;quantile&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">[pd.Period(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s4">&quot;D&quot;</span><span class="s1">)])</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;to_timestamp&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">[pd.Timestamp(</span><span class="s4">&quot;2000&quot;</span><span class="s1">)])</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;to_period&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s4">&quot;D&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_mi_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;isin&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s1">]))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_mi_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;isin&quot;</span><span class="s2">, </span><span class="s1">pd.Series([</span><span class="s5">1</span><span class="s1">])))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_mi_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;isin&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}))</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;swapaxes&quot;</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_mi_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;droplevel&quot;</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;pop&quot;</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;squeeze&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;squeeze&quot;</span><span class="s1">))</span>
        <span class="s3"># marks=not_implemented_mark,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;rename_axis&quot;</span><span class="s2">, </span><span class="s1">index=</span><span class="s4">&quot;a&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;rename_axis&quot;</span><span class="s2">, </span><span class="s1">columns=</span><span class="s4">&quot;a&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s3"># Unary ops</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.neg)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">operator.neg)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.pos)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">operator.pos)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.inv)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">operator.inv)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">abs)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">abs)</span><span class="s2">,</span>
    <span class="s1">pytest.param((pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">round)</span><span class="s2">, </span><span class="s1">marks=not_implemented_mark)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">round)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;take&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_mi_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;xs&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">mi)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;xs&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;get&quot;</span><span class="s2">, </span><span class="s4">&quot;A&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">frame_data</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;reindex_like&quot;</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]}))</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">frame_data</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;reindex_like&quot;</span><span class="s2">, </span><span class="s1">pd.Series([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;add_prefix&quot;</span><span class="s2">, </span><span class="s4">&quot;_&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;add_suffix&quot;</span><span class="s2">, </span><span class="s4">&quot;_&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s1">])</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;add_prefix&quot;</span><span class="s2">, </span><span class="s4">&quot;_&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s1">])</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;add_suffix&quot;</span><span class="s2">, </span><span class="s4">&quot;_&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">3</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;sort_values&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s1">] * </span><span class="s5">10</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;head&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">] * </span><span class="s5">10</span><span class="s1">}</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;head&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s1">] * </span><span class="s5">10</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;tail&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">] * </span><span class="s5">10</span><span class="s1">}</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;tail&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;sample&quot;</span><span class="s2">, </span><span class="s1">n=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">replace=</span><span class="s2">True</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">(frame_data</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;sample&quot;</span><span class="s2">, </span><span class="s1">n=</span><span class="s5">2</span><span class="s2">, </span><span class="s1">replace=</span><span class="s2">True</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;astype&quot;</span><span class="s2">, </span><span class="s1">float))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;astype&quot;</span><span class="s2">, </span><span class="s1">float))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;copy&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;copy&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, None, </span><span class="s1">object)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;infer_objects&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: np.array([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=object)}</span><span class="s2">,</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;infer_objects&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;convert_dtypes&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;convert_dtypes&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, None, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;interpolate&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, None, </span><span class="s5">3</span><span class="s1">]}</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;interpolate&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;clip&quot;</span><span class="s2">, </span><span class="s1">lower=</span><span class="s5">1</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;clip&quot;</span><span class="s2">, </span><span class="s1">lower=</span><span class="s5">1</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;asfreq&quot;</span><span class="s2">, </span><span class="s4">&quot;H&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;asfreq&quot;</span><span class="s2">, </span><span class="s4">&quot;H&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;at_time&quot;</span><span class="s2">, </span><span class="s4">&quot;12:00&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;at_time&quot;</span><span class="s2">, </span><span class="s4">&quot;12:00&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;between_time&quot;</span><span class="s2">, </span><span class="s4">&quot;12:00&quot;</span><span class="s2">, </span><span class="s4">&quot;13:00&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;between_time&quot;</span><span class="s2">, </span><span class="s4">&quot;12:00&quot;</span><span class="s2">, </span><span class="s4">&quot;13:00&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;first&quot;</span><span class="s2">, </span><span class="s4">&quot;3D&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;first&quot;</span><span class="s2">, </span><span class="s4">&quot;3D&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;last&quot;</span><span class="s2">, </span><span class="s4">&quot;3D&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;last&quot;</span><span class="s2">, </span><span class="s4">&quot;3D&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;rank&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;rank&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;where&quot;</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s2">True, False</span><span class="s1">])))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;where&quot;</span><span class="s2">, </span><span class="s1">np.array([[</span><span class="s2">True</span><span class="s1">]])))</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;mask&quot;</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s2">True, False</span><span class="s1">])))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;mask&quot;</span><span class="s2">, </span><span class="s1">np.array([[</span><span class="s2">True</span><span class="s1">]])))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.Series</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;tshift&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=pytest.mark.filterwarnings(</span><span class="s4">&quot;ignore::FutureWarning&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;tshift&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">marks=pytest.mark.filterwarnings(</span><span class="s4">&quot;ignore::FutureWarning&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;truncate&quot;</span><span class="s2">, </span><span class="s1">before=</span><span class="s5">0</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;truncate&quot;</span><span class="s2">, </span><span class="s1">before=</span><span class="s5">0</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">tz=</span><span class="s4">&quot;UTC&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;tz_convert&quot;</span><span class="s2">, </span><span class="s4">&quot;CET&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s2">, </span><span class="s1">tz=</span><span class="s4">&quot;UTC&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;tz_convert&quot;</span><span class="s2">, </span><span class="s4">&quot;CET&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.Series</span><span class="s2">,</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;tz_localize&quot;</span><span class="s2">, </span><span class="s4">&quot;CET&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(</span>
        <span class="s1">pd.DataFrame</span><span class="s2">,</span>
        <span class="s1">({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;tz_localize&quot;</span><span class="s2">, </span><span class="s4">&quot;CET&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;describe&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;describe&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;pct_change&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;pct_change&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;transform&quot;</span><span class="s2">, lambda </span><span class="s1">x: x - x.min()))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(</span>
            <span class="s1">pd.DataFrame</span><span class="s2">,</span>
            <span class="s1">frame_mi_data</span><span class="s2">,</span>
            <span class="s1">operator.methodcaller(</span><span class="s4">&quot;transform&quot;</span><span class="s2">, lambda </span><span class="s1">x: x - x.min())</span><span class="s2">,</span>
        <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;apply&quot;</span><span class="s2">, lambda </span><span class="s1">x: x))</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_mi_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;apply&quot;</span><span class="s2">, lambda </span><span class="s1">x: x))</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3"># Cumulative reductions</span>
    <span class="s1">(pd.Series</span><span class="s2">, </span><span class="s1">([</span><span class="s5">1</span><span class="s1">]</span><span class="s2">,</span><span class="s1">)</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;cumsum&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;cumsum&quot;</span><span class="s1">))</span><span class="s2">,</span>
    <span class="s3"># Reductions</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;any&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;sum&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;std&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s1">pytest.param(</span>
        <span class="s1">(pd.DataFrame</span><span class="s2">, </span><span class="s1">frame_data</span><span class="s2">, </span><span class="s1">operator.methodcaller(</span><span class="s4">&quot;mean&quot;</span><span class="s1">))</span><span class="s2">,</span>
        <span class="s1">marks=not_implemented_mark</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
<span class="s1">]</span>


<span class="s2">def </span><span class="s1">idfn(x):</span>
    <span class="s1">xpr = re.compile(</span><span class="s4">r&quot;'(.*)?'&quot;</span><span class="s1">)</span>
    <span class="s1">m = xpr.search(str(x))</span>
    <span class="s2">if </span><span class="s1">m:</span>
        <span class="s2">return </span><span class="s1">m.group(</span><span class="s5">1</span><span class="s1">)</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s2">return </span><span class="s1">str(x)</span>


<span class="s1">@pytest.fixture(params=_all_methods</span><span class="s2">, </span><span class="s1">ids=</span><span class="s2">lambda </span><span class="s1">x: idfn(x[-</span><span class="s5">1</span><span class="s1">]))</span>
<span class="s2">def </span><span class="s1">ndframe_method(request):</span>
    <span class="s0">&quot;&quot;&quot; 
    An NDFrame method returning an NDFrame. 
    &quot;&quot;&quot;</span>
    <span class="s2">return </span><span class="s1">request.param</span>


<span class="s2">def </span><span class="s1">test_finalize_called(ndframe_method):</span>
    <span class="s1">cls</span><span class="s2">, </span><span class="s1">init_args</span><span class="s2">, </span><span class="s1">method = ndframe_method</span>
    <span class="s1">ndframe = cls(*init_args)</span>

    <span class="s1">ndframe.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = method(ndframe)</span>

    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s1">@not_implemented_mark</span>
<span class="s2">def </span><span class="s1">test_finalize_called_eval_numexpr():</span>
    <span class="s1">pytest.importorskip(</span><span class="s4">&quot;numexpr&quot;</span><span class="s1">)</span>
    <span class="s1">df = pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]})</span>
    <span class="s1">df.attrs[</span><span class="s4">&quot;A&quot;</span><span class="s1">] = </span><span class="s5">1</span>
    <span class="s1">result = df.eval(</span><span class="s4">&quot;A + 1&quot;</span><span class="s2">, </span><span class="s1">engine=</span><span class="s4">&quot;numexpr&quot;</span><span class="s1">)</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;A&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s3"># ----------------------------------------------------------------------------</span>
<span class="s3"># Binary operations</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;annotate&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;left&quot;</span><span class="s2">, </span><span class="s4">&quot;right&quot;</span><span class="s2">, </span><span class="s4">&quot;both&quot;</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;args&quot;</span><span class="s2">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.Series([</span><span class="s5">1</span><span class="s1">]))</span><span class="s2">,</span>
        <span class="s1">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}))</span><span class="s2">,</span>
        <span class="s1">(pd.Series([</span><span class="s5">1</span><span class="s1">])</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">(pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]})</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">(pd.Series([</span><span class="s5">1</span><span class="s1">])</span><span class="s2">, </span><span class="s1">pd.Series([</span><span class="s5">1</span><span class="s1">]))</span><span class="s2">,</span>
        <span class="s1">(pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]})</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}))</span><span class="s2">,</span>
        <span class="s1">(pd.Series([</span><span class="s5">1</span><span class="s1">])</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]}))</span><span class="s2">,</span>
        <span class="s1">(pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s1">]})</span><span class="s2">, </span><span class="s1">pd.Series([</span><span class="s5">1</span><span class="s1">]))</span><span class="s2">,</span>
    <span class="s1">]</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">def </span><span class="s1">test_binops(request</span><span class="s2">, </span><span class="s1">args</span><span class="s2">, </span><span class="s1">annotate</span><span class="s2">, </span><span class="s1">all_arithmetic_functions):</span>
    <span class="s3"># This generates 326 tests... Is that needed?</span>
    <span class="s1">left</span><span class="s2">, </span><span class="s1">right = args</span>
    <span class="s2">if </span><span class="s1">annotate == </span><span class="s4">&quot;both&quot; </span><span class="s2">and </span><span class="s1">isinstance(left</span><span class="s2">, </span><span class="s1">int) </span><span class="s2">or </span><span class="s1">isinstance(right</span><span class="s2">, </span><span class="s1">int):</span>
        <span class="s2">return</span>

    <span class="s2">if </span><span class="s1">isinstance(left</span><span class="s2">, </span><span class="s1">pd.DataFrame) </span><span class="s2">or </span><span class="s1">isinstance(right</span><span class="s2">, </span><span class="s1">pd.DataFrame):</span>
        <span class="s1">request.node.add_marker(pytest.mark.xfail(reason=</span><span class="s4">&quot;not implemented&quot;</span><span class="s1">))</span>

    <span class="s2">if </span><span class="s1">annotate </span><span class="s2">in </span><span class="s1">{</span><span class="s4">&quot;left&quot;</span><span class="s2">, </span><span class="s4">&quot;both&quot;</span><span class="s1">} </span><span class="s2">and not </span><span class="s1">isinstance(left</span><span class="s2">, </span><span class="s1">int):</span>
        <span class="s1">left.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s2">if </span><span class="s1">annotate </span><span class="s2">in </span><span class="s1">{</span><span class="s4">&quot;left&quot;</span><span class="s2">, </span><span class="s4">&quot;both&quot;</span><span class="s1">} </span><span class="s2">and not </span><span class="s1">isinstance(right</span><span class="s2">, </span><span class="s1">int):</span>
        <span class="s1">right.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>

    <span class="s1">result = all_arithmetic_functions(left</span><span class="s2">, </span><span class="s1">right)</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s3"># ----------------------------------------------------------------------------</span>
<span class="s3"># Accessors</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;method&quot;</span><span class="s2">,</span>
    <span class="s1">[</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;capitalize&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;casefold&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;cat&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;a&quot;</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;contains&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;count&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;encode&quot;</span><span class="s2">, </span><span class="s4">&quot;utf-8&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;endswith&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;extract&quot;</span><span class="s2">, </span><span class="s4">r&quot;(\w)(\d)&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;extract&quot;</span><span class="s2">, </span><span class="s4">r&quot;(\w)(\d)&quot;</span><span class="s2">, </span><span class="s1">expand=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;find&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;findall&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;get&quot;</span><span class="s2">, </span><span class="s5">0</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;index&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;len&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;ljust&quot;</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;lower&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;lstrip&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;match&quot;</span><span class="s2">, </span><span class="s4">r&quot;\w&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;normalize&quot;</span><span class="s2">, </span><span class="s4">&quot;NFC&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;pad&quot;</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;partition&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;repeat&quot;</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;replace&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;rfind&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;rindex&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;rjust&quot;</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;rpartition&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;rstrip&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;slice&quot;</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;slice_replace&quot;</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">repl=</span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;startswith&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;strip&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;swapcase&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;translate&quot;</span><span class="s2">, </span><span class="s1">{</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s4">&quot;b&quot;</span><span class="s1">})</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;upper&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;wrap&quot;</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;zfill&quot;</span><span class="s2">, </span><span class="s5">4</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;isalnum&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;isalpha&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;isdigit&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;isspace&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;islower&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;isupper&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;istitle&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;isnumeric&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;isdecimal&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;get_dummies&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">ids=idfn</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">def </span><span class="s1">test_string_method(method):</span>
    <span class="s1">s = pd.Series([</span><span class="s4">&quot;a1&quot;</span><span class="s1">])</span>
    <span class="s1">s.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = method(s.str)</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;method&quot;</span><span class="s2">,</span>
    <span class="s1">[</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;to_period&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;tz_localize&quot;</span><span class="s2">, </span><span class="s4">&quot;CET&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;normalize&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;strftime&quot;</span><span class="s2">, </span><span class="s4">&quot;%Y&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;round&quot;</span><span class="s2">, </span><span class="s4">&quot;H&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;floor&quot;</span><span class="s2">, </span><span class="s4">&quot;H&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;ceil&quot;</span><span class="s2">, </span><span class="s4">&quot;H&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;month_name&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;day_name&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">ids=idfn</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">def </span><span class="s1">test_datetime_method(method):</span>
    <span class="s1">s = pd.Series(pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span>
    <span class="s1">s.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = method(s.dt)</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;attr&quot;</span><span class="s2">,</span>
    <span class="s1">[</span>
        <span class="s4">&quot;date&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;time&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;timetz&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;year&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;month&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;day&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;hour&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;minute&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;second&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;microsecond&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;nanosecond&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;dayofweek&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;day_of_week&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;dayofyear&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;day_of_year&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;quarter&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;is_month_start&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;is_month_end&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;is_quarter_start&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;is_quarter_end&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;is_year_start&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;is_year_end&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;is_leap_year&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;daysinmonth&quot;</span><span class="s2">,</span>
        <span class="s4">&quot;days_in_month&quot;</span><span class="s2">,</span>
    <span class="s1">]</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">def </span><span class="s1">test_datetime_property(attr):</span>
    <span class="s1">s = pd.Series(pd.date_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span>
    <span class="s1">s.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = getattr(s.dt</span><span class="s2">, </span><span class="s1">attr)</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;attr&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;days&quot;</span><span class="s2">, </span><span class="s4">&quot;seconds&quot;</span><span class="s2">, </span><span class="s4">&quot;microseconds&quot;</span><span class="s2">, </span><span class="s4">&quot;nanoseconds&quot;</span><span class="s2">, </span><span class="s4">&quot;components&quot;</span><span class="s1">]</span>
<span class="s1">)</span>
<span class="s2">def </span><span class="s1">test_timedelta_property(attr):</span>
    <span class="s1">s = pd.Series(pd.timedelta_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span>
    <span class="s1">s.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = getattr(s.dt</span><span class="s2">, </span><span class="s1">attr)</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;method&quot;</span><span class="s2">, </span><span class="s1">[operator.methodcaller(</span><span class="s4">&quot;total_seconds&quot;</span><span class="s1">)])</span>
<span class="s2">def </span><span class="s1">test_timedelta_methods(method):</span>
    <span class="s1">s = pd.Series(pd.timedelta_range(</span><span class="s4">&quot;2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s5">4</span><span class="s1">))</span>
    <span class="s1">s.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = method(s.dt)</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;method&quot;</span><span class="s2">,</span>
    <span class="s1">[</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;add_categories&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;c&quot;</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;as_ordered&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;as_unordered&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: getattr(x</span><span class="s2">, </span><span class="s4">&quot;codes&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;remove_categories&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;remove_unused_categories&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;rename_categories&quot;</span><span class="s2">, </span><span class="s1">{</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s4">&quot;A&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s1">: </span><span class="s4">&quot;B&quot;</span><span class="s1">})</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;reorder_categories&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;b&quot;</span><span class="s2">, </span><span class="s4">&quot;a&quot;</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;set_categories&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s4">&quot;A&quot;</span><span class="s2">, </span><span class="s4">&quot;B&quot;</span><span class="s1">])</span><span class="s2">,</span>
    <span class="s1">]</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s1">@not_implemented_mark</span>
<span class="s2">def </span><span class="s1">test_categorical_accessor(method):</span>
    <span class="s1">s = pd.Series([</span><span class="s4">&quot;a&quot;</span><span class="s2">, </span><span class="s4">&quot;b&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">dtype=</span><span class="s4">&quot;category&quot;</span><span class="s1">)</span>
    <span class="s1">s.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = method(s.cat)</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s3"># ----------------------------------------------------------------------------</span>
<span class="s3"># Groupby</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;obj&quot;</span><span class="s2">, </span><span class="s1">[pd.Series([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s4">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]})]</span>
<span class="s1">)</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;method&quot;</span><span class="s2">,</span>
    <span class="s1">[</span>
        <span class="s1">operator.methodcaller(</span><span class="s4">&quot;sum&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.apply(</span><span class="s2">lambda </span><span class="s1">y: y)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;sum&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;mean&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;median&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">]</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">def </span><span class="s1">test_groupby_finalize(obj</span><span class="s2">, </span><span class="s1">method):</span>
    <span class="s1">obj.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = method(obj.groupby([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;obj&quot;</span><span class="s2">, </span><span class="s1">[pd.Series([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">])</span><span class="s2">, </span><span class="s1">pd.DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: [</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s4">&quot;B&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]})]</span>
<span class="s1">)</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;method&quot;</span><span class="s2">,</span>
    <span class="s1">[</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg([</span><span class="s4">&quot;sum&quot;</span><span class="s2">, </span><span class="s4">&quot;count&quot;</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;std&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;var&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;sem&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;size&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;ohlc&quot;</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s2">lambda </span><span class="s1">x: x.agg(</span><span class="s4">&quot;describe&quot;</span><span class="s1">)</span><span class="s2">,</span>
    <span class="s1">]</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s1">@not_implemented_mark</span>
<span class="s2">def </span><span class="s1">test_groupby_finalize_not_implemented(obj</span><span class="s2">, </span><span class="s1">method):</span>
    <span class="s1">obj.attrs = {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>
    <span class="s1">result = method(obj.groupby([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s2">assert </span><span class="s1">result.attrs == {</span><span class="s4">&quot;a&quot;</span><span class="s1">: </span><span class="s5">1</span><span class="s1">}</span>


<span class="s2">def </span><span class="s1">test_finalize_frame_series_name():</span>
    <span class="s3"># https://github.com/pandas-dev/pandas/pull/37186/files#r506978889</span>
    <span class="s3"># ensure we don't copy the column `name` to the Series.</span>
    <span class="s1">df = pd.DataFrame({</span><span class="s4">&quot;name&quot;</span><span class="s1">: [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]})</span>
    <span class="s1">result = pd.Series([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]).__finalize__(df)</span>
    <span class="s2">assert </span><span class="s1">result.name </span><span class="s2">is None</span>
</pre>
</body>
</html>