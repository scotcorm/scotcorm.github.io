<html>
<head>
<title>test_case_justify.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_case_justify.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">datetime</span>
<span class="s0">import </span><span class="s1">operator</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">Series</span><span class="s0">,</span>
    <span class="s1">_testing </span><span class="s0">as </span><span class="s1">tm</span><span class="s0">,</span>
<span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_title(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;FOO&quot;</span><span class="s0">, </span><span class="s2">&quot;BAR&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Blah&quot;</span><span class="s0">, </span><span class="s2">&quot;blurg&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = s.str.title()</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;Foo&quot;</span><span class="s0">, </span><span class="s2">&quot;Bar&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Blah&quot;</span><span class="s0">, </span><span class="s2">&quot;Blurg&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_title_mixed_object():</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;FOO&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;blah&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>
    <span class="s1">result = s.str.title()</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;Foo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Bar&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Blah&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_almost_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_lower_upper(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;om&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;nom&quot;</span><span class="s0">, </span><span class="s2">&quot;nom&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = s.str.upper()</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;OM&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;NOM&quot;</span><span class="s0">, </span><span class="s2">&quot;NOM&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = result.str.lower()</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">s)</span>


<span class="s0">def </span><span class="s1">test_lower_upper_mixed_object():</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>

    <span class="s1">result = s.str.upper()</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;FOO&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.lower()</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan])</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;data, expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span>
            <span class="s1">[</span><span class="s2">&quot;FOO&quot;</span><span class="s0">, </span><span class="s2">&quot;BAR&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Blah&quot;</span><span class="s0">, </span><span class="s2">&quot;blurg&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s2">&quot;Foo&quot;</span><span class="s0">, </span><span class="s2">&quot;Bar&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Blah&quot;</span><span class="s0">, </span><span class="s2">&quot;Blurg&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">([</span><span class="s2">&quot;a b&quot;</span><span class="s0">, </span><span class="s2">&quot;a bc. de&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;A b&quot;</span><span class="s0">, </span><span class="s2">&quot;A bc. de&quot;</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_capitalize(data</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s1">s = Series(data</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = s.str.capitalize()</span>
    <span class="s1">expected = Series(expected</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_capitalize_mixed_object():</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;FOO&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;blah&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>
    <span class="s1">result = s.str.capitalize()</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;Foo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Bar&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Blah&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_swapcase(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;FOO&quot;</span><span class="s0">, </span><span class="s2">&quot;BAR&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;Blah&quot;</span><span class="s0">, </span><span class="s2">&quot;blurg&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = s.str.swapcase()</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bLAH&quot;</span><span class="s0">, </span><span class="s2">&quot;BLURG&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_swapcase_mixed_object():</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;FOO&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;Blah&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>
    <span class="s1">result = s.str.swapcase()</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;BAR&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;bLAH&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_casefold():</span>
    <span class="s4"># GH25405</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;ss&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;case&quot;</span><span class="s0">, </span><span class="s2">&quot;ssd&quot;</span><span class="s1">])</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;ß&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;case&quot;</span><span class="s0">, </span><span class="s2">&quot;ßd&quot;</span><span class="s1">])</span>
    <span class="s1">result = s.str.casefold()</span>

    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_casemethods(any_string_dtype):</span>
    <span class="s1">values = [</span><span class="s2">&quot;aaa&quot;</span><span class="s0">, </span><span class="s2">&quot;bbb&quot;</span><span class="s0">, </span><span class="s2">&quot;CCC&quot;</span><span class="s0">, </span><span class="s2">&quot;Dddd&quot;</span><span class="s0">, </span><span class="s2">&quot;eEEE&quot;</span><span class="s1">]</span>
    <span class="s1">s = Series(values</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s0">assert </span><span class="s1">s.str.lower().tolist() == [v.lower() </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">values]</span>
    <span class="s0">assert </span><span class="s1">s.str.upper().tolist() == [v.upper() </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">values]</span>
    <span class="s0">assert </span><span class="s1">s.str.title().tolist() == [v.title() </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">values]</span>
    <span class="s0">assert </span><span class="s1">s.str.capitalize().tolist() == [v.capitalize() </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">values]</span>
    <span class="s0">assert </span><span class="s1">s.str.swapcase().tolist() == [v.swapcase() </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">values]</span>


<span class="s0">def </span><span class="s1">test_pad(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;left&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;    a&quot;</span><span class="s0">, </span><span class="s2">&quot;    b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;    c&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;right&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;a    &quot;</span><span class="s0">, </span><span class="s2">&quot;b    &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;c    &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;both&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;  a  &quot;</span><span class="s0">, </span><span class="s2">&quot;  b  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;  c  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_pad_mixed_object():</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;ee&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;left&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;    a&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;    b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;   ee&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;right&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;a    &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;b    &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;ee   &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;both&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;  a  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;  b  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;  ee &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_pad_fillchar(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;left&quot;</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;X&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;XXXXa&quot;</span><span class="s0">, </span><span class="s2">&quot;XXXXb&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;XXXXc&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;right&quot;</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;X&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;aXXXX&quot;</span><span class="s0">, </span><span class="s2">&quot;bXXXX&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;cXXXX&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">side=</span><span class="s2">&quot;both&quot;</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;X&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;XXaXX&quot;</span><span class="s0">, </span><span class="s2">&quot;XXbXX&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;XXcXX&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_pad_fillchar_bad_arg_raises(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">msg = </span><span class="s2">&quot;fillchar must be a character, not str&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;XY&quot;</span><span class="s1">)</span>

    <span class="s1">msg = </span><span class="s2">&quot;fillchar must be a character, not int&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">s.str.pad(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s3">5</span><span class="s1">)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;method_name&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;center&quot;</span><span class="s0">, </span><span class="s2">&quot;ljust&quot;</span><span class="s0">, </span><span class="s2">&quot;rjust&quot;</span><span class="s0">, </span><span class="s2">&quot;zfill&quot;</span><span class="s0">, </span><span class="s2">&quot;pad&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_pad_width_bad_arg_raises(method_name</span><span class="s0">, </span><span class="s1">any_string_dtype):</span>
    <span class="s4"># see gh-13598</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;1&quot;</span><span class="s0">, </span><span class="s2">&quot;22&quot;</span><span class="s0">, </span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;bb&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">op = operator.methodcaller(method_name</span><span class="s0">, </span><span class="s2">&quot;f&quot;</span><span class="s1">)</span>

    <span class="s1">msg = </span><span class="s2">&quot;width must be of integer type, not str&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">op(s.str)</span>


<span class="s0">def </span><span class="s1">test_center_ljust_rjust(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = s.str.center(</span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;  a  &quot;</span><span class="s0">, </span><span class="s2">&quot;  b  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;  c  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.ljust(</span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;a    &quot;</span><span class="s0">, </span><span class="s2">&quot;b    &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;c    &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.rjust(</span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;    a&quot;</span><span class="s0">, </span><span class="s2">&quot;    b&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;    c&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_center_ljust_rjust_mixed_object():</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, True, </span><span class="s1">datetime.today()</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;eee&quot;</span><span class="s0">, None, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2.0</span><span class="s1">])</span>

    <span class="s1">result = s.str.center(</span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span>
            <span class="s2">&quot;  a  &quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s2">&quot;  b  &quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s2">&quot;  c  &quot;</span><span class="s0">,</span>
            <span class="s2">&quot; eee &quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.ljust(</span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span>
            <span class="s2">&quot;a    &quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s2">&quot;b    &quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s2">&quot;c    &quot;</span><span class="s0">,</span>
            <span class="s2">&quot;eee  &quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.rjust(</span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span>
            <span class="s2">&quot;    a&quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s2">&quot;    b&quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s2">&quot;    c&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;  eee&quot;</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_center_ljust_rjust_fillchar(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;bb&quot;</span><span class="s0">, </span><span class="s2">&quot;cccc&quot;</span><span class="s0">, </span><span class="s2">&quot;ddddd&quot;</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = s.str.center(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;X&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;XXaXX&quot;</span><span class="s0">, </span><span class="s2">&quot;XXbbX&quot;</span><span class="s0">, </span><span class="s2">&quot;Xcccc&quot;</span><span class="s0">, </span><span class="s2">&quot;ddddd&quot;</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">expected = np.array([v.center(</span><span class="s3">5</span><span class="s0">, </span><span class="s2">&quot;X&quot;</span><span class="s1">) </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">np.array(s)]</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span>
    <span class="s1">tm.assert_numpy_array_equal(np.array(result</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.ljust(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;X&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;aXXXX&quot;</span><span class="s0">, </span><span class="s2">&quot;bbXXX&quot;</span><span class="s0">, </span><span class="s2">&quot;ccccX&quot;</span><span class="s0">, </span><span class="s2">&quot;ddddd&quot;</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">expected = np.array([v.ljust(</span><span class="s3">5</span><span class="s0">, </span><span class="s2">&quot;X&quot;</span><span class="s1">) </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">np.array(s)]</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span>
    <span class="s1">tm.assert_numpy_array_equal(np.array(result</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.rjust(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;X&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;XXXXa&quot;</span><span class="s0">, </span><span class="s2">&quot;XXXbb&quot;</span><span class="s0">, </span><span class="s2">&quot;Xcccc&quot;</span><span class="s0">, </span><span class="s2">&quot;ddddd&quot;</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">expected = np.array([v.rjust(</span><span class="s3">5</span><span class="s0">, </span><span class="s2">&quot;X&quot;</span><span class="s1">) </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">np.array(s)]</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span>
    <span class="s1">tm.assert_numpy_array_equal(np.array(result</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_center_ljust_rjust_fillchar_bad_arg_raises(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;bb&quot;</span><span class="s0">, </span><span class="s2">&quot;cccc&quot;</span><span class="s0">, </span><span class="s2">&quot;ddddd&quot;</span><span class="s0">, </span><span class="s2">&quot;eeeeee&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s4"># If fillchar is not a character, normal str raises TypeError</span>
    <span class="s4"># 'aaa'.ljust(5, 'XY')</span>
    <span class="s4"># TypeError: must be char, not str</span>
    <span class="s1">template = </span><span class="s2">&quot;fillchar must be a character, not {dtype}&quot;</span>

    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=template.format(dtype=</span><span class="s2">&quot;str&quot;</span><span class="s1">)):</span>
        <span class="s1">s.str.center(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;XY&quot;</span><span class="s1">)</span>

    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=template.format(dtype=</span><span class="s2">&quot;str&quot;</span><span class="s1">)):</span>
        <span class="s1">s.str.ljust(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;XY&quot;</span><span class="s1">)</span>

    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=template.format(dtype=</span><span class="s2">&quot;str&quot;</span><span class="s1">)):</span>
        <span class="s1">s.str.rjust(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s2">&quot;XY&quot;</span><span class="s1">)</span>

    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=template.format(dtype=</span><span class="s2">&quot;int&quot;</span><span class="s1">)):</span>
        <span class="s1">s.str.center(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s3">1</span><span class="s1">)</span>

    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=template.format(dtype=</span><span class="s2">&quot;int&quot;</span><span class="s1">)):</span>
        <span class="s1">s.str.ljust(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s3">1</span><span class="s1">)</span>

    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=template.format(dtype=</span><span class="s2">&quot;int&quot;</span><span class="s1">)):</span>
        <span class="s1">s.str.rjust(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">fillchar=</span><span class="s3">1</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_zfill(any_string_dtype):</span>
    <span class="s1">s = Series([</span><span class="s2">&quot;1&quot;</span><span class="s0">, </span><span class="s2">&quot;22&quot;</span><span class="s0">, </span><span class="s2">&quot;aaa&quot;</span><span class="s0">, </span><span class="s2">&quot;333&quot;</span><span class="s0">, </span><span class="s2">&quot;45678&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>

    <span class="s1">result = s.str.zfill(</span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;00001&quot;</span><span class="s0">, </span><span class="s2">&quot;00022&quot;</span><span class="s0">, </span><span class="s2">&quot;00aaa&quot;</span><span class="s0">, </span><span class="s2">&quot;00333&quot;</span><span class="s0">, </span><span class="s2">&quot;45678&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">expected = np.array([v.zfill(</span><span class="s3">5</span><span class="s1">) </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">np.array(s)]</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span>
    <span class="s1">tm.assert_numpy_array_equal(np.array(result</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">result = s.str.zfill(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">expected = Series([</span><span class="s2">&quot;001&quot;</span><span class="s0">, </span><span class="s2">&quot;022&quot;</span><span class="s0">, </span><span class="s2">&quot;aaa&quot;</span><span class="s0">, </span><span class="s2">&quot;333&quot;</span><span class="s0">, </span><span class="s2">&quot;45678&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">expected = np.array([v.zfill(</span><span class="s3">3</span><span class="s1">) </span><span class="s0">for </span><span class="s1">v </span><span class="s0">in </span><span class="s1">np.array(s)]</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span>
    <span class="s1">tm.assert_numpy_array_equal(np.array(result</span><span class="s0">, </span><span class="s1">dtype=np.object_)</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">s = Series([</span><span class="s2">&quot;1&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;aaa&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;45678&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype)</span>
    <span class="s1">result = s.str.zfill(</span><span class="s3">5</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;00001&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;00aaa&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;45678&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_wrap(any_string_dtype):</span>
    <span class="s4"># test values are: two words less than width, two words equal to width,</span>
    <span class="s4"># two words greater than width, one word less than width, one word</span>
    <span class="s4"># equal to width, one word greater than width, multiple tokens with</span>
    <span class="s4"># trailing whitespace equal to width</span>
    <span class="s1">s = Series(</span>
        <span class="s1">[</span>
            <span class="s2">&quot;hello world&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;hello world!&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;hello world!!&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;abcdefabcde&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;abcdefabcdef&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;abcdefabcdefa&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;ab ab ab ab &quot;</span><span class="s0">,</span>
            <span class="s2">&quot;ab ab ab ab a&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;</span><span class="s0">\t</span><span class="s2">&quot;</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=any_string_dtype</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s4"># expected values</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span>
            <span class="s2">&quot;hello world&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;hello world!&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;hello</span><span class="s0">\n</span><span class="s2">world!!&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;abcdefabcde&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;abcdefabcdef&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;abcdefabcdef</span><span class="s0">\n</span><span class="s2">a&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;ab ab ab ab&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;ab ab ab ab</span><span class="s0">\n</span><span class="s2">a&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;&quot;</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=any_string_dtype</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">result = s.str.wrap(</span><span class="s3">12</span><span class="s0">, </span><span class="s1">break_long_words=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_wrap_unicode(any_string_dtype):</span>
    <span class="s4"># test with pre and post whitespace (non-unicode), NaN, and non-ascii Unicode</span>
    <span class="s1">s = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;  pre  &quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;</span><span class="s0">\xac\u20ac\U00008000 </span><span class="s2">abadcafe&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s2">&quot;  pre&quot;</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s2">&quot;</span><span class="s0">\xac\u20ac\U00008000 </span><span class="s2">ab</span><span class="s0">\n</span><span class="s2">adcafe&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=any_string_dtype</span>
    <span class="s1">)</span>
    <span class="s1">result = s.str.wrap(</span><span class="s3">6</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
</pre>
</body>
</html>