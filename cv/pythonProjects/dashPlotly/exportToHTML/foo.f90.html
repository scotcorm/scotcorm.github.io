<html>
<head>
<title>foo.f90</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #a9b7c6;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
foo.f90</font>
</center></td></tr></table>
<pre>
<span class="s0">subroutine foo(a, n, m, b)</span>
  <span class="s0">implicit none</span>

  <span class="s0">real, intent(in) :: a(n, m)</span>
  <span class="s0">integer, intent(in) :: n, m</span>
  <span class="s0">real, intent(out) :: b(size(a, 1))</span>

  <span class="s0">integer :: i</span>

  <span class="s0">do i = 1, size(b)</span>
    <span class="s0">b(i) = sum(a(i,:))</span>
  <span class="s0">enddo</span>
<span class="s0">end subroutine</span>

<span class="s0">subroutine trans(x,y)</span>
  <span class="s0">implicit none</span>
  <span class="s0">real, intent(in), dimension(:,:) :: x</span>
  <span class="s0">real, intent(out), dimension( size(x,2), size(x,1) ) :: y</span>
  <span class="s0">integer :: N, M, i, j</span>
  <span class="s0">N = size(x,1)</span>
  <span class="s0">M = size(x,2)</span>
  <span class="s0">DO i=1,N</span>
     <span class="s0">do j=1,M</span>
        <span class="s0">y(j,i) = x(i,j)</span>
     <span class="s0">END DO</span>
  <span class="s0">END DO</span>
<span class="s0">end subroutine trans</span>

<span class="s0">subroutine flatten(x,y)</span>
  <span class="s0">implicit none</span>
  <span class="s0">real, intent(in), dimension(:,:) :: x</span>
  <span class="s0">real, intent(out), dimension( size(x) ) :: y</span>
  <span class="s0">integer :: N, M, i, j, k</span>
  <span class="s0">N = size(x,1)</span>
  <span class="s0">M = size(x,2)</span>
  <span class="s0">k = 1</span>
  <span class="s0">DO i=1,N</span>
     <span class="s0">do j=1,M</span>
        <span class="s0">y(k) = x(i,j)</span>
        <span class="s0">k = k + 1</span>
     <span class="s0">END DO</span>
  <span class="s0">END DO</span>
<span class="s0">end subroutine flatten</span>
</pre>
</body>
</html>