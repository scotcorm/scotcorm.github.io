<html>
<head>
<title>_gantt.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #629755; font-style: italic;}
.s4 { color: #808080;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
_gantt.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">__future__ </span><span class="s0">import </span><span class="s1">absolute_import</span>

<span class="s0">from </span><span class="s1">numbers </span><span class="s0">import </span><span class="s1">Number</span>

<span class="s0">import </span><span class="s1">copy</span>

<span class="s0">from </span><span class="s1">plotly </span><span class="s0">import </span><span class="s1">exceptions</span><span class="s0">, </span><span class="s1">optional_imports</span>
<span class="s0">import </span><span class="s1">plotly.colors </span><span class="s0">as </span><span class="s1">clrs</span>
<span class="s0">from </span><span class="s1">plotly.figure_factory </span><span class="s0">import </span><span class="s1">utils</span>
<span class="s0">import </span><span class="s1">plotly.graph_objects </span><span class="s0">as </span><span class="s1">go</span>

<span class="s1">pd = optional_imports.get_module(</span><span class="s2">&quot;pandas&quot;</span><span class="s1">)</span>

<span class="s1">REQUIRED_GANTT_KEYS = [</span><span class="s2">&quot;Task&quot;</span><span class="s0">, </span><span class="s2">&quot;Start&quot;</span><span class="s0">, </span><span class="s2">&quot;Finish&quot;</span><span class="s1">]</span>


<span class="s0">def </span><span class="s1">_get_corner_points(x0</span><span class="s0">, </span><span class="s1">y0</span><span class="s0">, </span><span class="s1">x1</span><span class="s0">, </span><span class="s1">y1):</span>
    <span class="s3">&quot;&quot;&quot; 
    Returns the corner points of a scatter rectangle 
 
    :param x0: x-start 
    :param y0: y-lower 
    :param x1: x-end 
    :param y1: y-upper 
    :return: ([x], [y]), tuple of lists containing the x and y values 
    &quot;&quot;&quot;</span>

    <span class="s0">return </span><span class="s1">([x0</span><span class="s0">, </span><span class="s1">x1</span><span class="s0">, </span><span class="s1">x1</span><span class="s0">, </span><span class="s1">x0]</span><span class="s0">, </span><span class="s1">[y0</span><span class="s0">, </span><span class="s1">y0</span><span class="s0">, </span><span class="s1">y1</span><span class="s0">, </span><span class="s1">y1])</span>


<span class="s0">def </span><span class="s1">validate_gantt(df):</span>
    <span class="s3">&quot;&quot;&quot; 
    Validates the inputted dataframe or list 
    &quot;&quot;&quot;</span>
    <span class="s0">if </span><span class="s1">pd </span><span class="s0">and </span><span class="s1">isinstance(df</span><span class="s0">, </span><span class="s1">pd.core.frame.DataFrame):</span>
        <span class="s4"># validate that df has all the required keys</span>
        <span class="s0">for </span><span class="s1">key </span><span class="s0">in </span><span class="s1">REQUIRED_GANTT_KEYS:</span>
            <span class="s0">if </span><span class="s1">key </span><span class="s0">not in </span><span class="s1">df:</span>
                <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                    <span class="s2">&quot;The columns in your dataframe must include the &quot;</span>
                    <span class="s2">&quot;following keys: {0}&quot;</span><span class="s1">.format(</span><span class="s2">&quot;, &quot;</span><span class="s1">.join(REQUIRED_GANTT_KEYS))</span>
                <span class="s1">)</span>

        <span class="s1">num_of_rows = len(df.index)</span>
        <span class="s1">chart = []</span>
        <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(num_of_rows):</span>
            <span class="s1">task_dict = {}</span>
            <span class="s0">for </span><span class="s1">key </span><span class="s0">in </span><span class="s1">df:</span>
                <span class="s1">task_dict[key] = df.iloc[index][key]</span>
            <span class="s1">chart.append(task_dict)</span>

        <span class="s0">return </span><span class="s1">chart</span>

    <span class="s4"># validate if df is a list</span>
    <span class="s0">if not </span><span class="s1">isinstance(df</span><span class="s0">, </span><span class="s1">list):</span>
        <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
            <span class="s2">&quot;You must input either a dataframe &quot; &quot;or a list of dictionaries.&quot;</span>
        <span class="s1">)</span>

    <span class="s4"># validate if df is empty</span>
    <span class="s0">if </span><span class="s1">len(df) &lt;= </span><span class="s5">0</span><span class="s1">:</span>
        <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
            <span class="s2">&quot;Your list is empty. It must contain &quot; &quot;at least one dictionary.&quot;</span>
        <span class="s1">)</span>
    <span class="s0">if not </span><span class="s1">isinstance(df[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dict):</span>
        <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span><span class="s2">&quot;Your list must only &quot; &quot;include dictionaries.&quot;</span><span class="s1">)</span>
    <span class="s0">return </span><span class="s1">df</span>


<span class="s0">def </span><span class="s1">gantt(</span>
    <span class="s1">chart</span><span class="s0">,</span>
    <span class="s1">colors</span><span class="s0">,</span>
    <span class="s1">title</span><span class="s0">,</span>
    <span class="s1">bar_width</span><span class="s0">,</span>
    <span class="s1">showgrid_x</span><span class="s0">,</span>
    <span class="s1">showgrid_y</span><span class="s0">,</span>
    <span class="s1">height</span><span class="s0">,</span>
    <span class="s1">width</span><span class="s0">,</span>
    <span class="s1">tasks=</span><span class="s0">None,</span>
    <span class="s1">task_names=</span><span class="s0">None,</span>
    <span class="s1">data=</span><span class="s0">None,</span>
    <span class="s1">group_tasks=</span><span class="s0">False,</span>
    <span class="s1">show_hover_fill=</span><span class="s0">True,</span>
    <span class="s1">show_colorbar=</span><span class="s0">True,</span>
<span class="s1">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Refer to create_gantt() for docstring 
    &quot;&quot;&quot;</span>
    <span class="s0">if </span><span class="s1">tasks </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">tasks = []</span>
    <span class="s0">if </span><span class="s1">task_names </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">task_names = []</span>
    <span class="s0">if </span><span class="s1">data </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">data = []</span>

    <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(chart)):</span>
        <span class="s1">task = dict(</span>
            <span class="s1">x0=chart[index][</span><span class="s2">&quot;Start&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">x1=chart[index][</span><span class="s2">&quot;Finish&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">name=chart[index][</span><span class="s2">&quot;Task&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span>
        <span class="s0">if </span><span class="s2">&quot;Description&quot; </span><span class="s0">in </span><span class="s1">chart[index]:</span>
            <span class="s1">task[</span><span class="s2">&quot;description&quot;</span><span class="s1">] = chart[index][</span><span class="s2">&quot;Description&quot;</span><span class="s1">]</span>
        <span class="s1">tasks.append(task)</span>

    <span class="s4"># create a scatter trace for every task group</span>
    <span class="s1">scatter_data_dict = dict()</span>
    <span class="s1">marker_data_dict = dict()</span>

    <span class="s0">if </span><span class="s1">show_hover_fill:</span>
        <span class="s1">hoverinfo = </span><span class="s2">&quot;name&quot;</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">hoverinfo = </span><span class="s2">&quot;skip&quot;</span>

    <span class="s1">scatter_data_template = {</span>
        <span class="s2">&quot;x&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;y&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="s1">: </span><span class="s2">&quot;none&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;fill&quot;</span><span class="s1">: </span><span class="s2">&quot;toself&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;hoverinfo&quot;</span><span class="s1">: hoverinfo</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">marker_data_template = {</span>
        <span class="s2">&quot;x&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;y&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="s1">: </span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;text&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;marker&quot;</span><span class="s1">: dict(color=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">size=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">opacity=</span><span class="s5">0</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s2">&quot;name&quot;</span><span class="s1">: </span><span class="s2">&quot;&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;showlegend&quot;</span><span class="s1">: </span><span class="s0">False,</span>
    <span class="s1">}</span>

    <span class="s4"># create the list of task names</span>
    <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
        <span class="s1">tn = tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
        <span class="s4"># Is added to task_names if group_tasks is set to False,</span>
        <span class="s4"># or if the option is used (True) it only adds them if the</span>
        <span class="s4"># name is not already in the list</span>
        <span class="s0">if not </span><span class="s1">group_tasks </span><span class="s0">or </span><span class="s1">tn </span><span class="s0">not in </span><span class="s1">task_names:</span>
            <span class="s1">task_names.append(tn)</span>
    <span class="s4"># Guarantees that for grouped tasks the tasks that are inserted first</span>
    <span class="s4"># are shown at the top</span>
    <span class="s0">if </span><span class="s1">group_tasks:</span>
        <span class="s1">task_names.reverse()</span>

    <span class="s1">color_index = </span><span class="s5">0</span>
    <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
        <span class="s1">tn = tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
        <span class="s0">del </span><span class="s1">tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>

        <span class="s4"># If group_tasks is True, all tasks with the same name belong</span>
        <span class="s4"># to the same row.</span>
        <span class="s1">groupID = index</span>
        <span class="s0">if </span><span class="s1">group_tasks:</span>
            <span class="s1">groupID = task_names.index(tn)</span>
        <span class="s1">tasks[index][</span><span class="s2">&quot;y0&quot;</span><span class="s1">] = groupID - bar_width</span>
        <span class="s1">tasks[index][</span><span class="s2">&quot;y1&quot;</span><span class="s1">] = groupID + bar_width</span>

        <span class="s4"># check if colors need to be looped</span>
        <span class="s0">if </span><span class="s1">color_index &gt;= len(colors):</span>
            <span class="s1">color_index = </span><span class="s5">0</span>
        <span class="s1">tasks[index][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">] = colors[color_index]</span>
        <span class="s1">color_id = tasks[index][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">]</span>

        <span class="s0">if </span><span class="s1">color_id </span><span class="s0">not in </span><span class="s1">scatter_data_dict:</span>
            <span class="s1">scatter_data_dict[color_id] = copy.deepcopy(scatter_data_template)</span>

        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">] = color_id</span>
        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;name&quot;</span><span class="s1">] = str(tn)</span>
        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;legendgroup&quot;</span><span class="s1">] = color_id</span>

        <span class="s4"># if there are already values append the gap</span>
        <span class="s0">if </span><span class="s1">len(scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">]) &gt; </span><span class="s5">0</span><span class="s1">:</span>
            <span class="s4"># a gap on the scatterplot separates the rectangles from each other</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(</span>
                <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">][-</span><span class="s5">1</span><span class="s1">]</span>
            <span class="s1">)</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>

        <span class="s1">xs</span><span class="s0">, </span><span class="s1">ys = _get_corner_points(</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;x0&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;y0&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;x1&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;y1&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span>

        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">] += xs</span>
        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">] += ys</span>

        <span class="s4"># append dummy markers for showing start and end of interval</span>
        <span class="s0">if </span><span class="s1">color_id </span><span class="s0">not in </span><span class="s1">marker_data_dict:</span>
            <span class="s1">marker_data_dict[color_id] = copy.deepcopy(marker_data_template)</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = color_id</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;legendgroup&quot;</span><span class="s1">] = color_id</span>

        <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;x0&quot;</span><span class="s1">])</span>
        <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;x1&quot;</span><span class="s1">])</span>
        <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(groupID)</span>
        <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(groupID)</span>

        <span class="s0">if </span><span class="s2">&quot;description&quot; </span><span class="s0">in </span><span class="s1">tasks[index]:</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">])</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">])</span>
            <span class="s0">del </span><span class="s1">tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">]</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>

        <span class="s1">color_index += </span><span class="s5">1</span>

    <span class="s1">showlegend = show_colorbar</span>

    <span class="s1">layout = dict(</span>
        <span class="s1">title=title</span><span class="s0">,</span>
        <span class="s1">showlegend=showlegend</span><span class="s0">,</span>
        <span class="s1">height=height</span><span class="s0">,</span>
        <span class="s1">width=width</span><span class="s0">,</span>
        <span class="s1">shapes=[]</span><span class="s0">,</span>
        <span class="s1">hovermode=</span><span class="s2">&quot;closest&quot;</span><span class="s0">,</span>
        <span class="s1">yaxis=dict(</span>
            <span class="s1">showgrid=showgrid_y</span><span class="s0">,</span>
            <span class="s1">ticktext=task_names</span><span class="s0">,</span>
            <span class="s1">tickvals=list(range(len(task_names)))</span><span class="s0">,</span>
            <span class="s1">range=[-</span><span class="s5">1</span><span class="s0">, </span><span class="s1">len(task_names) + </span><span class="s5">1</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">autorange=</span><span class="s0">False,</span>
            <span class="s1">zeroline=</span><span class="s0">False,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">xaxis=dict(</span>
            <span class="s1">showgrid=showgrid_x</span><span class="s0">,</span>
            <span class="s1">zeroline=</span><span class="s0">False,</span>
            <span class="s1">rangeselector=dict(</span>
                <span class="s1">buttons=list(</span>
                    <span class="s1">[</span>
                        <span class="s1">dict(count=</span><span class="s5">7</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1w&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;day&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1m&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;month&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">6</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;6m&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;month&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;YTD&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;year&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;todate&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1y&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;year&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(step=</span><span class="s2">&quot;all&quot;</span><span class="s1">)</span><span class="s0">,</span>
                    <span class="s1">]</span>
                <span class="s1">)</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s1">type=</span><span class="s2">&quot;date&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">data = [scatter_data_dict[k] </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">sorted(scatter_data_dict)]</span>
    <span class="s1">data += [marker_data_dict[k] </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">sorted(marker_data_dict)]</span>

    <span class="s4"># fig = dict(</span>
    <span class="s4">#     data=data, layout=layout</span>
    <span class="s4"># )</span>
    <span class="s1">fig = go.Figure(data=data</span><span class="s0">, </span><span class="s1">layout=layout)</span>
    <span class="s0">return </span><span class="s1">fig</span>


<span class="s0">def </span><span class="s1">gantt_colorscale(</span>
    <span class="s1">chart</span><span class="s0">,</span>
    <span class="s1">colors</span><span class="s0">,</span>
    <span class="s1">title</span><span class="s0">,</span>
    <span class="s1">index_col</span><span class="s0">,</span>
    <span class="s1">show_colorbar</span><span class="s0">,</span>
    <span class="s1">bar_width</span><span class="s0">,</span>
    <span class="s1">showgrid_x</span><span class="s0">,</span>
    <span class="s1">showgrid_y</span><span class="s0">,</span>
    <span class="s1">height</span><span class="s0">,</span>
    <span class="s1">width</span><span class="s0">,</span>
    <span class="s1">tasks=</span><span class="s0">None,</span>
    <span class="s1">task_names=</span><span class="s0">None,</span>
    <span class="s1">data=</span><span class="s0">None,</span>
    <span class="s1">group_tasks=</span><span class="s0">False,</span>
    <span class="s1">show_hover_fill=</span><span class="s0">True,</span>
<span class="s1">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Refer to FigureFactory.create_gantt() for docstring 
    &quot;&quot;&quot;</span>
    <span class="s0">if </span><span class="s1">tasks </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">tasks = []</span>
    <span class="s0">if </span><span class="s1">task_names </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">task_names = []</span>
    <span class="s0">if </span><span class="s1">data </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">data = []</span>
    <span class="s1">showlegend = </span><span class="s0">False</span>

    <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(chart)):</span>
        <span class="s1">task = dict(</span>
            <span class="s1">x0=chart[index][</span><span class="s2">&quot;Start&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">x1=chart[index][</span><span class="s2">&quot;Finish&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">name=chart[index][</span><span class="s2">&quot;Task&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span>
        <span class="s0">if </span><span class="s2">&quot;Description&quot; </span><span class="s0">in </span><span class="s1">chart[index]:</span>
            <span class="s1">task[</span><span class="s2">&quot;description&quot;</span><span class="s1">] = chart[index][</span><span class="s2">&quot;Description&quot;</span><span class="s1">]</span>
        <span class="s1">tasks.append(task)</span>

    <span class="s4"># create a scatter trace for every task group</span>
    <span class="s1">scatter_data_dict = dict()</span>
    <span class="s4"># create scatter traces for the start- and endpoints</span>
    <span class="s1">marker_data_dict = dict()</span>

    <span class="s0">if </span><span class="s1">show_hover_fill:</span>
        <span class="s1">hoverinfo = </span><span class="s2">&quot;name&quot;</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">hoverinfo = </span><span class="s2">&quot;skip&quot;</span>

    <span class="s1">scatter_data_template = {</span>
        <span class="s2">&quot;x&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;y&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="s1">: </span><span class="s2">&quot;none&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;fill&quot;</span><span class="s1">: </span><span class="s2">&quot;toself&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;showlegend&quot;</span><span class="s1">: </span><span class="s0">False,</span>
        <span class="s2">&quot;hoverinfo&quot;</span><span class="s1">: hoverinfo</span><span class="s0">,</span>
        <span class="s2">&quot;legendgroup&quot;</span><span class="s1">: </span><span class="s2">&quot;&quot;</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">marker_data_template = {</span>
        <span class="s2">&quot;x&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;y&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="s1">: </span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;text&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;marker&quot;</span><span class="s1">: dict(color=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">size=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">opacity=</span><span class="s5">0</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s2">&quot;name&quot;</span><span class="s1">: </span><span class="s2">&quot;&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;showlegend&quot;</span><span class="s1">: </span><span class="s0">False,</span>
        <span class="s2">&quot;legendgroup&quot;</span><span class="s1">: </span><span class="s2">&quot;&quot;</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">index_vals = []</span>
    <span class="s0">for </span><span class="s1">row </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
        <span class="s0">if </span><span class="s1">chart[row][index_col] </span><span class="s0">not in </span><span class="s1">index_vals:</span>
            <span class="s1">index_vals.append(chart[row][index_col])</span>

    <span class="s1">index_vals.sort()</span>

    <span class="s4"># compute the color for task based on indexing column</span>
    <span class="s0">if </span><span class="s1">isinstance(chart[</span><span class="s5">0</span><span class="s1">][index_col]</span><span class="s0">, </span><span class="s1">Number):</span>
        <span class="s4"># check that colors has at least 2 colors</span>
        <span class="s0">if </span><span class="s1">len(colors) &lt; </span><span class="s5">2</span><span class="s1">:</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;You must use at least 2 colors in 'colors' if you &quot;</span>
                <span class="s2">&quot;are using a colorscale. However only the first two &quot;</span>
                <span class="s2">&quot;colors given will be used for the lower and upper &quot;</span>
                <span class="s2">&quot;bounds on the colormap.&quot;</span>
            <span class="s1">)</span>

        <span class="s4"># create the list of task names</span>
        <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
            <span class="s1">tn = tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
            <span class="s4"># Is added to task_names if group_tasks is set to False,</span>
            <span class="s4"># or if the option is used (True) it only adds them if the</span>
            <span class="s4"># name is not already in the list</span>
            <span class="s0">if not </span><span class="s1">group_tasks </span><span class="s0">or </span><span class="s1">tn </span><span class="s0">not in </span><span class="s1">task_names:</span>
                <span class="s1">task_names.append(tn)</span>
        <span class="s4"># Guarantees that for grouped tasks the tasks that are inserted</span>
        <span class="s4"># first are shown at the top</span>
        <span class="s0">if </span><span class="s1">group_tasks:</span>
            <span class="s1">task_names.reverse()</span>

        <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
            <span class="s1">tn = tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
            <span class="s0">del </span><span class="s1">tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>

            <span class="s4"># If group_tasks is True, all tasks with the same name belong</span>
            <span class="s4"># to the same row.</span>
            <span class="s1">groupID = index</span>
            <span class="s0">if </span><span class="s1">group_tasks:</span>
                <span class="s1">groupID = task_names.index(tn)</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;y0&quot;</span><span class="s1">] = groupID - bar_width</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;y1&quot;</span><span class="s1">] = groupID + bar_width</span>

            <span class="s4"># unlabel color</span>
            <span class="s1">colors = clrs.color_parser(colors</span><span class="s0">, </span><span class="s1">clrs.unlabel_rgb)</span>
            <span class="s1">lowcolor = colors[</span><span class="s5">0</span><span class="s1">]</span>
            <span class="s1">highcolor = colors[</span><span class="s5">1</span><span class="s1">]</span>

            <span class="s1">intermed = (chart[index][index_col]) / </span><span class="s5">100.0</span>
            <span class="s1">intermed_color = clrs.find_intermediate_color(lowcolor</span><span class="s0">, </span><span class="s1">highcolor</span><span class="s0">, </span><span class="s1">intermed)</span>
            <span class="s1">intermed_color = clrs.color_parser(intermed_color</span><span class="s0">, </span><span class="s1">clrs.label_rgb)</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">] = intermed_color</span>
            <span class="s1">color_id = tasks[index][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">]</span>

            <span class="s0">if </span><span class="s1">color_id </span><span class="s0">not in </span><span class="s1">scatter_data_dict:</span>
                <span class="s1">scatter_data_dict[color_id] = copy.deepcopy(scatter_data_template)</span>

            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">] = color_id</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;name&quot;</span><span class="s1">] = str(chart[index][index_col])</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;legendgroup&quot;</span><span class="s1">] = color_id</span>

            <span class="s4"># relabel colors with 'rgb'</span>
            <span class="s1">colors = clrs.color_parser(colors</span><span class="s0">, </span><span class="s1">clrs.label_rgb)</span>

            <span class="s4"># if there are already values append the gap</span>
            <span class="s0">if </span><span class="s1">len(scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">]) &gt; </span><span class="s5">0</span><span class="s1">:</span>
                <span class="s4"># a gap on the scatterplot separates the rectangles from each other</span>
                <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(</span>
                    <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">][-</span><span class="s5">1</span><span class="s1">]</span>
                <span class="s1">)</span>
                <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>

            <span class="s1">xs</span><span class="s0">, </span><span class="s1">ys = _get_corner_points(</span>
                <span class="s1">tasks[index][</span><span class="s2">&quot;x0&quot;</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">tasks[index][</span><span class="s2">&quot;y0&quot;</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">tasks[index][</span><span class="s2">&quot;x1&quot;</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">tasks[index][</span><span class="s2">&quot;y1&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">)</span>

            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">] += xs</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">] += ys</span>

            <span class="s4"># append dummy markers for showing start and end of interval</span>
            <span class="s0">if </span><span class="s1">color_id </span><span class="s0">not in </span><span class="s1">marker_data_dict:</span>
                <span class="s1">marker_data_dict[color_id] = copy.deepcopy(marker_data_template)</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = color_id</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;legendgroup&quot;</span><span class="s1">] = color_id</span>

            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;x0&quot;</span><span class="s1">])</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;x1&quot;</span><span class="s1">])</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(groupID)</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(groupID)</span>

            <span class="s0">if </span><span class="s2">&quot;description&quot; </span><span class="s0">in </span><span class="s1">tasks[index]:</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">])</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">])</span>
                <span class="s0">del </span><span class="s1">tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">]</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>

        <span class="s4"># add colorbar to one of the traces randomly just for display</span>
        <span class="s0">if </span><span class="s1">show_colorbar </span><span class="s0">is True</span><span class="s1">:</span>
            <span class="s1">k = list(marker_data_dict.keys())[</span><span class="s5">0</span><span class="s1">]</span>
            <span class="s1">marker_data_dict[k][</span><span class="s2">&quot;marker&quot;</span><span class="s1">].update(</span>
                <span class="s1">dict(</span>
                    <span class="s1">colorscale=[[</span><span class="s5">0</span><span class="s0">, </span><span class="s1">colors[</span><span class="s5">0</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[</span><span class="s5">1</span><span class="s0">, </span><span class="s1">colors[</span><span class="s5">1</span><span class="s1">]]]</span><span class="s0">,</span>
                    <span class="s1">showscale=</span><span class="s0">True,</span>
                    <span class="s1">cmax=</span><span class="s5">100</span><span class="s0">,</span>
                    <span class="s1">cmin=</span><span class="s5">0</span><span class="s0">,</span>
                <span class="s1">)</span>
            <span class="s1">)</span>

    <span class="s0">if </span><span class="s1">isinstance(chart[</span><span class="s5">0</span><span class="s1">][index_col]</span><span class="s0">, </span><span class="s1">str):</span>
        <span class="s1">index_vals = []</span>
        <span class="s0">for </span><span class="s1">row </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
            <span class="s0">if </span><span class="s1">chart[row][index_col] </span><span class="s0">not in </span><span class="s1">index_vals:</span>
                <span class="s1">index_vals.append(chart[row][index_col])</span>

        <span class="s1">index_vals.sort()</span>

        <span class="s0">if </span><span class="s1">len(colors) &lt; len(index_vals):</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;Error. The number of colors in 'colors' must be no less &quot;</span>
                <span class="s2">&quot;than the number of unique index values in your group &quot;</span>
                <span class="s2">&quot;column.&quot;</span>
            <span class="s1">)</span>

        <span class="s4"># make a dictionary assignment to each index value</span>
        <span class="s1">index_vals_dict = {}</span>
        <span class="s4"># define color index</span>
        <span class="s1">c_index = </span><span class="s5">0</span>
        <span class="s0">for </span><span class="s1">key </span><span class="s0">in </span><span class="s1">index_vals:</span>
            <span class="s0">if </span><span class="s1">c_index &gt; len(colors) - </span><span class="s5">1</span><span class="s1">:</span>
                <span class="s1">c_index = </span><span class="s5">0</span>
            <span class="s1">index_vals_dict[key] = colors[c_index]</span>
            <span class="s1">c_index += </span><span class="s5">1</span>

        <span class="s4"># create the list of task names</span>
        <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
            <span class="s1">tn = tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
            <span class="s4"># Is added to task_names if group_tasks is set to False,</span>
            <span class="s4"># or if the option is used (True) it only adds them if the</span>
            <span class="s4"># name is not already in the list</span>
            <span class="s0">if not </span><span class="s1">group_tasks </span><span class="s0">or </span><span class="s1">tn </span><span class="s0">not in </span><span class="s1">task_names:</span>
                <span class="s1">task_names.append(tn)</span>
        <span class="s4"># Guarantees that for grouped tasks the tasks that are inserted</span>
        <span class="s4"># first are shown at the top</span>
        <span class="s0">if </span><span class="s1">group_tasks:</span>
            <span class="s1">task_names.reverse()</span>

        <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
            <span class="s1">tn = tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
            <span class="s0">del </span><span class="s1">tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>

            <span class="s4"># If group_tasks is True, all tasks with the same name belong</span>
            <span class="s4"># to the same row.</span>
            <span class="s1">groupID = index</span>
            <span class="s0">if </span><span class="s1">group_tasks:</span>
                <span class="s1">groupID = task_names.index(tn)</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;y0&quot;</span><span class="s1">] = groupID - bar_width</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;y1&quot;</span><span class="s1">] = groupID + bar_width</span>

            <span class="s1">tasks[index][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">] = index_vals_dict[chart[index][index_col]]</span>
            <span class="s1">color_id = tasks[index][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">]</span>

            <span class="s0">if </span><span class="s1">color_id </span><span class="s0">not in </span><span class="s1">scatter_data_dict:</span>
                <span class="s1">scatter_data_dict[color_id] = copy.deepcopy(scatter_data_template)</span>

            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">] = color_id</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;legendgroup&quot;</span><span class="s1">] = color_id</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;name&quot;</span><span class="s1">] = str(chart[index][index_col])</span>

            <span class="s4"># relabel colors with 'rgb'</span>
            <span class="s1">colors = clrs.color_parser(colors</span><span class="s0">, </span><span class="s1">clrs.label_rgb)</span>

            <span class="s4"># if there are already values append the gap</span>
            <span class="s0">if </span><span class="s1">len(scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">]) &gt; </span><span class="s5">0</span><span class="s1">:</span>
                <span class="s4"># a gap on the scatterplot separates the rectangles from each other</span>
                <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(</span>
                    <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">][-</span><span class="s5">1</span><span class="s1">]</span>
                <span class="s1">)</span>
                <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>

            <span class="s1">xs</span><span class="s0">, </span><span class="s1">ys = _get_corner_points(</span>
                <span class="s1">tasks[index][</span><span class="s2">&quot;x0&quot;</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">tasks[index][</span><span class="s2">&quot;y0&quot;</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">tasks[index][</span><span class="s2">&quot;x1&quot;</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">tasks[index][</span><span class="s2">&quot;y1&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">)</span>

            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">] += xs</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">] += ys</span>

            <span class="s4"># append dummy markers for showing start and end of interval</span>
            <span class="s0">if </span><span class="s1">color_id </span><span class="s0">not in </span><span class="s1">marker_data_dict:</span>
                <span class="s1">marker_data_dict[color_id] = copy.deepcopy(marker_data_template)</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = color_id</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;legendgroup&quot;</span><span class="s1">] = color_id</span>

            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;x0&quot;</span><span class="s1">])</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;x1&quot;</span><span class="s1">])</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(groupID)</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(groupID)</span>

            <span class="s0">if </span><span class="s2">&quot;description&quot; </span><span class="s0">in </span><span class="s1">tasks[index]:</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">])</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">])</span>
                <span class="s0">del </span><span class="s1">tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">]</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>
                <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>

        <span class="s0">if </span><span class="s1">show_colorbar </span><span class="s0">is True</span><span class="s1">:</span>
            <span class="s1">showlegend = </span><span class="s0">True</span>
            <span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">scatter_data_dict:</span>
                <span class="s1">scatter_data_dict[k][</span><span class="s2">&quot;showlegend&quot;</span><span class="s1">] = showlegend</span>
    <span class="s4"># add colorbar to one of the traces randomly just for display</span>
    <span class="s4"># if show_colorbar is True:</span>
    <span class="s4">#     k = list(marker_data_dict.keys())[0]</span>
    <span class="s4">#     marker_data_dict[k][&quot;marker&quot;].update(</span>
    <span class="s4">#         dict(</span>
    <span class="s4">#             colorscale=[[0, colors[0]], [1, colors[1]]],</span>
    <span class="s4">#             showscale=True,</span>
    <span class="s4">#             cmax=100,</span>
    <span class="s4">#             cmin=0,</span>
    <span class="s4">#         )</span>
    <span class="s4">#     )</span>

    <span class="s1">layout = dict(</span>
        <span class="s1">title=title</span><span class="s0">,</span>
        <span class="s1">showlegend=showlegend</span><span class="s0">,</span>
        <span class="s1">height=height</span><span class="s0">,</span>
        <span class="s1">width=width</span><span class="s0">,</span>
        <span class="s1">shapes=[]</span><span class="s0">,</span>
        <span class="s1">hovermode=</span><span class="s2">&quot;closest&quot;</span><span class="s0">,</span>
        <span class="s1">yaxis=dict(</span>
            <span class="s1">showgrid=showgrid_y</span><span class="s0">,</span>
            <span class="s1">ticktext=task_names</span><span class="s0">,</span>
            <span class="s1">tickvals=list(range(len(task_names)))</span><span class="s0">,</span>
            <span class="s1">range=[-</span><span class="s5">1</span><span class="s0">, </span><span class="s1">len(task_names) + </span><span class="s5">1</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">autorange=</span><span class="s0">False,</span>
            <span class="s1">zeroline=</span><span class="s0">False,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">xaxis=dict(</span>
            <span class="s1">showgrid=showgrid_x</span><span class="s0">,</span>
            <span class="s1">zeroline=</span><span class="s0">False,</span>
            <span class="s1">rangeselector=dict(</span>
                <span class="s1">buttons=list(</span>
                    <span class="s1">[</span>
                        <span class="s1">dict(count=</span><span class="s5">7</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1w&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;day&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1m&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;month&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">6</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;6m&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;month&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;YTD&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;year&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;todate&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1y&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;year&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(step=</span><span class="s2">&quot;all&quot;</span><span class="s1">)</span><span class="s0">,</span>
                    <span class="s1">]</span>
                <span class="s1">)</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s1">type=</span><span class="s2">&quot;date&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">data = [scatter_data_dict[k] </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">sorted(scatter_data_dict)]</span>
    <span class="s1">data += [marker_data_dict[k] </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">sorted(marker_data_dict)]</span>

    <span class="s4"># fig = dict(</span>
    <span class="s4">#     data=data, layout=layout</span>
    <span class="s4"># )</span>
    <span class="s1">fig = go.Figure(data=data</span><span class="s0">, </span><span class="s1">layout=layout)</span>
    <span class="s0">return </span><span class="s1">fig</span>


<span class="s0">def </span><span class="s1">gantt_dict(</span>
    <span class="s1">chart</span><span class="s0">,</span>
    <span class="s1">colors</span><span class="s0">,</span>
    <span class="s1">title</span><span class="s0">,</span>
    <span class="s1">index_col</span><span class="s0">,</span>
    <span class="s1">show_colorbar</span><span class="s0">,</span>
    <span class="s1">bar_width</span><span class="s0">,</span>
    <span class="s1">showgrid_x</span><span class="s0">,</span>
    <span class="s1">showgrid_y</span><span class="s0">,</span>
    <span class="s1">height</span><span class="s0">,</span>
    <span class="s1">width</span><span class="s0">,</span>
    <span class="s1">tasks=</span><span class="s0">None,</span>
    <span class="s1">task_names=</span><span class="s0">None,</span>
    <span class="s1">data=</span><span class="s0">None,</span>
    <span class="s1">group_tasks=</span><span class="s0">False,</span>
    <span class="s1">show_hover_fill=</span><span class="s0">True,</span>
<span class="s1">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Refer to FigureFactory.create_gantt() for docstring 
    &quot;&quot;&quot;</span>

    <span class="s0">if </span><span class="s1">tasks </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">tasks = []</span>
    <span class="s0">if </span><span class="s1">task_names </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">task_names = []</span>
    <span class="s0">if </span><span class="s1">data </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">data = []</span>
    <span class="s1">showlegend = </span><span class="s0">False</span>

    <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(chart)):</span>
        <span class="s1">task = dict(</span>
            <span class="s1">x0=chart[index][</span><span class="s2">&quot;Start&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">x1=chart[index][</span><span class="s2">&quot;Finish&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">name=chart[index][</span><span class="s2">&quot;Task&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span>
        <span class="s0">if </span><span class="s2">&quot;Description&quot; </span><span class="s0">in </span><span class="s1">chart[index]:</span>
            <span class="s1">task[</span><span class="s2">&quot;description&quot;</span><span class="s1">] = chart[index][</span><span class="s2">&quot;Description&quot;</span><span class="s1">]</span>
        <span class="s1">tasks.append(task)</span>

    <span class="s4"># create a scatter trace for every task group</span>
    <span class="s1">scatter_data_dict = dict()</span>
    <span class="s4"># create scatter traces for the start- and endpoints</span>
    <span class="s1">marker_data_dict = dict()</span>

    <span class="s0">if </span><span class="s1">show_hover_fill:</span>
        <span class="s1">hoverinfo = </span><span class="s2">&quot;name&quot;</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">hoverinfo = </span><span class="s2">&quot;skip&quot;</span>

    <span class="s1">scatter_data_template = {</span>
        <span class="s2">&quot;x&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;y&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="s1">: </span><span class="s2">&quot;none&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;fill&quot;</span><span class="s1">: </span><span class="s2">&quot;toself&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;hoverinfo&quot;</span><span class="s1">: hoverinfo</span><span class="s0">,</span>
        <span class="s2">&quot;legendgroup&quot;</span><span class="s1">: </span><span class="s2">&quot;&quot;</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">marker_data_template = {</span>
        <span class="s2">&quot;x&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;y&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;mode&quot;</span><span class="s1">: </span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;text&quot;</span><span class="s1">: []</span><span class="s0">,</span>
        <span class="s2">&quot;marker&quot;</span><span class="s1">: dict(color=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">size=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">opacity=</span><span class="s5">0</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s2">&quot;name&quot;</span><span class="s1">: </span><span class="s2">&quot;&quot;</span><span class="s0">,</span>
        <span class="s2">&quot;showlegend&quot;</span><span class="s1">: </span><span class="s0">False,</span>
    <span class="s1">}</span>

    <span class="s1">index_vals = []</span>
    <span class="s0">for </span><span class="s1">row </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
        <span class="s0">if </span><span class="s1">chart[row][index_col] </span><span class="s0">not in </span><span class="s1">index_vals:</span>
            <span class="s1">index_vals.append(chart[row][index_col])</span>

    <span class="s1">index_vals.sort()</span>

    <span class="s4"># verify each value in index column appears in colors dictionary</span>
    <span class="s0">for </span><span class="s1">key </span><span class="s0">in </span><span class="s1">index_vals:</span>
        <span class="s0">if </span><span class="s1">key </span><span class="s0">not in </span><span class="s1">colors:</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;If you are using colors as a dictionary, all of its &quot;</span>
                <span class="s2">&quot;keys must be all the values in the index column.&quot;</span>
            <span class="s1">)</span>

    <span class="s4"># create the list of task names</span>
    <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
        <span class="s1">tn = tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
        <span class="s4"># Is added to task_names if group_tasks is set to False,</span>
        <span class="s4"># or if the option is used (True) it only adds them if the</span>
        <span class="s4"># name is not already in the list</span>
        <span class="s0">if not </span><span class="s1">group_tasks </span><span class="s0">or </span><span class="s1">tn </span><span class="s0">not in </span><span class="s1">task_names:</span>
            <span class="s1">task_names.append(tn)</span>
    <span class="s4"># Guarantees that for grouped tasks the tasks that are inserted first</span>
    <span class="s4"># are shown at the top</span>
    <span class="s0">if </span><span class="s1">group_tasks:</span>
        <span class="s1">task_names.reverse()</span>

    <span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">range(len(tasks)):</span>
        <span class="s1">tn = tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
        <span class="s0">del </span><span class="s1">tasks[index][</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>

        <span class="s4"># If group_tasks is True, all tasks with the same name belong</span>
        <span class="s4"># to the same row.</span>
        <span class="s1">groupID = index</span>
        <span class="s0">if </span><span class="s1">group_tasks:</span>
            <span class="s1">groupID = task_names.index(tn)</span>
        <span class="s1">tasks[index][</span><span class="s2">&quot;y0&quot;</span><span class="s1">] = groupID - bar_width</span>
        <span class="s1">tasks[index][</span><span class="s2">&quot;y1&quot;</span><span class="s1">] = groupID + bar_width</span>

        <span class="s1">tasks[index][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">] = colors[chart[index][index_col]]</span>
        <span class="s1">color_id = tasks[index][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">]</span>

        <span class="s0">if </span><span class="s1">color_id </span><span class="s0">not in </span><span class="s1">scatter_data_dict:</span>
            <span class="s1">scatter_data_dict[color_id] = copy.deepcopy(scatter_data_template)</span>

        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;legendgroup&quot;</span><span class="s1">] = color_id</span>
        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;fillcolor&quot;</span><span class="s1">] = color_id</span>

        <span class="s4"># if there are already values append the gap</span>
        <span class="s0">if </span><span class="s1">len(scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">]) &gt; </span><span class="s5">0</span><span class="s1">:</span>
            <span class="s4"># a gap on the scatterplot separates the rectangles from each other</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(</span>
                <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">][-</span><span class="s5">1</span><span class="s1">]</span>
            <span class="s1">)</span>
            <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>

        <span class="s1">xs</span><span class="s0">, </span><span class="s1">ys = _get_corner_points(</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;x0&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;y0&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;x1&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">tasks[index][</span><span class="s2">&quot;y1&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span>

        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">] += xs</span>
        <span class="s1">scatter_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">] += ys</span>

        <span class="s4"># append dummy markers for showing start and end of interval</span>
        <span class="s0">if </span><span class="s1">color_id </span><span class="s0">not in </span><span class="s1">marker_data_dict:</span>
            <span class="s1">marker_data_dict[color_id] = copy.deepcopy(marker_data_template)</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = color_id</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;legendgroup&quot;</span><span class="s1">] = color_id</span>

        <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;x0&quot;</span><span class="s1">])</span>
        <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;x&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;x1&quot;</span><span class="s1">])</span>
        <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(groupID)</span>
        <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;y&quot;</span><span class="s1">].append(groupID)</span>

        <span class="s0">if </span><span class="s2">&quot;description&quot; </span><span class="s0">in </span><span class="s1">tasks[index]:</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">])</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">])</span>
            <span class="s0">del </span><span class="s1">tasks[index][</span><span class="s2">&quot;description&quot;</span><span class="s1">]</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>
            <span class="s1">marker_data_dict[color_id][</span><span class="s2">&quot;text&quot;</span><span class="s1">].append(</span><span class="s0">None</span><span class="s1">)</span>

    <span class="s0">if </span><span class="s1">show_colorbar </span><span class="s0">is True</span><span class="s1">:</span>
        <span class="s1">showlegend = </span><span class="s0">True</span>

    <span class="s0">for </span><span class="s1">index_value </span><span class="s0">in </span><span class="s1">index_vals:</span>
        <span class="s1">scatter_data_dict[colors[index_value]][</span><span class="s2">&quot;name&quot;</span><span class="s1">] = str(index_value)</span>

    <span class="s1">layout = dict(</span>
        <span class="s1">title=title</span><span class="s0">,</span>
        <span class="s1">showlegend=showlegend</span><span class="s0">,</span>
        <span class="s1">height=height</span><span class="s0">,</span>
        <span class="s1">width=width</span><span class="s0">,</span>
        <span class="s1">shapes=[]</span><span class="s0">,</span>
        <span class="s1">hovermode=</span><span class="s2">&quot;closest&quot;</span><span class="s0">,</span>
        <span class="s1">yaxis=dict(</span>
            <span class="s1">showgrid=showgrid_y</span><span class="s0">,</span>
            <span class="s1">ticktext=task_names</span><span class="s0">,</span>
            <span class="s1">tickvals=list(range(len(task_names)))</span><span class="s0">,</span>
            <span class="s1">range=[-</span><span class="s5">1</span><span class="s0">, </span><span class="s1">len(task_names) + </span><span class="s5">1</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">autorange=</span><span class="s0">False,</span>
            <span class="s1">zeroline=</span><span class="s0">False,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">xaxis=dict(</span>
            <span class="s1">showgrid=showgrid_x</span><span class="s0">,</span>
            <span class="s1">zeroline=</span><span class="s0">False,</span>
            <span class="s1">rangeselector=dict(</span>
                <span class="s1">buttons=list(</span>
                    <span class="s1">[</span>
                        <span class="s1">dict(count=</span><span class="s5">7</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1w&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;day&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1m&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;month&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">6</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;6m&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;month&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;YTD&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;year&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;todate&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(count=</span><span class="s5">1</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;1y&quot;</span><span class="s0">, </span><span class="s1">step=</span><span class="s2">&quot;year&quot;</span><span class="s0">, </span><span class="s1">stepmode=</span><span class="s2">&quot;backward&quot;</span><span class="s1">)</span><span class="s0">,</span>
                        <span class="s1">dict(step=</span><span class="s2">&quot;all&quot;</span><span class="s1">)</span><span class="s0">,</span>
                    <span class="s1">]</span>
                <span class="s1">)</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s1">type=</span><span class="s2">&quot;date&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">)</span>

    <span class="s1">data = [scatter_data_dict[k] </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">sorted(scatter_data_dict)]</span>
    <span class="s1">data += [marker_data_dict[k] </span><span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">sorted(marker_data_dict)]</span>

    <span class="s4"># fig = dict(</span>
    <span class="s4">#      data=data, layout=layout</span>
    <span class="s4"># )</span>
    <span class="s1">fig = go.Figure(data=data</span><span class="s0">, </span><span class="s1">layout=layout)</span>
    <span class="s0">return </span><span class="s1">fig</span>


<span class="s0">def </span><span class="s1">create_gantt(</span>
    <span class="s1">df</span><span class="s0">,</span>
    <span class="s1">colors=</span><span class="s0">None,</span>
    <span class="s1">index_col=</span><span class="s0">None,</span>
    <span class="s1">show_colorbar=</span><span class="s0">False,</span>
    <span class="s1">reverse_colors=</span><span class="s0">False,</span>
    <span class="s1">title=</span><span class="s2">&quot;Gantt Chart&quot;</span><span class="s0">,</span>
    <span class="s1">bar_width=</span><span class="s5">0.2</span><span class="s0">,</span>
    <span class="s1">showgrid_x=</span><span class="s0">False,</span>
    <span class="s1">showgrid_y=</span><span class="s0">False,</span>
    <span class="s1">height=</span><span class="s5">600</span><span class="s0">,</span>
    <span class="s1">width=</span><span class="s0">None,</span>
    <span class="s1">tasks=</span><span class="s0">None,</span>
    <span class="s1">task_names=</span><span class="s0">None,</span>
    <span class="s1">data=</span><span class="s0">None,</span>
    <span class="s1">group_tasks=</span><span class="s0">False,</span>
    <span class="s1">show_hover_fill=</span><span class="s0">True,</span>
<span class="s1">):</span>
    <span class="s3">&quot;&quot;&quot; 
    **deprecated**, use instead 
    :func:`plotly.express.timeline`. 
 
    Returns figure for a gantt chart 
 
    :param (array|list) df: input data for gantt chart. Must be either a 
        a dataframe or a list. If dataframe, the columns must include 
        'Task', 'Start' and 'Finish'. Other columns can be included and 
        used for indexing. If a list, its elements must be dictionaries 
        with the same required column headers: 'Task', 'Start' and 
        'Finish'. 
    :param (str|list|dict|tuple) colors: either a plotly scale name, an 
        rgb or hex color, a color tuple or a list of colors. An rgb color 
        is of the form 'rgb(x, y, z)' where x, y, z belong to the interval 
        [0, 255] and a color tuple is a tuple of the form (a, b, c) where 
        a, b and c belong to [0, 1]. If colors is a list, it must 
        contain the valid color types aforementioned as its members. 
        If a dictionary, all values of the indexing column must be keys in 
        colors. 
    :param (str|float) index_col: the column header (if df is a data 
        frame) that will function as the indexing column. If df is a list, 
        index_col must be one of the keys in all the items of df. 
    :param (bool) show_colorbar: determines if colorbar will be visible. 
        Only applies if values in the index column are numeric. 
    :param (bool) show_hover_fill: enables/disables the hovertext for the 
        filled area of the chart. 
    :param (bool) reverse_colors: reverses the order of selected colors 
    :param (str) title: the title of the chart 
    :param (float) bar_width: the width of the horizontal bars in the plot 
    :param (bool) showgrid_x: show/hide the x-axis grid 
    :param (bool) showgrid_y: show/hide the y-axis grid 
    :param (float) height: the height of the chart 
    :param (float) width: the width of the chart 
 
    Example 1: Simple Gantt Chart 
 
    &gt;&gt;&gt; from plotly.figure_factory import create_gantt 
 
    &gt;&gt;&gt; # Make data for chart 
    &gt;&gt;&gt; df = [dict(Task=&quot;Job A&quot;, Start='2009-01-01', Finish='2009-02-30'), 
    ...       dict(Task=&quot;Job B&quot;, Start='2009-03-05', Finish='2009-04-15'), 
    ...       dict(Task=&quot;Job C&quot;, Start='2009-02-20', Finish='2009-05-30')] 
 
    &gt;&gt;&gt; # Create a figure 
    &gt;&gt;&gt; fig = create_gantt(df) 
    &gt;&gt;&gt; fig.show() 
 
 
    Example 2: Index by Column with Numerical Entries 
 
    &gt;&gt;&gt; from plotly.figure_factory import create_gantt 
 
    &gt;&gt;&gt; # Make data for chart 
    &gt;&gt;&gt; df = [dict(Task=&quot;Job A&quot;, Start='2009-01-01', 
    ...            Finish='2009-02-30', Complete=10), 
    ...       dict(Task=&quot;Job B&quot;, Start='2009-03-05', 
    ...            Finish='2009-04-15', Complete=60), 
    ...       dict(Task=&quot;Job C&quot;, Start='2009-02-20', 
    ...            Finish='2009-05-30', Complete=95)] 
 
    &gt;&gt;&gt; # Create a figure with Plotly colorscale 
    &gt;&gt;&gt; fig = create_gantt(df, colors='Blues', index_col='Complete', 
    ...                    show_colorbar=True, bar_width=0.5, 
    ...                    showgrid_x=True, showgrid_y=True) 
    &gt;&gt;&gt; fig.show() 
 
 
    Example 3: Index by Column with String Entries 
 
    &gt;&gt;&gt; from plotly.figure_factory import create_gantt 
 
    &gt;&gt;&gt; # Make data for chart 
    &gt;&gt;&gt; df = [dict(Task=&quot;Job A&quot;, Start='2009-01-01', 
    ...            Finish='2009-02-30', Resource='Apple'), 
    ...       dict(Task=&quot;Job B&quot;, Start='2009-03-05', 
    ...            Finish='2009-04-15', Resource='Grape'), 
    ...       dict(Task=&quot;Job C&quot;, Start='2009-02-20', 
    ...            Finish='2009-05-30', Resource='Banana')] 
 
    &gt;&gt;&gt; # Create a figure with Plotly colorscale 
    &gt;&gt;&gt; fig = create_gantt(df, colors=['rgb(200, 50, 25)', (1, 0, 1), '#6c4774'], 
    ...                    index_col='Resource', reverse_colors=True, 
    ...                    show_colorbar=True) 
    &gt;&gt;&gt; fig.show() 
 
 
    Example 4: Use a dictionary for colors 
 
    &gt;&gt;&gt; from plotly.figure_factory import create_gantt 
    &gt;&gt;&gt; # Make data for chart 
    &gt;&gt;&gt; df = [dict(Task=&quot;Job A&quot;, Start='2009-01-01', 
    ...            Finish='2009-02-30', Resource='Apple'), 
    ...       dict(Task=&quot;Job B&quot;, Start='2009-03-05', 
    ...            Finish='2009-04-15', Resource='Grape'), 
    ...       dict(Task=&quot;Job C&quot;, Start='2009-02-20', 
    ...            Finish='2009-05-30', Resource='Banana')] 
 
    &gt;&gt;&gt; # Make a dictionary of colors 
    &gt;&gt;&gt; colors = {'Apple': 'rgb(255, 0, 0)', 
    ...           'Grape': 'rgb(170, 14, 200)', 
    ...           'Banana': (1, 1, 0.2)} 
 
    &gt;&gt;&gt; # Create a figure with Plotly colorscale 
    &gt;&gt;&gt; fig = create_gantt(df, colors=colors, index_col='Resource', 
    ...                    show_colorbar=True) 
 
    &gt;&gt;&gt; fig.show() 
 
    Example 5: Use a pandas dataframe 
 
    &gt;&gt;&gt; from plotly.figure_factory import create_gantt 
    &gt;&gt;&gt; import pandas as pd 
 
    &gt;&gt;&gt; # Make data as a dataframe 
    &gt;&gt;&gt; df = pd.DataFrame([['Run', '2010-01-01', '2011-02-02', 10], 
    ...                    ['Fast', '2011-01-01', '2012-06-05', 55], 
    ...                    ['Eat', '2012-01-05', '2013-07-05', 94]], 
    ...                   columns=['Task', 'Start', 'Finish', 'Complete']) 
 
    &gt;&gt;&gt; # Create a figure with Plotly colorscale 
    &gt;&gt;&gt; fig = create_gantt(df, colors='Blues', index_col='Complete', 
    ...                    show_colorbar=True, bar_width=0.5, 
    ...                    showgrid_x=True, showgrid_y=True) 
    &gt;&gt;&gt; fig.show() 
    &quot;&quot;&quot;</span>
    <span class="s4"># validate gantt input data</span>
    <span class="s1">chart = validate_gantt(df)</span>

    <span class="s0">if </span><span class="s1">index_col:</span>
        <span class="s0">if </span><span class="s1">index_col </span><span class="s0">not in </span><span class="s1">chart[</span><span class="s5">0</span><span class="s1">]:</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;In order to use an indexing column and assign colors to &quot;</span>
                <span class="s2">&quot;the values of the index, you must choose an actual &quot;</span>
                <span class="s2">&quot;column name in the dataframe or key if a list of &quot;</span>
                <span class="s2">&quot;dictionaries is being used.&quot;</span>
            <span class="s1">)</span>

        <span class="s4"># validate gantt index column</span>
        <span class="s1">index_list = []</span>
        <span class="s0">for </span><span class="s1">dictionary </span><span class="s0">in </span><span class="s1">chart:</span>
            <span class="s1">index_list.append(dictionary[index_col])</span>
        <span class="s1">utils.validate_index(index_list)</span>

    <span class="s4"># Validate colors</span>
    <span class="s0">if </span><span class="s1">isinstance(colors</span><span class="s0">, </span><span class="s1">dict):</span>
        <span class="s1">colors = clrs.validate_colors_dict(colors</span><span class="s0">, </span><span class="s2">&quot;rgb&quot;</span><span class="s1">)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">colors = clrs.validate_colors(colors</span><span class="s0">, </span><span class="s2">&quot;rgb&quot;</span><span class="s1">)</span>

    <span class="s0">if </span><span class="s1">reverse_colors </span><span class="s0">is True</span><span class="s1">:</span>
        <span class="s1">colors.reverse()</span>

    <span class="s0">if not </span><span class="s1">index_col:</span>
        <span class="s0">if </span><span class="s1">isinstance(colors</span><span class="s0">, </span><span class="s1">dict):</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;Error. You have set colors to a dictionary but have not &quot;</span>
                <span class="s2">&quot;picked an index. An index is required if you are &quot;</span>
                <span class="s2">&quot;assigning colors to particular values in a dictionary.&quot;</span>
            <span class="s1">)</span>
        <span class="s1">fig = gantt(</span>
            <span class="s1">chart</span><span class="s0">,</span>
            <span class="s1">colors</span><span class="s0">,</span>
            <span class="s1">title</span><span class="s0">,</span>
            <span class="s1">bar_width</span><span class="s0">,</span>
            <span class="s1">showgrid_x</span><span class="s0">,</span>
            <span class="s1">showgrid_y</span><span class="s0">,</span>
            <span class="s1">height</span><span class="s0">,</span>
            <span class="s1">width</span><span class="s0">,</span>
            <span class="s1">tasks=</span><span class="s0">None,</span>
            <span class="s1">task_names=</span><span class="s0">None,</span>
            <span class="s1">data=</span><span class="s0">None,</span>
            <span class="s1">group_tasks=group_tasks</span><span class="s0">,</span>
            <span class="s1">show_hover_fill=show_hover_fill</span><span class="s0">,</span>
            <span class="s1">show_colorbar=show_colorbar</span><span class="s0">,</span>
        <span class="s1">)</span>
        <span class="s0">return </span><span class="s1">fig</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">if not </span><span class="s1">isinstance(colors</span><span class="s0">, </span><span class="s1">dict):</span>
            <span class="s1">fig = gantt_colorscale(</span>
                <span class="s1">chart</span><span class="s0">,</span>
                <span class="s1">colors</span><span class="s0">,</span>
                <span class="s1">title</span><span class="s0">,</span>
                <span class="s1">index_col</span><span class="s0">,</span>
                <span class="s1">show_colorbar</span><span class="s0">,</span>
                <span class="s1">bar_width</span><span class="s0">,</span>
                <span class="s1">showgrid_x</span><span class="s0">,</span>
                <span class="s1">showgrid_y</span><span class="s0">,</span>
                <span class="s1">height</span><span class="s0">,</span>
                <span class="s1">width</span><span class="s0">,</span>
                <span class="s1">tasks=</span><span class="s0">None,</span>
                <span class="s1">task_names=</span><span class="s0">None,</span>
                <span class="s1">data=</span><span class="s0">None,</span>
                <span class="s1">group_tasks=group_tasks</span><span class="s0">,</span>
                <span class="s1">show_hover_fill=show_hover_fill</span><span class="s0">,</span>
            <span class="s1">)</span>
            <span class="s0">return </span><span class="s1">fig</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">fig = gantt_dict(</span>
                <span class="s1">chart</span><span class="s0">,</span>
                <span class="s1">colors</span><span class="s0">,</span>
                <span class="s1">title</span><span class="s0">,</span>
                <span class="s1">index_col</span><span class="s0">,</span>
                <span class="s1">show_colorbar</span><span class="s0">,</span>
                <span class="s1">bar_width</span><span class="s0">,</span>
                <span class="s1">showgrid_x</span><span class="s0">,</span>
                <span class="s1">showgrid_y</span><span class="s0">,</span>
                <span class="s1">height</span><span class="s0">,</span>
                <span class="s1">width</span><span class="s0">,</span>
                <span class="s1">tasks=</span><span class="s0">None,</span>
                <span class="s1">task_names=</span><span class="s0">None,</span>
                <span class="s1">data=</span><span class="s0">None,</span>
                <span class="s1">group_tasks=group_tasks</span><span class="s0">,</span>
                <span class="s1">show_hover_fill=show_hover_fill</span><span class="s0">,</span>
            <span class="s1">)</span>
            <span class="s0">return </span><span class="s1">fig</span>
</pre>
</body>
</html>