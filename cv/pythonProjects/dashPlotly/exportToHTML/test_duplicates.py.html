<html>
<head>
<title>test_duplicates.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_duplicates.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">itertools </span><span class="s0">import </span><span class="s1">product</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">from </span><span class="s1">pandas._libs </span><span class="s0">import </span><span class="s1">hashtable</span>

<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">DatetimeIndex</span><span class="s0">,</span>
    <span class="s1">MultiIndex</span><span class="s0">,</span>
    <span class="s1">Series</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">import </span><span class="s1">pandas._testing </span><span class="s0">as </span><span class="s1">tm</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;names&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">None, </span><span class="s1">[</span><span class="s2">&quot;first&quot;</span><span class="s0">, </span><span class="s2">&quot;second&quot;</span><span class="s1">]])</span>
<span class="s0">def </span><span class="s1">test_unique(names):</span>
    <span class="s1">mi = MultiIndex.from_arrays([[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=names)</span>

    <span class="s1">res = mi.unique()</span>
    <span class="s1">exp = MultiIndex.from_arrays([[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=mi.names)</span>
    <span class="s1">tm.assert_index_equal(res</span><span class="s0">, </span><span class="s1">exp)</span>

    <span class="s1">mi = MultiIndex.from_arrays([list(</span><span class="s2">&quot;aaaa&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">list(</span><span class="s2">&quot;abab&quot;</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">names=names)</span>
    <span class="s1">res = mi.unique()</span>
    <span class="s1">exp = MultiIndex.from_arrays([list(</span><span class="s2">&quot;aa&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">list(</span><span class="s2">&quot;ab&quot;</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">names=mi.names)</span>
    <span class="s1">tm.assert_index_equal(res</span><span class="s0">, </span><span class="s1">exp)</span>

    <span class="s1">mi = MultiIndex.from_arrays([list(</span><span class="s2">&quot;aaaa&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">list(</span><span class="s2">&quot;aaaa&quot;</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">names=names)</span>
    <span class="s1">res = mi.unique()</span>
    <span class="s1">exp = MultiIndex.from_arrays([[</span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;a&quot;</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=mi.names)</span>
    <span class="s1">tm.assert_index_equal(res</span><span class="s0">, </span><span class="s1">exp)</span>

    <span class="s4"># GH #20568 - empty MI</span>
    <span class="s1">mi = MultiIndex.from_arrays([[]</span><span class="s0">, </span><span class="s1">[]]</span><span class="s0">, </span><span class="s1">names=names)</span>
    <span class="s1">res = mi.unique()</span>
    <span class="s1">tm.assert_index_equal(mi</span><span class="s0">, </span><span class="s1">res)</span>


<span class="s0">def </span><span class="s1">test_unique_datetimelike():</span>
    <span class="s1">idx1 = DatetimeIndex(</span>
        <span class="s1">[</span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;NaT&quot;</span><span class="s0">, </span><span class="s2">&quot;NaT&quot;</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">idx2 = DatetimeIndex(</span>
        <span class="s1">[</span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-02&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-02&quot;</span><span class="s0">, </span><span class="s2">&quot;NaT&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-01&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">tz=</span><span class="s2">&quot;Asia/Tokyo&quot;</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">result = MultiIndex.from_arrays([idx1</span><span class="s0">, </span><span class="s1">idx2]).unique()</span>

    <span class="s1">eidx1 = DatetimeIndex([</span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;NaT&quot;</span><span class="s0">, </span><span class="s2">&quot;NaT&quot;</span><span class="s1">])</span>
    <span class="s1">eidx2 = DatetimeIndex(</span>
        <span class="s1">[</span><span class="s2">&quot;2015-01-01&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-02&quot;</span><span class="s0">, </span><span class="s2">&quot;NaT&quot;</span><span class="s0">, </span><span class="s2">&quot;2015-01-01&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">tz=</span><span class="s2">&quot;Asia/Tokyo&quot;</span>
    <span class="s1">)</span>
    <span class="s1">exp = MultiIndex.from_arrays([eidx1</span><span class="s0">, </span><span class="s1">eidx2])</span>
    <span class="s1">tm.assert_index_equal(result</span><span class="s0">, </span><span class="s1">exp)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;level&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s2">&quot;first&quot;</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s2">&quot;second&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_unique_level(idx</span><span class="s0">, </span><span class="s1">level):</span>
    <span class="s4"># GH #17896 - with level= argument</span>
    <span class="s1">result = idx.unique(level=level)</span>
    <span class="s1">expected = idx.get_level_values(level).unique()</span>
    <span class="s1">tm.assert_index_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s4"># With already unique level</span>
    <span class="s1">mi = MultiIndex.from_arrays([[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;first&quot;</span><span class="s0">, </span><span class="s2">&quot;second&quot;</span><span class="s1">])</span>
    <span class="s1">result = mi.unique(level=level)</span>
    <span class="s1">expected = mi.get_level_values(level)</span>
    <span class="s1">tm.assert_index_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s4"># With empty MI</span>
    <span class="s1">mi = MultiIndex.from_arrays([[]</span><span class="s0">, </span><span class="s1">[]]</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;first&quot;</span><span class="s0">, </span><span class="s2">&quot;second&quot;</span><span class="s1">])</span>
    <span class="s1">result = mi.unique(level=level)</span>
    <span class="s1">expected = mi.get_level_values(level)</span>
    <span class="s1">tm.assert_index_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_duplicate_multiindex_codes():</span>
    <span class="s4"># GH 17464</span>
    <span class="s4"># Make sure that a MultiIndex with duplicate levels throws a ValueError</span>
    <span class="s1">msg = </span><span class="s2">r&quot;Level values must be unique: \[[A', ]+\] on level 0&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">mi = MultiIndex([[</span><span class="s2">&quot;A&quot;</span><span class="s1">] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">range(</span><span class="s3">10</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">0</span><span class="s1">] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">range(</span><span class="s3">10</span><span class="s1">)])</span>

    <span class="s4"># And that using set_levels with duplicate levels fails</span>
    <span class="s1">mi = MultiIndex.from_arrays([[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]])</span>
    <span class="s1">msg = </span><span class="s2">r&quot;Level values must be unique: \[[AB', ]+\] on level 0&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
            <span class="s1">mi.set_levels([[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">inplace=</span><span class="s0">True</span><span class="s1">)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;names&quot;</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]])</span>
<span class="s0">def </span><span class="s1">test_duplicate_level_names(names):</span>
    <span class="s4"># GH18872, GH19029</span>
    <span class="s1">mi = MultiIndex.from_product([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]] * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">names=names)</span>
    <span class="s0">assert </span><span class="s1">mi.names == names</span>

    <span class="s4"># With .rename()</span>
    <span class="s1">mi = MultiIndex.from_product([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]] * </span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">mi = mi.rename(names)</span>
    <span class="s0">assert </span><span class="s1">mi.names == names</span>

    <span class="s4"># With .rename(., level=)</span>
    <span class="s1">mi.rename(names[</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">level=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">inplace=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">mi = mi.rename([names[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">names[</span><span class="s3">2</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">level=[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
    <span class="s0">assert </span><span class="s1">mi.names == names</span>


<span class="s0">def </span><span class="s1">test_duplicate_meta_data():</span>
    <span class="s4"># GH 10115</span>
    <span class="s1">mi = MultiIndex(</span>
        <span class="s1">levels=[[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">codes=[[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span>
    <span class="s1">)</span>

    <span class="s0">for </span><span class="s1">idx </span><span class="s0">in </span><span class="s1">[</span>
        <span class="s1">mi</span><span class="s0">,</span>
        <span class="s1">mi.set_names([</span><span class="s0">None, None</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">mi.set_names([</span><span class="s0">None, </span><span class="s2">&quot;Num&quot;</span><span class="s1">])</span><span class="s0">,</span>
        <span class="s1">mi.set_names([</span><span class="s2">&quot;Upper&quot;</span><span class="s0">, </span><span class="s2">&quot;Num&quot;</span><span class="s1">])</span><span class="s0">,</span>
    <span class="s1">]:</span>
        <span class="s0">assert </span><span class="s1">idx.has_duplicates</span>
        <span class="s0">assert </span><span class="s1">idx.drop_duplicates().names == idx.names</span>


<span class="s0">def </span><span class="s1">test_has_duplicates(idx</span><span class="s0">, </span><span class="s1">idx_dup):</span>
    <span class="s4"># see fixtures</span>
    <span class="s0">assert </span><span class="s1">idx.is_unique </span><span class="s0">is True</span>
    <span class="s0">assert </span><span class="s1">idx.has_duplicates </span><span class="s0">is False</span>
    <span class="s0">assert </span><span class="s1">idx_dup.is_unique </span><span class="s0">is False</span>
    <span class="s0">assert </span><span class="s1">idx_dup.has_duplicates </span><span class="s0">is True</span>

    <span class="s1">mi = MultiIndex(</span>
        <span class="s1">levels=[[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">codes=[[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span>
    <span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">mi.is_unique </span><span class="s0">is False</span>
    <span class="s0">assert </span><span class="s1">mi.has_duplicates </span><span class="s0">is True</span>

    <span class="s4"># single instance of NaN</span>
    <span class="s1">mi_nan = MultiIndex(</span>
        <span class="s1">levels=[[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">codes=[[-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span>
    <span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">mi_nan.is_unique </span><span class="s0">is True</span>
    <span class="s0">assert </span><span class="s1">mi_nan.has_duplicates </span><span class="s0">is False</span>

    <span class="s4"># multiple instances of NaN</span>
    <span class="s1">mi_nan_dup = MultiIndex(</span>
        <span class="s1">levels=[[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">codes=[[-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span>
    <span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">mi_nan_dup.is_unique </span><span class="s0">is False</span>
    <span class="s0">assert </span><span class="s1">mi_nan_dup.has_duplicates </span><span class="s0">is True</span>


<span class="s0">def </span><span class="s1">test_has_duplicates_from_tuples():</span>
    <span class="s4"># GH 9075</span>
    <span class="s1">t = [</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">169</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">119</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">135</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">13</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">145</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">158</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">16</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">122</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">17</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">160</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">18</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">180</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">143</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">21</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">128</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">22</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">129</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">25</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">111</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">114</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">29</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">121</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">31</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">126</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">32</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">155</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">33</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">123</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;x&quot;</span><span class="s0">, </span><span class="s2">&quot;out&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s2">&quot;y&quot;</span><span class="s0">, </span><span class="s2">&quot;in&quot;</span><span class="s0">, </span><span class="s2">&quot;z&quot;</span><span class="s0">, </span><span class="s3">144</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span>

    <span class="s1">mi = MultiIndex.from_tuples(t)</span>
    <span class="s0">assert not </span><span class="s1">mi.has_duplicates</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;nlevels&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">8</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;with_nulls&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_has_duplicates_overflow(nlevels</span><span class="s0">, </span><span class="s1">with_nulls):</span>
    <span class="s4"># handle int64 overflow if possible</span>
    <span class="s4"># no overflow with 4</span>
    <span class="s4"># overflow possible with 8</span>
    <span class="s1">codes = np.tile(np.arange(</span><span class="s3">500</span><span class="s1">)</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
    <span class="s1">level = np.arange(</span><span class="s3">500</span><span class="s1">)</span>

    <span class="s0">if </span><span class="s1">with_nulls:  </span><span class="s4"># inject some null values</span>
        <span class="s1">codes[</span><span class="s3">500</span><span class="s1">] = -</span><span class="s3">1  </span><span class="s4"># common nan value</span>
        <span class="s1">codes = [codes.copy() </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(nlevels)]</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(nlevels):</span>
            <span class="s1">codes[i][</span><span class="s3">500 </span><span class="s1">+ i - nlevels // </span><span class="s3">2</span><span class="s1">] = -</span><span class="s3">1</span>

        <span class="s1">codes += [np.array([-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]).repeat(</span><span class="s3">500</span><span class="s1">)]</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">codes = [codes] * nlevels + [np.arange(</span><span class="s3">2</span><span class="s1">).repeat(</span><span class="s3">500</span><span class="s1">)]</span>

    <span class="s1">levels = [level] * nlevels + [[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span>

    <span class="s4"># no dups</span>
    <span class="s1">mi = MultiIndex(levels=levels</span><span class="s0">, </span><span class="s1">codes=codes)</span>
    <span class="s0">assert not </span><span class="s1">mi.has_duplicates</span>

    <span class="s4"># with a dup</span>
    <span class="s0">if </span><span class="s1">with_nulls:</span>

        <span class="s0">def </span><span class="s1">f(a):</span>
            <span class="s0">return </span><span class="s1">np.insert(a</span><span class="s0">, </span><span class="s3">1000</span><span class="s0">, </span><span class="s1">a[</span><span class="s3">0</span><span class="s1">])</span>

        <span class="s1">codes = list(map(f</span><span class="s0">, </span><span class="s1">codes))</span>
        <span class="s1">mi = MultiIndex(levels=levels</span><span class="s0">, </span><span class="s1">codes=codes)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">values = mi.values.tolist()</span>
        <span class="s1">mi = MultiIndex.from_tuples(values + [values[</span><span class="s3">0</span><span class="s1">]])</span>

    <span class="s0">assert </span><span class="s1">mi.has_duplicates</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;keep, expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s2">&quot;first&quot;</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s0">False, False, False, True, True, False</span><span class="s1">]))</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;last&quot;</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s0">False, True, True, False, False, False</span><span class="s1">]))</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s0">False, </span><span class="s1">np.array([</span><span class="s0">False, True, True, True, True, False</span><span class="s1">]))</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_duplicated(idx_dup</span><span class="s0">, </span><span class="s1">keep</span><span class="s0">, </span><span class="s1">expected):</span>
    <span class="s1">result = idx_dup.duplicated(keep=keep)</span>
    <span class="s1">tm.assert_numpy_array_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.arm_slow</span>
<span class="s0">def </span><span class="s1">test_duplicated_large(keep):</span>
    <span class="s4"># GH 9125</span>
    <span class="s1">n</span><span class="s0">, </span><span class="s1">k = </span><span class="s3">200</span><span class="s0">, </span><span class="s3">5000</span>
    <span class="s1">levels = [np.arange(n)</span><span class="s0">, </span><span class="s1">tm.makeStringIndex(n)</span><span class="s0">, </span><span class="s3">1000 </span><span class="s1">+ np.arange(n)]</span>
    <span class="s1">codes = [np.random.choice(n</span><span class="s0">, </span><span class="s1">k * n) </span><span class="s0">for </span><span class="s1">lev </span><span class="s0">in </span><span class="s1">levels]</span>
    <span class="s1">mi = MultiIndex(levels=levels</span><span class="s0">, </span><span class="s1">codes=codes)</span>

    <span class="s1">result = mi.duplicated(keep=keep)</span>
    <span class="s1">expected = hashtable.duplicated(mi.values</span><span class="s0">, </span><span class="s1">keep=keep)</span>
    <span class="s1">tm.assert_numpy_array_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_duplicated2():</span>
    <span class="s4"># TODO: more informative test name</span>
    <span class="s4"># GH5873</span>
    <span class="s0">for </span><span class="s1">a </span><span class="s0">in </span><span class="s1">[</span><span class="s3">101</span><span class="s0">, </span><span class="s3">102</span><span class="s1">]:</span>
        <span class="s1">mi = MultiIndex.from_arrays([[</span><span class="s3">101</span><span class="s0">, </span><span class="s1">a]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">3.5</span><span class="s0">, </span><span class="s1">np.nan]])</span>
        <span class="s0">assert not </span><span class="s1">mi.has_duplicates</span>

        <span class="s1">tm.assert_numpy_array_equal(mi.duplicated()</span><span class="s0">, </span><span class="s1">np.zeros(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">&quot;bool&quot;</span><span class="s1">))</span>

    <span class="s0">for </span><span class="s1">n </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">6</span><span class="s1">):  </span><span class="s4"># 1st level shape</span>
        <span class="s0">for </span><span class="s1">m </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s1">):  </span><span class="s4"># 2nd level shape</span>
            <span class="s4"># all possible unique combinations, including nan</span>
            <span class="s1">codes = product(range(-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">n)</span><span class="s0">, </span><span class="s1">range(-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">m))</span>
            <span class="s1">mi = MultiIndex(</span>
                <span class="s1">levels=[list(</span><span class="s2">&quot;abcde&quot;</span><span class="s1">)[:n]</span><span class="s0">, </span><span class="s1">list(</span><span class="s2">&quot;WXYZ&quot;</span><span class="s1">)[:m]]</span><span class="s0">,</span>
                <span class="s1">codes=np.random.permutation(list(codes)).T</span><span class="s0">,</span>
            <span class="s1">)</span>
            <span class="s0">assert </span><span class="s1">len(mi) == (n + </span><span class="s3">1</span><span class="s1">) * (m + </span><span class="s3">1</span><span class="s1">)</span>
            <span class="s0">assert not </span><span class="s1">mi.has_duplicates</span>

            <span class="s1">tm.assert_numpy_array_equal(</span>
                <span class="s1">mi.duplicated()</span><span class="s0">, </span><span class="s1">np.zeros(len(mi)</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">&quot;bool&quot;</span><span class="s1">)</span>
            <span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_duplicated_drop_duplicates():</span>
    <span class="s4"># GH#4060</span>
    <span class="s1">idx = MultiIndex.from_arrays(([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]))</span>

    <span class="s1">expected = np.array([</span><span class="s0">False, False, False, True, False, False</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=bool)</span>
    <span class="s1">duplicated = idx.duplicated()</span>
    <span class="s1">tm.assert_numpy_array_equal(duplicated</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">duplicated.dtype == bool</span>
    <span class="s1">expected = MultiIndex.from_arrays(([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]))</span>
    <span class="s1">tm.assert_index_equal(idx.drop_duplicates()</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">expected = np.array([</span><span class="s0">True, False, False, False, False, False</span><span class="s1">])</span>
    <span class="s1">duplicated = idx.duplicated(keep=</span><span class="s2">&quot;last&quot;</span><span class="s1">)</span>
    <span class="s1">tm.assert_numpy_array_equal(duplicated</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">duplicated.dtype == bool</span>
    <span class="s1">expected = MultiIndex.from_arrays(([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]))</span>
    <span class="s1">tm.assert_index_equal(idx.drop_duplicates(keep=</span><span class="s2">&quot;last&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s1">expected = np.array([</span><span class="s0">True, False, False, True, False, False</span><span class="s1">])</span>
    <span class="s1">duplicated = idx.duplicated(keep=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">tm.assert_numpy_array_equal(duplicated</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">duplicated.dtype == bool</span>
    <span class="s1">expected = MultiIndex.from_arrays(([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]))</span>
    <span class="s1">tm.assert_index_equal(idx.drop_duplicates(keep=</span><span class="s0">False</span><span class="s1">)</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;dtype&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">np.complex64</span><span class="s0">,</span>
        <span class="s1">np.complex128</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_duplicated_series_complex_numbers(dtype):</span>
    <span class="s4"># GH 17927</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[</span><span class="s0">False, False, False, True, False, False, False, True, False, True</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=bool</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">result = Series(</span>
        <span class="s1">[</span>
            <span class="s1">np.nan + np.nan * </span><span class="s3">1j</span><span class="s0">,</span>
            <span class="s3">0</span><span class="s0">,</span>
            <span class="s3">1j</span><span class="s0">,</span>
            <span class="s3">1j</span><span class="s0">,</span>
            <span class="s3">1</span><span class="s0">,</span>
            <span class="s3">1 </span><span class="s1">+ </span><span class="s3">1j</span><span class="s0">,</span>
            <span class="s3">1 </span><span class="s1">+ </span><span class="s3">2j</span><span class="s0">,</span>
            <span class="s3">1 </span><span class="s1">+ </span><span class="s3">1j</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan + np.nan * </span><span class="s3">1j</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s1">dtype=dtype</span><span class="s0">,</span>
    <span class="s1">).duplicated()</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_multi_drop_duplicates_pos_args_deprecation():</span>
    <span class="s4"># GH#41485</span>
    <span class="s1">idx = MultiIndex.from_arrays([[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]])</span>
    <span class="s1">msg = (</span>
        <span class="s2">&quot;In a future version of pandas all arguments of &quot;</span>
        <span class="s2">&quot;MultiIndex.drop_duplicates will be keyword-only&quot;</span>
    <span class="s1">)</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">result = idx.drop_duplicates(</span><span class="s2">&quot;last&quot;</span><span class="s1">)</span>
    <span class="s1">expected = MultiIndex.from_arrays([[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]])</span>
    <span class="s1">tm.assert_index_equal(expected</span><span class="s0">, </span><span class="s1">result)</span>
</pre>
</body>
</html>