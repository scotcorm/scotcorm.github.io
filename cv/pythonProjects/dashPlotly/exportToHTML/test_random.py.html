<html>
<head>
<title>test_random.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6897bb;}
.s3 { color: #808080;}
.s4 { color: #6a8759;}
.s5 { color: #a5c261;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_random.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">warnings</span>

<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">(</span>
        <span class="s1">assert_</span><span class="s0">, </span><span class="s1">assert_raises</span><span class="s0">, </span><span class="s1">assert_equal</span><span class="s0">, </span><span class="s1">assert_warns</span><span class="s0">,</span>
        <span class="s1">assert_no_warnings</span><span class="s0">, </span><span class="s1">assert_array_equal</span><span class="s0">, </span><span class="s1">assert_array_almost_equal</span><span class="s0">,</span>
        <span class="s1">suppress_warnings</span>
        <span class="s1">)</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">random</span>
<span class="s0">import </span><span class="s1">sys</span>


<span class="s0">class </span><span class="s1">TestSeed:</span>
    <span class="s0">def </span><span class="s1">test_scalar(self):</span>
        <span class="s1">s = np.random.RandomState(</span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s2">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s2">684</span><span class="s1">)</span>
        <span class="s1">s = np.random.RandomState(</span><span class="s2">4294967295</span><span class="s1">)</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s2">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s2">419</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_array(self):</span>
        <span class="s1">s = np.random.RandomState(range(</span><span class="s2">10</span><span class="s1">))</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s2">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s2">468</span><span class="s1">)</span>
        <span class="s1">s = np.random.RandomState(np.arange(</span><span class="s2">10</span><span class="s1">))</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s2">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s2">468</span><span class="s1">)</span>
        <span class="s1">s = np.random.RandomState([</span><span class="s2">0</span><span class="s1">])</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s2">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s2">973</span><span class="s1">)</span>
        <span class="s1">s = np.random.RandomState([</span><span class="s2">4294967295</span><span class="s1">])</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s2">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s2">265</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_scalar(self):</span>
        <span class="s3"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.5</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_array(self):</span>
        <span class="s3"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">[-</span><span class="s2">0.5</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">[-</span><span class="s2">1</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">[</span><span class="s2">4294967296</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">4294967296</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s0">, </span><span class="s2">4294967296</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_invalid_array_shape(self):</span>
        <span class="s3"># gh-9832</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">,</span>
                      <span class="s1">np.array([]</span><span class="s0">, </span><span class="s1">dtype=np.int64))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.RandomState</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">,</span>
                                                          <span class="s1">[</span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s1">]])</span>


<span class="s0">class </span><span class="s1">TestBinomial:</span>
    <span class="s0">def </span><span class="s1">test_n_zero(self):</span>
        <span class="s3"># Tests the corner case of n == 0 for the binomial distribution.</span>
        <span class="s3"># binomial(0, p) should be zero for any p in [0, 1].</span>
        <span class="s3"># This test addresses issue #3480.</span>
        <span class="s1">zeros = np.zeros(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s4">'int'</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">p </span><span class="s0">in </span><span class="s1">[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">.5</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]:</span>
            <span class="s1">assert_(random.binomial(</span><span class="s2">0</span><span class="s0">, </span><span class="s1">p) == </span><span class="s2">0</span><span class="s1">)</span>
            <span class="s1">assert_array_equal(random.binomial(zeros</span><span class="s0">, </span><span class="s1">p)</span><span class="s0">, </span><span class="s1">zeros)</span>

    <span class="s0">def </span><span class="s1">test_p_is_nan(self):</span>
        <span class="s3"># Issue #4571.</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.binomial</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s1">np.nan)</span>


<span class="s0">class </span><span class="s1">TestMultinomial:</span>
    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">random.multinomial(</span><span class="s2">100</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0.2</span><span class="s0">, </span><span class="s2">0.8</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_zero_probability(self):</span>
        <span class="s1">random.multinomial(</span><span class="s2">100</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0.2</span><span class="s0">, </span><span class="s2">0.8</span><span class="s0">, </span><span class="s2">0.0</span><span class="s0">, </span><span class="s2">0.0</span><span class="s0">, </span><span class="s2">0.0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_int_negative_interval(self):</span>
        <span class="s1">assert_(-</span><span class="s2">5 </span><span class="s1">&lt;= random.randint(-</span><span class="s2">5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s1">) &lt; -</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">x = random.randint(-</span><span class="s2">5</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">5</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(-</span><span class="s2">5 </span><span class="s1">&lt;= x))</span>
        <span class="s1">assert_(np.all(x &lt; -</span><span class="s2">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_size(self):</span>
        <span class="s3"># gh-3173</span>
        <span class="s1">p = [</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">]</span>
        <span class="s1">assert_equal(np.random.multinomial(</span><span class="s2">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s2">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.multinomial(</span><span class="s2">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s2">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.multinomial(</span><span class="s2">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s2">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.multinomial(</span><span class="s2">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.multinomial(</span><span class="s2">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.multinomial(</span><span class="s2">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.array((</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))).shape</span><span class="s0">,</span>
                     <span class="s1">(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>

        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.random.multinomial</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">,</span>
                      <span class="s1">float(</span><span class="s2">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_multidimensional_pvals(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.multinomial</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.multinomial</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.multinomial</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s1">[[[</span><span class="s2">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0</span><span class="s1">]]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.multinomial</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s1">np.array([[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s1">]]))</span>


<span class="s0">class </span><span class="s1">TestSetState:</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s2">1234567890</span>
        <span class="s1">self.prng = random.RandomState(self.seed)</span>
        <span class="s1">self.state = self.prng.get_state()</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">old = self.prng.tomaxint(</span><span class="s2">16</span><span class="s1">)</span>
        <span class="s1">self.prng.set_state(self.state)</span>
        <span class="s1">new = self.prng.tomaxint(</span><span class="s2">16</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(old == new))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset(self):</span>
        <span class="s3"># Make sure the cached every-other-Gaussian is reset.</span>
        <span class="s1">old = self.prng.standard_normal(size=</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">self.prng.set_state(self.state)</span>
        <span class="s1">new = self.prng.standard_normal(size=</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(old == new))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset_in_media_res(self):</span>
        <span class="s3"># When the state is saved with a cached Gaussian, make sure the</span>
        <span class="s3"># cached Gaussian is restored.</span>

        <span class="s1">self.prng.standard_normal()</span>
        <span class="s1">state = self.prng.get_state()</span>
        <span class="s1">old = self.prng.standard_normal(size=</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">self.prng.set_state(state)</span>
        <span class="s1">new = self.prng.standard_normal(size=</span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(old == new))</span>

    <span class="s0">def </span><span class="s1">test_backwards_compatibility(self):</span>
        <span class="s3"># Make sure we can accept old state tuples that do not have the</span>
        <span class="s3"># cached Gaussian value.</span>
        <span class="s1">old_state = self.state[:-</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">x1 = self.prng.standard_normal(size=</span><span class="s2">16</span><span class="s1">)</span>
        <span class="s1">self.prng.set_state(old_state)</span>
        <span class="s1">x2 = self.prng.standard_normal(size=</span><span class="s2">16</span><span class="s1">)</span>
        <span class="s1">self.prng.set_state(self.state)</span>
        <span class="s1">x3 = self.prng.standard_normal(size=</span><span class="s2">16</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(x1 == x2))</span>
        <span class="s1">assert_(np.all(x1 == x3))</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s3"># Ensure that the negative binomial results take floating point</span>
        <span class="s3"># arguments without truncation.</span>
        <span class="s1">self.prng.negative_binomial(</span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.5</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestRandint:</span>

    <span class="s1">rfunc = np.random.randint</span>

    <span class="s3"># valid integer/boolean types</span>
    <span class="s1">itype = [np.bool_</span><span class="s0">, </span><span class="s1">np.int8</span><span class="s0">, </span><span class="s1">np.uint8</span><span class="s0">, </span><span class="s1">np.int16</span><span class="s0">, </span><span class="s1">np.uint16</span><span class="s0">,</span>
             <span class="s1">np.int32</span><span class="s0">, </span><span class="s1">np.uint32</span><span class="s0">, </span><span class="s1">np.int64</span><span class="s0">, </span><span class="s1">np.uint64]</span>

    <span class="s0">def </span><span class="s1">test_unsupported_type(self):</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s1">dtype=float)</span>

    <span class="s0">def </span><span class="s1">test_bounds_checking(self):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s2">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s2">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s2">1</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">lbnd - </span><span class="s2">1</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">lbnd</span><span class="s0">, </span><span class="s1">ubnd + </span><span class="s2">1</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">lbnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s1">dtype=dt)</span>

    <span class="s0">def </span><span class="s1">test_rng_zero_and_extremes(self):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s2">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s2">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s2">1</span>

            <span class="s1">tgt = ubnd - </span><span class="s2">1</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + </span><span class="s2">1</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">1000</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

            <span class="s1">tgt = lbnd</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + </span><span class="s2">1</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">1000</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

            <span class="s1">tgt = (lbnd + ubnd)//</span><span class="s2">2</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + </span><span class="s2">1</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">1000</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

    <span class="s0">def </span><span class="s1">test_full_range(self):</span>
        <span class="s3"># Test for ticket #1690</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s2">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s2">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s2">1</span>

            <span class="s0">try</span><span class="s1">:</span>
                <span class="s1">self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e:</span>
                <span class="s0">raise </span><span class="s1">AssertionError(</span><span class="s4">&quot;No error should have been raised, &quot;</span>
                                     <span class="s4">&quot;but one was with the following &quot;</span>
                                     <span class="s4">&quot;message:</span><span class="s0">\n\n</span><span class="s4">%s&quot; </span><span class="s1">% str(e))</span>

    <span class="s0">def </span><span class="s1">test_in_bounds_fuzz(self):</span>
        <span class="s3"># Don't use fixed seed</span>
        <span class="s1">np.random.seed()</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype[</span><span class="s2">1</span><span class="s1">:]:</span>
            <span class="s0">for </span><span class="s1">ubnd </span><span class="s0">in </span><span class="s1">[</span><span class="s2">4</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">16</span><span class="s1">]:</span>
                <span class="s1">vals = self.rfunc(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">2</span><span class="s1">**</span><span class="s2">16</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
                <span class="s1">assert_(vals.max() &lt; ubnd)</span>
                <span class="s1">assert_(vals.min() &gt;= </span><span class="s2">2</span><span class="s1">)</span>

        <span class="s1">vals = self.rfunc(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">2</span><span class="s1">**</span><span class="s2">16</span><span class="s0">, </span><span class="s1">dtype=np.bool_)</span>

        <span class="s1">assert_(vals.max() &lt; </span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">assert_(vals.min() &gt;= </span><span class="s2">0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability(self):</span>
        <span class="s0">import </span><span class="s1">hashlib</span>
        <span class="s3"># We use a sha256 hash of generated sequences of 1000 samples</span>
        <span class="s3"># in the range [0, 6) for all but bool, where the range</span>
        <span class="s3"># is [0, 2). Hashes are for little endian numbers.</span>
        <span class="s1">tgt = {</span><span class="s4">'bool'</span><span class="s1">: </span><span class="s4">'509aea74d792fb931784c4b0135392c65aec64beee12b0cc167548a2c3d31e71'</span><span class="s0">,</span>
               <span class="s4">'int16'</span><span class="s1">: </span><span class="s4">'7b07f1a920e46f6d0fe02314155a2330bcfd7635e708da50e536c5ebb631a7d4'</span><span class="s0">,</span>
               <span class="s4">'int32'</span><span class="s1">: </span><span class="s4">'e577bfed6c935de944424667e3da285012e741892dcb7051a8f1ce68ab05c92f'</span><span class="s0">,</span>
               <span class="s4">'int64'</span><span class="s1">: </span><span class="s4">'0fbead0b06759df2cfb55e43148822d4a1ff953c7eb19a5b08445a63bb64fa9e'</span><span class="s0">,</span>
               <span class="s4">'int8'</span><span class="s1">: </span><span class="s4">'001aac3a5acb935a9b186cbe14a1ca064b8bb2dd0b045d48abeacf74d0203404'</span><span class="s0">,</span>
               <span class="s4">'uint16'</span><span class="s1">: </span><span class="s4">'7b07f1a920e46f6d0fe02314155a2330bcfd7635e708da50e536c5ebb631a7d4'</span><span class="s0">,</span>
               <span class="s4">'uint32'</span><span class="s1">: </span><span class="s4">'e577bfed6c935de944424667e3da285012e741892dcb7051a8f1ce68ab05c92f'</span><span class="s0">,</span>
               <span class="s4">'uint64'</span><span class="s1">: </span><span class="s4">'0fbead0b06759df2cfb55e43148822d4a1ff953c7eb19a5b08445a63bb64fa9e'</span><span class="s0">,</span>
               <span class="s4">'uint8'</span><span class="s1">: </span><span class="s4">'001aac3a5acb935a9b186cbe14a1ca064b8bb2dd0b045d48abeacf74d0203404'</span><span class="s1">}</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype[</span><span class="s2">1</span><span class="s1">:]:</span>
            <span class="s1">np.random.seed(</span><span class="s2">1234</span><span class="s1">)</span>

            <span class="s3"># view as little endian for hash</span>
            <span class="s0">if </span><span class="s1">sys.byteorder == </span><span class="s4">'little'</span><span class="s1">:</span>
                <span class="s1">val = self.rfunc(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">1000</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">val = self.rfunc(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">1000</span><span class="s0">, </span><span class="s1">dtype=dt).byteswap()</span>

            <span class="s1">res = hashlib.sha256(val.view(np.int8)).hexdigest()</span>
            <span class="s1">assert_(tgt[np.dtype(dt).name] == res)</span>

        <span class="s3"># bools do not depend on endianness</span>
        <span class="s1">np.random.seed(</span><span class="s2">1234</span><span class="s1">)</span>
        <span class="s1">val = self.rfunc(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">1000</span><span class="s0">, </span><span class="s1">dtype=bool).view(np.int8)</span>
        <span class="s1">res = hashlib.sha256(val).hexdigest()</span>
        <span class="s1">assert_(tgt[np.dtype(bool).name] == res)</span>

    <span class="s0">def </span><span class="s1">test_int64_uint64_corner_case(self):</span>
        <span class="s3"># When stored in Numpy arrays, `lbnd` is casted</span>
        <span class="s3"># as np.int64, and `ubnd` is casted as np.uint64.</span>
        <span class="s3"># Checking whether `lbnd` &gt;= `ubnd` used to be</span>
        <span class="s3"># done solely via direct comparison, which is incorrect</span>
        <span class="s3"># because when Numpy tries to compare both numbers,</span>
        <span class="s3"># it casts both to np.float64 because there is</span>
        <span class="s3"># no integer superset of np.int64 and np.uint64. However,</span>
        <span class="s3"># `ubnd` is too large to be represented in np.float64,</span>
        <span class="s3"># causing it be round down to np.iinfo(np.int64).max,</span>
        <span class="s3"># leading to a ValueError because `lbnd` now equals</span>
        <span class="s3"># the new `ubnd`.</span>

        <span class="s1">dt = np.int64</span>
        <span class="s1">tgt = np.iinfo(np.int64).max</span>
        <span class="s1">lbnd = np.int64(np.iinfo(np.int64).max)</span>
        <span class="s1">ubnd = np.uint64(np.iinfo(np.int64).max + </span><span class="s2">1</span><span class="s1">)</span>

        <span class="s3"># None of these function calls should</span>
        <span class="s3"># generate a ValueError now.</span>
        <span class="s1">actual = np.random.randint(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">tgt)</span>

    <span class="s0">def </span><span class="s1">test_respect_dtype_singleton(self):</span>
        <span class="s3"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s2">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s2">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s2">1</span>

            <span class="s1">sample = self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_equal(sample.dtype</span><span class="s0">, </span><span class="s1">np.dtype(dt))</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">(bool</span><span class="s0">, </span><span class="s1">int</span><span class="s0">, </span><span class="s1">np.compat.long):</span>
            <span class="s1">lbnd = </span><span class="s2">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s2">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s2">1</span>

            <span class="s3"># gh-7284: Ensure that we get Python data types</span>
            <span class="s1">sample = self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">hasattr(sample</span><span class="s0">, </span><span class="s4">'dtype'</span><span class="s1">))</span>
            <span class="s1">assert_equal(type(sample)</span><span class="s0">, </span><span class="s1">dt)</span>


<span class="s0">class </span><span class="s1">TestRandomDist:</span>
    <span class="s3"># Make sure the random distribution returns the correct value for a</span>
    <span class="s3"># given seed</span>

    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s2">1234567890</span>

    <span class="s0">def </span><span class="s1">test_rand(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.rand(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.61879477158567997</span><span class="s0">, </span><span class="s2">0.59162362775974664</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.88868358904449662</span><span class="s0">, </span><span class="s2">0.89165480011560816</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.4575674820298663</span><span class="s0">, </span><span class="s2">0.7781880808593471</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_randn(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.randn(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s2">1.34016345771863121</span><span class="s0">, </span><span class="s2">1.73759122771936081</span><span class="s1">]</span><span class="s0">,</span>
                           <span class="s1">[</span><span class="s2">1.498988344300628</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2286433324536169</span><span class="s1">]</span><span class="s0">,</span>
                           <span class="s1">[</span><span class="s2">2.031033998682787</span><span class="s0">, </span><span class="s2">2.17032494605655257</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_randint(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.randint(-</span><span class="s2">99</span><span class="s0">, </span><span class="s2">99</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">31</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">52</span><span class="s0">, </span><span class="s2">41</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">48</span><span class="s0">, </span><span class="s1">-</span><span class="s2">66</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_random_integers(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">w = sup.record(DeprecationWarning)</span>
            <span class="s1">actual = np.random.random_integers(-</span><span class="s2">99</span><span class="s0">, </span><span class="s2">99</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
            <span class="s1">assert_(len(w) == </span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s2">31</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">52</span><span class="s0">, </span><span class="s2">41</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">48</span><span class="s0">, </span><span class="s1">-</span><span class="s2">66</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_random_integers_max_int(self):</span>
        <span class="s3"># Tests whether random_integers can generate the</span>
        <span class="s3"># maximum allowed Python int that can be converted</span>
        <span class="s3"># into a C long. Previous implementations of this</span>
        <span class="s3"># method have thrown an OverflowError when attempting</span>
        <span class="s3"># to generate this integer.</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">w = sup.record(DeprecationWarning)</span>
            <span class="s1">actual = np.random.random_integers(np.iinfo(</span><span class="s4">'l'</span><span class="s1">).max</span><span class="s0">,</span>
                                               <span class="s1">np.iinfo(</span><span class="s4">'l'</span><span class="s1">).max)</span>
            <span class="s1">assert_(len(w) == </span><span class="s2">1</span><span class="s1">)</span>

        <span class="s1">desired = np.iinfo(</span><span class="s4">'l'</span><span class="s1">).max</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_random_integers_deprecated(self):</span>
        <span class="s0">with </span><span class="s1">warnings.catch_warnings():</span>
            <span class="s1">warnings.simplefilter(</span><span class="s4">&quot;error&quot;</span><span class="s0">, </span><span class="s1">DeprecationWarning)</span>

            <span class="s3"># DeprecationWarning raised with high == None</span>
            <span class="s1">assert_raises(DeprecationWarning</span><span class="s0">,</span>
                          <span class="s1">np.random.random_integers</span><span class="s0">,</span>
                          <span class="s1">np.iinfo(</span><span class="s4">'l'</span><span class="s1">).max)</span>

            <span class="s3"># DeprecationWarning raised with high != None</span>
            <span class="s1">assert_raises(DeprecationWarning</span><span class="s0">,</span>
                          <span class="s1">np.random.random_integers</span><span class="s0">,</span>
                          <span class="s1">np.iinfo(</span><span class="s4">'l'</span><span class="s1">).max</span><span class="s0">, </span><span class="s1">np.iinfo(</span><span class="s4">'l'</span><span class="s1">).max)</span>

    <span class="s0">def </span><span class="s1">test_random(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.random((</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.61879477158567997</span><span class="s0">, </span><span class="s2">0.59162362775974664</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.88868358904449662</span><span class="s0">, </span><span class="s2">0.89165480011560816</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.4575674820298663</span><span class="s0">, </span><span class="s2">0.7781880808593471</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_replace(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.choice(</span><span class="s2">4</span><span class="s0">, </span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_replace(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.choice(</span><span class="s2">4</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s1">p=[</span><span class="s2">0.4</span><span class="s0">, </span><span class="s2">0.4</span><span class="s0">, </span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">0.1</span><span class="s1">])</span>
        <span class="s1">desired = np.array([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_noreplace(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.choice(</span><span class="s2">4</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_noreplace(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.choice(</span><span class="s2">4</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False,</span>
                                  <span class="s1">p=[</span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">0.3</span><span class="s0">, </span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.1</span><span class="s1">])</span>
        <span class="s1">desired = np.array([</span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">1</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_noninteger(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.choice([</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'b'</span><span class="s0">, </span><span class="s4">'c'</span><span class="s0">, </span><span class="s4">'d'</span><span class="s1">]</span><span class="s0">, </span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s4">'c'</span><span class="s0">, </span><span class="s4">'d'</span><span class="s0">, </span><span class="s4">'c'</span><span class="s0">, </span><span class="s4">'d'</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_exceptions(self):</span>
        <span class="s1">sample = np.random.choice</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s2">3.</span><span class="s0">, </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s1">]]</span><span class="s0">, </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[]</span><span class="s0">, </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s1">]</span><span class="s0">, </span><span class="s2">3</span><span class="s0">,</span>
                      <span class="s1">p=[[</span><span class="s2">0.25</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0.25</span><span class="s0">, </span><span class="s2">0.25</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s2">0.4</span><span class="s0">, </span><span class="s2">0.4</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s2">1.1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.1</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s2">0.4</span><span class="s0">, </span><span class="s2">0.4</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s3"># gh-13087</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">(-</span><span class="s2">1</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">(-</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">, </span><span class="s2">2</span><span class="s0">,</span>
                      <span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_choice_return_shape(self):</span>
        <span class="s1">p = [</span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">0.9</span><span class="s1">]</span>
        <span class="s3"># Check scalar</span>
        <span class="s1">assert_(np.isscalar(np.random.choice(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(np.isscalar(np.random.choice(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)))</span>
        <span class="s1">assert_(np.isscalar(np.random.choice(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(np.isscalar(np.random.choice(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(np.isscalar(np.random.choice([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(np.random.choice([</span><span class="s0">None</span><span class="s1">]</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">) </span><span class="s0">is None</span><span class="s1">)</span>
        <span class="s1">a = np.array([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">])</span>
        <span class="s1">arr = np.empty(</span><span class="s2">1</span><span class="s0">, </span><span class="s1">dtype=object)</span>
        <span class="s1">arr[</span><span class="s2">0</span><span class="s1">] = a</span>
        <span class="s1">assert_(np.random.choice(arr</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">) </span><span class="s0">is </span><span class="s1">a)</span>

        <span class="s3"># Check 0-d array</span>
        <span class="s1">s = tuple()</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(np.random.choice(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(np.random.choice(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(np.random.choice(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(np.random.choice(</span><span class="s2">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(np.random.choice([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(np.random.choice([</span><span class="s0">None</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).ndim == </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">a = np.array([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">])</span>
        <span class="s1">arr = np.empty(</span><span class="s2">1</span><span class="s0">, </span><span class="s1">dtype=object)</span>
        <span class="s1">arr[</span><span class="s2">0</span><span class="s1">] = a</span>
        <span class="s1">assert_(np.random.choice(arr</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).item() </span><span class="s0">is </span><span class="s1">a)</span>

        <span class="s3"># Check multi dimensional array</span>
        <span class="s1">s = (</span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">p = [</span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">0.4</span><span class="s0">, </span><span class="s2">0.2</span><span class="s1">]</span>
        <span class="s1">assert_equal(np.random.choice(</span><span class="s2">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(np.random.choice(</span><span class="s2">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(np.random.choice(</span><span class="s2">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(np.random.choice(</span><span class="s2">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(np.random.choice(np.arange(</span><span class="s2">6</span><span class="s1">)</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>

        <span class="s3"># Check zero-size</span>
        <span class="s1">assert_equal(np.random.randint(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">4</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">4</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.randint(</span><span class="s2">0</span><span class="s0">, </span><span class="s1">-</span><span class="s2">10</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.randint(</span><span class="s2">10</span><span class="s0">, </span><span class="s2">10</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.choice(</span><span class="s2">0</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.choice([]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.choice([</span><span class="s4">'a'</span><span class="s0">, </span><span class="s4">'b'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">4</span><span class="s1">)).shape</span><span class="s0">,</span>
                     <span class="s1">(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">4</span><span class="s1">))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.choice</span><span class="s0">, </span><span class="s1">[]</span><span class="s0">, </span><span class="s2">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nan_probabilities(self):</span>
        <span class="s1">a = np.array([</span><span class="s2">42</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">])</span>
        <span class="s1">p = [</span><span class="s0">None, None, None</span><span class="s1">]</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.choice</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">p=p)</span>

    <span class="s0">def </span><span class="s1">test_bytes(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.bytes(</span><span class="s2">10</span><span class="s1">)</span>
        <span class="s1">desired = </span><span class="s5">b'</span><span class="s0">\x82</span><span class="s5">Ui</span><span class="s0">\x9e\xff\x97</span><span class="s5">+Wf</span><span class="s0">\xa5</span><span class="s5">'</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_shuffle(self):</span>
        <span class="s3"># Test lists, arrays (of various dtypes), and multidimensional versions</span>
        <span class="s3"># of both, c-contiguous or not:</span>
        <span class="s0">for </span><span class="s1">conv </span><span class="s0">in </span><span class="s1">[</span><span class="s0">lambda </span><span class="s1">x: np.array([])</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: x</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.int8)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.float32)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.complex64)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(object)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: [(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray([[i</span><span class="s0">, </span><span class="s1">i] </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x])</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.vstack([x</span><span class="s0">, </span><span class="s1">x]).T</span><span class="s0">,</span>
                     <span class="s3"># gh-11442</span>
                     <span class="s0">lambda </span><span class="s1">x: (np.asarray([(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                                           <span class="s1">[(</span><span class="s4">&quot;a&quot;</span><span class="s0">, </span><span class="s1">int)</span><span class="s0">, </span><span class="s1">(</span><span class="s4">&quot;b&quot;</span><span class="s0">, </span><span class="s1">int)])</span>
                                <span class="s1">.view(np.recarray))</span><span class="s0">,</span>
                     <span class="s3"># gh-4270</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray([(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                                          <span class="s1">[(</span><span class="s4">&quot;a&quot;</span><span class="s0">, </span><span class="s1">object)</span><span class="s0">, </span><span class="s1">(</span><span class="s4">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.int32)])]:</span>
            <span class="s1">np.random.seed(self.seed)</span>
            <span class="s1">alist = conv([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">9</span><span class="s0">, </span><span class="s2">0</span><span class="s1">])</span>
            <span class="s1">np.random.shuffle(alist)</span>
            <span class="s1">actual = alist</span>
            <span class="s1">desired = conv([</span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">9</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">7</span><span class="s0">, </span><span class="s2">3</span><span class="s1">])</span>
            <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_masked(self):</span>
        <span class="s3"># gh-3263</span>
        <span class="s1">a = np.ma.masked_values(np.reshape(range(</span><span class="s2">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">4</span><span class="s1">)) % </span><span class="s2">3 </span><span class="s1">- </span><span class="s2">1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">b = np.ma.masked_values(np.arange(</span><span class="s2">20</span><span class="s1">) % </span><span class="s2">3 </span><span class="s1">- </span><span class="s2">1</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">a_orig = a.copy()</span>
        <span class="s1">b_orig = b.copy()</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s2">50</span><span class="s1">):</span>
            <span class="s1">np.random.shuffle(a)</span>
            <span class="s1">assert_equal(</span>
                <span class="s1">sorted(a.data[~a.mask])</span><span class="s0">, </span><span class="s1">sorted(a_orig.data[~a_orig.mask]))</span>
            <span class="s1">np.random.shuffle(b)</span>
            <span class="s1">assert_equal(</span>
                <span class="s1">sorted(b.data[~b.mask])</span><span class="s0">, </span><span class="s1">sorted(b_orig.data[~b_orig.mask]))</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;random&quot;</span><span class="s0">,</span>
            <span class="s1">[np.random</span><span class="s0">, </span><span class="s1">np.random.RandomState()</span><span class="s0">, </span><span class="s1">np.random.default_rng()])</span>
    <span class="s0">def </span><span class="s1">test_shuffle_untyped_warning(self</span><span class="s0">, </span><span class="s1">random):</span>
        <span class="s3"># Create a dict works like a sequence but isn't one</span>
        <span class="s1">values = {</span><span class="s2">0</span><span class="s1">: </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">: </span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">: </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">: </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s1">: </span><span class="s2">4</span><span class="s0">, </span><span class="s2">5</span><span class="s1">: </span><span class="s2">5</span><span class="s0">, </span><span class="s2">6</span><span class="s1">: </span><span class="s2">6</span><span class="s1">}</span>
        <span class="s0">with </span><span class="s1">pytest.warns(UserWarning</span><span class="s0">,</span>
                <span class="s1">match=</span><span class="s4">&quot;you are shuffling a 'dict' object&quot;</span><span class="s1">) </span><span class="s0">as </span><span class="s1">rec:</span>
            <span class="s1">random.shuffle(values)</span>
        <span class="s0">assert </span><span class="s4">&quot;test_random&quot; </span><span class="s0">in </span><span class="s1">rec[</span><span class="s2">0</span><span class="s1">].filename</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;random&quot;</span><span class="s0">,</span>
        <span class="s1">[np.random</span><span class="s0">, </span><span class="s1">np.random.RandomState()</span><span class="s0">, </span><span class="s1">np.random.default_rng()])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;use_array_like&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_shuffle_no_object_unpacking(self</span><span class="s0">, </span><span class="s1">random</span><span class="s0">, </span><span class="s1">use_array_like):</span>
        <span class="s0">class </span><span class="s1">MyArr(np.ndarray):</span>
            <span class="s0">pass</span>

        <span class="s1">items = [</span>
            <span class="s0">None, </span><span class="s1">np.array([</span><span class="s2">3</span><span class="s1">])</span><span class="s0">, </span><span class="s1">np.float64(</span><span class="s2">3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.array(</span><span class="s2">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.float64(</span><span class="s2">7</span><span class="s1">)</span>
        <span class="s1">]</span>
        <span class="s1">arr = np.array(items</span><span class="s0">, </span><span class="s1">dtype=object)</span>
        <span class="s1">item_ids = {id(i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">items}</span>
        <span class="s0">if </span><span class="s1">use_array_like:</span>
            <span class="s1">arr = arr.view(MyArr)</span>

        <span class="s3"># The array was created fine, and did not modify any objects:</span>
        <span class="s0">assert </span><span class="s1">all(id(i) </span><span class="s0">in </span><span class="s1">item_ids </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">arr)</span>

        <span class="s0">if </span><span class="s1">use_array_like </span><span class="s0">and not </span><span class="s1">isinstance(random</span><span class="s0">, </span><span class="s1">np.random.Generator):</span>
            <span class="s3"># The old API gives incorrect results, but warns about it.</span>
            <span class="s0">with </span><span class="s1">pytest.warns(UserWarning</span><span class="s0">,</span>
                    <span class="s1">match=</span><span class="s4">&quot;Shuffling a one dimensional array.*&quot;</span><span class="s1">):</span>
                <span class="s1">random.shuffle(arr)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">random.shuffle(arr)</span>
            <span class="s0">assert </span><span class="s1">all(id(i) </span><span class="s0">in </span><span class="s1">item_ids </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">arr)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_memoryview(self):</span>
        <span class="s3"># gh-18273</span>
        <span class="s3"># allow graceful handling of memoryviews</span>
        <span class="s3"># (treat the same as arrays)</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">a = np.arange(</span><span class="s2">5</span><span class="s1">).data</span>
        <span class="s1">np.random.shuffle(a)</span>
        <span class="s1">assert_equal(np.asarray(a)</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">])</span>
        <span class="s1">rng = np.random.RandomState(self.seed)</span>
        <span class="s1">rng.shuffle(a)</span>
        <span class="s1">assert_equal(np.asarray(a)</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s1">])</span>
        <span class="s1">rng = np.random.default_rng(self.seed)</span>
        <span class="s1">rng.shuffle(a)</span>
        <span class="s1">assert_equal(np.asarray(a)</span><span class="s0">, </span><span class="s1">[</span><span class="s2">4</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_beta(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.beta(</span><span class="s2">.1</span><span class="s0">, </span><span class="s2">.9</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array(</span>
                <span class="s1">[[</span><span class="s2">1.45341850513746058e-02</span><span class="s0">, </span><span class="s2">5.31297615662868145e-04</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s2">1.85366619058432324e-06</span><span class="s0">, </span><span class="s2">4.19214516800110563e-03</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s2">1.58405155108498093e-04</span><span class="s0">, </span><span class="s2">1.26252891949397652e-04</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_binomial(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.binomial(</span><span class="s2">100</span><span class="s0">, </span><span class="s2">.456</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">37</span><span class="s0">, </span><span class="s2">43</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">42</span><span class="s0">, </span><span class="s2">48</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">46</span><span class="s0">, </span><span class="s2">45</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_chisquare(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.chisquare(</span><span class="s2">50</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">63.87858175501090585</span><span class="s0">, </span><span class="s2">68.68407748911370447</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">65.77116116901505904</span><span class="s0">, </span><span class="s2">47.09686762438974483</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">72.3828403199695174</span><span class="s0">, </span><span class="s2">74.18408615260374006</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">alpha = np.array([</span><span class="s2">51.72840233779265162</span><span class="s0">, </span><span class="s2">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">actual = np.random.mtrand.dirichlet(alpha</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[[</span><span class="s2">0.54539444573611562</span><span class="s0">, </span><span class="s2">0.45460555426388438</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s2">0.62345816822039413</span><span class="s0">, </span><span class="s2">0.37654183177960598</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s2">0.55206000085785778</span><span class="s0">, </span><span class="s2">0.44793999914214233</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s2">0.58964023305154301</span><span class="s0">, </span><span class="s2">0.41035976694845688</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s2">0.59266909280647828</span><span class="s0">, </span><span class="s2">0.40733090719352177</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s2">0.56974431743975207</span><span class="s0">, </span><span class="s2">0.43025568256024799</span><span class="s1">]]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_size(self):</span>
        <span class="s3"># gh-3173</span>
        <span class="s1">p = np.array([</span><span class="s2">51.72840233779265162</span><span class="s0">, </span><span class="s2">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">assert_equal(np.random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s2">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s2">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s2">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.dirichlet(p</span><span class="s0">, </span><span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.dirichlet(p</span><span class="s0">, </span><span class="s1">(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(np.random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.array((</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>

        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.random.dirichlet</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">float(</span><span class="s2">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_bad_alpha(self):</span>
        <span class="s3"># gh-2089</span>
        <span class="s1">alpha = np.array([</span><span class="s2">5.4e-01</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.0e-16</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.mtrand.dirichlet</span><span class="s0">, </span><span class="s1">alpha)</span>

        <span class="s3"># gh-15876</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">5</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">[[[</span><span class="s2">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[</span><span class="s2">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">5</span><span class="s1">]]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">np.array([[</span><span class="s2">5</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">5</span><span class="s1">]]))</span>

    <span class="s0">def </span><span class="s1">test_exponential(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.exponential(</span><span class="s2">1.1234</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">1.08342649775011624</span><span class="s0">, </span><span class="s2">1.00607889924557314</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">2.46628830085216721</span><span class="s0">, </span><span class="s2">2.49668106809923884</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.68717433461363442</span><span class="s0">, </span><span class="s2">1.69175666993575979</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_exponential_0(self):</span>
        <span class="s1">assert_equal(np.random.exponential(scale=</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.exponential</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_f(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.f(</span><span class="s2">12</span><span class="s0">, </span><span class="s2">77</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">1.21975394418575878</span><span class="s0">, </span><span class="s2">1.75135759791559775</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1.44803115017146489</span><span class="s0">, </span><span class="s2">1.22108959480396262</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1.02176975757740629</span><span class="s0">, </span><span class="s2">1.34431827623300415</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.gamma(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">24.60509188649287182</span><span class="s0">, </span><span class="s2">28.54993563207210627</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">26.13476110204064184</span><span class="s0">, </span><span class="s2">12.56988482927716078</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">31.71863275789960568</span><span class="s0">, </span><span class="s2">33.30143302795922011</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma_0(self):</span>
        <span class="s1">assert_equal(np.random.gamma(shape=</span><span class="s2">0</span><span class="s0">, </span><span class="s1">scale=</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.gamma</span><span class="s0">, </span><span class="s1">shape=-</span><span class="s2">0.</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_geometric(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.geometric(</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">8</span><span class="s0">, </span><span class="s2">7</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">17</span><span class="s0">, </span><span class="s2">17</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">5</span><span class="s0">, </span><span class="s2">12</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_gumbel(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.gumbel(loc=</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s2">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.19591898743416816</span><span class="s0">, </span><span class="s2">0.34405539668096674</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">1.4492522252274278</span><span class="s0">, </span><span class="s1">-</span><span class="s2">1.47374816298446865</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1.10651090478803416</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.69535848626236174</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel_0(self):</span>
        <span class="s1">assert_equal(np.random.gumbel(scale=</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.gumbel</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.hypergeometric(</span><span class="s2">10</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">14</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">10</span><span class="s0">, </span><span class="s2">10</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">10</span><span class="s0">, </span><span class="s2">10</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">9</span><span class="s0">, </span><span class="s2">9</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s3"># Test nbad = 0</span>
        <span class="s1">actual = np.random.hypergeometric(</span><span class="s2">5</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s2">3</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">3</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">actual = np.random.hypergeometric(</span><span class="s2">15</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">12</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s2">12</span><span class="s0">, </span><span class="s2">12</span><span class="s0">, </span><span class="s2">12</span><span class="s0">, </span><span class="s2">12</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s3"># Test ngood = 0</span>
        <span class="s1">actual = np.random.hypergeometric(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">actual = np.random.hypergeometric(</span><span class="s2">0</span><span class="s0">, </span><span class="s2">15</span><span class="s0">, </span><span class="s2">12</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_laplace(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.laplace(loc=</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s2">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.66599721112760157</span><span class="s0">, </span><span class="s2">0.52829452552221945</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">3.12791959514407125</span><span class="s0">, </span><span class="s2">3.18202813572992005</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">0.05391065675859356</span><span class="s0">, </span><span class="s2">1.74901336242837324</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_laplace_0(self):</span>
        <span class="s1">assert_equal(np.random.laplace(scale=</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.laplace</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logistic(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.logistic(loc=</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s2">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">1.09232835305011444</span><span class="s0">, </span><span class="s2">0.8648196662399954</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">4.27818590694950185</span><span class="s0">, </span><span class="s2">4.33897006346929714</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">0.21682183359214885</span><span class="s0">, </span><span class="s2">2.63373365386060332</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.lognormal(mean=</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">sigma=</span><span class="s2">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">16.50698631688883822</span><span class="s0">, </span><span class="s2">36.54846706092654784</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">22.67886599981281748</span><span class="s0">, </span><span class="s2">0.71617561058995771</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">65.72798501792723869</span><span class="s0">, </span><span class="s2">86.84341601437161273</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal_0(self):</span>
        <span class="s1">assert_equal(np.random.lognormal(sigma=</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.lognormal</span><span class="s0">, </span><span class="s1">sigma=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logseries(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.logseries(p=</span><span class="s2">.923456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">6</span><span class="s0">, </span><span class="s2">17</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">3</span><span class="s0">, </span><span class="s2">6</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_multinomial(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.multinomial(</span><span class="s2">20</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s1">/</span><span class="s2">6.</span><span class="s1">]*</span><span class="s2">6</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[[</span><span class="s2">4</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s2">5</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">8</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">4</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">6</span><span class="s0">, </span><span class="s2">4</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s2">4</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">5</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s2">4</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">3</span><span class="s0">, </span><span class="s2">4</span><span class="s1">]]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_multivariate_normal(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">mean = (</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s2">10</span><span class="s1">)</span>
        <span class="s1">cov = [[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]]</span>
        <span class="s1">size = (</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">actual = np.random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s1">size)</span>
        <span class="s1">desired = np.array([[[</span><span class="s2">1.463620246718631</span><span class="s0">, </span><span class="s2">11.73759122771936</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s2">1.622445133300628</span><span class="s0">, </span><span class="s2">9.771356667546383</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s2">2.154490787682787</span><span class="s0">, </span><span class="s2">12.170324946056553</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s2">1.719909438201865</span><span class="s0">, </span><span class="s2">9.230548443648306</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s2">0.689515026297799</span><span class="s0">, </span><span class="s2">9.880729819607714</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[-</span><span class="s2">0.023054015651998</span><span class="s0">, </span><span class="s2">9.201096623542879</span><span class="s1">]]])</span>

        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

        <span class="s3"># Check for default size, was raising deprecation warning</span>
        <span class="s1">actual = np.random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov)</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.895289569463708</span><span class="s0">, </span><span class="s2">9.17180864067987</span><span class="s1">])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

        <span class="s3"># Check that non positive-semidefinite covariance warns with</span>
        <span class="s3"># RuntimeWarning</span>
        <span class="s1">mean = [</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">cov = [[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">2</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]]</span>
        <span class="s1">assert_warns(RuntimeWarning</span><span class="s0">, </span><span class="s1">np.random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov)</span>

        <span class="s3"># and that it doesn't warn with RuntimeWarning check_valid='ignore'</span>
        <span class="s1">assert_no_warnings(np.random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                           <span class="s1">check_valid=</span><span class="s4">'ignore'</span><span class="s1">)</span>

        <span class="s3"># and that it raises with RuntimeWarning check_valid='raises'</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                      <span class="s1">check_valid=</span><span class="s4">'raise'</span><span class="s1">)</span>

        <span class="s1">cov = np.array([[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0.1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0.1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">np.random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov)</span>
            <span class="s1">w = sup.record(RuntimeWarning)</span>
            <span class="s0">assert </span><span class="s1">len(w) == </span><span class="s2">0</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.negative_binomial(n=</span><span class="s2">100</span><span class="s0">, </span><span class="s1">p=</span><span class="s2">.12345</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">848</span><span class="s0">, </span><span class="s2">841</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">892</span><span class="s0">, </span><span class="s2">611</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">779</span><span class="s0">, </span><span class="s2">647</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.noncentral_chisquare(df=</span><span class="s2">5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s2">5</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">23.91905354498517511</span><span class="s0">, </span><span class="s2">13.35324692733826346</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">31.22452661329736401</span><span class="s0">, </span><span class="s2">16.60047399466177254</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">5.03461598262724586</span><span class="s0">, </span><span class="s2">17.94973089023519464</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

        <span class="s1">actual = np.random.noncentral_chisquare(df=</span><span class="s2">.5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s2">.2</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">1.47145377828516666</span><span class="s0">,  </span><span class="s2">0.15052899268012659</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.00943803056963588</span><span class="s0">,  </span><span class="s2">1.02647251615666169</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.332334982684171</span><span class="s0">,  </span><span class="s2">0.15451287602753125</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.noncentral_chisquare(df=</span><span class="s2">5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s2">0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">9.597154162763948</span><span class="s0">, </span><span class="s2">11.725484450296079</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">10.413711048138335</span><span class="s0">, </span><span class="s2">3.694475922923986</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">13.484222138963087</span><span class="s0">, </span><span class="s2">14.377255424602957</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.noncentral_f(dfnum=</span><span class="s2">5</span><span class="s0">, </span><span class="s1">dfden=</span><span class="s2">2</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s2">1</span><span class="s0">,</span>
                                        <span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">1.40598099674926669</span><span class="s0">, </span><span class="s2">0.34207973179285761</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">3.57715069265772545</span><span class="s0">, </span><span class="s2">7.92632662577829805</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.43741599463544162</span><span class="s0">, </span><span class="s2">1.1774208752428319</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.normal(loc=</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s2">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">2.80378370443726244</span><span class="s0">, </span><span class="s2">3.59863924443872163</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">3.121433477601256</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.33382987590723379</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">4.18552478636557357</span><span class="s0">, </span><span class="s2">4.46410668111310471</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_normal_0(self):</span>
        <span class="s1">assert_equal(np.random.normal(scale=</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.normal</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_pareto(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.pareto(a=</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array(</span>
                <span class="s1">[[</span><span class="s2">2.46852460439034849e+03</span><span class="s0">, </span><span class="s2">1.41286880810518346e+03</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s2">5.28287797029485181e+07</span><span class="s0">, </span><span class="s2">6.57720981047328785e+07</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s2">1.40840323350391515e+02</span><span class="s0">, </span><span class="s2">1.98390255135251704e+05</span><span class="s1">]])</span>
        <span class="s3"># For some reason on 32-bit x86 Ubuntu 12.10 the [1, 0] entry in this</span>
        <span class="s3"># matrix differs by 24 nulps. Discussion:</span>
        <span class="s3">#   https://mail.python.org/pipermail/numpy-discussion/2012-September/063801.html</span>
        <span class="s3"># Consensus is that this is probably some gcc quirk that affects</span>
        <span class="s3"># rounding but not in any important way, so we just use a looser</span>
        <span class="s3"># tolerance on this test:</span>
        <span class="s1">np.testing.assert_array_almost_equal_nulp(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">nulp=</span><span class="s2">30</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_poisson(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.poisson(lam=</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_poisson_exceptions(self):</span>
        <span class="s1">lambig = np.iinfo(</span><span class="s4">'l'</span><span class="s1">).max</span>
        <span class="s1">lamneg = -</span><span class="s2">1</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.poisson</span><span class="s0">, </span><span class="s1">lamneg)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.poisson</span><span class="s0">, </span><span class="s1">[lamneg]*</span><span class="s2">10</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.poisson</span><span class="s0">, </span><span class="s1">lambig)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.poisson</span><span class="s0">, </span><span class="s1">[lambig]*</span><span class="s2">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_power(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.power(a=</span><span class="s2">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.02048932883240791</span><span class="s0">, </span><span class="s2">0.01424192241128213</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.38446073748535298</span><span class="s0">, </span><span class="s2">0.39499689943484395</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.00177699707563439</span><span class="s0">, </span><span class="s2">0.13115505880863756</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.rayleigh(scale=</span><span class="s2">10</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">13.8882496494248393</span><span class="s0">, </span><span class="s2">13.383318339044731</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">20.95413364294492098</span><span class="s0">, </span><span class="s2">21.08285015800712614</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">11.06066537006854311</span><span class="s0">, </span><span class="s2">17.35468505778271009</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh_0(self):</span>
        <span class="s1">assert_equal(np.random.rayleigh(scale=</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.rayleigh</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_cauchy(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.standard_cauchy(size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.77127660196445336</span><span class="s0">, </span><span class="s1">-</span><span class="s2">6.55601161955910605</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.93582023391158309</span><span class="s0">, </span><span class="s1">-</span><span class="s2">2.07479293013759447</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">4.74601644297011926</span><span class="s0">, </span><span class="s2">0.18338989290760804</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.standard_exponential(size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.96441739162374596</span><span class="s0">, </span><span class="s2">0.89556604882105506</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">2.1953785836319808</span><span class="s0">, </span><span class="s2">2.22243285392490542</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.6116915921431676</span><span class="s0">, </span><span class="s2">1.50592546727413201</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.standard_gamma(shape=</span><span class="s2">3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">5.50841531318455058</span><span class="s0">, </span><span class="s2">6.62953470301903103</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">5.93988484943779227</span><span class="s0">, </span><span class="s2">2.31044849402133989</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">7.54838614231317084</span><span class="s0">, </span><span class="s2">8.012756093271868</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_0(self):</span>
        <span class="s1">assert_equal(np.random.standard_gamma(shape=</span><span class="s2">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.standard_gamma</span><span class="s0">, </span><span class="s1">shape=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.standard_normal(size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">1.34016345771863121</span><span class="s0">, </span><span class="s2">1.73759122771936081</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1.498988344300628</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.2286433324536169</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">2.031033998682787</span><span class="s0">, </span><span class="s2">2.17032494605655257</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.standard_t(df=</span><span class="s2">10</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.97140611862659965</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.08830486548450577</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1.36311143689505321</span><span class="s0">, </span><span class="s1">-</span><span class="s2">0.55317463909867071</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s2">0.18473749069684214</span><span class="s0">, </span><span class="s2">0.61181537341755321</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_triangular(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.triangular(left=</span><span class="s2">5.12</span><span class="s0">, </span><span class="s1">mode=</span><span class="s2">10.23</span><span class="s0">, </span><span class="s1">right=</span><span class="s2">20.34</span><span class="s0">,</span>
                                      <span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">12.68117178949215784</span><span class="s0">, </span><span class="s2">12.4129206149193152</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">16.20131377335158263</span><span class="s0">, </span><span class="s2">16.25692138747600524</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">11.20400690911820263</span><span class="s0">, </span><span class="s2">14.4978144835829923</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uniform(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.uniform(low=</span><span class="s2">1.23</span><span class="s0">, </span><span class="s1">high=</span><span class="s2">10.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">6.99097932346268003</span><span class="s0">, </span><span class="s2">6.73801597444323974</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">9.50364421400426274</span><span class="s0">, </span><span class="s2">9.53130618907631089</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">5.48995325769805476</span><span class="s0">, </span><span class="s2">8.47493103280052118</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uniform_range_bounds(self):</span>
        <span class="s1">fmin = np.finfo(</span><span class="s4">'float'</span><span class="s1">).min</span>
        <span class="s1">fmax = np.finfo(</span><span class="s4">'float'</span><span class="s1">).max</span>

        <span class="s1">func = np.random.uniform</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s2">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">,  </span><span class="s2">0</span><span class="s0">,      </span><span class="s1">np.inf)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">,  </span><span class="s1">fmin</span><span class="s0">,   </span><span class="s1">fmax)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">[-np.inf]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0</span><span class="s1">])</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[np.inf])</span>

        <span class="s3"># (fmax / 1e17) - fmin is within range, so this should not throw</span>
        <span class="s3"># account for i386 extended precision DBL_MAX / 1e17 + DBL_MAX &gt;</span>
        <span class="s3"># DBL_MAX by increasing fmin a bit</span>
        <span class="s1">np.random.uniform(low=np.nextafter(fmin</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">high=fmax / </span><span class="s2">1e17</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_scalar_exception_propagation(self):</span>
        <span class="s3"># Tests that exceptions are correctly propagated in distributions</span>
        <span class="s3"># when called with objects that throw exceptions when converted to</span>
        <span class="s3"># scalars.</span>
        <span class="s3">#</span>
        <span class="s3"># Regression test for gh: 8865</span>

        <span class="s0">class </span><span class="s1">ThrowingFloat(np.ndarray):</span>
            <span class="s0">def </span><span class="s1">__float__(self):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_float = np.array(</span><span class="s2">1.0</span><span class="s1">).view(ThrowingFloat)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.random.uniform</span><span class="s0">, </span><span class="s1">throwing_float</span><span class="s0">,</span>
                      <span class="s1">throwing_float)</span>

        <span class="s0">class </span><span class="s1">ThrowingInteger(np.ndarray):</span>
            <span class="s0">def </span><span class="s1">__int__(self):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

            <span class="s1">__index__ = __int__</span>

        <span class="s1">throwing_int = np.array(</span><span class="s2">1</span><span class="s1">).view(ThrowingInteger)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.random.hypergeometric</span><span class="s0">, </span><span class="s1">throwing_int</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.vonmises(mu=</span><span class="s2">1.23</span><span class="s0">, </span><span class="s1">kappa=</span><span class="s2">1.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">2.28567572673902042</span><span class="s0">, </span><span class="s2">2.89163838442285037</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.38198375564286025</span><span class="s0">, </span><span class="s2">2.57638023113890746</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1.19153771588353052</span><span class="s0">, </span><span class="s2">1.83509849681825354</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises_small(self):</span>
        <span class="s3"># check infinite loop, gh-4720</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">r = np.random.vonmises(mu=</span><span class="s2">0.</span><span class="s0">, </span><span class="s1">kappa=</span><span class="s2">1.1e-8</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">10</span><span class="s1">**</span><span class="s2">6</span><span class="s1">)</span>
        <span class="s1">np.testing.assert_(np.isfinite(r).all())</span>

    <span class="s0">def </span><span class="s1">test_wald(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.wald(mean=</span><span class="s2">1.23</span><span class="s0">, </span><span class="s1">scale=</span><span class="s2">1.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">3.82935265715889983</span><span class="s0">, </span><span class="s2">5.13125249184285526</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.35045403618358717</span><span class="s0">, </span><span class="s2">1.50832396872003538</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.24124319895843183</span><span class="s0">, </span><span class="s2">0.22031101461955038</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.weibull(a=</span><span class="s2">1.23</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">0.97097342648766727</span><span class="s0">, </span><span class="s2">0.91422896443565516</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1.89517770034962929</span><span class="s0">, </span><span class="s2">1.91414357960479564</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">0.67057783752390987</span><span class="s0">, </span><span class="s2">1.39494046635066793</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull_0(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">assert_equal(np.random.weibull(a=</span><span class="s2">0</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">12</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.zeros(</span><span class="s2">12</span><span class="s1">))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.random.weibull</span><span class="s0">, </span><span class="s1">a=-</span><span class="s2">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_zipf(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>
        <span class="s1">actual = np.random.zipf(a=</span><span class="s2">1.23</span><span class="s0">, </span><span class="s1">size=(</span><span class="s2">3</span><span class="s0">, </span><span class="s2">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s2">66</span><span class="s0">, </span><span class="s2">29</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s2">3</span><span class="s0">, </span><span class="s2">13</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>


<span class="s0">class </span><span class="s1">TestBroadcast:</span>
    <span class="s3"># tests that functions that broadcast behave</span>
    <span class="s3"># correctly when presented with non-scalar arguments</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s2">123456789</span>

    <span class="s0">def </span><span class="s1">setSeed(self):</span>
        <span class="s1">np.random.seed(self.seed)</span>

    <span class="s3"># TODO: Include test for randint once it can broadcast</span>
    <span class="s3"># Can steal the test written in PR #6938</span>

    <span class="s0">def </span><span class="s1">test_uniform(self):</span>
        <span class="s1">low = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">high = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">uniform = np.random.uniform</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.53283302478975902</span><span class="s0">,</span>
                            <span class="s2">0.53413660089041659</span><span class="s0">,</span>
                            <span class="s2">0.50955303552646702</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = uniform(low * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">high)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = uniform(low</span><span class="s0">, </span><span class="s1">high * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s1">loc = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">normal = np.random.normal</span>
        <span class="s1">desired = np.array([</span><span class="s2">2.2129019979039612</span><span class="s0">,</span>
                            <span class="s2">2.1283977976520019</span><span class="s0">,</span>
                            <span class="s2">1.8417114045748335</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = normal(loc * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">normal</span><span class="s0">, </span><span class="s1">loc * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = normal(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">normal</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_beta(self):</span>
        <span class="s1">a = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">b = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_b = [-</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">beta = np.random.beta</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.19843558305989056</span><span class="s0">,</span>
                            <span class="s2">0.075230336409423643</span><span class="s0">,</span>
                            <span class="s2">0.24976865978980844</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = beta(a * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">b)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">b)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">a * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_b)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = beta(a</span><span class="s0">, </span><span class="s1">b * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">bad_a</span><span class="s0">, </span><span class="s1">b * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">bad_b * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_exponential(self):</span>
        <span class="s1">scale = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">exponential = np.random.exponential</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.76106853658845242</span><span class="s0">,</span>
                            <span class="s2">0.76386282278691653</span><span class="s0">,</span>
                            <span class="s2">0.71243813125891797</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = exponential(scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">exponential</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma(self):</span>
        <span class="s1">shape = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_shape = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">std_gamma = np.random.standard_gamma</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.76106853658845242</span><span class="s0">,</span>
                            <span class="s2">0.76386282278691653</span><span class="s0">,</span>
                            <span class="s2">0.71243813125891797</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = std_gamma(shape * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">std_gamma</span><span class="s0">, </span><span class="s1">bad_shape * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma(self):</span>
        <span class="s1">shape = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_shape = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">gamma = np.random.gamma</span>
        <span class="s1">desired = np.array([</span><span class="s2">1.5221370731769048</span><span class="s0">,</span>
                            <span class="s2">1.5277256455738331</span><span class="s0">,</span>
                            <span class="s2">1.4248762625178359</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = gamma(shape * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">bad_shape * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">shape * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = gamma(shape</span><span class="s0">, </span><span class="s1">scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">bad_shape</span><span class="s0">, </span><span class="s1">scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">shape</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_f(self):</span>
        <span class="s1">dfnum = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">dfden = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_dfnum = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_dfden = [-</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">f = np.random.f</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.80038951638264799</span><span class="s0">,</span>
                            <span class="s2">0.86768719635363512</span><span class="s0">,</span>
                            <span class="s2">2.7251095168386801</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = f(dfnum * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">dfden)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">bad_dfnum * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">dfden)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_dfden)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = f(dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f(self):</span>
        <span class="s1">dfnum = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">dfden = [</span><span class="s2">3</span><span class="s1">]</span>
        <span class="s1">nonc = [</span><span class="s2">4</span><span class="s1">]</span>
        <span class="s1">bad_dfnum = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">bad_dfden = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_nonc = [-</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">nonc_f = np.random.noncentral_f</span>
        <span class="s1">desired = np.array([</span><span class="s2">9.1393943263705211</span><span class="s0">,</span>
                            <span class="s2">13.025456344595602</span><span class="s0">,</span>
                            <span class="s2">8.8018098359100545</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = nonc_f(dfnum * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = nonc_f(dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = nonc_f(dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">bad_nonc * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_small_df(self):</span>
        <span class="s1">self.setSeed()</span>
        <span class="s1">desired = np.array([</span><span class="s2">6.869638627492048</span><span class="s0">, </span><span class="s2">0.785880199263955</span><span class="s1">])</span>
        <span class="s1">actual = np.random.noncentral_f(</span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">0.9</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">2</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare(self):</span>
        <span class="s1">df = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">chisquare = np.random.chisquare</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.57022801133088286</span><span class="s0">,</span>
                            <span class="s2">0.51947702108840776</span><span class="s0">,</span>
                            <span class="s2">0.1320969254923558</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = chisquare(df * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">chisquare</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare(self):</span>
        <span class="s1">df = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">nonc = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_nonc = [-</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">nonc_chi = np.random.noncentral_chisquare</span>
        <span class="s1">desired = np.array([</span><span class="s2">9.0015599467913763</span><span class="s0">,</span>
                            <span class="s2">4.5804135049718742</span><span class="s0">,</span>
                            <span class="s2">6.0872302432834564</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = nonc_chi(df * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">df * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = nonc_chi(df</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">bad_df</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">df</span><span class="s0">, </span><span class="s1">bad_nonc * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t(self):</span>
        <span class="s1">df = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">t = np.random.standard_t</span>
        <span class="s1">desired = np.array([</span><span class="s2">3.0702872575217643</span><span class="s0">,</span>
                            <span class="s2">5.8560725167361607</span><span class="s0">,</span>
                            <span class="s2">1.0274791436474273</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = t(df * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">t</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises(self):</span>
        <span class="s1">mu = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">kappa = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_kappa = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">vonmises = np.random.vonmises</span>
        <span class="s1">desired = np.array([</span><span class="s2">2.9883443664201312</span><span class="s0">,</span>
                            <span class="s1">-</span><span class="s2">2.7064099483995943</span><span class="s0">,</span>
                            <span class="s1">-</span><span class="s2">1.8672476700665914</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = vonmises(mu * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">kappa)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">vonmises</span><span class="s0">, </span><span class="s1">mu * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_kappa)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = vonmises(mu</span><span class="s0">, </span><span class="s1">kappa * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">vonmises</span><span class="s0">, </span><span class="s1">mu</span><span class="s0">, </span><span class="s1">bad_kappa * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_pareto(self):</span>
        <span class="s1">a = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">pareto = np.random.pareto</span>
        <span class="s1">desired = np.array([</span><span class="s2">1.1405622680198362</span><span class="s0">,</span>
                            <span class="s2">1.1465519762044529</span><span class="s0">,</span>
                            <span class="s2">1.0389564467453547</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = pareto(a * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">pareto</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull(self):</span>
        <span class="s1">a = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">weibull = np.random.weibull</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.76106853658845242</span><span class="s0">,</span>
                            <span class="s2">0.76386282278691653</span><span class="s0">,</span>
                            <span class="s2">0.71243813125891797</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = weibull(a * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">weibull</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_power(self):</span>
        <span class="s1">a = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">power = np.random.power</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.53283302478975902</span><span class="s0">,</span>
                            <span class="s2">0.53413660089041659</span><span class="s0">,</span>
                            <span class="s2">0.50955303552646702</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = power(a * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">power</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_laplace(self):</span>
        <span class="s1">loc = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">laplace = np.random.laplace</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.067921356028507157</span><span class="s0">,</span>
                            <span class="s2">0.070715642226971326</span><span class="s0">,</span>
                            <span class="s2">0.019290950698972624</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = laplace(loc * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">laplace</span><span class="s0">, </span><span class="s1">loc * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = laplace(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">laplace</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel(self):</span>
        <span class="s1">loc = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">gumbel = np.random.gumbel</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.2730318639556768</span><span class="s0">,</span>
                            <span class="s2">0.26936705726291116</span><span class="s0">,</span>
                            <span class="s2">0.33906220393037939</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = gumbel(loc * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gumbel</span><span class="s0">, </span><span class="s1">loc * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = gumbel(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gumbel</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logistic(self):</span>
        <span class="s1">loc = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">logistic = np.random.logistic</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.13152135837586171</span><span class="s0">,</span>
                            <span class="s2">0.13675915696285773</span><span class="s0">,</span>
                            <span class="s2">0.038216792802833396</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = logistic(loc * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logistic</span><span class="s0">, </span><span class="s1">loc * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = logistic(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logistic</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal(self):</span>
        <span class="s1">mean = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">sigma = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_sigma = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">lognormal = np.random.lognormal</span>
        <span class="s1">desired = np.array([</span><span class="s2">9.1422086044848427</span><span class="s0">,</span>
                            <span class="s2">8.4013952870126261</span><span class="s0">,</span>
                            <span class="s2">6.3073234116578671</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = lognormal(mean * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">sigma)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">lognormal</span><span class="s0">, </span><span class="s1">mean * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_sigma)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = lognormal(mean</span><span class="s0">, </span><span class="s1">sigma * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">lognormal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">bad_sigma * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh(self):</span>
        <span class="s1">scale = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">rayleigh = np.random.rayleigh</span>
        <span class="s1">desired = np.array([</span><span class="s2">1.2337491937897689</span><span class="s0">,</span>
                            <span class="s2">1.2360119924878694</span><span class="s0">,</span>
                            <span class="s2">1.1936818095781789</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = rayleigh(scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">rayleigh</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_wald(self):</span>
        <span class="s1">mean = [</span><span class="s2">0.5</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_mean = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">wald = np.random.wald</span>
        <span class="s1">desired = np.array([</span><span class="s2">0.11873681120271318</span><span class="s0">,</span>
                            <span class="s2">0.12450084820795027</span><span class="s0">,</span>
                            <span class="s2">0.9096122728408238</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = wald(mean * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s1">bad_mean * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s1">mean * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = wald(mean</span><span class="s0">, </span><span class="s1">scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s1">bad_mean</span><span class="s0">, </span><span class="s1">scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s2">0.0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s2">0.5</span><span class="s0">, </span><span class="s2">0.0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_triangular(self):</span>
        <span class="s1">left = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">right = [</span><span class="s2">3</span><span class="s1">]</span>
        <span class="s1">mode = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_left_one = [</span><span class="s2">3</span><span class="s1">]</span>
        <span class="s1">bad_mode_one = [</span><span class="s2">4</span><span class="s1">]</span>
        <span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two = right * </span><span class="s2">2</span>
        <span class="s1">triangular = np.random.triangular</span>
        <span class="s1">desired = np.array([</span><span class="s2">2.03339048710429</span><span class="s0">,</span>
                            <span class="s2">2.0347400359389356</span><span class="s0">,</span>
                            <span class="s2">2.0095991069536208</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = triangular(left * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_mode_one</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_mode_two</span><span class="s0">,</span>
                      <span class="s1">right)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = triangular(left</span><span class="s0">, </span><span class="s1">mode * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one</span><span class="s0">, </span><span class="s1">mode * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left</span><span class="s0">, </span><span class="s1">bad_mode_one * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two * </span><span class="s2">3</span><span class="s0">,</span>
                      <span class="s1">right)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = triangular(left</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s2">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left</span><span class="s0">, </span><span class="s1">bad_mode_one</span><span class="s0">, </span><span class="s1">right * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two</span><span class="s0">,</span>
                      <span class="s1">right * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_binomial(self):</span>
        <span class="s1">n = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">p = [</span><span class="s2">0.5</span><span class="s1">]</span>
        <span class="s1">bad_n = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s2">1.5</span><span class="s1">]</span>
        <span class="s1">binom = np.random.binomial</span>
        <span class="s1">desired = np.array([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = binom(n * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">bad_n * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_p_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_p_two)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = binom(n</span><span class="s0">, </span><span class="s1">p * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">bad_n</span><span class="s0">, </span><span class="s1">p * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s1">n = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">p = [</span><span class="s2">0.5</span><span class="s1">]</span>
        <span class="s1">bad_n = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s2">1.5</span><span class="s1">]</span>
        <span class="s1">neg_binom = np.random.negative_binomial</span>
        <span class="s1">desired = np.array([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s2">1</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = neg_binom(n * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">bad_n * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_p_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_p_two)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = neg_binom(n</span><span class="s0">, </span><span class="s1">p * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">bad_n</span><span class="s0">, </span><span class="s1">p * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_poisson(self):</span>
        <span class="s1">max_lam = np.random.RandomState()._poisson_lam_max</span>

        <span class="s1">lam = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_lam_one = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_lam_two = [max_lam * </span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">poisson = np.random.poisson</span>
        <span class="s1">desired = np.array([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">0</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = poisson(lam * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">poisson</span><span class="s0">, </span><span class="s1">bad_lam_one * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">poisson</span><span class="s0">, </span><span class="s1">bad_lam_two * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_zipf(self):</span>
        <span class="s1">a = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_a = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">zipf = np.random.zipf</span>
        <span class="s1">desired = np.array([</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">1</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = zipf(a * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">np.errstate(invalid=</span><span class="s4">'ignore'</span><span class="s1">):</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">[</span><span class="s2">0</span><span class="s0">, </span><span class="s2">0</span><span class="s0">, </span><span class="s1">np.nan])</span>

    <span class="s0">def </span><span class="s1">test_geometric(self):</span>
        <span class="s1">p = [</span><span class="s2">0.5</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s2">1.5</span><span class="s1">]</span>
        <span class="s1">geom = np.random.geometric</span>
        <span class="s1">desired = np.array([</span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s0">, </span><span class="s2">2</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = geom(p * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">geom</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">geom</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric(self):</span>
        <span class="s1">ngood = [</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">nbad = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">nsample = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_ngood = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">bad_nbad = [-</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_nsample_one = [</span><span class="s2">0</span><span class="s1">]</span>
        <span class="s1">bad_nsample_two = [</span><span class="s2">4</span><span class="s1">]</span>
        <span class="s1">hypergeom = np.random.hypergeometric</span>
        <span class="s1">desired = np.array([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = hypergeom(ngood * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">bad_ngood * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_two)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = hypergeom(ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">bad_ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">bad_nbad * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_nsample_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s2">3</span><span class="s0">, </span><span class="s1">bad_nsample_two)</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = hypergeom(ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">bad_ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">bad_nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_one * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_two * </span><span class="s2">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logseries(self):</span>
        <span class="s1">p = [</span><span class="s2">0.5</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [</span><span class="s2">2</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [-</span><span class="s2">1</span><span class="s1">]</span>
        <span class="s1">logseries = np.random.logseries</span>
        <span class="s1">desired = np.array([</span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s0">, </span><span class="s2">1</span><span class="s1">])</span>

        <span class="s1">self.setSeed()</span>
        <span class="s1">actual = logseries(p * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logseries</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s2">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logseries</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s2">3</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestThread:</span>
    <span class="s3"># make sure each state produces the same sequence even in threads</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seeds = range(</span><span class="s2">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">check_function(self</span><span class="s0">, </span><span class="s1">function</span><span class="s0">, </span><span class="s1">sz):</span>
        <span class="s0">from </span><span class="s1">threading </span><span class="s0">import </span><span class="s1">Thread</span>

        <span class="s1">out1 = np.empty((len(self.seeds)</span><span class="s0">,</span><span class="s1">) + sz)</span>
        <span class="s1">out2 = np.empty((len(self.seeds)</span><span class="s0">,</span><span class="s1">) + sz)</span>

        <span class="s3"># threaded generation</span>
        <span class="s1">t = [Thread(target=function</span><span class="s0">, </span><span class="s1">args=(np.random.RandomState(s)</span><span class="s0">, </span><span class="s1">o))</span>
             <span class="s0">for </span><span class="s1">s</span><span class="s0">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip(self.seeds</span><span class="s0">, </span><span class="s1">out1)]</span>
        <span class="s1">[x.start() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t]</span>
        <span class="s1">[x.join() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t]</span>

        <span class="s3"># the same serial</span>
        <span class="s0">for </span><span class="s1">s</span><span class="s0">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip(self.seeds</span><span class="s0">, </span><span class="s1">out2):</span>
            <span class="s1">function(np.random.RandomState(s)</span><span class="s0">, </span><span class="s1">o)</span>

        <span class="s3"># these platforms change x87 fpu precision mode in threads</span>
        <span class="s0">if </span><span class="s1">np.intp().dtype.itemsize == </span><span class="s2">4 </span><span class="s0">and </span><span class="s1">sys.platform == </span><span class="s4">&quot;win32&quot;</span><span class="s1">:</span>
            <span class="s1">assert_array_almost_equal(out1</span><span class="s0">, </span><span class="s1">out2)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_array_equal(out1</span><span class="s0">, </span><span class="s1">out2)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.normal(size=</span><span class="s2">10000</span><span class="s1">)</span>
        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s2">10000</span><span class="s0">,</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_exp(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.exponential(scale=np.ones((</span><span class="s2">100</span><span class="s0">, </span><span class="s2">1000</span><span class="s1">)))</span>
        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s2">100</span><span class="s0">, </span><span class="s2">1000</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_multinomial(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.multinomial(</span><span class="s2">10</span><span class="s0">, </span><span class="s1">[</span><span class="s2">1</span><span class="s1">/</span><span class="s2">6.</span><span class="s1">]*</span><span class="s2">6</span><span class="s0">, </span><span class="s1">size=</span><span class="s2">10000</span><span class="s1">)</span>
        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s2">10000</span><span class="s0">, </span><span class="s2">6</span><span class="s1">))</span>


<span class="s3"># See Issue #4263</span>
<span class="s0">class </span><span class="s1">TestSingleEltArrayInput:</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.argOne = np.array([</span><span class="s2">2</span><span class="s1">])</span>
        <span class="s1">self.argTwo = np.array([</span><span class="s2">3</span><span class="s1">])</span>
        <span class="s1">self.argThree = np.array([</span><span class="s2">4</span><span class="s1">])</span>
        <span class="s1">self.tgtShape = (</span><span class="s2">1</span><span class="s0">,</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_one_arg_funcs(self):</span>
        <span class="s1">funcs = (np.random.exponential</span><span class="s0">, </span><span class="s1">np.random.standard_gamma</span><span class="s0">,</span>
                 <span class="s1">np.random.chisquare</span><span class="s0">, </span><span class="s1">np.random.standard_t</span><span class="s0">,</span>
                 <span class="s1">np.random.pareto</span><span class="s0">, </span><span class="s1">np.random.weibull</span><span class="s0">,</span>
                 <span class="s1">np.random.power</span><span class="s0">, </span><span class="s1">np.random.rayleigh</span><span class="s0">,</span>
                 <span class="s1">np.random.poisson</span><span class="s0">, </span><span class="s1">np.random.zipf</span><span class="s0">,</span>
                 <span class="s1">np.random.geometric</span><span class="s0">, </span><span class="s1">np.random.logseries)</span>

        <span class="s1">probfuncs = (np.random.geometric</span><span class="s0">, </span><span class="s1">np.random.logseries)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs:  </span><span class="s3"># p &lt; 1.0</span>
                <span class="s1">out = func(np.array([</span><span class="s2">0.5</span><span class="s1">]))</span>

            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">out = func(self.argOne)</span>

            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

    <span class="s0">def </span><span class="s1">test_two_arg_funcs(self):</span>
        <span class="s1">funcs = (np.random.uniform</span><span class="s0">, </span><span class="s1">np.random.normal</span><span class="s0">,</span>
                 <span class="s1">np.random.beta</span><span class="s0">, </span><span class="s1">np.random.gamma</span><span class="s0">,</span>
                 <span class="s1">np.random.f</span><span class="s0">, </span><span class="s1">np.random.noncentral_chisquare</span><span class="s0">,</span>
                 <span class="s1">np.random.vonmises</span><span class="s0">, </span><span class="s1">np.random.laplace</span><span class="s0">,</span>
                 <span class="s1">np.random.gumbel</span><span class="s0">, </span><span class="s1">np.random.logistic</span><span class="s0">,</span>
                 <span class="s1">np.random.lognormal</span><span class="s0">, </span><span class="s1">np.random.wald</span><span class="s0">,</span>
                 <span class="s1">np.random.binomial</span><span class="s0">, </span><span class="s1">np.random.negative_binomial)</span>

        <span class="s1">probfuncs = (np.random.binomial</span><span class="s0">, </span><span class="s1">np.random.negative_binomial)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs:  </span><span class="s3"># p &lt;= 1</span>
                <span class="s1">argTwo = np.array([</span><span class="s2">0.5</span><span class="s1">])</span>

            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">argTwo = self.argTwo</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">argTwo)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne[</span><span class="s2">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">argTwo)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">argTwo[</span><span class="s2">0</span><span class="s1">])</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

<span class="s3"># TODO: Uncomment once randint can broadcast arguments</span>
<span class="s3">#    def test_randint(self):</span>
<span class="s3">#        itype = [bool, np.int8, np.uint8, np.int16, np.uint16,</span>
<span class="s3">#                 np.int32, np.uint32, np.int64, np.uint64]</span>
<span class="s3">#        func = np.random.randint</span>
<span class="s3">#        high = np.array([1])</span>
<span class="s3">#        low = np.array([0])</span>
<span class="s3">#</span>
<span class="s3">#        for dt in itype:</span>
<span class="s3">#            out = func(low, high, dtype=dt)</span>
<span class="s3">#            self.assert_equal(out.shape, self.tgtShape)</span>
<span class="s3">#</span>
<span class="s3">#            out = func(low[0], high, dtype=dt)</span>
<span class="s3">#            self.assert_equal(out.shape, self.tgtShape)</span>
<span class="s3">#</span>
<span class="s3">#            out = func(low, high[0], dtype=dt)</span>
<span class="s3">#            self.assert_equal(out.shape, self.tgtShape)</span>

    <span class="s0">def </span><span class="s1">test_three_arg_funcs(self):</span>
        <span class="s1">funcs = [np.random.noncentral_f</span><span class="s0">, </span><span class="s1">np.random.triangular</span><span class="s0">,</span>
                 <span class="s1">np.random.hypergeometric]</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">self.argTwo</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne[</span><span class="s2">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">self.argTwo</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">self.argTwo[</span><span class="s2">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>
</pre>
</body>
</html>