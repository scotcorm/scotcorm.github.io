<html>
<head>
<title>test_datetimelike.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_datetimelike.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; Test cases for time series specific (freq conversion, etc) &quot;&quot;&quot;</span>
<span class="s2">from </span><span class="s1">datetime </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">date</span><span class="s2">,</span>
    <span class="s1">datetime</span><span class="s2">,</span>
    <span class="s1">time</span><span class="s2">,</span>
    <span class="s1">timedelta</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">import </span><span class="s1">pickle</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">from </span><span class="s1">pandas._libs.tslibs </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">BaseOffset</span><span class="s2">,</span>
    <span class="s1">to_offset</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">import </span><span class="s1">pandas.util._test_decorators </span><span class="s2">as </span><span class="s1">td</span>

<span class="s2">from </span><span class="s1">pandas </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">DataFrame</span><span class="s2">,</span>
    <span class="s1">Index</span><span class="s2">,</span>
    <span class="s1">NaT</span><span class="s2">,</span>
    <span class="s1">Series</span><span class="s2">,</span>
    <span class="s1">concat</span><span class="s2">,</span>
    <span class="s1">isna</span><span class="s2">,</span>
    <span class="s1">to_datetime</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">import </span><span class="s1">pandas._testing </span><span class="s2">as </span><span class="s1">tm</span>
<span class="s2">from </span><span class="s1">pandas.core.indexes.datetimes </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">DatetimeIndex</span><span class="s2">,</span>
    <span class="s1">bdate_range</span><span class="s2">,</span>
    <span class="s1">date_range</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">from </span><span class="s1">pandas.core.indexes.period </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">Period</span><span class="s2">,</span>
    <span class="s1">PeriodIndex</span><span class="s2">,</span>
    <span class="s1">period_range</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">from </span><span class="s1">pandas.core.indexes.timedeltas </span><span class="s2">import </span><span class="s1">timedelta_range</span>
<span class="s2">from </span><span class="s1">pandas.tests.plotting.common </span><span class="s2">import </span><span class="s1">TestPlotBase</span>

<span class="s2">from </span><span class="s1">pandas.tseries.offsets </span><span class="s2">import </span><span class="s1">WeekOfMonth</span>

<span class="s1">pytestmark = pytest.mark.slow</span>


<span class="s1">@td.skip_if_no_mpl</span>
<span class="s2">class </span><span class="s1">TestTSPlot(TestPlotBase):</span>
    <span class="s2">def </span><span class="s1">setup_method(self</span><span class="s2">, </span><span class="s1">method):</span>
        <span class="s1">TestPlotBase.setup_method(self</span><span class="s2">, </span><span class="s1">method)</span>

        <span class="s1">self.freq = [</span><span class="s3">&quot;S&quot;</span><span class="s2">, </span><span class="s3">&quot;T&quot;</span><span class="s2">, </span><span class="s3">&quot;H&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s3">&quot;W&quot;</span><span class="s2">, </span><span class="s3">&quot;M&quot;</span><span class="s2">, </span><span class="s3">&quot;Q&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s1">]</span>
        <span class="s1">idx = [period_range(</span><span class="s3">&quot;12/31/1999&quot;</span><span class="s2">, </span><span class="s1">freq=x</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">100</span><span class="s1">) </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">self.freq]</span>
        <span class="s1">self.period_ser = [Series(np.random.randn(len(x))</span><span class="s2">, </span><span class="s1">x) </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">idx]</span>
        <span class="s1">self.period_df = [</span>
            <span class="s1">DataFrame(np.random.randn(len(x)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=x</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">])</span>
            <span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">idx</span>
        <span class="s1">]</span>

        <span class="s1">freq = [</span><span class="s3">&quot;S&quot;</span><span class="s2">, </span><span class="s3">&quot;T&quot;</span><span class="s2">, </span><span class="s3">&quot;H&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s3">&quot;W&quot;</span><span class="s2">, </span><span class="s3">&quot;M&quot;</span><span class="s2">, </span><span class="s3">&quot;Q-DEC&quot;</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;1B30Min&quot;</span><span class="s1">]</span>
        <span class="s1">idx = [date_range(</span><span class="s3">&quot;12/31/1999&quot;</span><span class="s2">, </span><span class="s1">freq=x</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">100</span><span class="s1">) </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">freq]</span>
        <span class="s1">self.datetime_ser = [Series(np.random.randn(len(x))</span><span class="s2">, </span><span class="s1">x) </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">idx]</span>
        <span class="s1">self.datetime_df = [</span>
            <span class="s1">DataFrame(np.random.randn(len(x)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=x</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">])</span>
            <span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">idx</span>
        <span class="s1">]</span>

    <span class="s2">def </span><span class="s1">teardown_method(self</span><span class="s2">, </span><span class="s1">method):</span>
        <span class="s1">tm.close()</span>

    <span class="s2">def </span><span class="s1">test_ts_plot_with_tz(self</span><span class="s2">, </span><span class="s1">tz_aware_fixture):</span>
        <span class="s5"># GH2877, GH17173, GH31205, GH31580</span>
        <span class="s1">tz = tz_aware_fixture</span>
        <span class="s1">index = date_range(</span><span class="s3">&quot;1/1/2011&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;H&quot;</span><span class="s2">, </span><span class="s1">tz=tz)</span>
        <span class="s1">ts = Series([</span><span class="s4">188.5</span><span class="s2">, </span><span class="s4">328.25</span><span class="s1">]</span><span class="s2">, </span><span class="s1">index=index)</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(</span><span class="s2">None</span><span class="s1">):</span>
            <span class="s1">_check_plot_works(ts.plot)</span>
            <span class="s1">ax = ts.plot()</span>
            <span class="s1">xdata = list(ax.get_lines())[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
            <span class="s5"># Check first and last points' labels are correct</span>
            <span class="s2">assert </span><span class="s1">(xdata[</span><span class="s4">0</span><span class="s1">].hour</span><span class="s2">, </span><span class="s1">xdata[</span><span class="s4">0</span><span class="s1">].minute) == (</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">)</span>
            <span class="s2">assert </span><span class="s1">(xdata[-</span><span class="s4">1</span><span class="s1">].hour</span><span class="s2">, </span><span class="s1">xdata[-</span><span class="s4">1</span><span class="s1">].minute) == (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">0</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_fontsize_set_correctly(self):</span>
        <span class="s5"># For issue #8765</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">9</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=range(</span><span class="s4">10</span><span class="s1">))</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(fontsize=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s2">for </span><span class="s1">label </span><span class="s2">in </span><span class="s1">ax.get_xticklabels() + ax.get_yticklabels():</span>
            <span class="s2">assert </span><span class="s1">label.get_fontsize() == </span><span class="s4">2</span>

    <span class="s2">def </span><span class="s1">test_frame_inferred(self):</span>
        <span class="s5"># inferred freq</span>
        <span class="s1">idx = date_range(</span><span class="s3">&quot;1/1/1987&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;MS&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">100</span><span class="s1">)</span>
        <span class="s1">idx = DatetimeIndex(idx.values</span><span class="s2">, </span><span class="s1">freq=</span><span class="s2">None</span><span class="s1">)</span>

        <span class="s1">df = DataFrame(np.random.randn(len(idx)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idx)</span>
        <span class="s1">_check_plot_works(df.plot)</span>

        <span class="s5"># axes freq</span>
        <span class="s1">idx = idx[</span><span class="s4">0</span><span class="s1">:</span><span class="s4">40</span><span class="s1">].union(idx[</span><span class="s4">45</span><span class="s1">:</span><span class="s4">99</span><span class="s1">])</span>
        <span class="s1">df2 = DataFrame(np.random.randn(len(idx)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idx)</span>
        <span class="s1">_check_plot_works(df2.plot)</span>

        <span class="s5"># N &gt; 1</span>
        <span class="s1">idx = date_range(</span><span class="s3">&quot;2008-1-1 00:15:00&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;15T&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s1">)</span>
        <span class="s1">idx = DatetimeIndex(idx.values</span><span class="s2">, </span><span class="s1">freq=</span><span class="s2">None</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(len(idx)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idx)</span>
        <span class="s1">_check_plot_works(df.plot)</span>

    <span class="s2">def </span><span class="s1">test_is_error_nozeroindex(self):</span>
        <span class="s5"># GH11858</span>
        <span class="s1">i = np.array([</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s1">])</span>
        <span class="s1">a = DataFrame(i</span><span class="s2">, </span><span class="s1">index=i)</span>
        <span class="s1">_check_plot_works(a.plot</span><span class="s2">, </span><span class="s1">xerr=a)</span>
        <span class="s1">_check_plot_works(a.plot</span><span class="s2">, </span><span class="s1">yerr=a)</span>

    <span class="s2">def </span><span class="s1">test_nonnumeric_exclude(self):</span>
        <span class="s1">idx = date_range(</span><span class="s3">&quot;1/1/1987&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">3</span><span class="s1">)</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;A&quot;</span><span class="s1">: [</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s3">&quot;z&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]}</span><span class="s2">, </span><span class="s1">idx)</span>

        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(ax=ax)  </span><span class="s5"># it works</span>
        <span class="s2">assert </span><span class="s1">len(ax.get_lines()) == </span><span class="s4">1  </span><span class="s5"># B was plotted</span>
        <span class="s1">self.plt.close(fig)</span>

        <span class="s1">msg = </span><span class="s3">&quot;no numeric data to plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(TypeError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df[</span><span class="s3">&quot;A&quot;</span><span class="s1">].plot()</span>

    <span class="s2">def </span><span class="s1">test_tsplot(self):</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ts = tm.makeTimeSeries()</span>

        <span class="s2">for </span><span class="s1">s </span><span class="s2">in </span><span class="s1">self.period_ser:</span>
            <span class="s1">_check_plot_works(s.plot</span><span class="s2">, </span><span class="s1">ax=ax)</span>

        <span class="s2">for </span><span class="s1">s </span><span class="s2">in </span><span class="s1">self.datetime_ser:</span>
            <span class="s1">_check_plot_works(s.plot</span><span class="s2">, </span><span class="s1">ax=ax)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ts.plot(style=</span><span class="s3">&quot;k&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">color = (</span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">0.0</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">color == ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_color()</span>

    <span class="s2">def </span><span class="s1">test_both_style_and_color(self):</span>

        <span class="s1">ts = tm.makeTimeSeries()</span>
        <span class="s1">msg = (</span>
            <span class="s3">&quot;Cannot pass 'style' string with a color symbol and 'color' &quot;</span>
            <span class="s3">&quot;keyword argument. Please use one or the other or pass 'style' &quot;</span>
            <span class="s3">&quot;without a color symbol&quot;</span>
        <span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">ts.plot(style=</span><span class="s3">&quot;b-&quot;</span><span class="s2">, </span><span class="s1">color=</span><span class="s3">&quot;#000099&quot;</span><span class="s1">)</span>

        <span class="s1">s = ts.reset_index(drop=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">s.plot(style=</span><span class="s3">&quot;b-&quot;</span><span class="s2">, </span><span class="s1">color=</span><span class="s3">&quot;#000099&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_high_freq(self):</span>
        <span class="s1">freaks = [</span><span class="s3">&quot;ms&quot;</span><span class="s2">, </span><span class="s3">&quot;us&quot;</span><span class="s1">]</span>
        <span class="s2">for </span><span class="s1">freq </span><span class="s2">in </span><span class="s1">freaks:</span>
            <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
            <span class="s1">rng = date_range(</span><span class="s3">&quot;1/1/2012&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">100</span><span class="s2">, </span><span class="s1">freq=freq)</span>
            <span class="s1">ser = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
            <span class="s1">_check_plot_works(ser.plot</span><span class="s2">, </span><span class="s1">ax=ax)</span>

    <span class="s2">def </span><span class="s1">test_get_datevalue(self):</span>
        <span class="s2">from </span><span class="s1">pandas.plotting._matplotlib.converter </span><span class="s2">import </span><span class="s1">get_datevalue</span>

        <span class="s2">assert </span><span class="s1">get_datevalue(</span><span class="s2">None, </span><span class="s3">&quot;D&quot;</span><span class="s1">) </span><span class="s2">is None</span>
        <span class="s2">assert </span><span class="s1">get_datevalue(</span><span class="s4">1987</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s1">) == </span><span class="s4">1987</span>
        <span class="s2">assert </span><span class="s1">get_datevalue(Period(</span><span class="s4">1987</span><span class="s2">, </span><span class="s3">&quot;A&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;M&quot;</span><span class="s1">) == Period(</span><span class="s3">&quot;1987-12&quot;</span><span class="s2">, </span><span class="s3">&quot;M&quot;</span><span class="s1">).ordinal</span>
        <span class="s2">assert </span><span class="s1">get_datevalue(</span><span class="s3">&quot;1/1/1987&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s1">) == Period(</span><span class="s3">&quot;1987-1-1&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s1">).ordinal</span>

    <span class="s2">def </span><span class="s1">test_ts_plot_format_coord(self):</span>
        <span class="s2">def </span><span class="s1">check_format_of_first_point(ax</span><span class="s2">, </span><span class="s1">expected_string):</span>
            <span class="s1">first_line = ax.get_lines()[</span><span class="s4">0</span><span class="s1">]</span>
            <span class="s1">first_x = first_line.get_xdata()[</span><span class="s4">0</span><span class="s1">].ordinal</span>
            <span class="s1">first_y = first_line.get_ydata()[</span><span class="s4">0</span><span class="s1">]</span>
            <span class="s2">assert </span><span class="s1">expected_string == ax.format_coord(first_x</span><span class="s2">, </span><span class="s1">first_y)</span>

        <span class="s1">annual = Series(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">index=date_range(</span><span class="s3">&quot;2014-01-01&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;A-DEC&quot;</span><span class="s1">))</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">annual.plot(ax=ax)</span>
        <span class="s1">check_format_of_first_point(ax</span><span class="s2">, </span><span class="s3">&quot;t = 2014  y = 1.000000&quot;</span><span class="s1">)</span>

        <span class="s5"># note this is added to the annual plot already in existence, and</span>
        <span class="s5"># changes its freq field</span>
        <span class="s1">daily = Series(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">index=date_range(</span><span class="s3">&quot;2014-01-01&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s1">))</span>
        <span class="s1">daily.plot(ax=ax)</span>
        <span class="s1">check_format_of_first_point(ax</span><span class="s2">, </span><span class="s3">&quot;t = 2014-01-01  y = 1.000000&quot;</span><span class="s1">)</span>
        <span class="s1">tm.close()</span>

    <span class="s2">def </span><span class="s1">test_line_plot_period_series(self):</span>
        <span class="s2">for </span><span class="s1">s </span><span class="s2">in </span><span class="s1">self.period_ser:</span>
            <span class="s1">_check_plot_works(s.plot</span><span class="s2">, </span><span class="s1">s.index.freq)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;frqncy&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;1S&quot;</span><span class="s2">, </span><span class="s3">&quot;3S&quot;</span><span class="s2">, </span><span class="s3">&quot;5T&quot;</span><span class="s2">, </span><span class="s3">&quot;7H&quot;</span><span class="s2">, </span><span class="s3">&quot;4D&quot;</span><span class="s2">, </span><span class="s3">&quot;8W&quot;</span><span class="s2">, </span><span class="s3">&quot;11M&quot;</span><span class="s2">, </span><span class="s3">&quot;3A&quot;</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_line_plot_period_mlt_series(self</span><span class="s2">, </span><span class="s1">frqncy):</span>
        <span class="s5"># test period index line plot for series with multiples (`mlt`) of the</span>
        <span class="s5"># frequency (`frqncy`) rule code. tests resolution of issue #14763</span>
        <span class="s1">idx = period_range(</span><span class="s3">&quot;12/31/1999&quot;</span><span class="s2">, </span><span class="s1">freq=frqncy</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">100</span><span class="s1">)</span>
        <span class="s1">s = Series(np.random.randn(len(idx))</span><span class="s2">, </span><span class="s1">idx)</span>
        <span class="s1">_check_plot_works(s.plot</span><span class="s2">, </span><span class="s1">s.index.freq.rule_code)</span>

    <span class="s2">def </span><span class="s1">test_line_plot_datetime_series(self):</span>
        <span class="s2">for </span><span class="s1">s </span><span class="s2">in </span><span class="s1">self.datetime_ser:</span>
            <span class="s1">_check_plot_works(s.plot</span><span class="s2">, </span><span class="s1">s.index.freq.rule_code)</span>

    <span class="s2">def </span><span class="s1">test_line_plot_period_frame(self):</span>
        <span class="s2">for </span><span class="s1">df </span><span class="s2">in </span><span class="s1">self.period_df:</span>
            <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">df.index.freq)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;frqncy&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;1S&quot;</span><span class="s2">, </span><span class="s3">&quot;3S&quot;</span><span class="s2">, </span><span class="s3">&quot;5T&quot;</span><span class="s2">, </span><span class="s3">&quot;7H&quot;</span><span class="s2">, </span><span class="s3">&quot;4D&quot;</span><span class="s2">, </span><span class="s3">&quot;8W&quot;</span><span class="s2">, </span><span class="s3">&quot;11M&quot;</span><span class="s2">, </span><span class="s3">&quot;3A&quot;</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_line_plot_period_mlt_frame(self</span><span class="s2">, </span><span class="s1">frqncy):</span>
        <span class="s5"># test period index line plot for DataFrames with multiples (`mlt`)</span>
        <span class="s5"># of the frequency (`frqncy`) rule code. tests resolution of issue</span>
        <span class="s5"># #14763</span>
        <span class="s1">idx = period_range(</span><span class="s3">&quot;12/31/1999&quot;</span><span class="s2">, </span><span class="s1">freq=frqncy</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">100</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(len(idx)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idx</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">])</span>
        <span class="s1">freq = df.index.asfreq(df.index.freq.rule_code).freq</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">freq)</span>

    <span class="s2">def </span><span class="s1">test_line_plot_datetime_frame(self):</span>
        <span class="s2">for </span><span class="s1">df </span><span class="s2">in </span><span class="s1">self.datetime_df:</span>
            <span class="s1">freq = df.index.to_period(df.index.freq.rule_code).freq</span>
            <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">freq)</span>

    <span class="s2">def </span><span class="s1">test_line_plot_inferred_freq(self):</span>
        <span class="s2">for </span><span class="s1">ser </span><span class="s2">in </span><span class="s1">self.datetime_ser:</span>
            <span class="s1">ser = Series(ser.values</span><span class="s2">, </span><span class="s1">Index(np.asarray(ser.index)))</span>
            <span class="s1">_check_plot_works(ser.plot</span><span class="s2">, </span><span class="s1">ser.index.inferred_freq)</span>

            <span class="s1">ser = ser[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s1">]]</span>
            <span class="s1">_check_plot_works(ser.plot)</span>

    <span class="s2">def </span><span class="s1">test_fake_inferred_business(self):</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">rng = date_range(</span><span class="s3">&quot;2001-1-1&quot;</span><span class="s2">, </span><span class="s3">&quot;2001-1-10&quot;</span><span class="s1">)</span>
        <span class="s1">ts = Series(range(len(rng))</span><span class="s2">, </span><span class="s1">index=rng)</span>
        <span class="s1">ts = concat([ts[:</span><span class="s4">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ts[</span><span class="s4">5</span><span class="s1">:]])</span>
        <span class="s1">ts.plot(ax=ax)</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;freq&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_plot_offset_freq(self):</span>
        <span class="s1">ser = tm.makeTimeSeries()</span>
        <span class="s1">_check_plot_works(ser.plot)</span>

        <span class="s1">dr = date_range(ser.index[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;BQS&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s1">)</span>
        <span class="s1">ser = Series(np.random.randn(len(dr))</span><span class="s2">, </span><span class="s1">index=dr)</span>
        <span class="s1">_check_plot_works(ser.plot)</span>

    <span class="s2">def </span><span class="s1">test_plot_multiple_inferred_freq(self):</span>
        <span class="s1">dr = Index([datetime(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">datetime(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">6</span><span class="s1">)</span><span class="s2">, </span><span class="s1">datetime(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">11</span><span class="s1">)])</span>
        <span class="s1">ser = Series(np.random.randn(len(dr))</span><span class="s2">, </span><span class="s1">index=dr)</span>
        <span class="s1">_check_plot_works(ser.plot)</span>

    <span class="s2">def </span><span class="s1">test_uhf(self):</span>
        <span class="s2">import </span><span class="s1">pandas.plotting._matplotlib.converter </span><span class="s2">as </span><span class="s1">conv</span>

        <span class="s1">idx = date_range(</span><span class="s3">&quot;2012-6-22 21:59:51.960928&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;L&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">500</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(len(idx)</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idx)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(ax=ax)</span>
        <span class="s1">axis = ax.get_xaxis()</span>

        <span class="s1">tlocs = axis.get_ticklocs()</span>
        <span class="s1">tlabels = axis.get_ticklabels()</span>
        <span class="s2">for </span><span class="s1">loc</span><span class="s2">, </span><span class="s1">label </span><span class="s2">in </span><span class="s1">zip(tlocs</span><span class="s2">, </span><span class="s1">tlabels):</span>
            <span class="s1">xp = conv._from_ordinal(loc).strftime(</span><span class="s3">&quot;%H:%M:%S.%f&quot;</span><span class="s1">)</span>
            <span class="s1">rs = str(label.get_text())</span>
            <span class="s2">if </span><span class="s1">len(rs):</span>
                <span class="s2">assert </span><span class="s1">xp == rs</span>

    <span class="s2">def </span><span class="s1">test_irreg_hf(self):</span>
        <span class="s1">idx = date_range(</span><span class="s3">&quot;2012-6-22 21:59:51&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;S&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">100</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(len(idx)</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idx)</span>

        <span class="s1">irreg = df.iloc[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s1">]]</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">irreg.plot(ax=ax)</span>
        <span class="s1">diffs = Series(ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xydata()[:</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]).diff()</span>

        <span class="s1">sec = </span><span class="s4">1.0 </span><span class="s1">/ </span><span class="s4">24 </span><span class="s1">/ </span><span class="s4">60 </span><span class="s1">/ </span><span class="s4">60</span>
        <span class="s2">assert </span><span class="s1">(np.fabs(diffs[</span><span class="s4">1</span><span class="s1">:] - [sec</span><span class="s2">, </span><span class="s1">sec * </span><span class="s4">2</span><span class="s2">, </span><span class="s1">sec]) &lt; </span><span class="s4">1e-8</span><span class="s1">).all()</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df2 = df.copy()</span>
        <span class="s1">df2.index = df.index.astype(object)</span>
        <span class="s1">df2.plot(ax=ax)</span>
        <span class="s1">diffs = Series(ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xydata()[:</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]).diff()</span>
        <span class="s2">assert </span><span class="s1">(np.fabs(diffs[</span><span class="s4">1</span><span class="s1">:] - sec) &lt; </span><span class="s4">1e-8</span><span class="s1">).all()</span>

    <span class="s2">def </span><span class="s1">test_irregular_datetime64_repr_bug(self):</span>
        <span class="s1">ser = tm.makeTimeSeries()</span>
        <span class="s1">ser = ser[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">7</span><span class="s1">]]</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>

        <span class="s1">ret = ser.plot(ax=ax)</span>
        <span class="s2">assert </span><span class="s1">ret </span><span class="s2">is not None</span>

        <span class="s2">for </span><span class="s1">rs</span><span class="s2">, </span><span class="s1">xp </span><span class="s2">in </span><span class="s1">zip(ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xdata()</span><span class="s2">, </span><span class="s1">ser.index):</span>
            <span class="s2">assert </span><span class="s1">rs == xp</span>

    <span class="s2">def </span><span class="s1">test_business_freq(self):</span>
        <span class="s1">bts = tm.makePeriodSeries()</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">bts.plot(ax=ax)</span>
        <span class="s2">assert </span><span class="s1">ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xydata()[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">] == bts.index[</span><span class="s4">0</span><span class="s1">].ordinal</span>
        <span class="s1">idx = ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
        <span class="s2">assert </span><span class="s1">PeriodIndex(data=idx).freqstr == </span><span class="s3">&quot;B&quot;</span>

    <span class="s2">def </span><span class="s1">test_business_freq_convert(self):</span>
        <span class="s1">bts = tm.makeTimeSeries(</span><span class="s4">300</span><span class="s1">).asfreq(</span><span class="s3">&quot;BM&quot;</span><span class="s1">)</span>
        <span class="s1">ts = bts.to_period(</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">bts.plot(ax=ax)</span>
        <span class="s2">assert </span><span class="s1">ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xydata()[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">] == ts.index[</span><span class="s4">0</span><span class="s1">].ordinal</span>
        <span class="s1">idx = ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
        <span class="s2">assert </span><span class="s1">PeriodIndex(data=idx).freqstr == </span><span class="s3">&quot;M&quot;</span>

    <span class="s2">def </span><span class="s1">test_freq_with_no_period_alias(self):</span>
        <span class="s5"># GH34487</span>
        <span class="s1">freq = WeekOfMonth()</span>
        <span class="s1">bts = tm.makeTimeSeries(</span><span class="s4">5</span><span class="s1">).asfreq(freq)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">bts.plot(ax=ax)</span>

        <span class="s1">idx = ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
        <span class="s1">msg = </span><span class="s3">&quot;freq not specified and cannot be inferred&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">PeriodIndex(data=idx)</span>

    <span class="s2">def </span><span class="s1">test_nonzero_base(self):</span>
        <span class="s5"># GH2571</span>
        <span class="s1">idx = date_range(</span><span class="s3">&quot;2012-12-20&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">24</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;H&quot;</span><span class="s1">) + timedelta(minutes=</span><span class="s4">30</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.arange(</span><span class="s4">24</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idx)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(ax=ax)</span>
        <span class="s1">rs = ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
        <span class="s2">assert not </span><span class="s1">Index(rs).is_normalized</span>

    <span class="s2">def </span><span class="s1">test_dataframe(self):</span>
        <span class="s1">bts = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: tm.makeTimeSeries()})</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">bts.plot(ax=ax)</span>
        <span class="s1">idx = ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
        <span class="s1">tm.assert_index_equal(bts.index.to_period()</span><span class="s2">, </span><span class="s1">PeriodIndex(idx))</span>

    <span class="s2">def </span><span class="s1">test_axis_limits(self):</span>
        <span class="s2">def </span><span class="s1">_test(ax):</span>
            <span class="s1">xlim = ax.get_xlim()</span>
            <span class="s1">ax.set_xlim(xlim[</span><span class="s4">0</span><span class="s1">] - </span><span class="s4">5</span><span class="s2">, </span><span class="s1">xlim[</span><span class="s4">1</span><span class="s1">] + </span><span class="s4">10</span><span class="s1">)</span>
            <span class="s1">result = ax.get_xlim()</span>
            <span class="s2">assert </span><span class="s1">result[</span><span class="s4">0</span><span class="s1">] == xlim[</span><span class="s4">0</span><span class="s1">] - </span><span class="s4">5</span>
            <span class="s2">assert </span><span class="s1">result[</span><span class="s4">1</span><span class="s1">] == xlim[</span><span class="s4">1</span><span class="s1">] + </span><span class="s4">10</span>

            <span class="s5"># string</span>
            <span class="s1">expected = (Period(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">ax.freq)</span><span class="s2">, </span><span class="s1">Period(</span><span class="s3">&quot;4/1/2000&quot;</span><span class="s2">, </span><span class="s1">ax.freq))</span>
            <span class="s1">ax.set_xlim(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s3">&quot;4/1/2000&quot;</span><span class="s1">)</span>
            <span class="s1">result = ax.get_xlim()</span>
            <span class="s2">assert </span><span class="s1">int(result[</span><span class="s4">0</span><span class="s1">]) == expected[</span><span class="s4">0</span><span class="s1">].ordinal</span>
            <span class="s2">assert </span><span class="s1">int(result[</span><span class="s4">1</span><span class="s1">]) == expected[</span><span class="s4">1</span><span class="s1">].ordinal</span>

            <span class="s5"># datetime</span>
            <span class="s1">expected = (Period(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">ax.freq)</span><span class="s2">, </span><span class="s1">Period(</span><span class="s3">&quot;4/1/2000&quot;</span><span class="s2">, </span><span class="s1">ax.freq))</span>
            <span class="s1">ax.set_xlim(datetime(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">datetime(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>
            <span class="s1">result = ax.get_xlim()</span>
            <span class="s2">assert </span><span class="s1">int(result[</span><span class="s4">0</span><span class="s1">]) == expected[</span><span class="s4">0</span><span class="s1">].ordinal</span>
            <span class="s2">assert </span><span class="s1">int(result[</span><span class="s4">1</span><span class="s1">]) == expected[</span><span class="s4">1</span><span class="s1">].ordinal</span>
            <span class="s1">fig = ax.get_figure()</span>
            <span class="s1">self.plt.close(fig)</span>

        <span class="s1">ser = tm.makeTimeSeries()</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ser.plot(ax=ax)</span>
        <span class="s1">_test(ax)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: ser</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: ser + </span><span class="s4">1</span><span class="s1">})</span>
        <span class="s1">df.plot(ax=ax)</span>
        <span class="s1">_test(ax)</span>

        <span class="s1">df = DataFrame({</span><span class="s3">&quot;a&quot;</span><span class="s1">: ser</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: ser + </span><span class="s4">1</span><span class="s1">})</span>
        <span class="s1">axes = df.plot(subplots=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes:</span>
            <span class="s1">_test(ax)</span>

    <span class="s2">def </span><span class="s1">test_get_finder(self):</span>
        <span class="s2">import </span><span class="s1">pandas.plotting._matplotlib.converter </span><span class="s2">as </span><span class="s1">conv</span>

        <span class="s2">assert </span><span class="s1">conv.get_finder(to_offset(</span><span class="s3">&quot;B&quot;</span><span class="s1">)) == conv._daily_finder</span>
        <span class="s2">assert </span><span class="s1">conv.get_finder(to_offset(</span><span class="s3">&quot;D&quot;</span><span class="s1">)) == conv._daily_finder</span>
        <span class="s2">assert </span><span class="s1">conv.get_finder(to_offset(</span><span class="s3">&quot;M&quot;</span><span class="s1">)) == conv._monthly_finder</span>
        <span class="s2">assert </span><span class="s1">conv.get_finder(to_offset(</span><span class="s3">&quot;Q&quot;</span><span class="s1">)) == conv._quarterly_finder</span>
        <span class="s2">assert </span><span class="s1">conv.get_finder(to_offset(</span><span class="s3">&quot;A&quot;</span><span class="s1">)) == conv._annual_finder</span>
        <span class="s2">assert </span><span class="s1">conv.get_finder(to_offset(</span><span class="s3">&quot;W&quot;</span><span class="s1">)) == conv._daily_finder</span>

    <span class="s2">def </span><span class="s1">test_finder_daily(self):</span>
        <span class="s1">day_lst = [</span><span class="s4">10</span><span class="s2">, </span><span class="s4">40</span><span class="s2">, </span><span class="s4">252</span><span class="s2">, </span><span class="s4">400</span><span class="s2">, </span><span class="s4">950</span><span class="s2">, </span><span class="s4">2750</span><span class="s2">, </span><span class="s4">10000</span><span class="s1">]</span>

        <span class="s1">xpl1 = xpl2 = [Period(</span><span class="s3">&quot;1999-1-1&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;B&quot;</span><span class="s1">).ordinal] * len(day_lst)</span>
        <span class="s1">rs1 = []</span>
        <span class="s1">rs2 = []</span>
        <span class="s2">for </span><span class="s1">n </span><span class="s2">in </span><span class="s1">day_lst:</span>
            <span class="s1">rng = bdate_range(</span><span class="s3">&quot;1999-1-1&quot;</span><span class="s2">, </span><span class="s1">periods=n)</span>
            <span class="s1">ser = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
            <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
            <span class="s1">ser.plot(ax=ax)</span>
            <span class="s1">xaxis = ax.get_xaxis()</span>
            <span class="s1">rs1.append(xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">])</span>

            <span class="s1">vmin</span><span class="s2">, </span><span class="s1">vmax = ax.get_xlim()</span>
            <span class="s1">ax.set_xlim(vmin + </span><span class="s4">0.9</span><span class="s2">, </span><span class="s1">vmax)</span>
            <span class="s1">rs2.append(xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">])</span>
            <span class="s1">self.plt.close(ax.get_figure())</span>

        <span class="s2">assert </span><span class="s1">rs1 == xpl1</span>
        <span class="s2">assert </span><span class="s1">rs2 == xpl2</span>

    <span class="s2">def </span><span class="s1">test_finder_quarterly(self):</span>
        <span class="s1">yrs = [</span><span class="s4">3.5</span><span class="s2">, </span><span class="s4">11</span><span class="s1">]</span>

        <span class="s1">xpl1 = xpl2 = [Period(</span><span class="s3">&quot;1988Q1&quot;</span><span class="s1">).ordinal] * len(yrs)</span>
        <span class="s1">rs1 = []</span>
        <span class="s1">rs2 = []</span>
        <span class="s2">for </span><span class="s1">n </span><span class="s2">in </span><span class="s1">yrs:</span>
            <span class="s1">rng = period_range(</span><span class="s3">&quot;1987Q2&quot;</span><span class="s2">, </span><span class="s1">periods=int(n * </span><span class="s4">4</span><span class="s1">)</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;Q&quot;</span><span class="s1">)</span>
            <span class="s1">ser = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
            <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
            <span class="s1">ser.plot(ax=ax)</span>
            <span class="s1">xaxis = ax.get_xaxis()</span>
            <span class="s1">rs1.append(xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">])</span>

            <span class="s1">(vmin</span><span class="s2">, </span><span class="s1">vmax) = ax.get_xlim()</span>
            <span class="s1">ax.set_xlim(vmin + </span><span class="s4">0.9</span><span class="s2">, </span><span class="s1">vmax)</span>
            <span class="s1">rs2.append(xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">])</span>
            <span class="s1">self.plt.close(ax.get_figure())</span>

        <span class="s2">assert </span><span class="s1">rs1 == xpl1</span>
        <span class="s2">assert </span><span class="s1">rs2 == xpl2</span>

    <span class="s2">def </span><span class="s1">test_finder_monthly(self):</span>
        <span class="s1">yrs = [</span><span class="s4">1.15</span><span class="s2">, </span><span class="s4">2.5</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">11</span><span class="s1">]</span>

        <span class="s1">xpl1 = xpl2 = [Period(</span><span class="s3">&quot;Jan 1988&quot;</span><span class="s1">).ordinal] * len(yrs)</span>
        <span class="s1">rs1 = []</span>
        <span class="s1">rs2 = []</span>
        <span class="s2">for </span><span class="s1">n </span><span class="s2">in </span><span class="s1">yrs:</span>
            <span class="s1">rng = period_range(</span><span class="s3">&quot;1987Q2&quot;</span><span class="s2">, </span><span class="s1">periods=int(n * </span><span class="s4">12</span><span class="s1">)</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
            <span class="s1">ser = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
            <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
            <span class="s1">ser.plot(ax=ax)</span>
            <span class="s1">xaxis = ax.get_xaxis()</span>
            <span class="s1">rs1.append(xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">])</span>

            <span class="s1">vmin</span><span class="s2">, </span><span class="s1">vmax = ax.get_xlim()</span>
            <span class="s1">ax.set_xlim(vmin + </span><span class="s4">0.9</span><span class="s2">, </span><span class="s1">vmax)</span>
            <span class="s1">rs2.append(xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">])</span>
            <span class="s1">self.plt.close(ax.get_figure())</span>

        <span class="s2">assert </span><span class="s1">rs1 == xpl1</span>
        <span class="s2">assert </span><span class="s1">rs2 == xpl2</span>

    <span class="s2">def </span><span class="s1">test_finder_monthly_long(self):</span>
        <span class="s1">rng = period_range(</span><span class="s3">&quot;1988Q1&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">24 </span><span class="s1">* </span><span class="s4">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">ser = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ser.plot(ax=ax)</span>
        <span class="s1">xaxis = ax.get_xaxis()</span>
        <span class="s1">rs = xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">xp = Period(</span><span class="s3">&quot;1989Q1&quot;</span><span class="s2">, </span><span class="s3">&quot;M&quot;</span><span class="s1">).ordinal</span>
        <span class="s2">assert </span><span class="s1">rs == xp</span>

    <span class="s2">def </span><span class="s1">test_finder_annual(self):</span>
        <span class="s1">xp = [</span><span class="s4">1987</span><span class="s2">, </span><span class="s4">1988</span><span class="s2">, </span><span class="s4">1990</span><span class="s2">, </span><span class="s4">1990</span><span class="s2">, </span><span class="s4">1995</span><span class="s2">, </span><span class="s4">2020</span><span class="s2">, </span><span class="s4">2070</span><span class="s2">, </span><span class="s4">2170</span><span class="s1">]</span>
        <span class="s1">xp = [Period(x</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;A&quot;</span><span class="s1">).ordinal </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">xp]</span>
        <span class="s1">rs = []</span>
        <span class="s2">for </span><span class="s1">nyears </span><span class="s2">in </span><span class="s1">[</span><span class="s4">5</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">19</span><span class="s2">, </span><span class="s4">49</span><span class="s2">, </span><span class="s4">99</span><span class="s2">, </span><span class="s4">199</span><span class="s2">, </span><span class="s4">599</span><span class="s2">, </span><span class="s4">1001</span><span class="s1">]:</span>
            <span class="s1">rng = period_range(</span><span class="s3">&quot;1987&quot;</span><span class="s2">, </span><span class="s1">periods=nyears</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;A&quot;</span><span class="s1">)</span>
            <span class="s1">ser = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
            <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
            <span class="s1">ser.plot(ax=ax)</span>
            <span class="s1">xaxis = ax.get_xaxis()</span>
            <span class="s1">rs.append(xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">])</span>
            <span class="s1">self.plt.close(ax.get_figure())</span>

        <span class="s2">assert </span><span class="s1">rs == xp</span>

    <span class="s2">def </span><span class="s1">test_finder_minutely(self):</span>
        <span class="s1">nminutes = </span><span class="s4">50 </span><span class="s1">* </span><span class="s4">24 </span><span class="s1">* </span><span class="s4">60</span>
        <span class="s1">rng = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;Min&quot;</span><span class="s2">, </span><span class="s1">periods=nminutes)</span>
        <span class="s1">ser = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ser.plot(ax=ax)</span>
        <span class="s1">xaxis = ax.get_xaxis()</span>
        <span class="s1">rs = xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">xp = Period(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;Min&quot;</span><span class="s1">).ordinal</span>

        <span class="s2">assert </span><span class="s1">rs == xp</span>

    <span class="s2">def </span><span class="s1">test_finder_hourly(self):</span>
        <span class="s1">nhours = </span><span class="s4">23</span>
        <span class="s1">rng = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;H&quot;</span><span class="s2">, </span><span class="s1">periods=nhours)</span>
        <span class="s1">ser = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ser.plot(ax=ax)</span>
        <span class="s1">xaxis = ax.get_xaxis()</span>
        <span class="s1">rs = xaxis.get_majorticklocs()[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">xp = Period(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;H&quot;</span><span class="s1">).ordinal</span>

        <span class="s2">assert </span><span class="s1">rs == xp</span>

    <span class="s2">def </span><span class="s1">test_gaps(self):</span>
        <span class="s1">ts = tm.makeTimeSeries()</span>
        <span class="s1">ts[</span><span class="s4">5</span><span class="s1">:</span><span class="s4">25</span><span class="s1">] = np.nan</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ts.plot(ax=ax)</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">len(lines) == </span><span class="s4">1</span>
        <span class="s1">line = lines[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">data = line.get_xydata()</span>

        <span class="s2">if </span><span class="s1">self.mpl_ge_3_0_0 </span><span class="s2">or not </span><span class="s1">self.mpl_ge_2_2_3:</span>
            <span class="s1">data = np.ma.MaskedArray(data</span><span class="s2">, </span><span class="s1">mask=isna(data)</span><span class="s2">, </span><span class="s1">fill_value=np.nan)</span>

        <span class="s2">assert </span><span class="s1">isinstance(data</span><span class="s2">, </span><span class="s1">np.ma.core.MaskedArray)</span>
        <span class="s1">mask = data.mask</span>
        <span class="s2">assert </span><span class="s1">mask[</span><span class="s4">5</span><span class="s1">:</span><span class="s4">25</span><span class="s2">, </span><span class="s4">1</span><span class="s1">].all()</span>
        <span class="s1">self.plt.close(ax.get_figure())</span>

        <span class="s5"># irregular</span>
        <span class="s1">ts = tm.makeTimeSeries()</span>
        <span class="s1">ts = ts[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">20</span><span class="s1">]]</span>
        <span class="s1">ts[</span><span class="s4">2</span><span class="s1">:</span><span class="s4">5</span><span class="s1">] = np.nan</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = ts.plot(ax=ax)</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">len(lines) == </span><span class="s4">1</span>
        <span class="s1">line = lines[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">data = line.get_xydata()</span>

        <span class="s2">if </span><span class="s1">self.mpl_ge_3_0_0 </span><span class="s2">or not </span><span class="s1">self.mpl_ge_2_2_3:</span>
            <span class="s1">data = np.ma.MaskedArray(data</span><span class="s2">, </span><span class="s1">mask=isna(data)</span><span class="s2">, </span><span class="s1">fill_value=np.nan)</span>

        <span class="s2">assert </span><span class="s1">isinstance(data</span><span class="s2">, </span><span class="s1">np.ma.core.MaskedArray)</span>
        <span class="s1">mask = data.mask</span>
        <span class="s2">assert </span><span class="s1">mask[</span><span class="s4">2</span><span class="s1">:</span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s1">].all()</span>
        <span class="s1">self.plt.close(ax.get_figure())</span>

        <span class="s5"># non-ts</span>
        <span class="s1">idx = [</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">20</span><span class="s1">]</span>
        <span class="s1">ser = Series(np.random.randn(len(idx))</span><span class="s2">, </span><span class="s1">idx)</span>
        <span class="s1">ser[</span><span class="s4">2</span><span class="s1">:</span><span class="s4">5</span><span class="s1">] = np.nan</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ser.plot(ax=ax)</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">len(lines) == </span><span class="s4">1</span>
        <span class="s1">line = lines[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">data = line.get_xydata()</span>
        <span class="s2">if </span><span class="s1">self.mpl_ge_3_0_0 </span><span class="s2">or not </span><span class="s1">self.mpl_ge_2_2_3:</span>
            <span class="s1">data = np.ma.MaskedArray(data</span><span class="s2">, </span><span class="s1">mask=isna(data)</span><span class="s2">, </span><span class="s1">fill_value=np.nan)</span>

        <span class="s2">assert </span><span class="s1">isinstance(data</span><span class="s2">, </span><span class="s1">np.ma.core.MaskedArray)</span>
        <span class="s1">mask = data.mask</span>
        <span class="s2">assert </span><span class="s1">mask[</span><span class="s4">2</span><span class="s1">:</span><span class="s4">5</span><span class="s2">, </span><span class="s4">1</span><span class="s1">].all()</span>

    <span class="s2">def </span><span class="s1">test_gap_upsample(self):</span>
        <span class="s1">low = tm.makeTimeSeries()</span>
        <span class="s1">low[</span><span class="s4">5</span><span class="s1">:</span><span class="s4">25</span><span class="s1">] = np.nan</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">low.plot(ax=ax)</span>

        <span class="s1">idxh = date_range(low.index[</span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">low.index[-</span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;12h&quot;</span><span class="s1">)</span>
        <span class="s1">s = Series(np.random.randn(len(idxh))</span><span class="s2">, </span><span class="s1">idxh)</span>
        <span class="s1">s.plot(secondary_y=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">len(lines) == </span><span class="s4">1</span>
        <span class="s2">assert </span><span class="s1">len(ax.right_ax.get_lines()) == </span><span class="s4">1</span>

        <span class="s1">line = lines[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">data = line.get_xydata()</span>
        <span class="s2">if </span><span class="s1">self.mpl_ge_3_0_0 </span><span class="s2">or not </span><span class="s1">self.mpl_ge_2_2_3:</span>
            <span class="s1">data = np.ma.MaskedArray(data</span><span class="s2">, </span><span class="s1">mask=isna(data)</span><span class="s2">, </span><span class="s1">fill_value=np.nan)</span>

        <span class="s2">assert </span><span class="s1">isinstance(data</span><span class="s2">, </span><span class="s1">np.ma.core.MaskedArray)</span>
        <span class="s1">mask = data.mask</span>
        <span class="s2">assert </span><span class="s1">mask[</span><span class="s4">5</span><span class="s1">:</span><span class="s4">25</span><span class="s2">, </span><span class="s4">1</span><span class="s1">].all()</span>

    <span class="s2">def </span><span class="s1">test_secondary_y(self):</span>
        <span class="s1">ser = Series(np.random.randn(</span><span class="s4">10</span><span class="s1">))</span>
        <span class="s1">ser2 = Series(np.random.randn(</span><span class="s4">10</span><span class="s1">))</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">_ = self.plt.subplots()</span>
        <span class="s1">ax = ser.plot(secondary_y=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;left_ax&quot;</span><span class="s1">)</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;right_ax&quot;</span><span class="s1">)</span>
        <span class="s1">axes = fig.get_axes()</span>
        <span class="s1">line = ax.get_lines()[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">xp = Series(line.get_ydata()</span><span class="s2">, </span><span class="s1">line.get_xdata())</span>
        <span class="s1">tm.assert_series_equal(ser</span><span class="s2">, </span><span class="s1">xp)</span>
        <span class="s2">assert </span><span class="s1">ax.get_yaxis().get_ticks_position() == </span><span class="s3">&quot;right&quot;</span>
        <span class="s2">assert not </span><span class="s1">axes[</span><span class="s4">0</span><span class="s1">].get_yaxis().get_visible()</span>
        <span class="s1">self.plt.close(fig)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax2 = self.plt.subplots()</span>
        <span class="s1">ser2.plot(ax=ax2)</span>
        <span class="s2">assert </span><span class="s1">ax2.get_yaxis().get_ticks_position() == self.default_tick_position</span>
        <span class="s1">self.plt.close(ax2.get_figure())</span>

        <span class="s1">ax = ser2.plot()</span>
        <span class="s1">ax2 = ser.plot(secondary_y=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">ax.get_yaxis().get_visible()</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;left_ax&quot;</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;right_ax&quot;</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">hasattr(ax2</span><span class="s2">, </span><span class="s3">&quot;left_ax&quot;</span><span class="s1">)</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax2</span><span class="s2">, </span><span class="s3">&quot;right_ax&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_secondary_y_ts(self):</span>
        <span class="s1">idx = date_range(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s1">)</span>
        <span class="s1">ser = Series(np.random.randn(</span><span class="s4">10</span><span class="s1">)</span><span class="s2">, </span><span class="s1">idx)</span>
        <span class="s1">ser2 = Series(np.random.randn(</span><span class="s4">10</span><span class="s1">)</span><span class="s2">, </span><span class="s1">idx)</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">_ = self.plt.subplots()</span>
        <span class="s1">ax = ser.plot(secondary_y=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;left_ax&quot;</span><span class="s1">)</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;right_ax&quot;</span><span class="s1">)</span>
        <span class="s1">axes = fig.get_axes()</span>
        <span class="s1">line = ax.get_lines()[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">xp = Series(line.get_ydata()</span><span class="s2">, </span><span class="s1">line.get_xdata()).to_timestamp()</span>
        <span class="s1">tm.assert_series_equal(ser</span><span class="s2">, </span><span class="s1">xp)</span>
        <span class="s2">assert </span><span class="s1">ax.get_yaxis().get_ticks_position() == </span><span class="s3">&quot;right&quot;</span>
        <span class="s2">assert not </span><span class="s1">axes[</span><span class="s4">0</span><span class="s1">].get_yaxis().get_visible()</span>
        <span class="s1">self.plt.close(fig)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax2 = self.plt.subplots()</span>
        <span class="s1">ser2.plot(ax=ax2)</span>
        <span class="s2">assert </span><span class="s1">ax2.get_yaxis().get_ticks_position() == self.default_tick_position</span>
        <span class="s1">self.plt.close(ax2.get_figure())</span>

        <span class="s1">ax = ser2.plot()</span>
        <span class="s1">ax2 = ser.plot(secondary_y=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">ax.get_yaxis().get_visible()</span>

    <span class="s1">@td.skip_if_no_scipy</span>
    <span class="s2">def </span><span class="s1">test_secondary_kde(self):</span>

        <span class="s1">ser = Series(np.random.randn(</span><span class="s4">10</span><span class="s1">))</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = ser.plot(secondary_y=</span><span class="s2">True, </span><span class="s1">kind=</span><span class="s3">&quot;density&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s2">assert </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;left_ax&quot;</span><span class="s1">)</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;right_ax&quot;</span><span class="s1">)</span>
        <span class="s1">axes = fig.get_axes()</span>
        <span class="s2">assert </span><span class="s1">axes[</span><span class="s4">1</span><span class="s1">].get_yaxis().get_ticks_position() == </span><span class="s3">&quot;right&quot;</span>

    <span class="s2">def </span><span class="s1">test_secondary_bar(self):</span>
        <span class="s1">ser = Series(np.random.randn(</span><span class="s4">10</span><span class="s1">))</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ser.plot(secondary_y=</span><span class="s2">True, </span><span class="s1">kind=</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">axes = fig.get_axes()</span>
        <span class="s2">assert </span><span class="s1">axes[</span><span class="s4">1</span><span class="s1">].get_yaxis().get_ticks_position() == </span><span class="s3">&quot;right&quot;</span>

    <span class="s2">def </span><span class="s1">test_secondary_frame(self):</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">])</span>
        <span class="s1">axes = df.plot(secondary_y=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">axes[</span><span class="s4">0</span><span class="s1">].get_yaxis().get_ticks_position() == </span><span class="s3">&quot;right&quot;</span>
        <span class="s2">assert </span><span class="s1">axes[</span><span class="s4">1</span><span class="s1">].get_yaxis().get_ticks_position() == self.default_tick_position</span>
        <span class="s2">assert </span><span class="s1">axes[</span><span class="s4">2</span><span class="s1">].get_yaxis().get_ticks_position() == </span><span class="s3">&quot;right&quot;</span>

    <span class="s2">def </span><span class="s1">test_secondary_bar_frame(self):</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">5</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">])</span>
        <span class="s1">axes = df.plot(kind=</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s1">secondary_y=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;c&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">axes[</span><span class="s4">0</span><span class="s1">].get_yaxis().get_ticks_position() == </span><span class="s3">&quot;right&quot;</span>
        <span class="s2">assert </span><span class="s1">axes[</span><span class="s4">1</span><span class="s1">].get_yaxis().get_ticks_position() == self.default_tick_position</span>
        <span class="s2">assert </span><span class="s1">axes[</span><span class="s4">2</span><span class="s1">].get_yaxis().get_ticks_position() == </span><span class="s3">&quot;right&quot;</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_regular_first(self):</span>
        <span class="s5"># TODO</span>
        <span class="s1">s1 = tm.makeTimeSeries()</span>
        <span class="s1">s2 = s1[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">11</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s4">15</span><span class="s1">]]</span>

        <span class="s5"># it works!</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">s1.plot(ax=ax)</span>

        <span class="s1">ax2 = s2.plot(style=</span><span class="s3">&quot;g&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">lines = ax2.get_lines()</span>
        <span class="s1">idx1 = PeriodIndex(lines[</span><span class="s4">0</span><span class="s1">].get_xdata())</span>
        <span class="s1">idx2 = PeriodIndex(lines[</span><span class="s4">1</span><span class="s1">].get_xdata())</span>

        <span class="s1">tm.assert_index_equal(idx1</span><span class="s2">, </span><span class="s1">s1.index.to_period(</span><span class="s3">&quot;B&quot;</span><span class="s1">))</span>
        <span class="s1">tm.assert_index_equal(idx2</span><span class="s2">, </span><span class="s1">s2.index.to_period(</span><span class="s3">&quot;B&quot;</span><span class="s1">))</span>

        <span class="s1">left</span><span class="s2">, </span><span class="s1">right = ax2.get_xlim()</span>
        <span class="s1">pidx = s1.index.to_period()</span>
        <span class="s2">assert </span><span class="s1">left &lt;= pidx[</span><span class="s4">0</span><span class="s1">].ordinal</span>
        <span class="s2">assert </span><span class="s1">right &gt;= pidx[-</span><span class="s4">1</span><span class="s1">].ordinal</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_irregular_first(self):</span>
        <span class="s1">s1 = tm.makeTimeSeries()</span>
        <span class="s1">s2 = s1[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">11</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s4">15</span><span class="s1">]]</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">s2.plot(style=</span><span class="s3">&quot;g&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">s1.plot(ax=ax)</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;freq&quot;</span><span class="s1">)</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s1">x1 = lines[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
        <span class="s1">tm.assert_numpy_array_equal(x1</span><span class="s2">, </span><span class="s1">s2.index.astype(object).values)</span>
        <span class="s1">x2 = lines[</span><span class="s4">1</span><span class="s1">].get_xdata()</span>
        <span class="s1">tm.assert_numpy_array_equal(x2</span><span class="s2">, </span><span class="s1">s1.index.astype(object).values)</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_regular_first_df(self):</span>
        <span class="s5"># GH 9852</span>
        <span class="s1">s1 = tm.makeTimeSeries().to_frame()</span>
        <span class="s1">s2 = s1.iloc[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">11</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s4">15</span><span class="s1">]</span><span class="s2">, </span><span class="s1">:]</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">s1.plot(ax=ax)</span>
        <span class="s1">ax2 = s2.plot(style=</span><span class="s3">&quot;g&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">lines = ax2.get_lines()</span>
        <span class="s1">idx1 = PeriodIndex(lines[</span><span class="s4">0</span><span class="s1">].get_xdata())</span>
        <span class="s1">idx2 = PeriodIndex(lines[</span><span class="s4">1</span><span class="s1">].get_xdata())</span>
        <span class="s2">assert </span><span class="s1">idx1.equals(s1.index.to_period(</span><span class="s3">&quot;B&quot;</span><span class="s1">))</span>
        <span class="s2">assert </span><span class="s1">idx2.equals(s2.index.to_period(</span><span class="s3">&quot;B&quot;</span><span class="s1">))</span>
        <span class="s1">left</span><span class="s2">, </span><span class="s1">right = ax2.get_xlim()</span>
        <span class="s1">pidx = s1.index.to_period()</span>
        <span class="s2">assert </span><span class="s1">left &lt;= pidx[</span><span class="s4">0</span><span class="s1">].ordinal</span>
        <span class="s2">assert </span><span class="s1">right &gt;= pidx[-</span><span class="s4">1</span><span class="s1">].ordinal</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_irregular_first_df(self):</span>
        <span class="s5"># GH 9852</span>
        <span class="s1">s1 = tm.makeTimeSeries().to_frame()</span>
        <span class="s1">s2 = s1.iloc[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">11</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s4">15</span><span class="s1">]</span><span class="s2">, </span><span class="s1">:]</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">s2.plot(style=</span><span class="s3">&quot;g&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">s1.plot(ax=ax)</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;freq&quot;</span><span class="s1">)</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s1">x1 = lines[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
        <span class="s1">tm.assert_numpy_array_equal(x1</span><span class="s2">, </span><span class="s1">s2.index.astype(object).values)</span>
        <span class="s1">x2 = lines[</span><span class="s4">1</span><span class="s1">].get_xdata()</span>
        <span class="s1">tm.assert_numpy_array_equal(x2</span><span class="s2">, </span><span class="s1">s1.index.astype(object).values)</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_hf_first(self):</span>
        <span class="s1">idxh = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">365</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s1">)</span>
        <span class="s1">idxl = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">high = Series(np.random.randn(len(idxh))</span><span class="s2">, </span><span class="s1">idxh)</span>
        <span class="s1">low = Series(np.random.randn(len(idxl))</span><span class="s2">, </span><span class="s1">idxl)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">high.plot(ax=ax)</span>
        <span class="s1">low.plot(ax=ax)</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == </span><span class="s3">&quot;D&quot;</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_alignment(self):</span>
        <span class="s1">ts_ind = date_range(</span><span class="s3">&quot;2012-01-01 13:00&quot;</span><span class="s2">, </span><span class="s3">&quot;2012-01-02&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;H&quot;</span><span class="s1">)</span>
        <span class="s1">ts_data = np.random.randn(</span><span class="s4">12</span><span class="s1">)</span>

        <span class="s1">ts = Series(ts_data</span><span class="s2">, </span><span class="s1">index=ts_ind)</span>
        <span class="s1">ts2 = ts.asfreq(</span><span class="s3">&quot;T&quot;</span><span class="s1">).interpolate()</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = ts.plot(ax=ax)</span>
        <span class="s1">ts2.plot(style=</span><span class="s3">&quot;r&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>

        <span class="s2">assert </span><span class="s1">ax.lines[</span><span class="s4">0</span><span class="s1">].get_xdata()[</span><span class="s4">0</span><span class="s1">] == ax.lines[</span><span class="s4">1</span><span class="s1">].get_xdata()[</span><span class="s4">0</span><span class="s1">]</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_lf_first(self):</span>

        <span class="s1">idxh = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">365</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s1">)</span>
        <span class="s1">idxl = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">high = Series(np.random.randn(len(idxh))</span><span class="s2">, </span><span class="s1">idxh)</span>
        <span class="s1">low = Series(np.random.randn(len(idxl))</span><span class="s2">, </span><span class="s1">idxl)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">low.plot(legend=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">high.plot(legend=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == </span><span class="s3">&quot;D&quot;</span>
        <span class="s1">leg = ax.get_legend()</span>
        <span class="s2">assert </span><span class="s1">len(leg.texts) == </span><span class="s4">2</span>
        <span class="s1">self.plt.close(ax.get_figure())</span>

        <span class="s1">idxh = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">240</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;T&quot;</span><span class="s1">)</span>
        <span class="s1">idxl = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;H&quot;</span><span class="s1">)</span>
        <span class="s1">high = Series(np.random.randn(len(idxh))</span><span class="s2">, </span><span class="s1">idxh)</span>
        <span class="s1">low = Series(np.random.randn(len(idxl))</span><span class="s2">, </span><span class="s1">idxl)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">low.plot(ax=ax)</span>
        <span class="s1">high.plot(ax=ax)</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == </span><span class="s3">&quot;T&quot;</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_irreg_period(self):</span>
        <span class="s1">ts = tm.makeTimeSeries()</span>
        <span class="s1">irreg = ts[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">16</span><span class="s2">, </span><span class="s4">17</span><span class="s2">, </span><span class="s4">18</span><span class="s2">, </span><span class="s4">29</span><span class="s1">]]</span>
        <span class="s1">rng = period_range(</span><span class="s3">&quot;1/3/2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">30</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;B&quot;</span><span class="s1">)</span>
        <span class="s1">ps = Series(np.random.randn(len(rng))</span><span class="s2">, </span><span class="s1">rng)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">irreg.plot(ax=ax)</span>
        <span class="s1">ps.plot(ax=ax)</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_shared_ax(self):</span>

        <span class="s5"># GH13341, using sharex=True</span>
        <span class="s1">idx1 = date_range(</span><span class="s3">&quot;2015-01-01&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">idx2 = idx1[:</span><span class="s4">1</span><span class="s1">].union(idx1[</span><span class="s4">2</span><span class="s1">:])</span>
        <span class="s1">s1 = Series(range(len(idx1))</span><span class="s2">, </span><span class="s1">idx1)</span>
        <span class="s1">s2 = Series(range(len(idx2))</span><span class="s2">, </span><span class="s1">idx2)</span>

        <span class="s1">fig</span><span class="s2">, </span><span class="s1">(ax1</span><span class="s2">, </span><span class="s1">ax2) = self.plt.subplots(nrows=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">s1.plot(ax=ax1)</span>
        <span class="s1">s2.plot(ax=ax2)</span>

        <span class="s2">assert </span><span class="s1">ax1.freq == </span><span class="s3">&quot;M&quot;</span>
        <span class="s2">assert </span><span class="s1">ax2.freq == </span><span class="s3">&quot;M&quot;</span>
        <span class="s2">assert </span><span class="s1">ax1.lines[</span><span class="s4">0</span><span class="s1">].get_xydata()[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">] == ax2.lines[</span><span class="s4">0</span><span class="s1">].get_xydata()[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>

        <span class="s5"># using twinx</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax1 = self.plt.subplots()</span>
        <span class="s1">ax2 = ax1.twinx()</span>
        <span class="s1">s1.plot(ax=ax1)</span>
        <span class="s1">s2.plot(ax=ax2)</span>

        <span class="s2">assert </span><span class="s1">ax1.lines[</span><span class="s4">0</span><span class="s1">].get_xydata()[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">] == ax2.lines[</span><span class="s4">0</span><span class="s1">].get_xydata()[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span>

        <span class="s5"># TODO (GH14330, GH14322)</span>
        <span class="s5"># plotting the irregular first does not yet work</span>
        <span class="s5"># fig, ax1 = plt.subplots()</span>
        <span class="s5"># ax2 = ax1.twinx()</span>
        <span class="s5"># s2.plot(ax=ax1)</span>
        <span class="s5"># s1.plot(ax=ax2)</span>
        <span class="s5"># assert (ax1.lines[0].get_xydata()[0, 0] ==</span>
        <span class="s5">#         ax2.lines[0].get_xydata()[0, 0])</span>

    <span class="s2">def </span><span class="s1">test_nat_handling(self):</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>

        <span class="s1">dti = DatetimeIndex([</span><span class="s3">&quot;2015-01-01&quot;</span><span class="s2">, </span><span class="s1">NaT</span><span class="s2">, </span><span class="s3">&quot;2015-01-03&quot;</span><span class="s1">])</span>
        <span class="s1">s = Series(range(len(dti))</span><span class="s2">, </span><span class="s1">dti)</span>
        <span class="s1">s.plot(ax=ax)</span>
        <span class="s1">xdata = ax.get_lines()[</span><span class="s4">0</span><span class="s1">].get_xdata()</span>
        <span class="s5"># plot x data is bounded by index values</span>
        <span class="s2">assert </span><span class="s1">s.index.min() &lt;= Series(xdata).min()</span>
        <span class="s2">assert </span><span class="s1">Series(xdata).max() &lt;= s.index.max()</span>

    <span class="s2">def </span><span class="s1">test_to_weekly_resampling(self):</span>
        <span class="s1">idxh = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">52</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;W&quot;</span><span class="s1">)</span>
        <span class="s1">idxl = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">high = Series(np.random.randn(len(idxh))</span><span class="s2">, </span><span class="s1">idxh)</span>
        <span class="s1">low = Series(np.random.randn(len(idxl))</span><span class="s2">, </span><span class="s1">idxl)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">high.plot(ax=ax)</span>
        <span class="s1">low.plot(ax=ax)</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == idxh.freq</span>

    <span class="s2">def </span><span class="s1">test_from_weekly_resampling(self):</span>
        <span class="s1">idxh = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">52</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;W&quot;</span><span class="s1">)</span>
        <span class="s1">idxl = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">high = Series(np.random.randn(len(idxh))</span><span class="s2">, </span><span class="s1">idxh)</span>
        <span class="s1">low = Series(np.random.randn(len(idxl))</span><span class="s2">, </span><span class="s1">idxl)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">low.plot(ax=ax)</span>
        <span class="s1">high.plot(ax=ax)</span>

        <span class="s1">expected_h = idxh.to_period().asi8.astype(np.float64)</span>
        <span class="s1">expected_l = np.array(</span>
            <span class="s1">[</span><span class="s4">1514</span><span class="s2">, </span><span class="s4">1519</span><span class="s2">, </span><span class="s4">1523</span><span class="s2">, </span><span class="s4">1527</span><span class="s2">, </span><span class="s4">1531</span><span class="s2">, </span><span class="s4">1536</span><span class="s2">, </span><span class="s4">1540</span><span class="s2">, </span><span class="s4">1544</span><span class="s2">, </span><span class="s4">1549</span><span class="s2">, </span><span class="s4">1553</span><span class="s2">, </span><span class="s4">1558</span><span class="s2">, </span><span class="s4">1562</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">dtype=np.float64</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == idxh.freq</span>
            <span class="s1">xdata = line.get_xdata(orig=</span><span class="s2">False</span><span class="s1">)</span>
            <span class="s2">if </span><span class="s1">len(xdata) == </span><span class="s4">12</span><span class="s1">:  </span><span class="s5"># idxl lines</span>
                <span class="s1">tm.assert_numpy_array_equal(xdata</span><span class="s2">, </span><span class="s1">expected_l)</span>
            <span class="s2">else</span><span class="s1">:</span>
                <span class="s1">tm.assert_numpy_array_equal(xdata</span><span class="s2">, </span><span class="s1">expected_h)</span>
        <span class="s1">tm.close()</span>

    <span class="s2">def </span><span class="s1">test_from_resampling_area_line_mixed(self):</span>
        <span class="s1">idxh = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">52</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;W&quot;</span><span class="s1">)</span>
        <span class="s1">idxl = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">high = DataFrame(np.random.rand(len(idxh)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idxh</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s1">])</span>
        <span class="s1">low = DataFrame(np.random.rand(len(idxl)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=idxl</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s1">])</span>

        <span class="s5"># low to high</span>
        <span class="s2">for </span><span class="s1">kind1</span><span class="s2">, </span><span class="s1">kind2 </span><span class="s2">in </span><span class="s1">[(</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;area&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;area&quot;</span><span class="s2">, </span><span class="s3">&quot;line&quot;</span><span class="s1">)]:</span>
            <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
            <span class="s1">low.plot(kind=kind1</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
            <span class="s1">high.plot(kind=kind2</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>

            <span class="s5"># check low dataframe result</span>
            <span class="s1">expected_x = np.array(</span>
                <span class="s1">[</span>
                    <span class="s4">1514</span><span class="s2">,</span>
                    <span class="s4">1519</span><span class="s2">,</span>
                    <span class="s4">1523</span><span class="s2">,</span>
                    <span class="s4">1527</span><span class="s2">,</span>
                    <span class="s4">1531</span><span class="s2">,</span>
                    <span class="s4">1536</span><span class="s2">,</span>
                    <span class="s4">1540</span><span class="s2">,</span>
                    <span class="s4">1544</span><span class="s2">,</span>
                    <span class="s4">1549</span><span class="s2">,</span>
                    <span class="s4">1553</span><span class="s2">,</span>
                    <span class="s4">1558</span><span class="s2">,</span>
                    <span class="s4">1562</span><span class="s2">,</span>
                <span class="s1">]</span><span class="s2">,</span>
                <span class="s1">dtype=np.float64</span><span class="s2">,</span>
            <span class="s1">)</span>
            <span class="s1">expected_y = np.zeros(len(expected_x)</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
            <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">3</span><span class="s1">):</span>
                <span class="s1">line = ax.lines[i]</span>
                <span class="s2">assert </span><span class="s1">PeriodIndex(line.get_xdata()).freq == idxh.freq</span>
                <span class="s1">tm.assert_numpy_array_equal(line.get_xdata(orig=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">, </span><span class="s1">expected_x)</span>
                <span class="s5"># check stacked values are correct</span>
                <span class="s1">expected_y += low[i].values</span>
                <span class="s1">tm.assert_numpy_array_equal(line.get_ydata(orig=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">, </span><span class="s1">expected_y)</span>

            <span class="s5"># check high dataframe result</span>
            <span class="s1">expected_x = idxh.to_period().asi8.astype(np.float64)</span>
            <span class="s1">expected_y = np.zeros(len(expected_x)</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
            <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">3</span><span class="s1">):</span>
                <span class="s1">line = ax.lines[</span><span class="s4">3 </span><span class="s1">+ i]</span>
                <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == idxh.freq</span>
                <span class="s1">tm.assert_numpy_array_equal(line.get_xdata(orig=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">, </span><span class="s1">expected_x)</span>
                <span class="s1">expected_y += high[i].values</span>
                <span class="s1">tm.assert_numpy_array_equal(line.get_ydata(orig=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">, </span><span class="s1">expected_y)</span>

        <span class="s5"># high to low</span>
        <span class="s2">for </span><span class="s1">kind1</span><span class="s2">, </span><span class="s1">kind2 </span><span class="s2">in </span><span class="s1">[(</span><span class="s3">&quot;line&quot;</span><span class="s2">, </span><span class="s3">&quot;area&quot;</span><span class="s1">)</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;area&quot;</span><span class="s2">, </span><span class="s3">&quot;line&quot;</span><span class="s1">)]:</span>
            <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
            <span class="s1">high.plot(kind=kind1</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
            <span class="s1">low.plot(kind=kind2</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>

            <span class="s5"># check high dataframe result</span>
            <span class="s1">expected_x = idxh.to_period().asi8.astype(np.float64)</span>
            <span class="s1">expected_y = np.zeros(len(expected_x)</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
            <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">3</span><span class="s1">):</span>
                <span class="s1">line = ax.lines[i]</span>
                <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == idxh.freq</span>
                <span class="s1">tm.assert_numpy_array_equal(line.get_xdata(orig=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">, </span><span class="s1">expected_x)</span>
                <span class="s1">expected_y += high[i].values</span>
                <span class="s1">tm.assert_numpy_array_equal(line.get_ydata(orig=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">, </span><span class="s1">expected_y)</span>

            <span class="s5"># check low dataframe result</span>
            <span class="s1">expected_x = np.array(</span>
                <span class="s1">[</span>
                    <span class="s4">1514</span><span class="s2">,</span>
                    <span class="s4">1519</span><span class="s2">,</span>
                    <span class="s4">1523</span><span class="s2">,</span>
                    <span class="s4">1527</span><span class="s2">,</span>
                    <span class="s4">1531</span><span class="s2">,</span>
                    <span class="s4">1536</span><span class="s2">,</span>
                    <span class="s4">1540</span><span class="s2">,</span>
                    <span class="s4">1544</span><span class="s2">,</span>
                    <span class="s4">1549</span><span class="s2">,</span>
                    <span class="s4">1553</span><span class="s2">,</span>
                    <span class="s4">1558</span><span class="s2">,</span>
                    <span class="s4">1562</span><span class="s2">,</span>
                <span class="s1">]</span><span class="s2">,</span>
                <span class="s1">dtype=np.float64</span><span class="s2">,</span>
            <span class="s1">)</span>
            <span class="s1">expected_y = np.zeros(len(expected_x)</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
            <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">3</span><span class="s1">):</span>
                <span class="s1">lines = ax.lines[</span><span class="s4">3 </span><span class="s1">+ i]</span>
                <span class="s2">assert </span><span class="s1">PeriodIndex(data=lines.get_xdata()).freq == idxh.freq</span>
                <span class="s1">tm.assert_numpy_array_equal(lines.get_xdata(orig=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">, </span><span class="s1">expected_x)</span>
                <span class="s1">expected_y += low[i].values</span>
                <span class="s1">tm.assert_numpy_array_equal(lines.get_ydata(orig=</span><span class="s2">False</span><span class="s1">)</span><span class="s2">, </span><span class="s1">expected_y)</span>

    <span class="s2">def </span><span class="s1">test_mixed_freq_second_millisecond(self):</span>
        <span class="s5"># GH 7772, GH 7760</span>
        <span class="s1">idxh = date_range(</span><span class="s3">&quot;2014-07-01 09:00&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;S&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">50</span><span class="s1">)</span>
        <span class="s1">idxl = date_range(</span><span class="s3">&quot;2014-07-01 09:00&quot;</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;100L&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">500</span><span class="s1">)</span>
        <span class="s1">high = Series(np.random.randn(len(idxh))</span><span class="s2">, </span><span class="s1">idxh)</span>
        <span class="s1">low = Series(np.random.randn(len(idxl))</span><span class="s2">, </span><span class="s1">idxl)</span>
        <span class="s5"># high to low</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">high.plot(ax=ax)</span>
        <span class="s1">low.plot(ax=ax)</span>
        <span class="s2">assert </span><span class="s1">len(ax.get_lines()) == </span><span class="s4">2</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == </span><span class="s3">&quot;L&quot;</span>
        <span class="s1">tm.close()</span>

        <span class="s5"># low to high</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">low.plot(ax=ax)</span>
        <span class="s1">high.plot(ax=ax)</span>
        <span class="s2">assert </span><span class="s1">len(ax.get_lines()) == </span><span class="s4">2</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(data=line.get_xdata()).freq == </span><span class="s3">&quot;L&quot;</span>

    <span class="s2">def </span><span class="s1">test_irreg_dtypes(self):</span>
        <span class="s5"># date</span>
        <span class="s1">idx = [date(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">5</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">20</span><span class="s1">)]</span>
        <span class="s1">df = DataFrame(np.random.randn(len(idx)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">Index(idx</span><span class="s2">, </span><span class="s1">dtype=object))</span>
        <span class="s1">_check_plot_works(df.plot)</span>

        <span class="s5"># np.datetime64</span>
        <span class="s1">idx = date_range(</span><span class="s3">&quot;1/1/2000&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s1">)</span>
        <span class="s1">idx = idx[[</span><span class="s4">0</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">9</span><span class="s1">]].astype(object)</span>
        <span class="s1">df = DataFrame(np.random.randn(len(idx)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">idx)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">_check_plot_works(df.plot</span><span class="s2">, </span><span class="s1">ax=ax)</span>

    <span class="s2">def </span><span class="s1">test_time(self):</span>
        <span class="s1">t = datetime(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">30</span><span class="s2">, </span><span class="s4">0</span><span class="s1">)</span>
        <span class="s1">deltas = np.random.randint(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">20</span><span class="s2">, </span><span class="s4">3</span><span class="s1">).cumsum()</span>
        <span class="s1">ts = np.array([(t + timedelta(minutes=int(x))).time() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">deltas])</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.random.randn(len(ts))</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: np.random.randn(len(ts))}</span><span class="s2">, </span><span class="s1">index=ts</span>
        <span class="s1">)</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(ax=ax)</span>

        <span class="s5"># verify tick labels</span>
        <span class="s1">ticks = ax.get_xticks()</span>
        <span class="s1">labels = ax.get_xticklabels()</span>
        <span class="s2">for </span><span class="s1">t</span><span class="s2">, </span><span class="s1">l </span><span class="s2">in </span><span class="s1">zip(ticks</span><span class="s2">, </span><span class="s1">labels):</span>
            <span class="s1">m</span><span class="s2">, </span><span class="s1">s = divmod(int(t)</span><span class="s2">, </span><span class="s4">60</span><span class="s1">)</span>
            <span class="s1">h</span><span class="s2">, </span><span class="s1">m = divmod(m</span><span class="s2">, </span><span class="s4">60</span><span class="s1">)</span>
            <span class="s1">rs = l.get_text()</span>
            <span class="s2">if </span><span class="s1">len(rs) &gt; </span><span class="s4">0</span><span class="s1">:</span>
                <span class="s2">if </span><span class="s1">s != </span><span class="s4">0</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s).strftime(</span><span class="s3">&quot;%H:%M:%S&quot;</span><span class="s1">)</span>
                <span class="s2">else</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s).strftime(</span><span class="s3">&quot;%H:%M&quot;</span><span class="s1">)</span>
                <span class="s2">assert </span><span class="s1">xp == rs</span>

    <span class="s2">def </span><span class="s1">test_time_change_xlim(self):</span>
        <span class="s1">t = datetime(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">30</span><span class="s2">, </span><span class="s4">0</span><span class="s1">)</span>
        <span class="s1">deltas = np.random.randint(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">20</span><span class="s2">, </span><span class="s4">3</span><span class="s1">).cumsum()</span>
        <span class="s1">ts = np.array([(t + timedelta(minutes=int(x))).time() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">deltas])</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.random.randn(len(ts))</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: np.random.randn(len(ts))}</span><span class="s2">, </span><span class="s1">index=ts</span>
        <span class="s1">)</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(ax=ax)</span>

        <span class="s5"># verify tick labels</span>
        <span class="s1">ticks = ax.get_xticks()</span>
        <span class="s1">labels = ax.get_xticklabels()</span>
        <span class="s2">for </span><span class="s1">t</span><span class="s2">, </span><span class="s1">l </span><span class="s2">in </span><span class="s1">zip(ticks</span><span class="s2">, </span><span class="s1">labels):</span>
            <span class="s1">m</span><span class="s2">, </span><span class="s1">s = divmod(int(t)</span><span class="s2">, </span><span class="s4">60</span><span class="s1">)</span>
            <span class="s1">h</span><span class="s2">, </span><span class="s1">m = divmod(m</span><span class="s2">, </span><span class="s4">60</span><span class="s1">)</span>
            <span class="s1">rs = l.get_text()</span>
            <span class="s2">if </span><span class="s1">len(rs) &gt; </span><span class="s4">0</span><span class="s1">:</span>
                <span class="s2">if </span><span class="s1">s != </span><span class="s4">0</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s).strftime(</span><span class="s3">&quot;%H:%M:%S&quot;</span><span class="s1">)</span>
                <span class="s2">else</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s).strftime(</span><span class="s3">&quot;%H:%M&quot;</span><span class="s1">)</span>
                <span class="s2">assert </span><span class="s1">xp == rs</span>

        <span class="s5"># change xlim</span>
        <span class="s1">ax.set_xlim(</span><span class="s3">&quot;1:30&quot;</span><span class="s2">, </span><span class="s3">&quot;5:00&quot;</span><span class="s1">)</span>

        <span class="s5"># check tick labels again</span>
        <span class="s1">ticks = ax.get_xticks()</span>
        <span class="s1">labels = ax.get_xticklabels()</span>
        <span class="s2">for </span><span class="s1">t</span><span class="s2">, </span><span class="s1">l </span><span class="s2">in </span><span class="s1">zip(ticks</span><span class="s2">, </span><span class="s1">labels):</span>
            <span class="s1">m</span><span class="s2">, </span><span class="s1">s = divmod(int(t)</span><span class="s2">, </span><span class="s4">60</span><span class="s1">)</span>
            <span class="s1">h</span><span class="s2">, </span><span class="s1">m = divmod(m</span><span class="s2">, </span><span class="s4">60</span><span class="s1">)</span>
            <span class="s1">rs = l.get_text()</span>
            <span class="s2">if </span><span class="s1">len(rs) &gt; </span><span class="s4">0</span><span class="s1">:</span>
                <span class="s2">if </span><span class="s1">s != </span><span class="s4">0</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s).strftime(</span><span class="s3">&quot;%H:%M:%S&quot;</span><span class="s1">)</span>
                <span class="s2">else</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s).strftime(</span><span class="s3">&quot;%H:%M&quot;</span><span class="s1">)</span>
                <span class="s2">assert </span><span class="s1">xp == rs</span>

    <span class="s2">def </span><span class="s1">test_time_musec(self):</span>
        <span class="s1">t = datetime(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">30</span><span class="s2">, </span><span class="s4">0</span><span class="s1">)</span>
        <span class="s1">deltas = np.random.randint(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">20</span><span class="s2">, </span><span class="s4">3</span><span class="s1">).cumsum()</span>
        <span class="s1">ts = np.array([(t + timedelta(microseconds=int(x))).time() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">deltas])</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span><span class="s3">&quot;a&quot;</span><span class="s1">: np.random.randn(len(ts))</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">: np.random.randn(len(ts))}</span><span class="s2">, </span><span class="s1">index=ts</span>
        <span class="s1">)</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df.plot(ax=ax)</span>

        <span class="s5"># verify tick labels</span>
        <span class="s1">ticks = ax.get_xticks()</span>
        <span class="s1">labels = ax.get_xticklabels()</span>
        <span class="s2">for </span><span class="s1">t</span><span class="s2">, </span><span class="s1">l </span><span class="s2">in </span><span class="s1">zip(ticks</span><span class="s2">, </span><span class="s1">labels):</span>
            <span class="s1">m</span><span class="s2">, </span><span class="s1">s = divmod(int(t)</span><span class="s2">, </span><span class="s4">60</span><span class="s1">)</span>

            <span class="s1">us = round((t - int(t)) * </span><span class="s4">1e6</span><span class="s1">)</span>

            <span class="s1">h</span><span class="s2">, </span><span class="s1">m = divmod(m</span><span class="s2">, </span><span class="s4">60</span><span class="s1">)</span>
            <span class="s1">rs = l.get_text()</span>
            <span class="s2">if </span><span class="s1">len(rs) &gt; </span><span class="s4">0</span><span class="s1">:</span>
                <span class="s2">if </span><span class="s1">(us % </span><span class="s4">1000</span><span class="s1">) != </span><span class="s4">0</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">us).strftime(</span><span class="s3">&quot;%H:%M:%S.%f&quot;</span><span class="s1">)</span>
                <span class="s2">elif </span><span class="s1">(us // </span><span class="s4">1000</span><span class="s1">) != </span><span class="s4">0</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">us).strftime(</span><span class="s3">&quot;%H:%M:%S.%f&quot;</span><span class="s1">)[:-</span><span class="s4">3</span><span class="s1">]</span>
                <span class="s2">elif </span><span class="s1">s != </span><span class="s4">0</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">us).strftime(</span><span class="s3">&quot;%H:%M:%S&quot;</span><span class="s1">)</span>
                <span class="s2">else</span><span class="s1">:</span>
                    <span class="s1">xp = time(h</span><span class="s2">, </span><span class="s1">m</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">us).strftime(</span><span class="s3">&quot;%H:%M&quot;</span><span class="s1">)</span>
                <span class="s2">assert </span><span class="s1">xp == rs</span>

    <span class="s2">def </span><span class="s1">test_secondary_upsample(self):</span>
        <span class="s1">idxh = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">365</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s1">)</span>
        <span class="s1">idxl = date_range(</span><span class="s3">&quot;1/1/1999&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">high = Series(np.random.randn(len(idxh))</span><span class="s2">, </span><span class="s1">idxh)</span>
        <span class="s1">low = Series(np.random.randn(len(idxl))</span><span class="s2">, </span><span class="s1">idxl)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">low.plot(ax=ax)</span>
        <span class="s1">ax = high.plot(secondary_y=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(line.get_xdata()).freq == </span><span class="s3">&quot;D&quot;</span>
        <span class="s2">assert </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;left_ax&quot;</span><span class="s1">)</span>
        <span class="s2">assert not </span><span class="s1">hasattr(ax</span><span class="s2">, </span><span class="s3">&quot;right_ax&quot;</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">ax.left_ax.get_lines():</span>
            <span class="s2">assert </span><span class="s1">PeriodIndex(line.get_xdata()).freq == </span><span class="s3">&quot;D&quot;</span>

    <span class="s2">def </span><span class="s1">test_secondary_legend(self):</span>
        <span class="s1">fig = self.plt.figure()</span>
        <span class="s1">ax = fig.add_subplot(</span><span class="s4">211</span><span class="s1">)</span>

        <span class="s5"># ts</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">df.plot(secondary_y=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">leg = ax.get_legend()</span>
        <span class="s2">assert </span><span class="s1">len(leg.get_lines()) == </span><span class="s4">4</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">0</span><span class="s1">].get_text() == </span><span class="s3">&quot;A (right)&quot;</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">1</span><span class="s1">].get_text() == </span><span class="s3">&quot;B (right)&quot;</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">2</span><span class="s1">].get_text() == </span><span class="s3">&quot;C&quot;</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">3</span><span class="s1">].get_text() == </span><span class="s3">&quot;D&quot;</span>
        <span class="s2">assert </span><span class="s1">ax.right_ax.get_legend() </span><span class="s2">is None</span>
        <span class="s1">colors = set()</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">leg.get_lines():</span>
            <span class="s1">colors.add(line.get_color())</span>

        <span class="s5"># TODO: color cycle problems</span>
        <span class="s2">assert </span><span class="s1">len(colors) == </span><span class="s4">4</span>
        <span class="s1">self.plt.close(fig)</span>

        <span class="s1">fig = self.plt.figure()</span>
        <span class="s1">ax = fig.add_subplot(</span><span class="s4">211</span><span class="s1">)</span>
        <span class="s1">df.plot(secondary_y=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">mark_right=</span><span class="s2">False, </span><span class="s1">ax=ax)</span>
        <span class="s1">leg = ax.get_legend()</span>
        <span class="s2">assert </span><span class="s1">len(leg.get_lines()) == </span><span class="s4">4</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">0</span><span class="s1">].get_text() == </span><span class="s3">&quot;A&quot;</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">1</span><span class="s1">].get_text() == </span><span class="s3">&quot;B&quot;</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">2</span><span class="s1">].get_text() == </span><span class="s3">&quot;C&quot;</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">3</span><span class="s1">].get_text() == </span><span class="s3">&quot;D&quot;</span>
        <span class="s1">self.plt.close(fig)</span>

        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(kind=</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s1">secondary_y=[</span><span class="s3">&quot;A&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">leg = ax.get_legend()</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">0</span><span class="s1">].get_text() == </span><span class="s3">&quot;A (right)&quot;</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">1</span><span class="s1">].get_text() == </span><span class="s3">&quot;B&quot;</span>
        <span class="s1">self.plt.close(fig)</span>

        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(kind=</span><span class="s3">&quot;bar&quot;</span><span class="s2">, </span><span class="s1">secondary_y=[</span><span class="s3">&quot;A&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">mark_right=</span><span class="s2">False, </span><span class="s1">ax=ax)</span>
        <span class="s1">leg = ax.get_legend()</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">0</span><span class="s1">].get_text() == </span><span class="s3">&quot;A&quot;</span>
        <span class="s2">assert </span><span class="s1">leg.get_texts()[</span><span class="s4">1</span><span class="s1">].get_text() == </span><span class="s3">&quot;B&quot;</span>
        <span class="s1">self.plt.close(fig)</span>

        <span class="s1">fig = self.plt.figure()</span>
        <span class="s1">ax = fig.add_subplot(</span><span class="s4">211</span><span class="s1">)</span>
        <span class="s1">df = tm.makeTimeDataFrame()</span>
        <span class="s1">ax = df.plot(secondary_y=[</span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">leg = ax.get_legend()</span>
        <span class="s2">assert </span><span class="s1">len(leg.get_lines()) == </span><span class="s4">4</span>
        <span class="s2">assert </span><span class="s1">ax.right_ax.get_legend() </span><span class="s2">is None</span>
        <span class="s1">colors = set()</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">leg.get_lines():</span>
            <span class="s1">colors.add(line.get_color())</span>

        <span class="s5"># TODO: color cycle problems</span>
        <span class="s2">assert </span><span class="s1">len(colors) == </span><span class="s4">4</span>
        <span class="s1">self.plt.close(fig)</span>

        <span class="s5"># non-ts</span>
        <span class="s1">df = tm.makeDataFrame()</span>
        <span class="s1">fig = self.plt.figure()</span>
        <span class="s1">ax = fig.add_subplot(</span><span class="s4">211</span><span class="s1">)</span>
        <span class="s1">ax = df.plot(secondary_y=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">leg = ax.get_legend()</span>
        <span class="s2">assert </span><span class="s1">len(leg.get_lines()) == </span><span class="s4">4</span>
        <span class="s2">assert </span><span class="s1">ax.right_ax.get_legend() </span><span class="s2">is None</span>
        <span class="s1">colors = set()</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">leg.get_lines():</span>
            <span class="s1">colors.add(line.get_color())</span>

        <span class="s5"># TODO: color cycle problems</span>
        <span class="s2">assert </span><span class="s1">len(colors) == </span><span class="s4">4</span>
        <span class="s1">self.plt.close()</span>

        <span class="s1">fig = self.plt.figure()</span>
        <span class="s1">ax = fig.add_subplot(</span><span class="s4">211</span><span class="s1">)</span>
        <span class="s1">ax = df.plot(secondary_y=[</span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">leg = ax.get_legend()</span>
        <span class="s2">assert </span><span class="s1">len(leg.get_lines()) == </span><span class="s4">4</span>
        <span class="s2">assert </span><span class="s1">ax.right_ax.get_legend() </span><span class="s2">is None</span>
        <span class="s1">colors = set()</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">leg.get_lines():</span>
            <span class="s1">colors.add(line.get_color())</span>

        <span class="s5"># TODO: color cycle problems</span>
        <span class="s2">assert </span><span class="s1">len(colors) == </span><span class="s4">4</span>

    <span class="s2">def </span><span class="s1">test_format_date_axis(self):</span>
        <span class="s1">rng = date_range(</span><span class="s3">&quot;1/1/2012&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">12</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;M&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(len(rng)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">rng)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df.plot(ax=ax)</span>
        <span class="s1">xaxis = ax.get_xaxis()</span>
        <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">xaxis.get_ticklabels():</span>
            <span class="s2">if </span><span class="s1">len(line.get_text()) &gt; </span><span class="s4">0</span><span class="s1">:</span>
                <span class="s2">assert </span><span class="s1">line.get_rotation() == </span><span class="s4">30</span>

    <span class="s2">def </span><span class="s1">test_ax_plot(self):</span>
        <span class="s1">x = date_range(start=</span><span class="s3">&quot;2012-01-02&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s1">)</span>
        <span class="s1">y = list(range(len(x)))</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">lines = ax.plot(x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s1">label=</span><span class="s3">&quot;Y&quot;</span><span class="s1">)</span>
        <span class="s1">tm.assert_index_equal(DatetimeIndex(lines[</span><span class="s4">0</span><span class="s1">].get_xdata())</span><span class="s2">, </span><span class="s1">x)</span>

    <span class="s2">def </span><span class="s1">test_mpl_nopandas(self):</span>
        <span class="s1">dates = [date(</span><span class="s4">2008</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">31</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date(</span><span class="s4">2009</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">31</span><span class="s1">)]</span>
        <span class="s1">values1 = np.arange(</span><span class="s4">10.0</span><span class="s2">, </span><span class="s4">11.0</span><span class="s2">, </span><span class="s4">0.5</span><span class="s1">)</span>
        <span class="s1">values2 = np.arange(</span><span class="s4">11.0</span><span class="s2">, </span><span class="s4">12.0</span><span class="s2">, </span><span class="s4">0.5</span><span class="s1">)</span>

        <span class="s1">kw = {</span><span class="s3">&quot;fmt&quot;</span><span class="s1">: </span><span class="s3">&quot;-&quot;</span><span class="s2">, </span><span class="s3">&quot;lw&quot;</span><span class="s1">: </span><span class="s4">4</span><span class="s1">}</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax.plot_date([x.toordinal() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">dates]</span><span class="s2">, </span><span class="s1">values1</span><span class="s2">, </span><span class="s1">**kw)</span>
        <span class="s1">ax.plot_date([x.toordinal() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">dates]</span><span class="s2">, </span><span class="s1">values2</span><span class="s2">, </span><span class="s1">**kw)</span>

        <span class="s1">line1</span><span class="s2">, </span><span class="s1">line2 = ax.get_lines()</span>

        <span class="s1">exp = np.array([x.toordinal() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">dates]</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
        <span class="s1">tm.assert_numpy_array_equal(line1.get_xydata()[:</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">exp)</span>
        <span class="s1">exp = np.array([x.toordinal() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">dates]</span><span class="s2">, </span><span class="s1">dtype=np.float64)</span>
        <span class="s1">tm.assert_numpy_array_equal(line2.get_xydata()[:</span><span class="s2">, </span><span class="s4">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">exp)</span>

    <span class="s2">def </span><span class="s1">test_irregular_ts_shared_ax_xlim(self):</span>
        <span class="s5"># GH 2960</span>
        <span class="s2">from </span><span class="s1">pandas.plotting._matplotlib.converter </span><span class="s2">import </span><span class="s1">DatetimeConverter</span>

        <span class="s1">ts = tm.makeTimeSeries()[:</span><span class="s4">20</span><span class="s1">]</span>
        <span class="s1">ts_irregular = ts[[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">17</span><span class="s2">, </span><span class="s4">18</span><span class="s1">]]</span>

        <span class="s5"># plot the left section of the irregular series, then the right section</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ts_irregular[:</span><span class="s4">5</span><span class="s1">].plot(ax=ax)</span>
        <span class="s1">ts_irregular[</span><span class="s4">5</span><span class="s1">:].plot(ax=ax)</span>

        <span class="s5"># check that axis limits are correct</span>
        <span class="s1">left</span><span class="s2">, </span><span class="s1">right = ax.get_xlim()</span>
        <span class="s2">assert </span><span class="s1">left &lt;= DatetimeConverter.convert(ts_irregular.index.min()</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">ax)</span>
        <span class="s2">assert </span><span class="s1">right &gt;= DatetimeConverter.convert(ts_irregular.index.max()</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">ax)</span>

    <span class="s2">def </span><span class="s1">test_secondary_y_non_ts_xlim(self):</span>
        <span class="s5"># GH 3490 - non-timeseries with secondary y</span>
        <span class="s1">index_1 = [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s2">, </span><span class="s4">4</span><span class="s1">]</span>
        <span class="s1">index_2 = [</span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">7</span><span class="s2">, </span><span class="s4">8</span><span class="s1">]</span>
        <span class="s1">s1 = Series(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">index=index_1)</span>
        <span class="s1">s2 = Series(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">index=index_2)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">s1.plot(ax=ax)</span>
        <span class="s1">left_before</span><span class="s2">, </span><span class="s1">right_before = ax.get_xlim()</span>
        <span class="s1">s2.plot(secondary_y=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">left_after</span><span class="s2">, </span><span class="s1">right_after = ax.get_xlim()</span>

        <span class="s2">assert </span><span class="s1">left_before &gt;= left_after</span>
        <span class="s2">assert </span><span class="s1">right_before &lt; right_after</span>

    <span class="s2">def </span><span class="s1">test_secondary_y_regular_ts_xlim(self):</span>
        <span class="s5"># GH 3490 - regular-timeseries with secondary y</span>
        <span class="s1">index_1 = date_range(start=</span><span class="s3">&quot;2000-01-01&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s1">)</span>
        <span class="s1">index_2 = date_range(start=</span><span class="s3">&quot;2000-01-05&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s1">)</span>
        <span class="s1">s1 = Series(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">index=index_1)</span>
        <span class="s1">s2 = Series(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">index=index_2)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">s1.plot(ax=ax)</span>
        <span class="s1">left_before</span><span class="s2">, </span><span class="s1">right_before = ax.get_xlim()</span>
        <span class="s1">s2.plot(secondary_y=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">left_after</span><span class="s2">, </span><span class="s1">right_after = ax.get_xlim()</span>

        <span class="s2">assert </span><span class="s1">left_before &gt;= left_after</span>
        <span class="s2">assert </span><span class="s1">right_before &lt; right_after</span>

    <span class="s2">def </span><span class="s1">test_secondary_y_mixed_freq_ts_xlim(self):</span>
        <span class="s5"># GH 3490 - mixed frequency timeseries with secondary y</span>
        <span class="s1">rng = date_range(</span><span class="s3">&quot;2000-01-01&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10000</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;min&quot;</span><span class="s1">)</span>
        <span class="s1">ts = Series(</span><span class="s4">1</span><span class="s2">, </span><span class="s1">index=rng)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ts.plot(ax=ax)</span>
        <span class="s1">left_before</span><span class="s2">, </span><span class="s1">right_before = ax.get_xlim()</span>
        <span class="s1">ts.resample(</span><span class="s3">&quot;D&quot;</span><span class="s1">).mean().plot(secondary_y=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">left_after</span><span class="s2">, </span><span class="s1">right_after = ax.get_xlim()</span>

        <span class="s5"># a downsample should not have changed either limit</span>
        <span class="s2">assert </span><span class="s1">left_before == left_after</span>
        <span class="s2">assert </span><span class="s1">right_before == right_after</span>

    <span class="s2">def </span><span class="s1">test_secondary_y_irregular_ts_xlim(self):</span>
        <span class="s5"># GH 3490 - irregular-timeseries with secondary y</span>
        <span class="s2">from </span><span class="s1">pandas.plotting._matplotlib.converter </span><span class="s2">import </span><span class="s1">DatetimeConverter</span>

        <span class="s1">ts = tm.makeTimeSeries()[:</span><span class="s4">20</span><span class="s1">]</span>
        <span class="s1">ts_irregular = ts[[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">5</span><span class="s2">, </span><span class="s4">6</span><span class="s2">, </span><span class="s4">8</span><span class="s2">, </span><span class="s4">9</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">13</span><span class="s2">, </span><span class="s4">14</span><span class="s2">, </span><span class="s4">15</span><span class="s2">, </span><span class="s4">17</span><span class="s2">, </span><span class="s4">18</span><span class="s1">]]</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ts_irregular[:</span><span class="s4">5</span><span class="s1">].plot(ax=ax)</span>
        <span class="s5"># plot higher-x values on secondary axis</span>
        <span class="s1">ts_irregular[</span><span class="s4">5</span><span class="s1">:].plot(secondary_y=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s5"># ensure secondary limits aren't overwritten by plot on primary</span>
        <span class="s1">ts_irregular[:</span><span class="s4">5</span><span class="s1">].plot(ax=ax)</span>

        <span class="s1">left</span><span class="s2">, </span><span class="s1">right = ax.get_xlim()</span>
        <span class="s2">assert </span><span class="s1">left &lt;= DatetimeConverter.convert(ts_irregular.index.min()</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">ax)</span>
        <span class="s2">assert </span><span class="s1">right &gt;= DatetimeConverter.convert(ts_irregular.index.max()</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">, </span><span class="s1">ax)</span>

    <span class="s2">def </span><span class="s1">test_plot_outofbounds_datetime(self):</span>
        <span class="s5"># 2579 - checking this does not raise</span>
        <span class="s1">values = [date(</span><span class="s4">1677</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">date(</span><span class="s4">1677</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)]</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax.plot(values)</span>

        <span class="s1">values = [datetime(</span><span class="s4">1677</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">12</span><span class="s1">)</span><span class="s2">, </span><span class="s1">datetime(</span><span class="s4">1677</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">12</span><span class="s1">)]</span>
        <span class="s1">ax.plot(values)</span>

    <span class="s2">def </span><span class="s1">test_format_timedelta_ticks_narrow(self):</span>

        <span class="s1">expected_labels = [</span><span class="s3">f&quot;00:00:00.0000000</span><span class="s2">{</span><span class="s1">i</span><span class="s2">:</span><span class="s3">0&gt;2d</span><span class="s2">}</span><span class="s3">&quot; </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">np.arange(</span><span class="s4">10</span><span class="s1">)]</span>

        <span class="s1">rng = timedelta_range(</span><span class="s3">&quot;0&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;ns&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(len(rng)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">rng)</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">df.plot(fontsize=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">self.plt.draw()</span>
        <span class="s1">labels = ax.get_xticklabels()</span>

        <span class="s1">result_labels = [x.get_text() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">labels]</span>
        <span class="s2">assert </span><span class="s1">len(result_labels) == len(expected_labels)</span>
        <span class="s2">assert </span><span class="s1">result_labels == expected_labels</span>

    <span class="s2">def </span><span class="s1">test_format_timedelta_ticks_wide(self):</span>
        <span class="s1">expected_labels = [</span>
            <span class="s3">&quot;00:00:00&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;1 days 03:46:40&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;2 days 07:33:20&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;3 days 11:20:00&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;4 days 15:06:40&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;5 days 18:53:20&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;6 days 22:40:00&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;8 days 02:26:40&quot;</span><span class="s2">,</span>
            <span class="s3">&quot;9 days 06:13:20&quot;</span><span class="s2">,</span>
        <span class="s1">]</span>

        <span class="s1">rng = timedelta_range(</span><span class="s3">&quot;0&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;1 d&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(len(rng)</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s1">rng)</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df.plot(fontsize=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">self.plt.draw()</span>
        <span class="s1">labels = ax.get_xticklabels()</span>

        <span class="s1">result_labels = [x.get_text() </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">labels]</span>
        <span class="s2">assert </span><span class="s1">len(result_labels) == len(expected_labels)</span>
        <span class="s2">assert </span><span class="s1">result_labels == expected_labels</span>

    <span class="s2">def </span><span class="s1">test_timedelta_plot(self):</span>
        <span class="s5"># test issue #8711</span>
        <span class="s1">s = Series(range(</span><span class="s4">5</span><span class="s1">)</span><span class="s2">, </span><span class="s1">timedelta_range(</span><span class="s3">&quot;1day&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">5</span><span class="s1">))</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">_check_plot_works(s.plot</span><span class="s2">, </span><span class="s1">ax=ax)</span>

        <span class="s5"># test long period</span>
        <span class="s1">index = timedelta_range(</span><span class="s3">&quot;1 day 2 hr 30 min 10 s&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;1 d&quot;</span><span class="s1">)</span>
        <span class="s1">s = Series(np.random.randn(len(index))</span><span class="s2">, </span><span class="s1">index)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">_check_plot_works(s.plot</span><span class="s2">, </span><span class="s1">ax=ax)</span>

        <span class="s5"># test short period</span>
        <span class="s1">index = timedelta_range(</span><span class="s3">&quot;1 day 2 hr 30 min 10 s&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;1 ns&quot;</span><span class="s1">)</span>
        <span class="s1">s = Series(np.random.randn(len(index))</span><span class="s2">, </span><span class="s1">index)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">_check_plot_works(s.plot</span><span class="s2">, </span><span class="s1">ax=ax)</span>

    <span class="s2">def </span><span class="s1">test_hist(self):</span>
        <span class="s5"># https://github.com/matplotlib/matplotlib/issues/8459</span>
        <span class="s1">rng = date_range(</span><span class="s3">&quot;1/1/2011&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;H&quot;</span><span class="s1">)</span>
        <span class="s1">x = rng</span>
        <span class="s1">w1 = np.arange(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s1">)</span>
        <span class="s1">w2 = np.arange(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s2">, </span><span class="s4">0.1</span><span class="s1">)[::-</span><span class="s4">1</span><span class="s1">]</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax.hist([x</span><span class="s2">, </span><span class="s1">x]</span><span class="s2">, </span><span class="s1">weights=[w1</span><span class="s2">, </span><span class="s1">w2])</span>

    <span class="s2">def </span><span class="s1">test_overlapping_datetime(self):</span>
        <span class="s5"># GB 6608</span>
        <span class="s1">s1 = Series(</span>
            <span class="s1">[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">index=[</span>
                <span class="s1">datetime(</span><span class="s4">1995</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">31</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">datetime(</span><span class="s4">2000</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">31</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">datetime(</span><span class="s4">2005</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">31</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">s2 = Series(</span>
            <span class="s1">[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">index=[</span>
                <span class="s1">datetime(</span><span class="s4">1997</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">31</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">datetime(</span><span class="s4">2003</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">31</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s1">datetime(</span><span class="s4">2008</span><span class="s2">, </span><span class="s4">12</span><span class="s2">, </span><span class="s4">31</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s5"># plot first series, then add the second series to those axes,</span>
        <span class="s5"># then try adding the first series again</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">s1.plot(ax=ax)</span>
        <span class="s1">s2.plot(ax=ax)</span>
        <span class="s1">s1.plot(ax=ax)</span>

    <span class="s1">@pytest.mark.xfail(reason=</span><span class="s3">&quot;GH9053 matplotlib does not use ax.xaxis.converter&quot;</span><span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_add_matplotlib_datetime64(self):</span>
        <span class="s5"># GH9053 - ensure that a plot with PeriodConverter still understands</span>
        <span class="s5"># datetime64 data. This still fails because matplotlib overrides the</span>
        <span class="s5"># ax.xaxis.converter with a DatetimeConverter</span>
        <span class="s1">s = Series(np.random.randn(</span><span class="s4">10</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=date_range(</span><span class="s3">&quot;1970-01-02&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s1">))</span>
        <span class="s1">ax = s.plot()</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(DeprecationWarning):</span>
            <span class="s5"># multi-dimensional indexing</span>
            <span class="s1">ax.plot(s.index</span><span class="s2">, </span><span class="s1">s.values</span><span class="s2">, </span><span class="s1">color=</span><span class="s3">&quot;g&quot;</span><span class="s1">)</span>
        <span class="s1">l1</span><span class="s2">, </span><span class="s1">l2 = ax.lines</span>
        <span class="s1">tm.assert_numpy_array_equal(l1.get_xydata()</span><span class="s2">, </span><span class="s1">l2.get_xydata())</span>

    <span class="s2">def </span><span class="s1">test_matplotlib_scatter_datetime64(self):</span>
        <span class="s5"># https://github.com/matplotlib/matplotlib/issues/11391</span>
        <span class="s1">df = DataFrame(np.random.RandomState(</span><span class="s4">0</span><span class="s1">).rand(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">])</span>
        <span class="s1">df[</span><span class="s3">&quot;time&quot;</span><span class="s1">] = date_range(</span><span class="s3">&quot;2018-01-01&quot;</span><span class="s2">, </span><span class="s1">periods=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">freq=</span><span class="s3">&quot;D&quot;</span><span class="s1">)</span>
        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax.scatter(x=</span><span class="s3">&quot;time&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">data=df)</span>
        <span class="s1">self.plt.draw()</span>
        <span class="s1">label = ax.get_xticklabels()[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s2">if </span><span class="s1">self.mpl_ge_3_2_0:</span>
            <span class="s1">expected = </span><span class="s3">&quot;2018-01-01&quot;</span>
        <span class="s2">elif </span><span class="s1">self.mpl_ge_3_0_0:</span>
            <span class="s1">expected = </span><span class="s3">&quot;2017-12-08&quot;</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">expected = </span><span class="s3">&quot;2017-12-12&quot;</span>
        <span class="s2">assert </span><span class="s1">label.get_text() == expected</span>

    <span class="s2">def </span><span class="s1">test_check_xticks_rot(self):</span>
        <span class="s5"># https://github.com/pandas-dev/pandas/issues/29460</span>
        <span class="s5"># regular time series</span>
        <span class="s1">x = to_datetime([</span><span class="s3">&quot;2020-05-01&quot;</span><span class="s2">, </span><span class="s3">&quot;2020-05-02&quot;</span><span class="s2">, </span><span class="s3">&quot;2020-05-03&quot;</span><span class="s1">])</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: x</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]})</span>
        <span class="s1">axes = df.plot(x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s1">)</span>
        <span class="s1">self._check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s4">0</span><span class="s1">)</span>

        <span class="s5"># irregular time series</span>
        <span class="s1">x = to_datetime([</span><span class="s3">&quot;2020-05-01&quot;</span><span class="s2">, </span><span class="s3">&quot;2020-05-02&quot;</span><span class="s2">, </span><span class="s3">&quot;2020-05-04&quot;</span><span class="s1">])</span>
        <span class="s1">df = DataFrame({</span><span class="s3">&quot;x&quot;</span><span class="s1">: x</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]})</span>
        <span class="s1">axes = df.plot(x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s1">)</span>
        <span class="s1">self._check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s4">30</span><span class="s1">)</span>

        <span class="s5"># use timeseries index or not</span>
        <span class="s1">axes = df.set_index(</span><span class="s3">&quot;x&quot;</span><span class="s1">).plot(y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">use_index=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">self._check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s4">30</span><span class="s1">)</span>
        <span class="s1">axes = df.set_index(</span><span class="s3">&quot;x&quot;</span><span class="s1">).plot(y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">use_index=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">self._check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s4">0</span><span class="s1">)</span>

        <span class="s5"># separate subplots</span>
        <span class="s1">axes = df.plot(x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True, </span><span class="s1">sharex=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">self._check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s4">30</span><span class="s1">)</span>
        <span class="s1">axes = df.plot(x=</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s1">y=</span><span class="s3">&quot;y&quot;</span><span class="s2">, </span><span class="s1">subplots=</span><span class="s2">True, </span><span class="s1">sharex=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">self._check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s4">0</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">_check_plot_works(f</span><span class="s2">, </span><span class="s1">freq=</span><span class="s2">None, </span><span class="s1">series=</span><span class="s2">None, </span><span class="s1">*args</span><span class="s2">, </span><span class="s1">**kwargs):</span>
    <span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

    <span class="s1">fig = plt.gcf()</span>

    <span class="s2">try</span><span class="s1">:</span>
        <span class="s1">plt.clf()</span>
        <span class="s1">ax = fig.add_subplot(</span><span class="s4">211</span><span class="s1">)</span>
        <span class="s1">orig_ax = kwargs.pop(</span><span class="s3">&quot;ax&quot;</span><span class="s2">, </span><span class="s1">plt.gca())</span>
        <span class="s1">orig_axfreq = getattr(orig_ax</span><span class="s2">, </span><span class="s3">&quot;freq&quot;</span><span class="s2">, None</span><span class="s1">)</span>

        <span class="s1">ret = f(*args</span><span class="s2">, </span><span class="s1">**kwargs)</span>
        <span class="s2">assert </span><span class="s1">ret </span><span class="s2">is not None  </span><span class="s5"># do something more intelligent</span>

        <span class="s1">ax = kwargs.pop(</span><span class="s3">&quot;ax&quot;</span><span class="s2">, </span><span class="s1">plt.gca())</span>
        <span class="s2">if </span><span class="s1">series </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">dfreq = series.index.freq</span>
            <span class="s2">if </span><span class="s1">isinstance(dfreq</span><span class="s2">, </span><span class="s1">BaseOffset):</span>
                <span class="s1">dfreq = dfreq.rule_code</span>
            <span class="s2">if </span><span class="s1">orig_axfreq </span><span class="s2">is None</span><span class="s1">:</span>
                <span class="s2">assert </span><span class="s1">ax.freq == dfreq</span>

        <span class="s2">if </span><span class="s1">freq </span><span class="s2">is not None and </span><span class="s1">orig_axfreq </span><span class="s2">is None</span><span class="s1">:</span>
            <span class="s2">assert </span><span class="s1">ax.freq == freq</span>

        <span class="s1">ax = fig.add_subplot(</span><span class="s4">212</span><span class="s1">)</span>
        <span class="s1">kwargs[</span><span class="s3">&quot;ax&quot;</span><span class="s1">] = ax</span>
        <span class="s1">ret = f(*args</span><span class="s2">, </span><span class="s1">**kwargs)</span>
        <span class="s2">assert </span><span class="s1">ret </span><span class="s2">is not None  </span><span class="s5"># TODO: do something more intelligent</span>

        <span class="s2">with </span><span class="s1">tm.ensure_clean(return_filelike=</span><span class="s2">True</span><span class="s1">) </span><span class="s2">as </span><span class="s1">path:</span>
            <span class="s1">plt.savefig(path)</span>

        <span class="s5"># GH18439, GH#24088, statsmodels#4772</span>
        <span class="s2">with </span><span class="s1">tm.ensure_clean(return_filelike=</span><span class="s2">True</span><span class="s1">) </span><span class="s2">as </span><span class="s1">path:</span>
            <span class="s1">pickle.dump(fig</span><span class="s2">, </span><span class="s1">path)</span>
    <span class="s2">finally</span><span class="s1">:</span>
        <span class="s1">plt.close(fig)</span>
</pre>
</body>
</html>