<html>
<head>
<title>test_win_type.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6897bb;}
.s4 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_win_type.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">from </span><span class="s1">pandas.errors </span><span class="s0">import </span><span class="s1">UnsupportedFunctionCall</span>
<span class="s0">import </span><span class="s1">pandas.util._test_decorators </span><span class="s0">as </span><span class="s1">td</span>

<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">DataFrame</span><span class="s0">,</span>
    <span class="s1">Series</span><span class="s0">,</span>
    <span class="s1">Timedelta</span><span class="s0">,</span>
    <span class="s1">concat</span><span class="s0">,</span>
    <span class="s1">date_range</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">import </span><span class="s1">pandas._testing </span><span class="s0">as </span><span class="s1">tm</span>
<span class="s0">from </span><span class="s1">pandas.api.indexers </span><span class="s0">import </span><span class="s1">BaseIndexer</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_constructor(frame_or_series):</span>
    <span class="s2"># GH 12669</span>
    <span class="s1">c = frame_or_series(range(</span><span class="s3">5</span><span class="s1">)).rolling</span>

    <span class="s2"># valid</span>
    <span class="s1">c(win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s0">, </span><span class="s1">window=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">min_periods=</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">c(win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s0">, </span><span class="s1">window=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">min_periods=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">c(win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s0">, </span><span class="s1">window=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">min_periods=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">False</span><span class="s1">)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;w&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2.0</span><span class="s0">, </span><span class="s4">&quot;foo&quot;</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">2</span><span class="s1">])])</span>
<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_invalid_constructor(frame_or_series</span><span class="s0">, </span><span class="s1">w):</span>
    <span class="s2"># not valid</span>

    <span class="s1">c = frame_or_series(range(</span><span class="s3">5</span><span class="s1">)).rolling</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s4">&quot;min_periods must be an integer&quot;</span><span class="s1">):</span>
        <span class="s1">c(win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s0">, </span><span class="s1">window=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">min_periods=w)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s4">&quot;center must be a boolean&quot;</span><span class="s1">):</span>
        <span class="s1">c(win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s0">, </span><span class="s1">window=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">min_periods=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">center=w)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;wt&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s4">&quot;foobar&quot;</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>
<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_invalid_constructor_wintype(frame_or_series</span><span class="s0">, </span><span class="s1">wt):</span>
    <span class="s1">c = frame_or_series(range(</span><span class="s3">5</span><span class="s1">)).rolling</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s4">&quot;Invalid win_type&quot;</span><span class="s1">):</span>
        <span class="s1">c(win_type=wt</span><span class="s0">, </span><span class="s1">window=</span><span class="s3">2</span><span class="s1">)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_constructor_with_win_type(frame_or_series</span><span class="s0">, </span><span class="s1">win_types):</span>
    <span class="s2"># GH 12669</span>
    <span class="s1">c = frame_or_series(range(</span><span class="s3">5</span><span class="s1">)).rolling</span>
    <span class="s1">c(win_type=win_types</span><span class="s0">, </span><span class="s1">window=</span><span class="s3">2</span><span class="s1">)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;method&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s4">&quot;sum&quot;</span><span class="s0">, </span><span class="s4">&quot;mean&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_numpy_compat(method):</span>
    <span class="s2"># see gh-12811</span>
    <span class="s1">w = Series([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]).rolling(window=</span><span class="s3">2</span><span class="s1">)</span>

    <span class="s1">msg = </span><span class="s4">&quot;numpy operations are not valid with window objects&quot;</span>

    <span class="s0">with </span><span class="s1">pytest.raises(UnsupportedFunctionCall</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">getattr(w</span><span class="s0">, </span><span class="s1">method)(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(UnsupportedFunctionCall</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">getattr(w</span><span class="s0">, </span><span class="s1">method)(dtype=np.float64)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;arg&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s4">&quot;median&quot;</span><span class="s0">, </span><span class="s4">&quot;kurt&quot;</span><span class="s0">, </span><span class="s4">&quot;skew&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_agg_function_support(arg):</span>
    <span class="s1">df = DataFrame({</span><span class="s4">&quot;A&quot;</span><span class="s1">: np.arange(</span><span class="s3">5</span><span class="s1">)})</span>
    <span class="s1">roll = df.rolling(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;triang&quot;</span><span class="s1">)</span>

    <span class="s1">msg = </span><span class="s4">f&quot;'</span><span class="s0">{</span><span class="s1">arg</span><span class="s0">}</span><span class="s4">' is not a valid function for 'Window' object&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(AttributeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">roll.agg(arg)</span>

    <span class="s0">with </span><span class="s1">pytest.raises(AttributeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">roll.agg([arg])</span>

    <span class="s0">with </span><span class="s1">pytest.raises(AttributeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">roll.agg({</span><span class="s4">&quot;A&quot;</span><span class="s1">: arg})</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_invalid_scipy_arg():</span>
    <span class="s2"># This error is raised by scipy</span>
    <span class="s1">msg = </span><span class="s4">r&quot;boxcar\(\) got an unexpected&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">Series(range(</span><span class="s3">3</span><span class="s1">)).rolling(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s1">).mean(foo=</span><span class="s4">&quot;bar&quot;</span><span class="s1">)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_constructor_with_win_type_invalid(frame_or_series):</span>
    <span class="s2"># GH 13383</span>
    <span class="s1">c = frame_or_series(range(</span><span class="s3">5</span><span class="s1">)).rolling</span>

    <span class="s1">msg = </span><span class="s4">&quot;window must be an integer 0 or greater&quot;</span>

    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">c(-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s1">)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s1">@pytest.mark.filterwarnings(</span><span class="s4">&quot;ignore:can't resolve:ImportWarning&quot;</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_window_with_args():</span>
    <span class="s2"># make sure that we are aggregating window functions correctly with arg</span>
    <span class="s1">r = Series(np.random.randn(</span><span class="s3">100</span><span class="s1">)).rolling(</span>
        <span class="s1">window=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">min_periods=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;gaussian&quot;</span>
    <span class="s1">)</span>
    <span class="s1">expected = concat([r.mean(std=</span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">r.mean(std=</span><span class="s3">0.01</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">expected.columns = [</span><span class="s4">&quot;&lt;lambda&gt;&quot;</span><span class="s0">, </span><span class="s4">&quot;&lt;lambda&gt;&quot;</span><span class="s1">]</span>
    <span class="s1">result = r.aggregate([</span><span class="s0">lambda </span><span class="s1">x: x.mean(std=</span><span class="s3">10</span><span class="s1">)</span><span class="s0">, lambda </span><span class="s1">x: x.mean(std=</span><span class="s3">0.01</span><span class="s1">)])</span>
    <span class="s1">tm.assert_frame_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s0">def </span><span class="s1">a(x):</span>
        <span class="s0">return </span><span class="s1">x.mean(std=</span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">b(x):</span>
        <span class="s0">return </span><span class="s1">x.mean(std=</span><span class="s3">0.01</span><span class="s1">)</span>

    <span class="s1">expected = concat([r.mean(std=</span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">r.mean(std=</span><span class="s3">0.01</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">expected.columns = [</span><span class="s4">&quot;a&quot;</span><span class="s0">, </span><span class="s4">&quot;b&quot;</span><span class="s1">]</span>
    <span class="s1">result = r.aggregate([a</span><span class="s0">, </span><span class="s1">b])</span>
    <span class="s1">tm.assert_frame_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_win_type_with_method_invalid():</span>
    <span class="s0">with </span><span class="s1">pytest.raises(</span>
        <span class="s1">NotImplementedError</span><span class="s0">, </span><span class="s1">match=</span><span class="s4">&quot;'single' is the only supported method type.&quot;</span>
    <span class="s1">):</span>
        <span class="s1">Series(range(</span><span class="s3">1</span><span class="s1">)).rolling(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;triang&quot;</span><span class="s0">, </span><span class="s1">method=</span><span class="s4">&quot;table&quot;</span><span class="s1">)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s4">&quot;arg&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2000000000</span><span class="s0">, </span><span class="s4">&quot;2s&quot;</span><span class="s0">, </span><span class="s1">Timedelta(</span><span class="s4">&quot;2s&quot;</span><span class="s1">)])</span>
<span class="s0">def </span><span class="s1">test_consistent_win_type_freq(arg):</span>
    <span class="s2"># GH 15969</span>
    <span class="s1">s = Series(range(</span><span class="s3">1</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s4">&quot;Invalid win_type freq&quot;</span><span class="s1">):</span>
        <span class="s1">s.rolling(arg</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;freq&quot;</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_win_type_freq_return_deprecation():</span>
    <span class="s1">freq_roll = Series(range(</span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">index=date_range(</span><span class="s4">&quot;2020&quot;</span><span class="s0">, </span><span class="s1">periods=</span><span class="s3">2</span><span class="s1">)).rolling(</span><span class="s4">&quot;2s&quot;</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s0">assert </span><span class="s1">freq_roll.win_type == </span><span class="s4">&quot;freq&quot;</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_win_type_not_implemented():</span>
    <span class="s0">class </span><span class="s1">CustomIndexer(BaseIndexer):</span>
        <span class="s0">def </span><span class="s1">get_window_bounds(self</span><span class="s0">, </span><span class="s1">num_values</span><span class="s0">, </span><span class="s1">min_periods</span><span class="s0">, </span><span class="s1">center</span><span class="s0">, </span><span class="s1">closed):</span>
            <span class="s0">return </span><span class="s1">np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>

    <span class="s1">df = DataFrame({</span><span class="s4">&quot;values&quot;</span><span class="s1">: range(</span><span class="s3">2</span><span class="s1">)})</span>
    <span class="s1">indexer = CustomIndexer()</span>
    <span class="s0">with </span><span class="s1">pytest.raises(NotImplementedError</span><span class="s0">, </span><span class="s1">match=</span><span class="s4">&quot;BaseIndexer subclasses not&quot;</span><span class="s1">):</span>
        <span class="s1">df.rolling(indexer</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s1">)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_mean():</span>
    <span class="s2"># GH 8238</span>
    <span class="s1">vals = np.array([</span><span class="s3">6.95</span><span class="s0">, </span><span class="s3">15.21</span><span class="s0">, </span><span class="s3">4.72</span><span class="s0">, </span><span class="s3">9.12</span><span class="s0">, </span><span class="s3">13.81</span><span class="s0">, </span><span class="s3">13.49</span><span class="s0">, </span><span class="s3">16.68</span><span class="s0">, </span><span class="s3">9.48</span><span class="s0">, </span><span class="s3">10.63</span><span class="s0">, </span><span class="s3">14.48</span><span class="s1">])</span>
    <span class="s1">result = Series(vals).rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">).mean()</span>
    <span class="s1">expected_values = [</span>
        <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s3">9.962</span><span class="s0">,</span>
        <span class="s3">11.27</span><span class="s0">,</span>
        <span class="s3">11.564</span><span class="s0">,</span>
        <span class="s3">12.516</span><span class="s0">,</span>
        <span class="s3">12.818</span><span class="s0">,</span>
        <span class="s3">12.952</span><span class="s0">,</span>
        <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">np.nan</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s1">expected = Series(expected_values)</span>
    <span class="s1">tm.assert_series_equal(expected</span><span class="s0">, </span><span class="s1">result)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_window():</span>
    <span class="s2"># GH 8238</span>
    <span class="s1">vals = np.array([</span><span class="s3">6.95</span><span class="s0">, </span><span class="s3">15.21</span><span class="s0">, </span><span class="s3">4.72</span><span class="s0">, </span><span class="s3">9.12</span><span class="s0">, </span><span class="s3">13.81</span><span class="s0">, </span><span class="s3">13.49</span><span class="s0">, </span><span class="s3">16.68</span><span class="s0">, </span><span class="s3">9.48</span><span class="s0">, </span><span class="s3">10.63</span><span class="s0">, </span><span class="s3">14.48</span><span class="s1">])</span>
    <span class="s1">result = Series(vals).rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">).mean()</span>
    <span class="s1">expected_values = [</span>
        <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s3">9.962</span><span class="s0">,</span>
        <span class="s3">11.27</span><span class="s0">,</span>
        <span class="s3">11.564</span><span class="s0">,</span>
        <span class="s3">12.516</span><span class="s0">,</span>
        <span class="s3">12.818</span><span class="s0">,</span>
        <span class="s3">12.952</span><span class="s0">,</span>
        <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">np.nan</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s1">expected = Series(expected_values)</span>
    <span class="s1">tm.assert_series_equal(expected</span><span class="s0">, </span><span class="s1">result)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_window_corner():</span>
    <span class="s2"># GH 8238</span>
    <span class="s2"># all nan</span>
    <span class="s1">vals = Series([np.nan] * </span><span class="s3">10</span><span class="s1">)</span>
    <span class="s1">result = vals.rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s1">).mean()</span>
    <span class="s0">assert </span><span class="s1">np.isnan(result).all()</span>

    <span class="s2"># empty</span>
    <span class="s1">vals = Series([]</span><span class="s0">, </span><span class="s1">dtype=object)</span>
    <span class="s1">result = vals.rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s1">).mean()</span>
    <span class="s0">assert </span><span class="s1">len(result) == </span><span class="s3">0</span>

    <span class="s2"># shorter than window</span>
    <span class="s1">vals = Series(np.random.randn(</span><span class="s3">5</span><span class="s1">))</span>
    <span class="s1">result = vals.rolling(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s1">).mean()</span>
    <span class="s0">assert </span><span class="s1">np.isnan(result).all()</span>
    <span class="s0">assert </span><span class="s1">len(result) == </span><span class="s3">5</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s4">&quot;f,xp&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span>
            <span class="s4">&quot;mean&quot;</span><span class="s0">,</span>
            <span class="s1">[</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">9.252</span><span class="s0">, </span><span class="s3">9.392</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">8.644</span><span class="s0">, </span><span class="s3">9.906</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">8.87</span><span class="s0">, </span><span class="s3">10.208</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">6.81</span><span class="s0">, </span><span class="s3">8.588</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">7.792</span><span class="s0">, </span><span class="s3">8.644</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">9.05</span><span class="s0">, </span><span class="s3">7.824</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
            <span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s4">&quot;std&quot;</span><span class="s0">,</span>
            <span class="s1">[</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">3.789706</span><span class="s0">, </span><span class="s3">4.068313</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">3.429232</span><span class="s0">, </span><span class="s3">3.237411</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">3.589269</span><span class="s0">, </span><span class="s3">3.220810</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">3.405195</span><span class="s0">, </span><span class="s3">2.380655</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">3.281839</span><span class="s0">, </span><span class="s3">2.369869</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">3.676846</span><span class="s0">, </span><span class="s3">1.801799</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
            <span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s4">&quot;var&quot;</span><span class="s0">,</span>
            <span class="s1">[</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">14.36187</span><span class="s0">, </span><span class="s3">16.55117</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">11.75963</span><span class="s0">, </span><span class="s3">10.48083</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">12.88285</span><span class="s0">, </span><span class="s3">10.37362</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">11.59535</span><span class="s0">, </span><span class="s3">5.66752</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">10.77047</span><span class="s0">, </span><span class="s3">5.61628</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">13.51920</span><span class="s0">, </span><span class="s3">3.24648</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
            <span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s4">&quot;sum&quot;</span><span class="s0">,</span>
            <span class="s1">[</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">46.26</span><span class="s0">, </span><span class="s3">46.96</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">43.22</span><span class="s0">, </span><span class="s3">49.53</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">44.35</span><span class="s0">, </span><span class="s3">51.04</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">34.05</span><span class="s0">, </span><span class="s3">42.94</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">38.96</span><span class="s0">, </span><span class="s3">43.22</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">45.25</span><span class="s0">, </span><span class="s3">39.12</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
                <span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">,</span>
            <span class="s1">]</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_cmov_window_frame(f</span><span class="s0">, </span><span class="s1">xp):</span>
    <span class="s2"># Gh 8238</span>
    <span class="s1">df = DataFrame(</span>
        <span class="s1">np.array(</span>
            <span class="s1">[</span>
                <span class="s1">[</span><span class="s3">12.18</span><span class="s0">, </span><span class="s3">3.64</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">10.18</span><span class="s0">, </span><span class="s3">9.16</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">13.24</span><span class="s0">, </span><span class="s3">14.61</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">4.51</span><span class="s0">, </span><span class="s3">8.11</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">6.15</span><span class="s0">, </span><span class="s3">11.44</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">9.14</span><span class="s0">, </span><span class="s3">6.21</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">11.31</span><span class="s0">, </span><span class="s3">10.67</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">2.94</span><span class="s0">, </span><span class="s3">6.51</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">9.42</span><span class="s0">, </span><span class="s3">8.39</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">[</span><span class="s3">12.44</span><span class="s0">, </span><span class="s3">7.34</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">]</span>
        <span class="s1">)</span>
    <span class="s1">)</span>
    <span class="s1">xp = DataFrame(np.array(xp))</span>

    <span class="s1">roll = df.rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">rs = getattr(roll</span><span class="s0">, </span><span class="s1">f)()</span>

    <span class="s1">tm.assert_frame_equal(xp</span><span class="s0">, </span><span class="s1">rs)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_window_na_min_periods():</span>
    <span class="s2"># min_periods</span>
    <span class="s1">vals = Series(np.random.randn(</span><span class="s3">10</span><span class="s1">))</span>
    <span class="s1">vals[</span><span class="s3">4</span><span class="s1">] = np.nan</span>
    <span class="s1">vals[</span><span class="s3">8</span><span class="s1">] = np.nan</span>

    <span class="s1">xp = vals.rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">min_periods=</span><span class="s3">4</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">).mean()</span>
    <span class="s1">rs = vals.rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">win_type=</span><span class="s4">&quot;boxcar&quot;</span><span class="s0">, </span><span class="s1">min_periods=</span><span class="s3">4</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">).mean()</span>
    <span class="s1">tm.assert_series_equal(xp</span><span class="s0">, </span><span class="s1">rs)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_window_regular(win_types):</span>
    <span class="s2"># GH 8238</span>
    <span class="s1">vals = np.array([</span><span class="s3">6.95</span><span class="s0">, </span><span class="s3">15.21</span><span class="s0">, </span><span class="s3">4.72</span><span class="s0">, </span><span class="s3">9.12</span><span class="s0">, </span><span class="s3">13.81</span><span class="s0">, </span><span class="s3">13.49</span><span class="s0">, </span><span class="s3">16.68</span><span class="s0">, </span><span class="s3">9.48</span><span class="s0">, </span><span class="s3">10.63</span><span class="s0">, </span><span class="s3">14.48</span><span class="s1">])</span>
    <span class="s1">xps = {</span>
        <span class="s4">&quot;hamming&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">8.71384</span><span class="s0">,</span>
            <span class="s3">9.56348</span><span class="s0">,</span>
            <span class="s3">12.38009</span><span class="s0">,</span>
            <span class="s3">14.03687</span><span class="s0">,</span>
            <span class="s3">13.8567</span><span class="s0">,</span>
            <span class="s3">11.81473</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;triang&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.28667</span><span class="s0">,</span>
            <span class="s3">10.34667</span><span class="s0">,</span>
            <span class="s3">12.00556</span><span class="s0">,</span>
            <span class="s3">13.33889</span><span class="s0">,</span>
            <span class="s3">13.38</span><span class="s0">,</span>
            <span class="s3">12.33667</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;barthann&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">8.4425</span><span class="s0">,</span>
            <span class="s3">9.1925</span><span class="s0">,</span>
            <span class="s3">12.5575</span><span class="s0">,</span>
            <span class="s3">14.3675</span><span class="s0">,</span>
            <span class="s3">14.0825</span><span class="s0">,</span>
            <span class="s3">11.5675</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;bohman&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">7.61599</span><span class="s0">,</span>
            <span class="s3">9.1764</span><span class="s0">,</span>
            <span class="s3">12.83559</span><span class="s0">,</span>
            <span class="s3">14.17267</span><span class="s0">,</span>
            <span class="s3">14.65923</span><span class="s0">,</span>
            <span class="s3">11.10401</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;blackmanharris&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">6.97691</span><span class="s0">,</span>
            <span class="s3">9.16438</span><span class="s0">,</span>
            <span class="s3">13.05052</span><span class="s0">,</span>
            <span class="s3">14.02156</span><span class="s0">,</span>
            <span class="s3">15.10512</span><span class="s0">,</span>
            <span class="s3">10.74574</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;nuttall&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">7.04618</span><span class="s0">,</span>
            <span class="s3">9.16786</span><span class="s0">,</span>
            <span class="s3">13.02671</span><span class="s0">,</span>
            <span class="s3">14.03559</span><span class="s0">,</span>
            <span class="s3">15.05657</span><span class="s0">,</span>
            <span class="s3">10.78514</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;blackman&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">7.73345</span><span class="s0">,</span>
            <span class="s3">9.17869</span><span class="s0">,</span>
            <span class="s3">12.79607</span><span class="s0">,</span>
            <span class="s3">14.20036</span><span class="s0">,</span>
            <span class="s3">14.57726</span><span class="s0">,</span>
            <span class="s3">11.16988</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;bartlett&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">8.4425</span><span class="s0">,</span>
            <span class="s3">9.1925</span><span class="s0">,</span>
            <span class="s3">12.5575</span><span class="s0">,</span>
            <span class="s3">14.3675</span><span class="s0">,</span>
            <span class="s3">14.0825</span><span class="s0">,</span>
            <span class="s3">11.5675</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">xp = Series(xps[win_types])</span>
    <span class="s1">rs = Series(vals).rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">win_type=win_types</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">).mean()</span>
    <span class="s1">tm.assert_series_equal(xp</span><span class="s0">, </span><span class="s1">rs)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_window_regular_linear_range(win_types):</span>
    <span class="s2"># GH 8238</span>
    <span class="s1">vals = np.array(range(</span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=float)</span>
    <span class="s1">xp = vals.copy()</span>
    <span class="s1">xp[:</span><span class="s3">2</span><span class="s1">] = np.nan</span>
    <span class="s1">xp[-</span><span class="s3">2</span><span class="s1">:] = np.nan</span>
    <span class="s1">xp = Series(xp)</span>

    <span class="s1">rs = Series(vals).rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">win_type=win_types</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">).mean()</span>
    <span class="s1">tm.assert_series_equal(xp</span><span class="s0">, </span><span class="s1">rs)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_window_regular_missing_data(win_types):</span>
    <span class="s2"># GH 8238</span>
    <span class="s1">vals = np.array(</span>
        <span class="s1">[</span><span class="s3">6.95</span><span class="s0">, </span><span class="s3">15.21</span><span class="s0">, </span><span class="s3">4.72</span><span class="s0">, </span><span class="s3">9.12</span><span class="s0">, </span><span class="s3">13.81</span><span class="s0">, </span><span class="s3">13.49</span><span class="s0">, </span><span class="s3">16.68</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s3">10.63</span><span class="s0">, </span><span class="s3">14.48</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">xps = {</span>
        <span class="s4">&quot;bartlett&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.70333</span><span class="s0">,</span>
            <span class="s3">10.5225</span><span class="s0">,</span>
            <span class="s3">8.4425</span><span class="s0">,</span>
            <span class="s3">9.1925</span><span class="s0">,</span>
            <span class="s3">12.5575</span><span class="s0">,</span>
            <span class="s3">14.3675</span><span class="s0">,</span>
            <span class="s3">15.61667</span><span class="s0">,</span>
            <span class="s3">13.655</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;blackman&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.04582</span><span class="s0">,</span>
            <span class="s3">11.41536</span><span class="s0">,</span>
            <span class="s3">7.73345</span><span class="s0">,</span>
            <span class="s3">9.17869</span><span class="s0">,</span>
            <span class="s3">12.79607</span><span class="s0">,</span>
            <span class="s3">14.20036</span><span class="s0">,</span>
            <span class="s3">15.8706</span><span class="s0">,</span>
            <span class="s3">13.655</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;barthann&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.70333</span><span class="s0">,</span>
            <span class="s3">10.5225</span><span class="s0">,</span>
            <span class="s3">8.4425</span><span class="s0">,</span>
            <span class="s3">9.1925</span><span class="s0">,</span>
            <span class="s3">12.5575</span><span class="s0">,</span>
            <span class="s3">14.3675</span><span class="s0">,</span>
            <span class="s3">15.61667</span><span class="s0">,</span>
            <span class="s3">13.655</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;bohman&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">8.9444</span><span class="s0">,</span>
            <span class="s3">11.56327</span><span class="s0">,</span>
            <span class="s3">7.61599</span><span class="s0">,</span>
            <span class="s3">9.1764</span><span class="s0">,</span>
            <span class="s3">12.83559</span><span class="s0">,</span>
            <span class="s3">14.17267</span><span class="s0">,</span>
            <span class="s3">15.90976</span><span class="s0">,</span>
            <span class="s3">13.655</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;hamming&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.59321</span><span class="s0">,</span>
            <span class="s3">10.29694</span><span class="s0">,</span>
            <span class="s3">8.71384</span><span class="s0">,</span>
            <span class="s3">9.56348</span><span class="s0">,</span>
            <span class="s3">12.38009</span><span class="s0">,</span>
            <span class="s3">14.20565</span><span class="s0">,</span>
            <span class="s3">15.24694</span><span class="s0">,</span>
            <span class="s3">13.69758</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;nuttall&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">8.47693</span><span class="s0">,</span>
            <span class="s3">12.2821</span><span class="s0">,</span>
            <span class="s3">7.04618</span><span class="s0">,</span>
            <span class="s3">9.16786</span><span class="s0">,</span>
            <span class="s3">13.02671</span><span class="s0">,</span>
            <span class="s3">14.03673</span><span class="s0">,</span>
            <span class="s3">16.08759</span><span class="s0">,</span>
            <span class="s3">13.65553</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;triang&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.33167</span><span class="s0">,</span>
            <span class="s3">9.76125</span><span class="s0">,</span>
            <span class="s3">9.28667</span><span class="s0">,</span>
            <span class="s3">10.34667</span><span class="s0">,</span>
            <span class="s3">12.00556</span><span class="s0">,</span>
            <span class="s3">13.82125</span><span class="s0">,</span>
            <span class="s3">14.49429</span><span class="s0">,</span>
            <span class="s3">13.765</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;blackmanharris&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">8.42526</span><span class="s0">,</span>
            <span class="s3">12.36824</span><span class="s0">,</span>
            <span class="s3">6.97691</span><span class="s0">,</span>
            <span class="s3">9.16438</span><span class="s0">,</span>
            <span class="s3">13.05052</span><span class="s0">,</span>
            <span class="s3">14.02175</span><span class="s0">,</span>
            <span class="s3">16.1098</span><span class="s0">,</span>
            <span class="s3">13.65509</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">xp = Series(xps[win_types])</span>
    <span class="s1">rs = Series(vals).rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">win_type=win_types</span><span class="s0">, </span><span class="s1">min_periods=</span><span class="s3">3</span><span class="s1">).mean()</span>
    <span class="s1">tm.assert_series_equal(xp</span><span class="s0">, </span><span class="s1">rs)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_window_special(win_types_special):</span>
    <span class="s2"># GH 8238</span>
    <span class="s1">kwds = {</span>
        <span class="s4">&quot;kaiser&quot;</span><span class="s1">: {</span><span class="s4">&quot;beta&quot;</span><span class="s1">: </span><span class="s3">1.0</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s4">&quot;gaussian&quot;</span><span class="s1">: {</span><span class="s4">&quot;std&quot;</span><span class="s1">: </span><span class="s3">1.0</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s4">&quot;general_gaussian&quot;</span><span class="s1">: {</span><span class="s4">&quot;p&quot;</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s4">&quot;sig&quot;</span><span class="s1">: </span><span class="s3">2.0</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s4">&quot;exponential&quot;</span><span class="s1">: {</span><span class="s4">&quot;tau&quot;</span><span class="s1">: </span><span class="s3">10</span><span class="s1">}</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">vals = np.array([</span><span class="s3">6.95</span><span class="s0">, </span><span class="s3">15.21</span><span class="s0">, </span><span class="s3">4.72</span><span class="s0">, </span><span class="s3">9.12</span><span class="s0">, </span><span class="s3">13.81</span><span class="s0">, </span><span class="s3">13.49</span><span class="s0">, </span><span class="s3">16.68</span><span class="s0">, </span><span class="s3">9.48</span><span class="s0">, </span><span class="s3">10.63</span><span class="s0">, </span><span class="s3">14.48</span><span class="s1">])</span>

    <span class="s1">xps = {</span>
        <span class="s4">&quot;gaussian&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">8.97297</span><span class="s0">,</span>
            <span class="s3">9.76077</span><span class="s0">,</span>
            <span class="s3">12.24763</span><span class="s0">,</span>
            <span class="s3">13.89053</span><span class="s0">,</span>
            <span class="s3">13.65671</span><span class="s0">,</span>
            <span class="s3">12.01002</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;general_gaussian&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.85011</span><span class="s0">,</span>
            <span class="s3">10.71589</span><span class="s0">,</span>
            <span class="s3">11.73161</span><span class="s0">,</span>
            <span class="s3">13.08516</span><span class="s0">,</span>
            <span class="s3">12.95111</span><span class="s0">,</span>
            <span class="s3">12.74577</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;kaiser&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.86851</span><span class="s0">,</span>
            <span class="s3">11.02969</span><span class="s0">,</span>
            <span class="s3">11.65161</span><span class="s0">,</span>
            <span class="s3">12.75129</span><span class="s0">,</span>
            <span class="s3">12.90702</span><span class="s0">,</span>
            <span class="s3">12.83757</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s4">&quot;exponential&quot;</span><span class="s1">: [</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s3">9.83364</span><span class="s0">,</span>
            <span class="s3">11.10472</span><span class="s0">,</span>
            <span class="s3">11.64551</span><span class="s0">,</span>
            <span class="s3">12.66138</span><span class="s0">,</span>
            <span class="s3">12.92379</span><span class="s0">,</span>
            <span class="s3">12.83770</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
            <span class="s1">np.nan</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">xp = Series(xps[win_types_special])</span>
    <span class="s1">rs = (</span>
        <span class="s1">Series(vals)</span>
        <span class="s1">.rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">win_type=win_types_special</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">)</span>
        <span class="s1">.mean(**kwds[win_types_special])</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(xp</span><span class="s0">, </span><span class="s1">rs)</span>


<span class="s1">@td.skip_if_no_scipy</span>
<span class="s0">def </span><span class="s1">test_cmov_window_special_linear_range(win_types_special):</span>
    <span class="s2"># GH 8238</span>
    <span class="s1">kwds = {</span>
        <span class="s4">&quot;kaiser&quot;</span><span class="s1">: {</span><span class="s4">&quot;beta&quot;</span><span class="s1">: </span><span class="s3">1.0</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s4">&quot;gaussian&quot;</span><span class="s1">: {</span><span class="s4">&quot;std&quot;</span><span class="s1">: </span><span class="s3">1.0</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s4">&quot;general_gaussian&quot;</span><span class="s1">: {</span><span class="s4">&quot;p&quot;</span><span class="s1">: </span><span class="s3">2.0</span><span class="s0">, </span><span class="s4">&quot;sig&quot;</span><span class="s1">: </span><span class="s3">2.0</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s4">&quot;slepian&quot;</span><span class="s1">: {</span><span class="s4">&quot;width&quot;</span><span class="s1">: </span><span class="s3">0.5</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s4">&quot;exponential&quot;</span><span class="s1">: {</span><span class="s4">&quot;tau&quot;</span><span class="s1">: </span><span class="s3">10</span><span class="s1">}</span><span class="s0">,</span>
    <span class="s1">}</span>

    <span class="s1">vals = np.array(range(</span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=float)</span>
    <span class="s1">xp = vals.copy()</span>
    <span class="s1">xp[:</span><span class="s3">2</span><span class="s1">] = np.nan</span>
    <span class="s1">xp[-</span><span class="s3">2</span><span class="s1">:] = np.nan</span>
    <span class="s1">xp = Series(xp)</span>

    <span class="s1">rs = (</span>
        <span class="s1">Series(vals)</span>
        <span class="s1">.rolling(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">win_type=win_types_special</span><span class="s0">, </span><span class="s1">center=</span><span class="s0">True</span><span class="s1">)</span>
        <span class="s1">.mean(**kwds[win_types_special])</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(xp</span><span class="s0">, </span><span class="s1">rs)</span>
</pre>
</body>
</html>