<html>
<head>
<title>test_hist_method.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_hist_method.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; Test cases for .hist method &quot;&quot;&quot;</span>
<span class="s2">import </span><span class="s1">re</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pytest</span>

<span class="s2">import </span><span class="s1">pandas.util._test_decorators </span><span class="s2">as </span><span class="s1">td</span>

<span class="s2">from </span><span class="s1">pandas </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">DataFrame</span><span class="s2">,</span>
    <span class="s1">Index</span><span class="s2">,</span>
    <span class="s1">Series</span><span class="s2">,</span>
    <span class="s1">to_datetime</span><span class="s2">,</span>
<span class="s1">)</span>
<span class="s2">import </span><span class="s1">pandas._testing </span><span class="s2">as </span><span class="s1">tm</span>
<span class="s2">from </span><span class="s1">pandas.tests.plotting.common </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">TestPlotBase</span><span class="s2">,</span>
    <span class="s1">_check_plot_works</span><span class="s2">,</span>
<span class="s1">)</span>

<span class="s1">pytestmark = pytest.mark.slow</span>


<span class="s1">@td.skip_if_no_mpl</span>
<span class="s2">class </span><span class="s1">TestSeriesPlots(TestPlotBase):</span>
    <span class="s2">def </span><span class="s1">setup_method(self</span><span class="s2">, </span><span class="s1">method):</span>
        <span class="s1">TestPlotBase.setup_method(self</span><span class="s2">, </span><span class="s1">method)</span>
        <span class="s2">import </span><span class="s1">matplotlib </span><span class="s2">as </span><span class="s1">mpl</span>

        <span class="s1">mpl.rcdefaults()</span>

        <span class="s1">self.ts = tm.makeTimeSeries()</span>
        <span class="s1">self.ts.name = </span><span class="s3">&quot;ts&quot;</span>

    <span class="s2">def </span><span class="s1">test_hist_legacy(self):</span>
        <span class="s1">_check_plot_works(self.ts.hist)</span>
        <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">grid=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">figsize=(</span><span class="s4">8</span><span class="s2">, </span><span class="s4">10</span><span class="s1">))</span>
        <span class="s5"># _check_plot_works adds an ax so catch warning. see GH #13188</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">by=self.ts.index.month)</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">by=self.ts.index.month</span><span class="s2">, </span><span class="s1">bins=</span><span class="s4">5</span><span class="s1">)</span>

        <span class="s1">fig</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span>
        <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">ax=ax</span><span class="s2">, </span><span class="s1">default_axes=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">ax=ax</span><span class="s2">, </span><span class="s1">figure=fig</span><span class="s2">, </span><span class="s1">default_axes=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">figure=fig</span><span class="s2">, </span><span class="s1">default_axes=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">tm.close()</span>

        <span class="s1">fig</span><span class="s2">, </span><span class="s1">(ax1</span><span class="s2">, </span><span class="s1">ax2) = self.plt.subplots(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span>
        <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">figure=fig</span><span class="s2">, </span><span class="s1">ax=ax1</span><span class="s2">, </span><span class="s1">default_axes=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">_check_plot_works(self.ts.hist</span><span class="s2">, </span><span class="s1">figure=fig</span><span class="s2">, </span><span class="s1">ax=ax2</span><span class="s2">, </span><span class="s1">default_axes=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s1">msg = (</span>
            <span class="s3">&quot;Cannot pass 'figure' when using the 'by' argument, since a new 'Figure' &quot;</span>
            <span class="s3">&quot;instance will be created&quot;</span>
        <span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">self.ts.hist(by=self.ts.index</span><span class="s2">, </span><span class="s1">figure=fig)</span>

    <span class="s2">def </span><span class="s1">test_hist_bins_legacy(self):</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">ax = df.hist(bins=</span><span class="s4">2</span><span class="s1">)[</span><span class="s4">0</span><span class="s1">][</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s2">assert </span><span class="s1">len(ax.patches) == </span><span class="s4">2</span>

    <span class="s2">def </span><span class="s1">test_hist_layout(self):</span>
        <span class="s1">df = self.hist_df</span>
        <span class="s1">msg = </span><span class="s3">&quot;The 'layout' keyword is not supported when 'by' is None&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.height.hist(layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.height.hist(layout=[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">])</span>

    <span class="s2">def </span><span class="s1">test_hist_layout_with_by(self):</span>
        <span class="s1">df = self.hist_df</span>

        <span class="s5"># _check_plot_works adds an `ax` kwarg to the method call</span>
        <span class="s5"># so we get a warning about an axis being cleared, even</span>
        <span class="s5"># though we don't explicing pass one, see GH #13188</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.height.hist</span><span class="s2">, </span><span class="s1">by=df.gender</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.height.hist</span><span class="s2">, </span><span class="s1">by=df.gender</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">3</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.height.hist</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.height.hist</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.height.hist</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">3</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.height.hist</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(-</span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.height.hist</span><span class="s2">, </span><span class="s1">by=df.classroom</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

        <span class="s1">axes = df.height.hist(by=df.category</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">figsize=(</span><span class="s4">12</span><span class="s2">, </span><span class="s4">7</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">figsize=(</span><span class="s4">12</span><span class="s2">, </span><span class="s4">7</span><span class="s1">))</span>

    <span class="s2">def </span><span class="s1">test_hist_no_overlap(self):</span>
        <span class="s2">from </span><span class="s1">matplotlib.pyplot </span><span class="s2">import </span><span class="s1">(</span>
            <span class="s1">gcf</span><span class="s2">,</span>
            <span class="s1">subplot</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">x = Series(np.random.randn(</span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">y = Series(np.random.randn(</span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">subplot(</span><span class="s4">121</span><span class="s1">)</span>
        <span class="s1">x.hist()</span>
        <span class="s1">subplot(</span><span class="s4">122</span><span class="s1">)</span>
        <span class="s1">y.hist()</span>
        <span class="s1">fig = gcf()</span>
        <span class="s1">axes = fig.axes</span>
        <span class="s2">assert </span><span class="s1">len(axes) == </span><span class="s4">2</span>

    <span class="s2">def </span><span class="s1">test_hist_by_no_extra_plots(self):</span>
        <span class="s1">df = self.hist_df</span>
        <span class="s1">axes = df.height.hist(by=df.gender)  </span><span class="s5"># noqa</span>
        <span class="s2">assert </span><span class="s1">len(self.plt.get_fignums()) == </span><span class="s4">1</span>

    <span class="s2">def </span><span class="s1">test_plot_fails_when_ax_differs_from_figure(self):</span>
        <span class="s2">from </span><span class="s1">pylab </span><span class="s2">import </span><span class="s1">figure</span>

        <span class="s1">fig1 = figure()</span>
        <span class="s1">fig2 = figure()</span>
        <span class="s1">ax1 = fig1.add_subplot(</span><span class="s4">111</span><span class="s1">)</span>
        <span class="s1">msg = </span><span class="s3">&quot;passed axis not bound to passed figure&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(AssertionError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">self.ts.hist(ax=ax1</span><span class="s2">, </span><span class="s1">figure=fig2)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;histtype, expected&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s3">&quot;bar&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;barstacked&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;step&quot;</span><span class="s2">, False</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;stepfilled&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_histtype_argument(self</span><span class="s2">, </span><span class="s1">histtype</span><span class="s2">, </span><span class="s1">expected):</span>
        <span class="s5"># GH23992 Verify functioning of histtype argument</span>
        <span class="s1">ser = Series(np.random.randint(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">10</span><span class="s1">))</span>
        <span class="s1">ax = ser.hist(histtype=histtype)</span>
        <span class="s1">self._check_patches_all_filled(ax</span><span class="s2">, </span><span class="s1">filled=expected)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;by, expected_axes_num, expected_layout&quot;</span><span class="s2">, </span><span class="s1">[(</span><span class="s2">None, </span><span class="s4">1</span><span class="s2">, </span><span class="s1">(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span><span class="s2">, </span><span class="s1">(</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s1">(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))]</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_hist_with_legend(self</span><span class="s2">, </span><span class="s1">by</span><span class="s2">, </span><span class="s1">expected_axes_num</span><span class="s2">, </span><span class="s1">expected_layout):</span>
        <span class="s5"># GH 6279 - Series histogram can have a legend</span>
        <span class="s1">index = </span><span class="s4">15 </span><span class="s1">* [</span><span class="s3">&quot;1&quot;</span><span class="s1">] + </span><span class="s4">15 </span><span class="s1">* [</span><span class="s3">&quot;2&quot;</span><span class="s1">]</span>
        <span class="s1">s = Series(np.random.randn(</span><span class="s4">30</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=index</span><span class="s2">, </span><span class="s1">name=</span><span class="s3">&quot;a&quot;</span><span class="s1">)</span>
        <span class="s1">s.index.name = </span><span class="s3">&quot;b&quot;</span>

        <span class="s5"># Use default_axes=True when plotting method generate subplots itself</span>
        <span class="s1">axes = _check_plot_works(s.hist</span><span class="s2">, </span><span class="s1">default_axes=</span><span class="s2">True, </span><span class="s1">legend=</span><span class="s2">True, </span><span class="s1">by=by)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=expected_axes_num</span><span class="s2">, </span><span class="s1">layout=expected_layout)</span>
        <span class="s1">self._check_legend_labels(axes</span><span class="s2">, </span><span class="s3">&quot;a&quot;</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;by&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">None, </span><span class="s3">&quot;b&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_hist_with_legend_raises(self</span><span class="s2">, </span><span class="s1">by):</span>
        <span class="s5"># GH 6279 - Series histogram with legend and label raises</span>
        <span class="s1">index = </span><span class="s4">15 </span><span class="s1">* [</span><span class="s3">&quot;1&quot;</span><span class="s1">] + </span><span class="s4">15 </span><span class="s1">* [</span><span class="s3">&quot;2&quot;</span><span class="s1">]</span>
        <span class="s1">s = Series(np.random.randn(</span><span class="s4">30</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=index</span><span class="s2">, </span><span class="s1">name=</span><span class="s3">&quot;a&quot;</span><span class="s1">)</span>
        <span class="s1">s.index.name = </span><span class="s3">&quot;b&quot;</span>

        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">&quot;Cannot use both legend and label&quot;</span><span class="s1">):</span>
            <span class="s1">s.hist(legend=</span><span class="s2">True, </span><span class="s1">by=by</span><span class="s2">, </span><span class="s1">label=</span><span class="s3">&quot;c&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hist_kwargs(self):</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = self.ts.plot.hist(bins=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s2">assert </span><span class="s1">len(ax.patches) == </span><span class="s4">5</span>
        <span class="s1">self._check_text_labels(ax.yaxis.get_label()</span><span class="s2">, </span><span class="s3">&quot;Frequency&quot;</span><span class="s1">)</span>
        <span class="s1">tm.close()</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = self.ts.plot.hist(orientation=</span><span class="s3">&quot;horizontal&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">self._check_text_labels(ax.xaxis.get_label()</span><span class="s2">, </span><span class="s3">&quot;Frequency&quot;</span><span class="s1">)</span>
        <span class="s1">tm.close()</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = self.ts.plot.hist(align=</span><span class="s3">&quot;left&quot;</span><span class="s2">, </span><span class="s1">stacked=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">tm.close()</span>

    <span class="s1">@td.skip_if_no_scipy</span>
    <span class="s2">def </span><span class="s1">test_hist_kde(self):</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = self.ts.plot.hist(logy=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">self._check_ax_scales(ax</span><span class="s2">, </span><span class="s1">yaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>
        <span class="s1">xlabels = ax.get_xticklabels()</span>
        <span class="s5"># ticks are values, thus ticklabels are blank</span>
        <span class="s1">self._check_text_labels(xlabels</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;&quot;</span><span class="s1">] * len(xlabels))</span>
        <span class="s1">ylabels = ax.get_yticklabels()</span>
        <span class="s1">self._check_text_labels(ylabels</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;&quot;</span><span class="s1">] * len(ylabels))</span>

        <span class="s1">_check_plot_works(self.ts.plot.kde)</span>
        <span class="s1">_check_plot_works(self.ts.plot.density)</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = self.ts.plot.kde(logy=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">self._check_ax_scales(ax</span><span class="s2">, </span><span class="s1">yaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>
        <span class="s1">xlabels = ax.get_xticklabels()</span>
        <span class="s1">self._check_text_labels(xlabels</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;&quot;</span><span class="s1">] * len(xlabels))</span>
        <span class="s1">ylabels = ax.get_yticklabels()</span>
        <span class="s1">self._check_text_labels(ylabels</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;&quot;</span><span class="s1">] * len(ylabels))</span>

    <span class="s1">@td.skip_if_no_scipy</span>
    <span class="s2">def </span><span class="s1">test_hist_kde_color(self):</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = self.ts.plot.hist(logy=</span><span class="s2">True, </span><span class="s1">bins=</span><span class="s4">10</span><span class="s2">, </span><span class="s1">color=</span><span class="s3">&quot;b&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">self._check_ax_scales(ax</span><span class="s2">, </span><span class="s1">yaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>
        <span class="s2">assert </span><span class="s1">len(ax.patches) == </span><span class="s4">10</span>
        <span class="s1">self._check_colors(ax.patches</span><span class="s2">, </span><span class="s1">facecolors=[</span><span class="s3">&quot;b&quot;</span><span class="s1">] * </span><span class="s4">10</span><span class="s1">)</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = self.ts.plot.kde(logy=</span><span class="s2">True, </span><span class="s1">color=</span><span class="s3">&quot;r&quot;</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s1">self._check_ax_scales(ax</span><span class="s2">, </span><span class="s1">yaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>
        <span class="s1">lines = ax.get_lines()</span>
        <span class="s2">assert </span><span class="s1">len(lines) == </span><span class="s4">1</span>
        <span class="s1">self._check_colors(lines</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;r&quot;</span><span class="s1">])</span>


<span class="s1">@td.skip_if_no_mpl</span>
<span class="s2">class </span><span class="s1">TestDataFramePlots(TestPlotBase):</span>
    <span class="s2">def </span><span class="s1">test_hist_df_legacy(self):</span>
        <span class="s2">from </span><span class="s1">matplotlib.patches </span><span class="s2">import </span><span class="s1">Rectangle</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">_check_plot_works(self.hist_df.hist)</span>

        <span class="s5"># make sure layout is handled</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">df[</span><span class="s4">2</span><span class="s1">] = to_datetime(</span>
            <span class="s1">np.random.randint(</span>
                <span class="s1">self.start_date_to_int64</span><span class="s2">,</span>
                <span class="s1">self.end_date_to_int64</span><span class="s2">,</span>
                <span class="s1">size=</span><span class="s4">100</span><span class="s2">,</span>
                <span class="s1">dtype=np.int64</span><span class="s2">,</span>
            <span class="s1">)</span>
        <span class="s1">)</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.hist</span><span class="s2">, </span><span class="s1">grid=</span><span class="s2">False</span><span class="s1">)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>
        <span class="s2">assert not </span><span class="s1">axes[</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">].get_visible()</span>

        <span class="s1">_check_plot_works(df[[</span><span class="s4">2</span><span class="s1">]].hist)</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">_check_plot_works(df.hist)</span>

        <span class="s5"># make sure layout is handled</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">5</span><span class="s1">))</span>
        <span class="s1">df[</span><span class="s4">5</span><span class="s1">] = to_datetime(</span>
            <span class="s1">np.random.randint(</span>
                <span class="s1">self.start_date_to_int64</span><span class="s2">,</span>
                <span class="s1">self.end_date_to_int64</span><span class="s2">,</span>
                <span class="s1">size=</span><span class="s4">100</span><span class="s2">,</span>
                <span class="s1">dtype=np.int64</span><span class="s2">,</span>
            <span class="s1">)</span>
        <span class="s1">)</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.hist</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">6</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

        <span class="s5"># make sure sharex, sharey is handled</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">_check_plot_works(df.hist</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s5"># handle figsize arg</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">_check_plot_works(df.hist</span><span class="s2">, </span><span class="s1">figsize=(</span><span class="s4">8</span><span class="s2">, </span><span class="s4">10</span><span class="s1">))</span>

        <span class="s5"># check bins argument</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">_check_plot_works(df.hist</span><span class="s2">, </span><span class="s1">bins=</span><span class="s4">5</span><span class="s1">)</span>

        <span class="s5"># make sure xlabelsize and xrot are handled</span>
        <span class="s1">ser = df[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s1">xf</span><span class="s2">, </span><span class="s1">yf = </span><span class="s4">20</span><span class="s2">, </span><span class="s4">18</span>
        <span class="s1">xrot</span><span class="s2">, </span><span class="s1">yrot = </span><span class="s4">30</span><span class="s2">, </span><span class="s4">40</span>
        <span class="s1">axes = ser.hist(xlabelsize=xf</span><span class="s2">, </span><span class="s1">xrot=xrot</span><span class="s2">, </span><span class="s1">ylabelsize=yf</span><span class="s2">, </span><span class="s1">yrot=yrot)</span>
        <span class="s1">self._check_ticks_props(</span>
            <span class="s1">axes</span><span class="s2">, </span><span class="s1">xlabelsize=xf</span><span class="s2">, </span><span class="s1">xrot=xrot</span><span class="s2">, </span><span class="s1">ylabelsize=yf</span><span class="s2">, </span><span class="s1">yrot=yrot</span>
        <span class="s1">)</span>

        <span class="s1">xf</span><span class="s2">, </span><span class="s1">yf = </span><span class="s4">20</span><span class="s2">, </span><span class="s4">18</span>
        <span class="s1">xrot</span><span class="s2">, </span><span class="s1">yrot = </span><span class="s4">30</span><span class="s2">, </span><span class="s4">40</span>
        <span class="s1">axes = df.hist(xlabelsize=xf</span><span class="s2">, </span><span class="s1">xrot=xrot</span><span class="s2">, </span><span class="s1">ylabelsize=yf</span><span class="s2">, </span><span class="s1">yrot=yrot)</span>
        <span class="s1">self._check_ticks_props(</span>
            <span class="s1">axes</span><span class="s2">, </span><span class="s1">xlabelsize=xf</span><span class="s2">, </span><span class="s1">xrot=xrot</span><span class="s2">, </span><span class="s1">ylabelsize=yf</span><span class="s2">, </span><span class="s1">yrot=yrot</span>
        <span class="s1">)</span>

        <span class="s1">tm.close()</span>

        <span class="s1">ax = ser.hist(cumulative=</span><span class="s2">True, </span><span class="s1">bins=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">density=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s5"># height of last bin (index 5) must be 1.0</span>
        <span class="s1">rects = [x </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax.get_children() </span><span class="s2">if </span><span class="s1">isinstance(x</span><span class="s2">, </span><span class="s1">Rectangle)]</span>
        <span class="s1">tm.assert_almost_equal(rects[-</span><span class="s4">1</span><span class="s1">].get_height()</span><span class="s2">, </span><span class="s4">1.0</span><span class="s1">)</span>

        <span class="s1">tm.close()</span>
        <span class="s1">ax = ser.hist(log=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s5"># scale of y must be 'log'</span>
        <span class="s1">self._check_ax_scales(ax</span><span class="s2">, </span><span class="s1">yaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>

        <span class="s1">tm.close()</span>

        <span class="s5"># propagate attr exception from matplotlib.Axes.hist</span>
        <span class="s2">with </span><span class="s1">tm.external_error_raised(AttributeError):</span>
            <span class="s1">ser.hist(foo=</span><span class="s3">&quot;bar&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hist_non_numerical_or_datetime_raises(self):</span>
        <span class="s5"># gh-10444, GH32590</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;a&quot;</span><span class="s1">: np.random.rand(</span><span class="s4">10</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;b&quot;</span><span class="s1">: np.random.randint(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s4">10</span><span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;c&quot;</span><span class="s1">: to_datetime(</span>
                    <span class="s1">np.random.randint(</span>
                        <span class="s4">1582800000000000000</span><span class="s2">, </span><span class="s4">1583500000000000000</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">dtype=np.int64</span>
                    <span class="s1">)</span>
                <span class="s1">)</span><span class="s2">,</span>
                <span class="s3">&quot;d&quot;</span><span class="s1">: to_datetime(</span>
                    <span class="s1">np.random.randint(</span>
                        <span class="s4">1582800000000000000</span><span class="s2">, </span><span class="s4">1583500000000000000</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">dtype=np.int64</span>
                    <span class="s1">)</span><span class="s2">,</span>
                    <span class="s1">utc=</span><span class="s2">True,</span>
                <span class="s1">)</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s1">df_o = df.astype(object)</span>

        <span class="s1">msg = </span><span class="s3">&quot;hist method requires numerical or datetime columns, nothing to plot.&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df_o.hist()</span>

    <span class="s2">def </span><span class="s1">test_hist_layout(self):</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">df[</span><span class="s4">2</span><span class="s1">] = to_datetime(</span>
            <span class="s1">np.random.randint(</span>
                <span class="s1">self.start_date_to_int64</span><span class="s2">,</span>
                <span class="s1">self.end_date_to_int64</span><span class="s2">,</span>
                <span class="s1">size=</span><span class="s4">100</span><span class="s2">,</span>
                <span class="s1">dtype=np.int64</span><span class="s2">,</span>
            <span class="s1">)</span>
        <span class="s1">)</span>

        <span class="s1">layout_to_expected_size = (</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: </span><span class="s2">None, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)}</span><span class="s2">,  </span><span class="s5"># default is 2x2</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: (</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">3</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: (-</span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">1</span><span class="s2">, </span><span class="s4">4</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: (</span><span class="s4">4</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: (-</span><span class="s4">1</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)}</span><span class="s2">,</span>
            <span class="s1">{</span><span class="s3">&quot;layout&quot;</span><span class="s1">: (</span><span class="s4">2</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s3">&quot;expected_size&quot;</span><span class="s1">: (</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)}</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s2">for </span><span class="s1">layout_test </span><span class="s2">in </span><span class="s1">layout_to_expected_size:</span>
            <span class="s1">axes = df.hist(layout=layout_test[</span><span class="s3">&quot;layout&quot;</span><span class="s1">])</span>
            <span class="s1">expected = layout_test[</span><span class="s3">&quot;expected_size&quot;</span><span class="s1">]</span>
            <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">layout=expected)</span>

        <span class="s5"># layout too small for all 4 plots</span>
        <span class="s1">msg = </span><span class="s3">&quot;Layout of 1x1 must be larger than required size 3&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.hist(layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s5"># invalid format for layout</span>
        <span class="s1">msg = re.escape(</span><span class="s3">&quot;Layout must be a tuple of (rows, columns)&quot;</span><span class="s1">)</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.hist(layout=(</span><span class="s4">1</span><span class="s2">,</span><span class="s1">))</span>
        <span class="s1">msg = </span><span class="s3">&quot;At least one dimension of layout must be positive&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.hist(layout=(-</span><span class="s4">1</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">))</span>

    <span class="s5"># GH 9351</span>
    <span class="s2">def </span><span class="s1">test_tight_layout(self):</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">df[</span><span class="s4">2</span><span class="s1">] = to_datetime(</span>
            <span class="s1">np.random.randint(</span>
                <span class="s1">self.start_date_to_int64</span><span class="s2">,</span>
                <span class="s1">self.end_date_to_int64</span><span class="s2">,</span>
                <span class="s1">size=</span><span class="s4">100</span><span class="s2">,</span>
                <span class="s1">dtype=np.int64</span><span class="s2">,</span>
            <span class="s1">)</span>
        <span class="s1">)</span>
        <span class="s5"># Use default_axes=True when plotting method generate subplots itself</span>
        <span class="s1">_check_plot_works(df.hist</span><span class="s2">, </span><span class="s1">default_axes=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s1">self.plt.tight_layout()</span>

        <span class="s1">tm.close()</span>

    <span class="s2">def </span><span class="s1">test_hist_subplot_xrot(self):</span>
        <span class="s5"># GH 30288</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;length&quot;</span><span class="s1">: [</span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">1.2</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;animal&quot;</span><span class="s1">: [</span><span class="s3">&quot;pig&quot;</span><span class="s2">, </span><span class="s3">&quot;rabbit&quot;</span><span class="s2">, </span><span class="s3">&quot;pig&quot;</span><span class="s2">, </span><span class="s3">&quot;pig&quot;</span><span class="s2">, </span><span class="s3">&quot;rabbit&quot;</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">}</span>
        <span class="s1">)</span>
        <span class="s5"># Use default_axes=True when plotting method generate subplots itself</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.hist</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">filterwarnings=</span><span class="s3">&quot;always&quot;</span><span class="s2">,</span>
            <span class="s1">column=</span><span class="s3">&quot;length&quot;</span><span class="s2">,</span>
            <span class="s1">by=</span><span class="s3">&quot;animal&quot;</span><span class="s2">,</span>
            <span class="s1">bins=</span><span class="s4">5</span><span class="s2">,</span>
            <span class="s1">xrot=</span><span class="s4">0</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">self._check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s4">0</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;column, expected&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s2">None, </span><span class="s1">[</span><span class="s3">&quot;width&quot;</span><span class="s2">, </span><span class="s3">&quot;length&quot;</span><span class="s2">, </span><span class="s3">&quot;height&quot;</span><span class="s1">])</span><span class="s2">,</span>
            <span class="s1">([</span><span class="s3">&quot;length&quot;</span><span class="s2">, </span><span class="s3">&quot;width&quot;</span><span class="s2">, </span><span class="s3">&quot;height&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[</span><span class="s3">&quot;length&quot;</span><span class="s2">, </span><span class="s3">&quot;width&quot;</span><span class="s2">, </span><span class="s3">&quot;height&quot;</span><span class="s1">])</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_hist_column_order_unchanged(self</span><span class="s2">, </span><span class="s1">column</span><span class="s2">, </span><span class="s1">expected):</span>
        <span class="s5"># GH29235</span>

        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span>
                <span class="s3">&quot;width&quot;</span><span class="s1">: [</span><span class="s4">0.7</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">0.15</span><span class="s2">, </span><span class="s4">0.2</span><span class="s2">, </span><span class="s4">1.1</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;length&quot;</span><span class="s1">: [</span><span class="s4">1.5</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">1.2</span><span class="s2">, </span><span class="s4">0.9</span><span class="s2">, </span><span class="s4">3</span><span class="s1">]</span><span class="s2">,</span>
                <span class="s3">&quot;height&quot;</span><span class="s1">: [</span><span class="s4">3</span><span class="s2">, </span><span class="s4">0.5</span><span class="s2">, </span><span class="s4">3.4</span><span class="s2">, </span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">]</span><span class="s2">,</span>
            <span class="s1">}</span><span class="s2">,</span>
            <span class="s1">index=[</span><span class="s3">&quot;pig&quot;</span><span class="s2">, </span><span class="s3">&quot;rabbit&quot;</span><span class="s2">, </span><span class="s3">&quot;duck&quot;</span><span class="s2">, </span><span class="s3">&quot;chicken&quot;</span><span class="s2">, </span><span class="s3">&quot;horse&quot;</span><span class="s1">]</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s5"># Use default_axes=True when plotting method generate subplots itself</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.hist</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">column=column</span><span class="s2">,</span>
            <span class="s1">layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">)</span>
        <span class="s1">result = [axes[</span><span class="s4">0</span><span class="s2">, </span><span class="s1">i].get_title() </span><span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">3</span><span class="s1">)]</span>
        <span class="s2">assert </span><span class="s1">result == expected</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;histtype, expected&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s3">&quot;bar&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;barstacked&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;step&quot;</span><span class="s2">, False</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;stepfilled&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_histtype_argument(self</span><span class="s2">, </span><span class="s1">histtype</span><span class="s2">, </span><span class="s1">expected):</span>
        <span class="s5"># GH23992 Verify functioning of histtype argument</span>
        <span class="s1">df = DataFrame(np.random.randint(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">size=(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">])</span>
        <span class="s1">ax = df.hist(histtype=histtype)</span>
        <span class="s1">self._check_patches_all_filled(ax</span><span class="s2">, </span><span class="s1">filled=expected)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;by&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">None, </span><span class="s3">&quot;c&quot;</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;column&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">None, </span><span class="s3">&quot;b&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_hist_with_legend(self</span><span class="s2">, </span><span class="s1">by</span><span class="s2">, </span><span class="s1">column):</span>
        <span class="s5"># GH 6279 - DataFrame histogram can have a legend</span>
        <span class="s1">expected_axes_num = </span><span class="s4">1 </span><span class="s2">if </span><span class="s1">by </span><span class="s2">is None and </span><span class="s1">column </span><span class="s2">is not None else </span><span class="s4">2</span>
        <span class="s1">expected_layout = (</span><span class="s4">1</span><span class="s2">, </span><span class="s1">expected_axes_num)</span>
        <span class="s1">expected_labels = column </span><span class="s2">or </span><span class="s1">[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">]</span>
        <span class="s2">if </span><span class="s1">by </span><span class="s2">is not None</span><span class="s1">:</span>
            <span class="s1">expected_labels = [expected_labels] * </span><span class="s4">2</span>

        <span class="s1">index = Index(</span><span class="s4">15 </span><span class="s1">* [</span><span class="s3">&quot;1&quot;</span><span class="s1">] + </span><span class="s4">15 </span><span class="s1">* [</span><span class="s3">&quot;2&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">name=</span><span class="s3">&quot;c&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">30</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=index</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">])</span>

        <span class="s5"># Use default_axes=True when plotting method generate subplots itself</span>
        <span class="s1">axes = _check_plot_works(</span>
            <span class="s1">df.hist</span><span class="s2">,</span>
            <span class="s1">default_axes=</span><span class="s2">True,</span>
            <span class="s1">legend=</span><span class="s2">True,</span>
            <span class="s1">by=by</span><span class="s2">,</span>
            <span class="s1">column=column</span><span class="s2">,</span>
        <span class="s1">)</span>

        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=expected_axes_num</span><span class="s2">, </span><span class="s1">layout=expected_layout)</span>
        <span class="s2">if </span><span class="s1">by </span><span class="s2">is None and </span><span class="s1">column </span><span class="s2">is None</span><span class="s1">:</span>
            <span class="s1">axes = axes[</span><span class="s4">0</span><span class="s1">]</span>
        <span class="s2">for </span><span class="s1">expected_label</span><span class="s2">, </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">zip(expected_labels</span><span class="s2">, </span><span class="s1">axes):</span>
            <span class="s1">self._check_legend_labels(ax</span><span class="s2">, </span><span class="s1">expected_label)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;by&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">None, </span><span class="s3">&quot;c&quot;</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s3">&quot;column&quot;</span><span class="s2">, </span><span class="s1">[</span><span class="s2">None, </span><span class="s3">&quot;b&quot;</span><span class="s1">])</span>
    <span class="s2">def </span><span class="s1">test_hist_with_legend_raises(self</span><span class="s2">, </span><span class="s1">by</span><span class="s2">, </span><span class="s1">column):</span>
        <span class="s5"># GH 6279 - DataFrame histogram with legend and label raises</span>
        <span class="s1">index = Index(</span><span class="s4">15 </span><span class="s1">* [</span><span class="s3">&quot;1&quot;</span><span class="s1">] + </span><span class="s4">15 </span><span class="s1">* [</span><span class="s3">&quot;2&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">name=</span><span class="s3">&quot;c&quot;</span><span class="s1">)</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">30</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">index=index</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">])</span>

        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=</span><span class="s3">&quot;Cannot use both legend and label&quot;</span><span class="s1">):</span>
            <span class="s1">df.hist(legend=</span><span class="s2">True, </span><span class="s1">by=by</span><span class="s2">, </span><span class="s1">column=column</span><span class="s2">, </span><span class="s1">label=</span><span class="s3">&quot;d&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_hist_df_kwargs(self):</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df.plot.hist(bins=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s2">assert </span><span class="s1">len(ax.patches) == </span><span class="s4">10</span>

    <span class="s2">def </span><span class="s1">test_hist_df_with_nonnumerics(self):</span>
        <span class="s5"># GH 9853</span>
        <span class="s2">with </span><span class="s1">tm.RNGContext(</span><span class="s4">1</span><span class="s1">):</span>
            <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">10</span><span class="s2">, </span><span class="s4">4</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;A&quot;</span><span class="s2">, </span><span class="s3">&quot;B&quot;</span><span class="s2">, </span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s3">&quot;D&quot;</span><span class="s1">])</span>
        <span class="s1">df[</span><span class="s3">&quot;E&quot;</span><span class="s1">] = [</span><span class="s3">&quot;x&quot;</span><span class="s2">, </span><span class="s3">&quot;y&quot;</span><span class="s1">] * </span><span class="s4">5</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df.plot.hist(bins=</span><span class="s4">5</span><span class="s2">, </span><span class="s1">ax=ax)</span>
        <span class="s2">assert </span><span class="s1">len(ax.patches) == </span><span class="s4">20</span>

        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df.plot.hist(ax=ax)  </span><span class="s5"># bins=10</span>
        <span class="s2">assert </span><span class="s1">len(ax.patches) == </span><span class="s4">40</span>

    <span class="s2">def </span><span class="s1">test_hist_secondary_legend(self):</span>
        <span class="s5"># GH 9610</span>
        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">30</span><span class="s2">, </span><span class="s4">4</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=list(</span><span class="s3">&quot;abcd&quot;</span><span class="s1">))</span>

        <span class="s5"># primary -&gt; secondary</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df[</span><span class="s3">&quot;a&quot;</span><span class="s1">].plot.hist(legend=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">df[</span><span class="s3">&quot;b&quot;</span><span class="s1">].plot.hist(ax=ax</span><span class="s2">, </span><span class="s1">legend=</span><span class="s2">True, </span><span class="s1">secondary_y=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s5"># both legends are drawn on left ax</span>
        <span class="s5"># left and right axis must be visible</span>
        <span class="s1">self._check_legend_labels(ax</span><span class="s2">, </span><span class="s1">labels=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b (right)&quot;</span><span class="s1">])</span>
        <span class="s2">assert </span><span class="s1">ax.get_yaxis().get_visible()</span>
        <span class="s2">assert </span><span class="s1">ax.right_ax.get_yaxis().get_visible()</span>
        <span class="s1">tm.close()</span>

        <span class="s5"># secondary -&gt; secondary</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df[</span><span class="s3">&quot;a&quot;</span><span class="s1">].plot.hist(legend=</span><span class="s2">True, </span><span class="s1">secondary_y=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s1">df[</span><span class="s3">&quot;b&quot;</span><span class="s1">].plot.hist(ax=ax</span><span class="s2">, </span><span class="s1">legend=</span><span class="s2">True, </span><span class="s1">secondary_y=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s5"># both legends are draw on left ax</span>
        <span class="s5"># left axis must be invisible, right axis must be visible</span>
        <span class="s1">self._check_legend_labels(ax.left_ax</span><span class="s2">, </span><span class="s1">labels=[</span><span class="s3">&quot;a (right)&quot;</span><span class="s2">, </span><span class="s3">&quot;b (right)&quot;</span><span class="s1">])</span>
        <span class="s2">assert not </span><span class="s1">ax.left_ax.get_yaxis().get_visible()</span>
        <span class="s2">assert </span><span class="s1">ax.get_yaxis().get_visible()</span>
        <span class="s1">tm.close()</span>

        <span class="s5"># secondary -&gt; primary</span>
        <span class="s1">_</span><span class="s2">, </span><span class="s1">ax = self.plt.subplots()</span>
        <span class="s1">ax = df[</span><span class="s3">&quot;a&quot;</span><span class="s1">].plot.hist(legend=</span><span class="s2">True, </span><span class="s1">secondary_y=</span><span class="s2">True, </span><span class="s1">ax=ax)</span>
        <span class="s5"># right axes is returned</span>
        <span class="s1">df[</span><span class="s3">&quot;b&quot;</span><span class="s1">].plot.hist(ax=ax</span><span class="s2">, </span><span class="s1">legend=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s5"># both legends are draw on left ax</span>
        <span class="s5"># left and right axis must be visible</span>
        <span class="s1">self._check_legend_labels(ax.left_ax</span><span class="s2">, </span><span class="s1">labels=[</span><span class="s3">&quot;a (right)&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">])</span>
        <span class="s2">assert </span><span class="s1">ax.left_ax.get_yaxis().get_visible()</span>
        <span class="s2">assert </span><span class="s1">ax.get_yaxis().get_visible()</span>
        <span class="s1">tm.close()</span>


<span class="s1">@td.skip_if_no_mpl</span>
<span class="s2">class </span><span class="s1">TestDataFrameGroupByPlots(TestPlotBase):</span>
    <span class="s2">def </span><span class="s1">test_grouped_hist_legacy(self):</span>
        <span class="s2">from </span><span class="s1">matplotlib.patches </span><span class="s2">import </span><span class="s1">Rectangle</span>

        <span class="s2">from </span><span class="s1">pandas.plotting._matplotlib.hist </span><span class="s2">import </span><span class="s1">_grouped_hist</span>

        <span class="s1">df = DataFrame(np.random.randn(</span><span class="s4">500</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;A&quot;</span><span class="s1">])</span>
        <span class="s1">df[</span><span class="s3">&quot;B&quot;</span><span class="s1">] = to_datetime(</span>
            <span class="s1">np.random.randint(</span>
                <span class="s1">self.start_date_to_int64</span><span class="s2">,</span>
                <span class="s1">self.end_date_to_int64</span><span class="s2">,</span>
                <span class="s1">size=</span><span class="s4">500</span><span class="s2">,</span>
                <span class="s1">dtype=np.int64</span><span class="s2">,</span>
            <span class="s1">)</span>
        <span class="s1">)</span>
        <span class="s1">df[</span><span class="s3">&quot;C&quot;</span><span class="s1">] = np.random.randint(</span><span class="s4">0</span><span class="s2">, </span><span class="s4">4</span><span class="s2">, </span><span class="s4">500</span><span class="s1">)</span>
        <span class="s1">df[</span><span class="s3">&quot;D&quot;</span><span class="s1">] = [</span><span class="s3">&quot;X&quot;</span><span class="s1">] * </span><span class="s4">500</span>

        <span class="s1">axes = _grouped_hist(df.A</span><span class="s2">, </span><span class="s1">by=df.C)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

        <span class="s1">tm.close()</span>
        <span class="s1">axes = df.hist(by=df.C)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

        <span class="s1">tm.close()</span>
        <span class="s5"># group by a key with single value</span>
        <span class="s1">axes = df.hist(by=</span><span class="s3">&quot;D&quot;</span><span class="s2">, </span><span class="s1">rot=</span><span class="s4">30</span><span class="s1">)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">1</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">self._check_ticks_props(axes</span><span class="s2">, </span><span class="s1">xrot=</span><span class="s4">30</span><span class="s1">)</span>

        <span class="s1">tm.close()</span>
        <span class="s5"># make sure kwargs to hist are handled</span>
        <span class="s1">xf</span><span class="s2">, </span><span class="s1">yf = </span><span class="s4">20</span><span class="s2">, </span><span class="s4">18</span>
        <span class="s1">xrot</span><span class="s2">, </span><span class="s1">yrot = </span><span class="s4">30</span><span class="s2">, </span><span class="s4">40</span>

        <span class="s1">axes = _grouped_hist(</span>
            <span class="s1">df.A</span><span class="s2">,</span>
            <span class="s1">by=df.C</span><span class="s2">,</span>
            <span class="s1">cumulative=</span><span class="s2">True,</span>
            <span class="s1">bins=</span><span class="s4">4</span><span class="s2">,</span>
            <span class="s1">xlabelsize=xf</span><span class="s2">,</span>
            <span class="s1">xrot=xrot</span><span class="s2">,</span>
            <span class="s1">ylabelsize=yf</span><span class="s2">,</span>
            <span class="s1">yrot=yrot</span><span class="s2">,</span>
            <span class="s1">density=</span><span class="s2">True,</span>
        <span class="s1">)</span>
        <span class="s5"># height of last bin (index 5) must be 1.0</span>
        <span class="s2">for </span><span class="s1">ax </span><span class="s2">in </span><span class="s1">axes.ravel():</span>
            <span class="s1">rects = [x </span><span class="s2">for </span><span class="s1">x </span><span class="s2">in </span><span class="s1">ax.get_children() </span><span class="s2">if </span><span class="s1">isinstance(x</span><span class="s2">, </span><span class="s1">Rectangle)]</span>
            <span class="s1">height = rects[-</span><span class="s4">1</span><span class="s1">].get_height()</span>
            <span class="s1">tm.assert_almost_equal(height</span><span class="s2">, </span><span class="s4">1.0</span><span class="s1">)</span>
        <span class="s1">self._check_ticks_props(</span>
            <span class="s1">axes</span><span class="s2">, </span><span class="s1">xlabelsize=xf</span><span class="s2">, </span><span class="s1">xrot=xrot</span><span class="s2">, </span><span class="s1">ylabelsize=yf</span><span class="s2">, </span><span class="s1">yrot=yrot</span>
        <span class="s1">)</span>

        <span class="s1">tm.close()</span>
        <span class="s1">axes = _grouped_hist(df.A</span><span class="s2">, </span><span class="s1">by=df.C</span><span class="s2">, </span><span class="s1">log=</span><span class="s2">True</span><span class="s1">)</span>
        <span class="s5"># scale of y must be 'log'</span>
        <span class="s1">self._check_ax_scales(axes</span><span class="s2">, </span><span class="s1">yaxis=</span><span class="s3">&quot;log&quot;</span><span class="s1">)</span>

        <span class="s1">tm.close()</span>
        <span class="s5"># propagate attr exception from matplotlib.Axes.hist</span>
        <span class="s2">with </span><span class="s1">tm.external_error_raised(AttributeError):</span>
            <span class="s1">_grouped_hist(df.A</span><span class="s2">, </span><span class="s1">by=df.C</span><span class="s2">, </span><span class="s1">foo=</span><span class="s3">&quot;bar&quot;</span><span class="s1">)</span>

        <span class="s1">msg = </span><span class="s3">&quot;Specify figure size by tuple instead&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.hist(by=</span><span class="s3">&quot;C&quot;</span><span class="s2">, </span><span class="s1">figsize=</span><span class="s3">&quot;default&quot;</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_grouped_hist_legacy2(self):</span>
        <span class="s1">n = </span><span class="s4">10</span>
        <span class="s1">weight = Series(np.random.normal(</span><span class="s4">166</span><span class="s2">, </span><span class="s4">20</span><span class="s2">, </span><span class="s1">size=n))</span>
        <span class="s1">height = Series(np.random.normal(</span><span class="s4">60</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">size=n))</span>
        <span class="s2">with </span><span class="s1">tm.RNGContext(</span><span class="s4">42</span><span class="s1">):</span>
            <span class="s1">gender_int = np.random.choice([</span><span class="s4">0</span><span class="s2">, </span><span class="s4">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">size=n)</span>
        <span class="s1">df_int = DataFrame({</span><span class="s3">&quot;height&quot;</span><span class="s1">: height</span><span class="s2">, </span><span class="s3">&quot;weight&quot;</span><span class="s1">: weight</span><span class="s2">, </span><span class="s3">&quot;gender&quot;</span><span class="s1">: gender_int})</span>
        <span class="s1">gb = df_int.groupby(</span><span class="s3">&quot;gender&quot;</span><span class="s1">)</span>
        <span class="s1">axes = gb.hist()</span>
        <span class="s2">assert </span><span class="s1">len(axes) == </span><span class="s4">2</span>
        <span class="s2">assert </span><span class="s1">len(self.plt.get_fignums()) == </span><span class="s4">2</span>
        <span class="s1">tm.close()</span>

    <span class="s2">def </span><span class="s1">test_grouped_hist_layout(self):</span>
        <span class="s1">df = self.hist_df</span>
        <span class="s1">msg = </span><span class="s3">&quot;Layout of 1x1 must be larger than required size 2&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.hist(column=</span><span class="s3">&quot;weight&quot;</span><span class="s2">, </span><span class="s1">by=df.gender</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s1">msg = </span><span class="s3">&quot;Layout of 1x3 must be larger than required size 4&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s1">))</span>

        <span class="s1">msg = </span><span class="s3">&quot;At least one dimension of layout must be positive&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(-</span><span class="s4">1</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(</span>
                <span class="s1">df.hist</span><span class="s2">, </span><span class="s1">column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.gender</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">)</span>
            <span class="s1">)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(</span>
                <span class="s1">df.hist</span><span class="s2">, </span><span class="s1">column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.gender</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s1">-</span><span class="s4">1</span><span class="s1">)</span>
            <span class="s1">)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s1">axes = df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s1">axes = df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(-</span><span class="s4">1</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">1</span><span class="s1">))</span>

        <span class="s1">axes = df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.category</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">figsize=(</span><span class="s4">12</span><span class="s2">, </span><span class="s4">8</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">4</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">4</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span><span class="s2">, </span><span class="s1">figsize=(</span><span class="s4">12</span><span class="s2">, </span><span class="s4">8</span><span class="s1">))</span>
        <span class="s1">tm.close()</span>

        <span class="s5"># GH 6769</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(</span>
                <span class="s1">df.hist</span><span class="s2">, </span><span class="s1">column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=</span><span class="s3">&quot;classroom&quot;</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">)</span>
            <span class="s1">)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

        <span class="s5"># without column</span>
        <span class="s2">with </span><span class="s1">tm.assert_produces_warning(UserWarning):</span>
            <span class="s1">axes = _check_plot_works(df.hist</span><span class="s2">, </span><span class="s1">by=</span><span class="s3">&quot;classroom&quot;</span><span class="s1">)</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

        <span class="s1">axes = df.hist(by=</span><span class="s3">&quot;gender&quot;</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">5</span><span class="s1">))</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">2</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">3</span><span class="s2">, </span><span class="s4">5</span><span class="s1">))</span>

        <span class="s1">axes = df.hist(column=[</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s3">&quot;weight&quot;</span><span class="s2">, </span><span class="s3">&quot;category&quot;</span><span class="s1">])</span>
        <span class="s1">self._check_axes_shape(axes</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span>

    <span class="s2">def </span><span class="s1">test_grouped_hist_multiple_axes(self):</span>
        <span class="s5"># GH 6970, GH 7069</span>
        <span class="s1">df = self.hist_df</span>

        <span class="s1">fig</span><span class="s2">, </span><span class="s1">axes = self.plt.subplots(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span>
        <span class="s1">returned = df.hist(column=[</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s3">&quot;weight&quot;</span><span class="s2">, </span><span class="s3">&quot;category&quot;</span><span class="s1">]</span><span class="s2">, </span><span class="s1">ax=axes[</span><span class="s4">0</span><span class="s1">])</span>
        <span class="s1">self._check_axes_shape(returned</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s1">))</span>
        <span class="s1">tm.assert_numpy_array_equal(returned</span><span class="s2">, </span><span class="s1">axes[</span><span class="s4">0</span><span class="s1">])</span>
        <span class="s2">assert </span><span class="s1">returned[</span><span class="s4">0</span><span class="s1">].figure </span><span class="s2">is </span><span class="s1">fig</span>
        <span class="s1">returned = df.hist(by=</span><span class="s3">&quot;classroom&quot;</span><span class="s2">, </span><span class="s1">ax=axes[</span><span class="s4">1</span><span class="s1">])</span>
        <span class="s1">self._check_axes_shape(returned</span><span class="s2">, </span><span class="s1">axes_num=</span><span class="s4">3</span><span class="s2">, </span><span class="s1">layout=(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">3</span><span class="s1">))</span>
        <span class="s1">tm.assert_numpy_array_equal(returned</span><span class="s2">, </span><span class="s1">axes[</span><span class="s4">1</span><span class="s1">])</span>
        <span class="s2">assert </span><span class="s1">returned[</span><span class="s4">0</span><span class="s1">].figure </span><span class="s2">is </span><span class="s1">fig</span>

        <span class="s1">fig</span><span class="s2">, </span><span class="s1">axes = self.plt.subplots(</span><span class="s4">2</span><span class="s2">, </span><span class="s4">3</span><span class="s1">)</span>
        <span class="s5"># pass different number of axes from required</span>
        <span class="s1">msg = </span><span class="s3">&quot;The number of passed axes must be 1, the same as the output plot&quot;</span>
        <span class="s2">with </span><span class="s1">pytest.raises(ValueError</span><span class="s2">, </span><span class="s1">match=msg):</span>
            <span class="s1">axes = df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">ax=axes)</span>

    <span class="s2">def </span><span class="s1">test_axis_share_x(self):</span>
        <span class="s1">df = self.hist_df</span>
        <span class="s5"># GH4089</span>
        <span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2 = df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.gender</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s5"># share x</span>
        <span class="s2">assert </span><span class="s1">self.get_x_axis(ax1).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>
        <span class="s2">assert </span><span class="s1">self.get_x_axis(ax2).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>

        <span class="s5"># don't share y</span>
        <span class="s2">assert not </span><span class="s1">self.get_y_axis(ax1).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>
        <span class="s2">assert not </span><span class="s1">self.get_y_axis(ax2).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>

    <span class="s2">def </span><span class="s1">test_axis_share_y(self):</span>
        <span class="s1">df = self.hist_df</span>
        <span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2 = df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.gender</span><span class="s2">, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s5"># share y</span>
        <span class="s2">assert </span><span class="s1">self.get_y_axis(ax1).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>
        <span class="s2">assert </span><span class="s1">self.get_y_axis(ax2).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>

        <span class="s5"># don't share x</span>
        <span class="s2">assert not </span><span class="s1">self.get_x_axis(ax1).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>
        <span class="s2">assert not </span><span class="s1">self.get_x_axis(ax2).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>

    <span class="s2">def </span><span class="s1">test_axis_share_xy(self):</span>
        <span class="s1">df = self.hist_df</span>
        <span class="s1">ax1</span><span class="s2">, </span><span class="s1">ax2 = df.hist(column=</span><span class="s3">&quot;height&quot;</span><span class="s2">, </span><span class="s1">by=df.gender</span><span class="s2">, </span><span class="s1">sharex=</span><span class="s2">True, </span><span class="s1">sharey=</span><span class="s2">True</span><span class="s1">)</span>

        <span class="s5"># share both x and y</span>
        <span class="s2">assert </span><span class="s1">self.get_x_axis(ax1).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>
        <span class="s2">assert </span><span class="s1">self.get_x_axis(ax2).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>

        <span class="s2">assert </span><span class="s1">self.get_y_axis(ax1).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>
        <span class="s2">assert </span><span class="s1">self.get_y_axis(ax2).joined(ax1</span><span class="s2">, </span><span class="s1">ax2)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s3">&quot;histtype, expected&quot;</span><span class="s2">,</span>
        <span class="s1">[</span>
            <span class="s1">(</span><span class="s3">&quot;bar&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;barstacked&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;step&quot;</span><span class="s2">, False</span><span class="s1">)</span><span class="s2">,</span>
            <span class="s1">(</span><span class="s3">&quot;stepfilled&quot;</span><span class="s2">, True</span><span class="s1">)</span><span class="s2">,</span>
        <span class="s1">]</span><span class="s2">,</span>
    <span class="s1">)</span>
    <span class="s2">def </span><span class="s1">test_histtype_argument(self</span><span class="s2">, </span><span class="s1">histtype</span><span class="s2">, </span><span class="s1">expected):</span>
        <span class="s5"># GH23992 Verify functioning of histtype argument</span>
        <span class="s1">df = DataFrame(np.random.randint(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">10</span><span class="s2">, </span><span class="s1">size=(</span><span class="s4">100</span><span class="s2">, </span><span class="s4">2</span><span class="s1">))</span><span class="s2">, </span><span class="s1">columns=[</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s3">&quot;b&quot;</span><span class="s1">])</span>
        <span class="s1">ax = df.hist(by=</span><span class="s3">&quot;a&quot;</span><span class="s2">, </span><span class="s1">histtype=histtype)</span>
        <span class="s1">self._check_patches_all_filled(ax</span><span class="s2">, </span><span class="s1">filled=expected)</span>
</pre>
</body>
</html>