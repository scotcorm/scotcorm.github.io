<html>
<head>
<title>_scatterplot.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #629755; font-style: italic;}
.s4 { color: #808080;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
_scatterplot.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">__future__ </span><span class="s0">import </span><span class="s1">absolute_import</span>

<span class="s0">import </span><span class="s1">six</span>

<span class="s0">from </span><span class="s1">plotly </span><span class="s0">import </span><span class="s1">exceptions</span><span class="s0">, </span><span class="s1">optional_imports</span>
<span class="s0">import </span><span class="s1">plotly.colors </span><span class="s0">as </span><span class="s1">clrs</span>
<span class="s0">from </span><span class="s1">plotly.figure_factory </span><span class="s0">import </span><span class="s1">utils</span>
<span class="s0">from </span><span class="s1">plotly.graph_objs </span><span class="s0">import </span><span class="s1">graph_objs</span>
<span class="s0">from </span><span class="s1">plotly.subplots </span><span class="s0">import </span><span class="s1">make_subplots</span>

<span class="s1">pd = optional_imports.get_module(</span><span class="s2">&quot;pandas&quot;</span><span class="s1">)</span>

<span class="s1">DIAG_CHOICES = [</span><span class="s2">&quot;scatter&quot;</span><span class="s0">, </span><span class="s2">&quot;histogram&quot;</span><span class="s0">, </span><span class="s2">&quot;box&quot;</span><span class="s1">]</span>
<span class="s1">VALID_COLORMAP_TYPES = [</span><span class="s2">&quot;cat&quot;</span><span class="s0">, </span><span class="s2">&quot;seq&quot;</span><span class="s1">]</span>


<span class="s0">def </span><span class="s1">endpts_to_intervals(endpts):</span>
    <span class="s3">&quot;&quot;&quot; 
    Returns a list of intervals for categorical colormaps 
 
    Accepts a list or tuple of sequentially increasing numbers and returns 
    a list representation of the mathematical intervals with these numbers 
    as endpoints. For example, [1, 6] returns [[-inf, 1], [1, 6], [6, inf]] 
 
    :raises: (PlotlyError) If input is not a list or tuple 
    :raises: (PlotlyError) If the input contains a string 
    :raises: (PlotlyError) If any number does not increase after the 
        previous one in the sequence 
    &quot;&quot;&quot;</span>
    <span class="s1">length = len(endpts)</span>
    <span class="s4"># Check if endpts is a list or tuple</span>
    <span class="s0">if not </span><span class="s1">(isinstance(endpts</span><span class="s0">, </span><span class="s1">(tuple)) </span><span class="s0">or </span><span class="s1">isinstance(endpts</span><span class="s0">, </span><span class="s1">(list))):</span>
        <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
            <span class="s2">&quot;The intervals_endpts argument must &quot;</span>
            <span class="s2">&quot;be a list or tuple of a sequence &quot;</span>
            <span class="s2">&quot;of increasing numbers.&quot;</span>
        <span class="s1">)</span>
    <span class="s4"># Check if endpts contains only numbers</span>
    <span class="s0">for </span><span class="s1">item </span><span class="s0">in </span><span class="s1">endpts:</span>
        <span class="s0">if </span><span class="s1">isinstance(item</span><span class="s0">, </span><span class="s1">str):</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;The intervals_endpts argument &quot;</span>
                <span class="s2">&quot;must be a list or tuple of a &quot;</span>
                <span class="s2">&quot;sequence of increasing &quot;</span>
                <span class="s2">&quot;numbers.&quot;</span>
            <span class="s1">)</span>
    <span class="s4"># Check if numbers in endpts are increasing</span>
    <span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">range(length - </span><span class="s5">1</span><span class="s1">):</span>
        <span class="s0">if </span><span class="s1">endpts[k] &gt;= endpts[k + </span><span class="s5">1</span><span class="s1">]:</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;The intervals_endpts argument &quot;</span>
                <span class="s2">&quot;must be a list or tuple of a &quot;</span>
                <span class="s2">&quot;sequence of increasing &quot;</span>
                <span class="s2">&quot;numbers.&quot;</span>
            <span class="s1">)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">intervals = []</span>
        <span class="s4"># add -inf to intervals</span>
        <span class="s1">intervals.append([float(</span><span class="s2">&quot;-inf&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">endpts[</span><span class="s5">0</span><span class="s1">]])</span>
        <span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">range(length - </span><span class="s5">1</span><span class="s1">):</span>
            <span class="s1">interval = []</span>
            <span class="s1">interval.append(endpts[k])</span>
            <span class="s1">interval.append(endpts[k + </span><span class="s5">1</span><span class="s1">])</span>
            <span class="s1">intervals.append(interval)</span>
        <span class="s4"># add +inf to intervals</span>
        <span class="s1">intervals.append([endpts[length - </span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">float(</span><span class="s2">&quot;inf&quot;</span><span class="s1">)])</span>
        <span class="s0">return </span><span class="s1">intervals</span>


<span class="s0">def </span><span class="s1">hide_tick_labels_from_box_subplots(fig):</span>
    <span class="s3">&quot;&quot;&quot; 
    Hides tick labels for box plots in scatterplotmatrix subplots. 
    &quot;&quot;&quot;</span>
    <span class="s1">boxplot_xaxes = []</span>
    <span class="s0">for </span><span class="s1">trace </span><span class="s0">in </span><span class="s1">fig[</span><span class="s2">&quot;data&quot;</span><span class="s1">]:</span>
        <span class="s0">if </span><span class="s1">trace[</span><span class="s2">&quot;type&quot;</span><span class="s1">] == </span><span class="s2">&quot;box&quot;</span><span class="s1">:</span>
            <span class="s4"># stores the xaxes which correspond to boxplot subplots</span>
            <span class="s4"># since we use xaxis1, xaxis2, etc, in plotly.py</span>
            <span class="s1">boxplot_xaxes.append(</span><span class="s2">&quot;xaxis{}&quot;</span><span class="s1">.format(trace[</span><span class="s2">&quot;xaxis&quot;</span><span class="s1">][</span><span class="s5">1</span><span class="s1">:]))</span>
    <span class="s0">for </span><span class="s1">xaxis </span><span class="s0">in </span><span class="s1">boxplot_xaxes:</span>
        <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][xaxis][</span><span class="s2">&quot;showticklabels&quot;</span><span class="s1">] = </span><span class="s0">False</span>


<span class="s0">def </span><span class="s1">validate_scatterplotmatrix(df</span><span class="s0">, </span><span class="s1">index</span><span class="s0">, </span><span class="s1">diag</span><span class="s0">, </span><span class="s1">colormap_type</span><span class="s0">, </span><span class="s1">**kwargs):</span>
    <span class="s3">&quot;&quot;&quot; 
    Validates basic inputs for FigureFactory.create_scatterplotmatrix() 
 
    :raises: (PlotlyError) If pandas is not imported 
    :raises: (PlotlyError) If pandas dataframe is not inputted 
    :raises: (PlotlyError) If pandas dataframe has &lt;= 1 columns 
    :raises: (PlotlyError) If diagonal plot choice (diag) is not one of 
        the viable options 
    :raises: (PlotlyError) If colormap_type is not a valid choice 
    :raises: (PlotlyError) If kwargs contains 'size', 'color' or 
        'colorscale' 
    &quot;&quot;&quot;</span>
    <span class="s0">if not </span><span class="s1">pd:</span>
        <span class="s0">raise </span><span class="s1">ImportError(</span>
            <span class="s2">&quot;FigureFactory.scatterplotmatrix requires &quot; &quot;a pandas DataFrame.&quot;</span>
        <span class="s1">)</span>

    <span class="s4"># Check if pandas dataframe</span>
    <span class="s0">if not </span><span class="s1">isinstance(df</span><span class="s0">, </span><span class="s1">pd.core.frame.DataFrame):</span>
        <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
            <span class="s2">&quot;Dataframe not inputed. Please &quot;</span>
            <span class="s2">&quot;use a pandas dataframe to pro&quot;</span>
            <span class="s2">&quot;duce a scatterplot matrix.&quot;</span>
        <span class="s1">)</span>

    <span class="s4"># Check if dataframe is 1 column or less</span>
    <span class="s0">if </span><span class="s1">len(df.columns) &lt;= </span><span class="s5">1</span><span class="s1">:</span>
        <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
            <span class="s2">&quot;Dataframe has only one column. To &quot;</span>
            <span class="s2">&quot;use the scatterplot matrix, use at &quot;</span>
            <span class="s2">&quot;least 2 columns.&quot;</span>
        <span class="s1">)</span>

    <span class="s4"># Check that diag parameter is a valid selection</span>
    <span class="s0">if </span><span class="s1">diag </span><span class="s0">not in </span><span class="s1">DIAG_CHOICES:</span>
        <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
            <span class="s2">&quot;Make sure diag is set to &quot; &quot;one of {}&quot;</span><span class="s1">.format(DIAG_CHOICES)</span>
        <span class="s1">)</span>

    <span class="s4"># Check that colormap_types is a valid selection</span>
    <span class="s0">if </span><span class="s1">colormap_type </span><span class="s0">not in </span><span class="s1">VALID_COLORMAP_TYPES:</span>
        <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
            <span class="s2">&quot;Must choose a valid colormap type. &quot;</span>
            <span class="s2">&quot;Either 'cat' or 'seq' for a cate&quot;</span>
            <span class="s2">&quot;gorical and sequential colormap &quot;</span>
            <span class="s2">&quot;respectively.&quot;</span>
        <span class="s1">)</span>

    <span class="s4"># Check for not 'size' or 'color' in 'marker' of **kwargs</span>
    <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
        <span class="s1">FORBIDDEN_PARAMS = [</span><span class="s2">&quot;size&quot;</span><span class="s0">, </span><span class="s2">&quot;color&quot;</span><span class="s0">, </span><span class="s2">&quot;colorscale&quot;</span><span class="s1">]</span>
        <span class="s0">if </span><span class="s1">any(param </span><span class="s0">in </span><span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">] </span><span class="s0">for </span><span class="s1">param </span><span class="s0">in </span><span class="s1">FORBIDDEN_PARAMS):</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;Your kwargs dictionary cannot &quot;</span>
                <span class="s2">&quot;include the 'size', 'color' or &quot;</span>
                <span class="s2">&quot;'colorscale' key words inside &quot;</span>
                <span class="s2">&quot;the marker dict since 'size' is &quot;</span>
                <span class="s2">&quot;already an argument of the &quot;</span>
                <span class="s2">&quot;scatterplot matrix function and &quot;</span>
                <span class="s2">&quot;both 'color' and 'colorscale &quot;</span>
                <span class="s2">&quot;are set internally.&quot;</span>
            <span class="s1">)</span>


<span class="s0">def </span><span class="s1">scatterplot(dataframe</span><span class="s0">, </span><span class="s1">headers</span><span class="s0">, </span><span class="s1">diag</span><span class="s0">, </span><span class="s1">size</span><span class="s0">, </span><span class="s1">height</span><span class="s0">, </span><span class="s1">width</span><span class="s0">, </span><span class="s1">title</span><span class="s0">, </span><span class="s1">**kwargs):</span>
    <span class="s3">&quot;&quot;&quot; 
    Refer to FigureFactory.create_scatterplotmatrix() for docstring 
 
    Returns fig for scatterplotmatrix without index 
 
    &quot;&quot;&quot;</span>
    <span class="s1">dim = len(dataframe)</span>
    <span class="s1">fig = make_subplots(rows=dim</span><span class="s0">, </span><span class="s1">cols=dim</span><span class="s0">, </span><span class="s1">print_grid=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">trace_list = []</span>
    <span class="s4"># Insert traces into trace_list</span>
    <span class="s0">for </span><span class="s1">listy </span><span class="s0">in </span><span class="s1">dataframe:</span>
        <span class="s0">for </span><span class="s1">listx </span><span class="s0">in </span><span class="s1">dataframe:</span>
            <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                <span class="s1">trace = graph_objs.Histogram(x=listx</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">False</span><span class="s1">)</span>
            <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                <span class="s1">trace = graph_objs.Box(y=listx</span><span class="s0">, </span><span class="s1">name=</span><span class="s0">None, </span><span class="s1">showlegend=</span><span class="s0">False</span><span class="s1">)</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                    <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                    <span class="s1">trace = graph_objs.Scatter(</span>
                        <span class="s1">x=listx</span><span class="s0">, </span><span class="s1">y=listy</span><span class="s0">, </span><span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">False, </span><span class="s1">**kwargs</span>
                    <span class="s1">)</span>
                    <span class="s1">trace_list.append(trace)</span>
                <span class="s0">else</span><span class="s1">:</span>
                    <span class="s1">trace = graph_objs.Scatter(</span>
                        <span class="s1">x=listx</span><span class="s0">,</span>
                        <span class="s1">y=listy</span><span class="s0">,</span>
                        <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                        <span class="s1">marker=dict(size=size)</span><span class="s0">,</span>
                        <span class="s1">showlegend=</span><span class="s0">False,</span>
                        <span class="s1">**kwargs</span>
                    <span class="s1">)</span>
            <span class="s1">trace_list.append(trace)</span>

    <span class="s1">trace_index = </span><span class="s5">0</span>
    <span class="s1">indices = range(</span><span class="s5">1</span><span class="s0">, </span><span class="s1">dim + </span><span class="s5">1</span><span class="s1">)</span>
    <span class="s0">for </span><span class="s1">y_index </span><span class="s0">in </span><span class="s1">indices:</span>
        <span class="s0">for </span><span class="s1">x_index </span><span class="s0">in </span><span class="s1">indices:</span>
            <span class="s1">fig.append_trace(trace_list[trace_index]</span><span class="s0">, </span><span class="s1">y_index</span><span class="s0">, </span><span class="s1">x_index)</span>
            <span class="s1">trace_index += </span><span class="s5">1</span>

    <span class="s4"># Insert headers into the figure</span>
    <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
        <span class="s1">xaxis_key = </span><span class="s2">&quot;xaxis{}&quot;</span><span class="s1">.format((dim * dim) - dim + </span><span class="s5">1 </span><span class="s1">+ j)</span>
        <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][xaxis_key].update(title=headers[j])</span>
    <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
        <span class="s1">yaxis_key = </span><span class="s2">&quot;yaxis{}&quot;</span><span class="s1">.format(</span><span class="s5">1 </span><span class="s1">+ (dim * j))</span>
        <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][yaxis_key].update(title=headers[j])</span>

    <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span><span class="s1">)</span>

    <span class="s1">hide_tick_labels_from_box_subplots(fig)</span>

    <span class="s0">return </span><span class="s1">fig</span>


<span class="s0">def </span><span class="s1">scatterplot_dict(</span>
    <span class="s1">dataframe</span><span class="s0">,</span>
    <span class="s1">headers</span><span class="s0">,</span>
    <span class="s1">diag</span><span class="s0">,</span>
    <span class="s1">size</span><span class="s0">,</span>
    <span class="s1">height</span><span class="s0">,</span>
    <span class="s1">width</span><span class="s0">,</span>
    <span class="s1">title</span><span class="s0">,</span>
    <span class="s1">index</span><span class="s0">,</span>
    <span class="s1">index_vals</span><span class="s0">,</span>
    <span class="s1">endpts</span><span class="s0">,</span>
    <span class="s1">colormap</span><span class="s0">,</span>
    <span class="s1">colormap_type</span><span class="s0">,</span>
    <span class="s1">**kwargs</span>
<span class="s1">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Refer to FigureFactory.create_scatterplotmatrix() for docstring 
 
    Returns fig for scatterplotmatrix with both index and colormap picked. 
    Used if colormap is a dictionary with index values as keys pointing to 
    colors. Forces colormap_type to behave categorically because it would 
    not make sense colors are assigned to each index value and thus 
    implies that a categorical approach should be taken 
 
    &quot;&quot;&quot;</span>

    <span class="s1">theme = colormap</span>
    <span class="s1">dim = len(dataframe)</span>
    <span class="s1">fig = make_subplots(rows=dim</span><span class="s0">, </span><span class="s1">cols=dim</span><span class="s0">, </span><span class="s1">print_grid=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">trace_list = []</span>
    <span class="s1">legend_param = </span><span class="s5">0</span>
    <span class="s4"># Work over all permutations of list pairs</span>
    <span class="s0">for </span><span class="s1">listy </span><span class="s0">in </span><span class="s1">dataframe:</span>
        <span class="s0">for </span><span class="s1">listx </span><span class="s0">in </span><span class="s1">dataframe:</span>
            <span class="s4"># create a dictionary for index_vals</span>
            <span class="s1">unique_index_vals = {}</span>
            <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">index_vals:</span>
                <span class="s0">if </span><span class="s1">name </span><span class="s0">not in </span><span class="s1">unique_index_vals:</span>
                    <span class="s1">unique_index_vals[name] = []</span>

            <span class="s4"># Fill all the rest of the names into the dictionary</span>
            <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">sorted(unique_index_vals.keys()):</span>
                <span class="s1">new_listx = []</span>
                <span class="s1">new_listy = []</span>
                <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(len(index_vals)):</span>
                    <span class="s0">if </span><span class="s1">index_vals[j] == name:</span>
                        <span class="s1">new_listx.append(listx[j])</span>
                        <span class="s1">new_listy.append(listy[j])</span>
                <span class="s4"># Generate trace with VISIBLE icon</span>
                <span class="s0">if </span><span class="s1">legend_param == </span><span class="s5">1</span><span class="s1">:</span>
                    <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                        <span class="s1">trace = graph_objs.Histogram(</span>
                            <span class="s1">x=new_listx</span><span class="s0">, </span><span class="s1">marker=dict(color=theme[name])</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span>
                        <span class="s1">)</span>
                    <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                        <span class="s1">trace = graph_objs.Box(</span>
                            <span class="s1">y=new_listx</span><span class="s0">,</span>
                            <span class="s1">name=</span><span class="s0">None,</span>
                            <span class="s1">marker=dict(color=theme[name])</span><span class="s0">,</span>
                            <span class="s1">showlegend=</span><span class="s0">True,</span>
                        <span class="s1">)</span>
                    <span class="s0">else</span><span class="s1">:</span>
                        <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                            <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                            <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = theme[name]</span>
                            <span class="s1">trace = graph_objs.Scatter(</span>
                                <span class="s1">x=new_listx</span><span class="s0">,</span>
                                <span class="s1">y=new_listy</span><span class="s0">,</span>
                                <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                <span class="s1">name=name</span><span class="s0">,</span>
                                <span class="s1">showlegend=</span><span class="s0">True,</span>
                                <span class="s1">**kwargs</span>
                            <span class="s1">)</span>
                        <span class="s0">else</span><span class="s1">:</span>
                            <span class="s1">trace = graph_objs.Scatter(</span>
                                <span class="s1">x=new_listx</span><span class="s0">,</span>
                                <span class="s1">y=new_listy</span><span class="s0">,</span>
                                <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                <span class="s1">name=name</span><span class="s0">,</span>
                                <span class="s1">marker=dict(size=size</span><span class="s0">, </span><span class="s1">color=theme[name])</span><span class="s0">,</span>
                                <span class="s1">showlegend=</span><span class="s0">True,</span>
                                <span class="s1">**kwargs</span>
                            <span class="s1">)</span>
                <span class="s4"># Generate trace with INVISIBLE icon</span>
                <span class="s0">else</span><span class="s1">:</span>
                    <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                        <span class="s1">trace = graph_objs.Histogram(</span>
                            <span class="s1">x=new_listx</span><span class="s0">,</span>
                            <span class="s1">marker=dict(color=theme[name])</span><span class="s0">,</span>
                            <span class="s1">showlegend=</span><span class="s0">False,</span>
                        <span class="s1">)</span>
                    <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                        <span class="s1">trace = graph_objs.Box(</span>
                            <span class="s1">y=new_listx</span><span class="s0">,</span>
                            <span class="s1">name=</span><span class="s0">None,</span>
                            <span class="s1">marker=dict(color=theme[name])</span><span class="s0">,</span>
                            <span class="s1">showlegend=</span><span class="s0">False,</span>
                        <span class="s1">)</span>
                    <span class="s0">else</span><span class="s1">:</span>
                        <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                            <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                            <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = theme[name]</span>
                            <span class="s1">trace = graph_objs.Scatter(</span>
                                <span class="s1">x=new_listx</span><span class="s0">,</span>
                                <span class="s1">y=new_listy</span><span class="s0">,</span>
                                <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                <span class="s1">name=name</span><span class="s0">,</span>
                                <span class="s1">showlegend=</span><span class="s0">False,</span>
                                <span class="s1">**kwargs</span>
                            <span class="s1">)</span>
                        <span class="s0">else</span><span class="s1">:</span>
                            <span class="s1">trace = graph_objs.Scatter(</span>
                                <span class="s1">x=new_listx</span><span class="s0">,</span>
                                <span class="s1">y=new_listy</span><span class="s0">,</span>
                                <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                <span class="s1">name=name</span><span class="s0">,</span>
                                <span class="s1">marker=dict(size=size</span><span class="s0">, </span><span class="s1">color=theme[name])</span><span class="s0">,</span>
                                <span class="s1">showlegend=</span><span class="s0">False,</span>
                                <span class="s1">**kwargs</span>
                            <span class="s1">)</span>
                <span class="s4"># Push the trace into dictionary</span>
                <span class="s1">unique_index_vals[name] = trace</span>
            <span class="s1">trace_list.append(unique_index_vals)</span>
            <span class="s1">legend_param += </span><span class="s5">1</span>

    <span class="s1">trace_index = </span><span class="s5">0</span>
    <span class="s1">indices = range(</span><span class="s5">1</span><span class="s0">, </span><span class="s1">dim + </span><span class="s5">1</span><span class="s1">)</span>
    <span class="s0">for </span><span class="s1">y_index </span><span class="s0">in </span><span class="s1">indices:</span>
        <span class="s0">for </span><span class="s1">x_index </span><span class="s0">in </span><span class="s1">indices:</span>
            <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">sorted(trace_list[trace_index].keys()):</span>
                <span class="s1">fig.append_trace(trace_list[trace_index][name]</span><span class="s0">, </span><span class="s1">y_index</span><span class="s0">, </span><span class="s1">x_index)</span>
            <span class="s1">trace_index += </span><span class="s5">1</span>

    <span class="s4"># Insert headers into the figure</span>
    <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
        <span class="s1">xaxis_key = </span><span class="s2">&quot;xaxis{}&quot;</span><span class="s1">.format((dim * dim) - dim + </span><span class="s5">1 </span><span class="s1">+ j)</span>
        <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][xaxis_key].update(title=headers[j])</span>

    <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
        <span class="s1">yaxis_key = </span><span class="s2">&quot;yaxis{}&quot;</span><span class="s1">.format(</span><span class="s5">1 </span><span class="s1">+ (dim * j))</span>
        <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][yaxis_key].update(title=headers[j])</span>

    <span class="s1">hide_tick_labels_from_box_subplots(fig)</span>

    <span class="s0">if </span><span class="s1">diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">:</span>
        <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
            <span class="s1">height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True, </span><span class="s1">barmode=</span><span class="s2">&quot;stack&quot;</span>
        <span class="s1">)</span>
        <span class="s0">return </span><span class="s1">fig</span>

    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span><span class="s1">)</span>
        <span class="s0">return </span><span class="s1">fig</span>


<span class="s0">def </span><span class="s1">scatterplot_theme(</span>
    <span class="s1">dataframe</span><span class="s0">,</span>
    <span class="s1">headers</span><span class="s0">,</span>
    <span class="s1">diag</span><span class="s0">,</span>
    <span class="s1">size</span><span class="s0">,</span>
    <span class="s1">height</span><span class="s0">,</span>
    <span class="s1">width</span><span class="s0">,</span>
    <span class="s1">title</span><span class="s0">,</span>
    <span class="s1">index</span><span class="s0">,</span>
    <span class="s1">index_vals</span><span class="s0">,</span>
    <span class="s1">endpts</span><span class="s0">,</span>
    <span class="s1">colormap</span><span class="s0">,</span>
    <span class="s1">colormap_type</span><span class="s0">,</span>
    <span class="s1">**kwargs</span>
<span class="s1">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Refer to FigureFactory.create_scatterplotmatrix() for docstring 
 
    Returns fig for scatterplotmatrix with both index and colormap picked 
 
    &quot;&quot;&quot;</span>

    <span class="s4"># Check if index is made of string values</span>
    <span class="s0">if </span><span class="s1">isinstance(index_vals[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">str):</span>
        <span class="s1">unique_index_vals = []</span>
        <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">index_vals:</span>
            <span class="s0">if </span><span class="s1">name </span><span class="s0">not in </span><span class="s1">unique_index_vals:</span>
                <span class="s1">unique_index_vals.append(name)</span>
        <span class="s1">n_colors_len = len(unique_index_vals)</span>

        <span class="s4"># Convert colormap to list of n RGB tuples</span>
        <span class="s0">if </span><span class="s1">colormap_type == </span><span class="s2">&quot;seq&quot;</span><span class="s1">:</span>
            <span class="s1">foo = clrs.color_parser(colormap</span><span class="s0">, </span><span class="s1">clrs.unlabel_rgb)</span>
            <span class="s1">foo = clrs.n_colors(foo[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">foo[</span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">n_colors_len)</span>
            <span class="s1">theme = clrs.color_parser(foo</span><span class="s0">, </span><span class="s1">clrs.label_rgb)</span>

        <span class="s0">if </span><span class="s1">colormap_type == </span><span class="s2">&quot;cat&quot;</span><span class="s1">:</span>
            <span class="s4"># leave list of colors the same way</span>
            <span class="s1">theme = colormap</span>

        <span class="s1">dim = len(dataframe)</span>
        <span class="s1">fig = make_subplots(rows=dim</span><span class="s0">, </span><span class="s1">cols=dim</span><span class="s0">, </span><span class="s1">print_grid=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">trace_list = []</span>
        <span class="s1">legend_param = </span><span class="s5">0</span>
        <span class="s4"># Work over all permutations of list pairs</span>
        <span class="s0">for </span><span class="s1">listy </span><span class="s0">in </span><span class="s1">dataframe:</span>
            <span class="s0">for </span><span class="s1">listx </span><span class="s0">in </span><span class="s1">dataframe:</span>
                <span class="s4"># create a dictionary for index_vals</span>
                <span class="s1">unique_index_vals = {}</span>
                <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">index_vals:</span>
                    <span class="s0">if </span><span class="s1">name </span><span class="s0">not in </span><span class="s1">unique_index_vals:</span>
                        <span class="s1">unique_index_vals[name] = []</span>

                <span class="s1">c_indx = </span><span class="s5">0  </span><span class="s4"># color index</span>
                <span class="s4"># Fill all the rest of the names into the dictionary</span>
                <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">sorted(unique_index_vals.keys()):</span>
                    <span class="s1">new_listx = []</span>
                    <span class="s1">new_listy = []</span>
                    <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(len(index_vals)):</span>
                        <span class="s0">if </span><span class="s1">index_vals[j] == name:</span>
                            <span class="s1">new_listx.append(listx[j])</span>
                            <span class="s1">new_listy.append(listy[j])</span>
                    <span class="s4"># Generate trace with VISIBLE icon</span>
                    <span class="s0">if </span><span class="s1">legend_param == </span><span class="s5">1</span><span class="s1">:</span>
                        <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                            <span class="s1">trace = graph_objs.Histogram(</span>
                                <span class="s1">x=new_listx</span><span class="s0">,</span>
                                <span class="s1">marker=dict(color=theme[c_indx])</span><span class="s0">,</span>
                                <span class="s1">showlegend=</span><span class="s0">True,</span>
                            <span class="s1">)</span>
                        <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                            <span class="s1">trace = graph_objs.Box(</span>
                                <span class="s1">y=new_listx</span><span class="s0">,</span>
                                <span class="s1">name=</span><span class="s0">None,</span>
                                <span class="s1">marker=dict(color=theme[c_indx])</span><span class="s0">,</span>
                                <span class="s1">showlegend=</span><span class="s0">True,</span>
                            <span class="s1">)</span>
                        <span class="s0">else</span><span class="s1">:</span>
                            <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = theme[c_indx]</span>
                                <span class="s1">trace = graph_objs.Scatter(</span>
                                    <span class="s1">x=new_listx</span><span class="s0">,</span>
                                    <span class="s1">y=new_listy</span><span class="s0">,</span>
                                    <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                    <span class="s1">name=name</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">True,</span>
                                    <span class="s1">**kwargs</span>
                                <span class="s1">)</span>
                            <span class="s0">else</span><span class="s1">:</span>
                                <span class="s1">trace = graph_objs.Scatter(</span>
                                    <span class="s1">x=new_listx</span><span class="s0">,</span>
                                    <span class="s1">y=new_listy</span><span class="s0">,</span>
                                    <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                    <span class="s1">name=name</span><span class="s0">,</span>
                                    <span class="s1">marker=dict(size=size</span><span class="s0">, </span><span class="s1">color=theme[c_indx])</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">True,</span>
                                    <span class="s1">**kwargs</span>
                                <span class="s1">)</span>
                    <span class="s4"># Generate trace with INVISIBLE icon</span>
                    <span class="s0">else</span><span class="s1">:</span>
                        <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                            <span class="s1">trace = graph_objs.Histogram(</span>
                                <span class="s1">x=new_listx</span><span class="s0">,</span>
                                <span class="s1">marker=dict(color=theme[c_indx])</span><span class="s0">,</span>
                                <span class="s1">showlegend=</span><span class="s0">False,</span>
                            <span class="s1">)</span>
                        <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                            <span class="s1">trace = graph_objs.Box(</span>
                                <span class="s1">y=new_listx</span><span class="s0">,</span>
                                <span class="s1">name=</span><span class="s0">None,</span>
                                <span class="s1">marker=dict(color=theme[c_indx])</span><span class="s0">,</span>
                                <span class="s1">showlegend=</span><span class="s0">False,</span>
                            <span class="s1">)</span>
                        <span class="s0">else</span><span class="s1">:</span>
                            <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = theme[c_indx]</span>
                                <span class="s1">trace = graph_objs.Scatter(</span>
                                    <span class="s1">x=new_listx</span><span class="s0">,</span>
                                    <span class="s1">y=new_listy</span><span class="s0">,</span>
                                    <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                    <span class="s1">name=name</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">False,</span>
                                    <span class="s1">**kwargs</span>
                                <span class="s1">)</span>
                            <span class="s0">else</span><span class="s1">:</span>
                                <span class="s1">trace = graph_objs.Scatter(</span>
                                    <span class="s1">x=new_listx</span><span class="s0">,</span>
                                    <span class="s1">y=new_listy</span><span class="s0">,</span>
                                    <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                    <span class="s1">name=name</span><span class="s0">,</span>
                                    <span class="s1">marker=dict(size=size</span><span class="s0">, </span><span class="s1">color=theme[c_indx])</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">False,</span>
                                    <span class="s1">**kwargs</span>
                                <span class="s1">)</span>
                    <span class="s4"># Push the trace into dictionary</span>
                    <span class="s1">unique_index_vals[name] = trace</span>
                    <span class="s0">if </span><span class="s1">c_indx &gt;= (len(theme) - </span><span class="s5">1</span><span class="s1">):</span>
                        <span class="s1">c_indx = -</span><span class="s5">1</span>
                    <span class="s1">c_indx += </span><span class="s5">1</span>
                <span class="s1">trace_list.append(unique_index_vals)</span>
                <span class="s1">legend_param += </span><span class="s5">1</span>

        <span class="s1">trace_index = </span><span class="s5">0</span>
        <span class="s1">indices = range(</span><span class="s5">1</span><span class="s0">, </span><span class="s1">dim + </span><span class="s5">1</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">y_index </span><span class="s0">in </span><span class="s1">indices:</span>
            <span class="s0">for </span><span class="s1">x_index </span><span class="s0">in </span><span class="s1">indices:</span>
                <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">sorted(trace_list[trace_index].keys()):</span>
                    <span class="s1">fig.append_trace(trace_list[trace_index][name]</span><span class="s0">, </span><span class="s1">y_index</span><span class="s0">, </span><span class="s1">x_index)</span>
                <span class="s1">trace_index += </span><span class="s5">1</span>

        <span class="s4"># Insert headers into the figure</span>
        <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
            <span class="s1">xaxis_key = </span><span class="s2">&quot;xaxis{}&quot;</span><span class="s1">.format((dim * dim) - dim + </span><span class="s5">1 </span><span class="s1">+ j)</span>
            <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][xaxis_key].update(title=headers[j])</span>

        <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
            <span class="s1">yaxis_key = </span><span class="s2">&quot;yaxis{}&quot;</span><span class="s1">.format(</span><span class="s5">1 </span><span class="s1">+ (dim * j))</span>
            <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][yaxis_key].update(title=headers[j])</span>

        <span class="s1">hide_tick_labels_from_box_subplots(fig)</span>

        <span class="s0">if </span><span class="s1">diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">:</span>
            <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                <span class="s1">height=height</span><span class="s0">,</span>
                <span class="s1">width=width</span><span class="s0">,</span>
                <span class="s1">title=title</span><span class="s0">,</span>
                <span class="s1">showlegend=</span><span class="s0">True,</span>
                <span class="s1">barmode=</span><span class="s2">&quot;stack&quot;</span><span class="s0">,</span>
            <span class="s1">)</span>
            <span class="s0">return </span><span class="s1">fig</span>

        <span class="s0">elif </span><span class="s1">diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">:</span>
            <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                <span class="s1">height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span>
            <span class="s1">)</span>
            <span class="s0">return </span><span class="s1">fig</span>

        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                <span class="s1">height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span>
            <span class="s1">)</span>
            <span class="s0">return </span><span class="s1">fig</span>

    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">if </span><span class="s1">endpts:</span>
            <span class="s1">intervals = utils.endpts_to_intervals(endpts)</span>

            <span class="s4"># Convert colormap to list of n RGB tuples</span>
            <span class="s0">if </span><span class="s1">colormap_type == </span><span class="s2">&quot;seq&quot;</span><span class="s1">:</span>
                <span class="s1">foo = clrs.color_parser(colormap</span><span class="s0">, </span><span class="s1">clrs.unlabel_rgb)</span>
                <span class="s1">foo = clrs.n_colors(foo[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">foo[</span><span class="s5">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">len(intervals))</span>
                <span class="s1">theme = clrs.color_parser(foo</span><span class="s0">, </span><span class="s1">clrs.label_rgb)</span>

            <span class="s0">if </span><span class="s1">colormap_type == </span><span class="s2">&quot;cat&quot;</span><span class="s1">:</span>
                <span class="s4"># leave list of colors the same way</span>
                <span class="s1">theme = colormap</span>

            <span class="s1">dim = len(dataframe)</span>
            <span class="s1">fig = make_subplots(rows=dim</span><span class="s0">, </span><span class="s1">cols=dim</span><span class="s0">, </span><span class="s1">print_grid=</span><span class="s0">False</span><span class="s1">)</span>
            <span class="s1">trace_list = []</span>
            <span class="s1">legend_param = </span><span class="s5">0</span>
            <span class="s4"># Work over all permutations of list pairs</span>
            <span class="s0">for </span><span class="s1">listy </span><span class="s0">in </span><span class="s1">dataframe:</span>
                <span class="s0">for </span><span class="s1">listx </span><span class="s0">in </span><span class="s1">dataframe:</span>
                    <span class="s1">interval_labels = {}</span>
                    <span class="s0">for </span><span class="s1">interval </span><span class="s0">in </span><span class="s1">intervals:</span>
                        <span class="s1">interval_labels[str(interval)] = []</span>

                    <span class="s1">c_indx = </span><span class="s5">0  </span><span class="s4"># color index</span>
                    <span class="s4"># Fill all the rest of the names into the dictionary</span>
                    <span class="s0">for </span><span class="s1">interval </span><span class="s0">in </span><span class="s1">intervals:</span>
                        <span class="s1">new_listx = []</span>
                        <span class="s1">new_listy = []</span>
                        <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(len(index_vals)):</span>
                            <span class="s0">if </span><span class="s1">interval[</span><span class="s5">0</span><span class="s1">] &lt; index_vals[j] &lt;= interval[</span><span class="s5">1</span><span class="s1">]:</span>
                                <span class="s1">new_listx.append(listx[j])</span>
                                <span class="s1">new_listy.append(listy[j])</span>
                        <span class="s4"># Generate trace with VISIBLE icon</span>
                        <span class="s0">if </span><span class="s1">legend_param == </span><span class="s5">1</span><span class="s1">:</span>
                            <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                                <span class="s1">trace = graph_objs.Histogram(</span>
                                    <span class="s1">x=new_listx</span><span class="s0">,</span>
                                    <span class="s1">marker=dict(color=theme[c_indx])</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">True,</span>
                                <span class="s1">)</span>
                            <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                                <span class="s1">trace = graph_objs.Box(</span>
                                    <span class="s1">y=new_listx</span><span class="s0">,</span>
                                    <span class="s1">name=</span><span class="s0">None,</span>
                                    <span class="s1">marker=dict(color=theme[c_indx])</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">True,</span>
                                <span class="s1">)</span>
                            <span class="s0">else</span><span class="s1">:</span>
                                <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                                    <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                                    <span class="s1">(kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">]) = theme[c_indx]</span>
                                    <span class="s1">trace = graph_objs.Scatter(</span>
                                        <span class="s1">x=new_listx</span><span class="s0">,</span>
                                        <span class="s1">y=new_listy</span><span class="s0">,</span>
                                        <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                        <span class="s1">name=str(interval)</span><span class="s0">,</span>
                                        <span class="s1">showlegend=</span><span class="s0">True,</span>
                                        <span class="s1">**kwargs</span>
                                    <span class="s1">)</span>
                                <span class="s0">else</span><span class="s1">:</span>
                                    <span class="s1">trace = graph_objs.Scatter(</span>
                                        <span class="s1">x=new_listx</span><span class="s0">,</span>
                                        <span class="s1">y=new_listy</span><span class="s0">,</span>
                                        <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                        <span class="s1">name=str(interval)</span><span class="s0">,</span>
                                        <span class="s1">marker=dict(size=size</span><span class="s0">, </span><span class="s1">color=theme[c_indx])</span><span class="s0">,</span>
                                        <span class="s1">showlegend=</span><span class="s0">True,</span>
                                        <span class="s1">**kwargs</span>
                                    <span class="s1">)</span>
                        <span class="s4"># Generate trace with INVISIBLE icon</span>
                        <span class="s0">else</span><span class="s1">:</span>
                            <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                                <span class="s1">trace = graph_objs.Histogram(</span>
                                    <span class="s1">x=new_listx</span><span class="s0">,</span>
                                    <span class="s1">marker=dict(color=theme[c_indx])</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">False,</span>
                                <span class="s1">)</span>
                            <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                                <span class="s1">trace = graph_objs.Box(</span>
                                    <span class="s1">y=new_listx</span><span class="s0">,</span>
                                    <span class="s1">name=</span><span class="s0">None,</span>
                                    <span class="s1">marker=dict(color=theme[c_indx])</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">False,</span>
                                <span class="s1">)</span>
                            <span class="s0">else</span><span class="s1">:</span>
                                <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                                    <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                                    <span class="s1">(kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">]) = theme[c_indx]</span>
                                    <span class="s1">trace = graph_objs.Scatter(</span>
                                        <span class="s1">x=new_listx</span><span class="s0">,</span>
                                        <span class="s1">y=new_listy</span><span class="s0">,</span>
                                        <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                        <span class="s1">name=str(interval)</span><span class="s0">,</span>
                                        <span class="s1">showlegend=</span><span class="s0">False,</span>
                                        <span class="s1">**kwargs</span>
                                    <span class="s1">)</span>
                                <span class="s0">else</span><span class="s1">:</span>
                                    <span class="s1">trace = graph_objs.Scatter(</span>
                                        <span class="s1">x=new_listx</span><span class="s0">,</span>
                                        <span class="s1">y=new_listy</span><span class="s0">,</span>
                                        <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                        <span class="s1">name=str(interval)</span><span class="s0">,</span>
                                        <span class="s1">marker=dict(size=size</span><span class="s0">, </span><span class="s1">color=theme[c_indx])</span><span class="s0">,</span>
                                        <span class="s1">showlegend=</span><span class="s0">False,</span>
                                        <span class="s1">**kwargs</span>
                                    <span class="s1">)</span>
                        <span class="s4"># Push the trace into dictionary</span>
                        <span class="s1">interval_labels[str(interval)] = trace</span>
                        <span class="s0">if </span><span class="s1">c_indx &gt;= (len(theme) - </span><span class="s5">1</span><span class="s1">):</span>
                            <span class="s1">c_indx = -</span><span class="s5">1</span>
                        <span class="s1">c_indx += </span><span class="s5">1</span>
                    <span class="s1">trace_list.append(interval_labels)</span>
                    <span class="s1">legend_param += </span><span class="s5">1</span>

            <span class="s1">trace_index = </span><span class="s5">0</span>
            <span class="s1">indices = range(</span><span class="s5">1</span><span class="s0">, </span><span class="s1">dim + </span><span class="s5">1</span><span class="s1">)</span>
            <span class="s0">for </span><span class="s1">y_index </span><span class="s0">in </span><span class="s1">indices:</span>
                <span class="s0">for </span><span class="s1">x_index </span><span class="s0">in </span><span class="s1">indices:</span>
                    <span class="s0">for </span><span class="s1">interval </span><span class="s0">in </span><span class="s1">intervals:</span>
                        <span class="s1">fig.append_trace(</span>
                            <span class="s1">trace_list[trace_index][str(interval)]</span><span class="s0">, </span><span class="s1">y_index</span><span class="s0">, </span><span class="s1">x_index</span>
                        <span class="s1">)</span>
                    <span class="s1">trace_index += </span><span class="s5">1</span>

            <span class="s4"># Insert headers into the figure</span>
            <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
                <span class="s1">xaxis_key = </span><span class="s2">&quot;xaxis{}&quot;</span><span class="s1">.format((dim * dim) - dim + </span><span class="s5">1 </span><span class="s1">+ j)</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][xaxis_key].update(title=headers[j])</span>
            <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
                <span class="s1">yaxis_key = </span><span class="s2">&quot;yaxis{}&quot;</span><span class="s1">.format(</span><span class="s5">1 </span><span class="s1">+ (dim * j))</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][yaxis_key].update(title=headers[j])</span>

            <span class="s1">hide_tick_labels_from_box_subplots(fig)</span>

            <span class="s0">if </span><span class="s1">diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">:</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                    <span class="s1">height=height</span><span class="s0">,</span>
                    <span class="s1">width=width</span><span class="s0">,</span>
                    <span class="s1">title=title</span><span class="s0">,</span>
                    <span class="s1">showlegend=</span><span class="s0">True,</span>
                    <span class="s1">barmode=</span><span class="s2">&quot;stack&quot;</span><span class="s0">,</span>
                <span class="s1">)</span>
                <span class="s0">return </span><span class="s1">fig</span>

            <span class="s0">elif </span><span class="s1">diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">:</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                    <span class="s1">height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span>
                <span class="s1">)</span>
                <span class="s0">return </span><span class="s1">fig</span>

            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                    <span class="s1">height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span>
                <span class="s1">)</span>
                <span class="s0">return </span><span class="s1">fig</span>

        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">theme = colormap</span>

            <span class="s4"># add a copy of rgb color to theme if it contains one color</span>
            <span class="s0">if </span><span class="s1">len(theme) &lt;= </span><span class="s5">1</span><span class="s1">:</span>
                <span class="s1">theme.append(theme[</span><span class="s5">0</span><span class="s1">])</span>

            <span class="s1">color = []</span>
            <span class="s0">for </span><span class="s1">incr </span><span class="s0">in </span><span class="s1">range(len(theme)):</span>
                <span class="s1">color.append([</span><span class="s5">1.0 </span><span class="s1">/ (len(theme) - </span><span class="s5">1</span><span class="s1">) * incr</span><span class="s0">, </span><span class="s1">theme[incr]])</span>

            <span class="s1">dim = len(dataframe)</span>
            <span class="s1">fig = make_subplots(rows=dim</span><span class="s0">, </span><span class="s1">cols=dim</span><span class="s0">, </span><span class="s1">print_grid=</span><span class="s0">False</span><span class="s1">)</span>
            <span class="s1">trace_list = []</span>
            <span class="s1">legend_param = </span><span class="s5">0</span>
            <span class="s4"># Run through all permutations of list pairs</span>
            <span class="s0">for </span><span class="s1">listy </span><span class="s0">in </span><span class="s1">dataframe:</span>
                <span class="s0">for </span><span class="s1">listx </span><span class="s0">in </span><span class="s1">dataframe:</span>
                    <span class="s4"># Generate trace with VISIBLE icon</span>
                    <span class="s0">if </span><span class="s1">legend_param == </span><span class="s5">1</span><span class="s1">:</span>
                        <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                            <span class="s1">trace = graph_objs.Histogram(</span>
                                <span class="s1">x=listx</span><span class="s0">, </span><span class="s1">marker=dict(color=theme[</span><span class="s5">0</span><span class="s1">])</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">False</span>
                            <span class="s1">)</span>
                        <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                            <span class="s1">trace = graph_objs.Box(</span>
                                <span class="s1">y=listx</span><span class="s0">, </span><span class="s1">marker=dict(color=theme[</span><span class="s5">0</span><span class="s1">])</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">False</span>
                            <span class="s1">)</span>
                        <span class="s0">else</span><span class="s1">:</span>
                            <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = index_vals</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;colorscale&quot;</span><span class="s1">] = color</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;showscale&quot;</span><span class="s1">] = </span><span class="s0">True</span>
                                <span class="s1">trace = graph_objs.Scatter(</span>
                                    <span class="s1">x=listx</span><span class="s0">,</span>
                                    <span class="s1">y=listy</span><span class="s0">,</span>
                                    <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">False,</span>
                                    <span class="s1">**kwargs</span>
                                <span class="s1">)</span>
                            <span class="s0">else</span><span class="s1">:</span>
                                <span class="s1">trace = graph_objs.Scatter(</span>
                                    <span class="s1">x=listx</span><span class="s0">,</span>
                                    <span class="s1">y=listy</span><span class="s0">,</span>
                                    <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                    <span class="s1">marker=dict(</span>
                                        <span class="s1">size=size</span><span class="s0">,</span>
                                        <span class="s1">color=index_vals</span><span class="s0">,</span>
                                        <span class="s1">colorscale=color</span><span class="s0">,</span>
                                        <span class="s1">showscale=</span><span class="s0">True,</span>
                                    <span class="s1">)</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">False,</span>
                                    <span class="s1">**kwargs</span>
                                <span class="s1">)</span>
                    <span class="s4"># Generate trace with INVISIBLE icon</span>
                    <span class="s0">else</span><span class="s1">:</span>
                        <span class="s0">if </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">):</span>
                            <span class="s1">trace = graph_objs.Histogram(</span>
                                <span class="s1">x=listx</span><span class="s0">, </span><span class="s1">marker=dict(color=theme[</span><span class="s5">0</span><span class="s1">])</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">False</span>
                            <span class="s1">)</span>
                        <span class="s0">elif </span><span class="s1">(listx == listy) </span><span class="s0">and </span><span class="s1">(diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">):</span>
                            <span class="s1">trace = graph_objs.Box(</span>
                                <span class="s1">y=listx</span><span class="s0">, </span><span class="s1">marker=dict(color=theme[</span><span class="s5">0</span><span class="s1">])</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">False</span>
                            <span class="s1">)</span>
                        <span class="s0">else</span><span class="s1">:</span>
                            <span class="s0">if </span><span class="s2">&quot;marker&quot; </span><span class="s0">in </span><span class="s1">kwargs:</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;size&quot;</span><span class="s1">] = size</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;color&quot;</span><span class="s1">] = index_vals</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;colorscale&quot;</span><span class="s1">] = color</span>
                                <span class="s1">kwargs[</span><span class="s2">&quot;marker&quot;</span><span class="s1">][</span><span class="s2">&quot;showscale&quot;</span><span class="s1">] = </span><span class="s0">False</span>
                                <span class="s1">trace = graph_objs.Scatter(</span>
                                    <span class="s1">x=listx</span><span class="s0">,</span>
                                    <span class="s1">y=listy</span><span class="s0">,</span>
                                    <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">False,</span>
                                    <span class="s1">**kwargs</span>
                                <span class="s1">)</span>
                            <span class="s0">else</span><span class="s1">:</span>
                                <span class="s1">trace = graph_objs.Scatter(</span>
                                    <span class="s1">x=listx</span><span class="s0">,</span>
                                    <span class="s1">y=listy</span><span class="s0">,</span>
                                    <span class="s1">mode=</span><span class="s2">&quot;markers&quot;</span><span class="s0">,</span>
                                    <span class="s1">marker=dict(</span>
                                        <span class="s1">size=size</span><span class="s0">,</span>
                                        <span class="s1">color=index_vals</span><span class="s0">,</span>
                                        <span class="s1">colorscale=color</span><span class="s0">,</span>
                                        <span class="s1">showscale=</span><span class="s0">False,</span>
                                    <span class="s1">)</span><span class="s0">,</span>
                                    <span class="s1">showlegend=</span><span class="s0">False,</span>
                                    <span class="s1">**kwargs</span>
                                <span class="s1">)</span>
                    <span class="s4"># Push the trace into list</span>
                    <span class="s1">trace_list.append(trace)</span>
                    <span class="s1">legend_param += </span><span class="s5">1</span>

            <span class="s1">trace_index = </span><span class="s5">0</span>
            <span class="s1">indices = range(</span><span class="s5">1</span><span class="s0">, </span><span class="s1">dim + </span><span class="s5">1</span><span class="s1">)</span>
            <span class="s0">for </span><span class="s1">y_index </span><span class="s0">in </span><span class="s1">indices:</span>
                <span class="s0">for </span><span class="s1">x_index </span><span class="s0">in </span><span class="s1">indices:</span>
                    <span class="s1">fig.append_trace(trace_list[trace_index]</span><span class="s0">, </span><span class="s1">y_index</span><span class="s0">, </span><span class="s1">x_index)</span>
                    <span class="s1">trace_index += </span><span class="s5">1</span>

            <span class="s4"># Insert headers into the figure</span>
            <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
                <span class="s1">xaxis_key = </span><span class="s2">&quot;xaxis{}&quot;</span><span class="s1">.format((dim * dim) - dim + </span><span class="s5">1 </span><span class="s1">+ j)</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][xaxis_key].update(title=headers[j])</span>
            <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(dim):</span>
                <span class="s1">yaxis_key = </span><span class="s2">&quot;yaxis{}&quot;</span><span class="s1">.format(</span><span class="s5">1 </span><span class="s1">+ (dim * j))</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">][yaxis_key].update(title=headers[j])</span>

            <span class="s1">hide_tick_labels_from_box_subplots(fig)</span>

            <span class="s0">if </span><span class="s1">diag == </span><span class="s2">&quot;histogram&quot;</span><span class="s1">:</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                    <span class="s1">height=height</span><span class="s0">,</span>
                    <span class="s1">width=width</span><span class="s0">,</span>
                    <span class="s1">title=title</span><span class="s0">,</span>
                    <span class="s1">showlegend=</span><span class="s0">True,</span>
                    <span class="s1">barmode=</span><span class="s2">&quot;stack&quot;</span><span class="s0">,</span>
                <span class="s1">)</span>
                <span class="s0">return </span><span class="s1">fig</span>

            <span class="s0">elif </span><span class="s1">diag == </span><span class="s2">&quot;box&quot;</span><span class="s1">:</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                    <span class="s1">height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span>
                <span class="s1">)</span>
                <span class="s0">return </span><span class="s1">fig</span>

            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">fig[</span><span class="s2">&quot;layout&quot;</span><span class="s1">].update(</span>
                    <span class="s1">height=height</span><span class="s0">, </span><span class="s1">width=width</span><span class="s0">, </span><span class="s1">title=title</span><span class="s0">, </span><span class="s1">showlegend=</span><span class="s0">True</span>
                <span class="s1">)</span>
                <span class="s0">return </span><span class="s1">fig</span>


<span class="s0">def </span><span class="s1">create_scatterplotmatrix(</span>
    <span class="s1">df</span><span class="s0">,</span>
    <span class="s1">index=</span><span class="s0">None,</span>
    <span class="s1">endpts=</span><span class="s0">None,</span>
    <span class="s1">diag=</span><span class="s2">&quot;scatter&quot;</span><span class="s0">,</span>
    <span class="s1">height=</span><span class="s5">500</span><span class="s0">,</span>
    <span class="s1">width=</span><span class="s5">500</span><span class="s0">,</span>
    <span class="s1">size=</span><span class="s5">6</span><span class="s0">,</span>
    <span class="s1">title=</span><span class="s2">&quot;Scatterplot Matrix&quot;</span><span class="s0">,</span>
    <span class="s1">colormap=</span><span class="s0">None,</span>
    <span class="s1">colormap_type=</span><span class="s2">&quot;cat&quot;</span><span class="s0">,</span>
    <span class="s1">dataframe=</span><span class="s0">None,</span>
    <span class="s1">headers=</span><span class="s0">None,</span>
    <span class="s1">index_vals=</span><span class="s0">None,</span>
    <span class="s1">**kwargs</span>
<span class="s1">):</span>
    <span class="s3">&quot;&quot;&quot; 
    Returns data for a scatterplot matrix; 
    **deprecated**, 
    use instead the plotly.graph_objects trace 
    :class:`plotly.graph_objects.Splom`. 
 
    :param (array) df: array of the data with column headers 
    :param (str) index: name of the index column in data array 
    :param (list|tuple) endpts: takes an increasing sequece of numbers 
        that defines intervals on the real line. They are used to group 
        the entries in an index of numbers into their corresponding 
        interval and therefore can be treated as categorical data 
    :param (str) diag: sets the chart type for the main diagonal plots. 
        The options are 'scatter', 'histogram' and 'box'. 
    :param (int|float) height: sets the height of the chart 
    :param (int|float) width: sets the width of the chart 
    :param (float) size: sets the marker size (in px) 
    :param (str) title: the title label of the scatterplot matrix 
    :param (str|tuple|list|dict) colormap: either a plotly scale name, 
        an rgb or hex color, a color tuple, a list of colors or a 
        dictionary. An rgb color is of the form 'rgb(x, y, z)' where 
        x, y and z belong to the interval [0, 255] and a color tuple is a 
        tuple of the form (a, b, c) where a, b and c belong to [0, 1]. 
        If colormap is a list, it must contain valid color types as its 
        members. 
        If colormap is a dictionary, all the string entries in 
        the index column must be a key in colormap. In this case, the 
        colormap_type is forced to 'cat' or categorical 
    :param (str) colormap_type: determines how colormap is interpreted. 
        Valid choices are 'seq' (sequential) and 'cat' (categorical). If 
        'seq' is selected, only the first two colors in colormap will be 
        considered (when colormap is a list) and the index values will be 
        linearly interpolated between those two colors. This option is 
        forced if all index values are numeric. 
        If 'cat' is selected, a color from colormap will be assigned to 
        each category from index, including the intervals if endpts is 
        being used 
    :param (dict) **kwargs: a dictionary of scatterplot arguments 
        The only forbidden parameters are 'size', 'color' and 
        'colorscale' in 'marker' 
 
    Example 1: Vanilla Scatterplot Matrix 
 
    &gt;&gt;&gt; from plotly.graph_objs import graph_objs 
    &gt;&gt;&gt; from plotly.figure_factory import create_scatterplotmatrix 
 
    &gt;&gt;&gt; import numpy as np 
    &gt;&gt;&gt; import pandas as pd 
 
    &gt;&gt;&gt; # Create dataframe 
    &gt;&gt;&gt; df = pd.DataFrame(np.random.randn(10, 2), 
    ...                 columns=['Column 1', 'Column 2']) 
 
    &gt;&gt;&gt; # Create scatterplot matrix 
    &gt;&gt;&gt; fig = create_scatterplotmatrix(df) 
    &gt;&gt;&gt; fig.show() 
 
 
    Example 2: Indexing a Column 
 
    &gt;&gt;&gt; from plotly.graph_objs import graph_objs 
    &gt;&gt;&gt; from plotly.figure_factory import create_scatterplotmatrix 
 
    &gt;&gt;&gt; import numpy as np 
    &gt;&gt;&gt; import pandas as pd 
 
    &gt;&gt;&gt; # Create dataframe with index 
    &gt;&gt;&gt; df = pd.DataFrame(np.random.randn(10, 2), 
    ...                    columns=['A', 'B']) 
 
    &gt;&gt;&gt; # Add another column of strings to the dataframe 
    &gt;&gt;&gt; df['Fruit'] = pd.Series(['apple', 'apple', 'grape', 'apple', 'apple', 
    ...                          'grape', 'pear', 'pear', 'apple', 'pear']) 
 
    &gt;&gt;&gt; # Create scatterplot matrix 
    &gt;&gt;&gt; fig = create_scatterplotmatrix(df, index='Fruit', size=10) 
    &gt;&gt;&gt; fig.show() 
 
 
    Example 3: Styling the Diagonal Subplots 
 
    &gt;&gt;&gt; from plotly.graph_objs import graph_objs 
    &gt;&gt;&gt; from plotly.figure_factory import create_scatterplotmatrix 
 
    &gt;&gt;&gt; import numpy as np 
    &gt;&gt;&gt; import pandas as pd 
 
    &gt;&gt;&gt; # Create dataframe with index 
    &gt;&gt;&gt; df = pd.DataFrame(np.random.randn(10, 4), 
    ...                    columns=['A', 'B', 'C', 'D']) 
 
    &gt;&gt;&gt; # Add another column of strings to the dataframe 
    &gt;&gt;&gt; df['Fruit'] = pd.Series(['apple', 'apple', 'grape', 'apple', 'apple', 
    ...                          'grape', 'pear', 'pear', 'apple', 'pear']) 
 
    &gt;&gt;&gt; # Create scatterplot matrix 
    &gt;&gt;&gt; fig = create_scatterplotmatrix(df, diag='box', index='Fruit', height=1000, 
    ...                                width=1000) 
    &gt;&gt;&gt; fig.show() 
 
 
    Example 4: Use a Theme to Style the Subplots 
 
    &gt;&gt;&gt; from plotly.graph_objs import graph_objs 
    &gt;&gt;&gt; from plotly.figure_factory import create_scatterplotmatrix 
 
    &gt;&gt;&gt; import numpy as np 
    &gt;&gt;&gt; import pandas as pd 
 
    &gt;&gt;&gt; # Create dataframe with random data 
    &gt;&gt;&gt; df = pd.DataFrame(np.random.randn(100, 3), 
    ...                    columns=['A', 'B', 'C']) 
 
    &gt;&gt;&gt; # Create scatterplot matrix using a built-in 
    &gt;&gt;&gt; # Plotly palette scale and indexing column 'A' 
    &gt;&gt;&gt; fig = create_scatterplotmatrix(df, diag='histogram', index='A', 
    ...                                colormap='Blues', height=800, width=800) 
    &gt;&gt;&gt; fig.show() 
 
 
    Example 5: Example 4 with Interval Factoring 
 
    &gt;&gt;&gt; from plotly.graph_objs import graph_objs 
    &gt;&gt;&gt; from plotly.figure_factory import create_scatterplotmatrix 
 
    &gt;&gt;&gt; import numpy as np 
    &gt;&gt;&gt; import pandas as pd 
 
    &gt;&gt;&gt; # Create dataframe with random data 
    &gt;&gt;&gt; df = pd.DataFrame(np.random.randn(100, 3), 
    ...                    columns=['A', 'B', 'C']) 
 
    &gt;&gt;&gt; # Create scatterplot matrix using a list of 2 rgb tuples 
    &gt;&gt;&gt; # and endpoints at -1, 0 and 1 
    &gt;&gt;&gt; fig = create_scatterplotmatrix(df, diag='histogram', index='A', 
    ...                                colormap=['rgb(140, 255, 50)', 
    ...                                          'rgb(170, 60, 115)', '#6c4774', 
    ...                                          (0.5, 0.1, 0.8)], 
    ...                                endpts=[-1, 0, 1], height=800, width=800) 
    &gt;&gt;&gt; fig.show() 
 
 
    Example 6: Using the colormap as a Dictionary 
 
    &gt;&gt;&gt; from plotly.graph_objs import graph_objs 
    &gt;&gt;&gt; from plotly.figure_factory import create_scatterplotmatrix 
 
    &gt;&gt;&gt; import numpy as np 
    &gt;&gt;&gt; import pandas as pd 
    &gt;&gt;&gt; import random 
 
    &gt;&gt;&gt; # Create dataframe with random data 
    &gt;&gt;&gt; df = pd.DataFrame(np.random.randn(100, 3), 
    ...                    columns=['Column A', 
    ...                             'Column B', 
    ...                             'Column C']) 
 
    &gt;&gt;&gt; # Add new color column to dataframe 
    &gt;&gt;&gt; new_column = [] 
    &gt;&gt;&gt; strange_colors = ['turquoise', 'limegreen', 'goldenrod'] 
 
    &gt;&gt;&gt; for j in range(100): 
    ...     new_column.append(random.choice(strange_colors)) 
    &gt;&gt;&gt; df['Colors'] = pd.Series(new_column, index=df.index) 
 
    &gt;&gt;&gt; # Create scatterplot matrix using a dictionary of hex color values 
    &gt;&gt;&gt; # which correspond to actual color names in 'Colors' column 
    &gt;&gt;&gt; fig = create_scatterplotmatrix( 
    ...     df, diag='box', index='Colors', 
    ...     colormap= dict( 
    ...         turquoise = '#00F5FF', 
    ...         limegreen = '#32CD32', 
    ...         goldenrod = '#DAA520' 
    ...     ), 
    ...     colormap_type='cat', 
    ...     height=800, width=800 
    ... ) 
    &gt;&gt;&gt; fig.show() 
    &quot;&quot;&quot;</span>
    <span class="s4"># TODO: protected until #282</span>
    <span class="s0">if </span><span class="s1">dataframe </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">dataframe = []</span>
    <span class="s0">if </span><span class="s1">headers </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">headers = []</span>
    <span class="s0">if </span><span class="s1">index_vals </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">index_vals = []</span>

    <span class="s1">validate_scatterplotmatrix(df</span><span class="s0">, </span><span class="s1">index</span><span class="s0">, </span><span class="s1">diag</span><span class="s0">, </span><span class="s1">colormap_type</span><span class="s0">, </span><span class="s1">**kwargs)</span>

    <span class="s4"># Validate colormap</span>
    <span class="s0">if </span><span class="s1">isinstance(colormap</span><span class="s0">, </span><span class="s1">dict):</span>
        <span class="s1">colormap = clrs.validate_colors_dict(colormap</span><span class="s0">, </span><span class="s2">&quot;rgb&quot;</span><span class="s1">)</span>
    <span class="s0">elif </span><span class="s1">(</span>
        <span class="s1">isinstance(colormap</span><span class="s0">, </span><span class="s1">six.string_types)</span>
        <span class="s0">and </span><span class="s2">&quot;rgb&quot; </span><span class="s0">not in </span><span class="s1">colormap</span>
        <span class="s0">and </span><span class="s2">&quot;#&quot; </span><span class="s0">not in </span><span class="s1">colormap</span>
    <span class="s1">):</span>
        <span class="s0">if </span><span class="s1">colormap </span><span class="s0">not in </span><span class="s1">clrs.PLOTLY_SCALES.keys():</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;If 'colormap' is a string, it must be the name &quot;</span>
                <span class="s2">&quot;of a Plotly Colorscale. The available colorscale &quot;</span>
                <span class="s2">&quot;names are {}&quot;</span><span class="s1">.format(clrs.PLOTLY_SCALES.keys())</span>
            <span class="s1">)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s4"># TODO change below to allow the correct Plotly colorscale</span>
            <span class="s1">colormap = clrs.colorscale_to_colors(clrs.PLOTLY_SCALES[colormap])</span>
            <span class="s4"># keep only first and last item - fix later</span>
            <span class="s1">colormap = [colormap[</span><span class="s5">0</span><span class="s1">]] + [colormap[-</span><span class="s5">1</span><span class="s1">]]</span>
        <span class="s1">colormap = clrs.validate_colors(colormap</span><span class="s0">, </span><span class="s2">&quot;rgb&quot;</span><span class="s1">)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">colormap = clrs.validate_colors(colormap</span><span class="s0">, </span><span class="s2">&quot;rgb&quot;</span><span class="s1">)</span>

    <span class="s0">if not </span><span class="s1">index:</span>
        <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">df:</span>
            <span class="s1">headers.append(name)</span>
        <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">headers:</span>
            <span class="s1">dataframe.append(df[name].values.tolist())</span>
        <span class="s4"># Check for same data-type in df columns</span>
        <span class="s1">utils.validate_dataframe(dataframe)</span>
        <span class="s1">figure = scatterplot(</span>
            <span class="s1">dataframe</span><span class="s0">, </span><span class="s1">headers</span><span class="s0">, </span><span class="s1">diag</span><span class="s0">, </span><span class="s1">size</span><span class="s0">, </span><span class="s1">height</span><span class="s0">, </span><span class="s1">width</span><span class="s0">, </span><span class="s1">title</span><span class="s0">, </span><span class="s1">**kwargs</span>
        <span class="s1">)</span>
        <span class="s0">return </span><span class="s1">figure</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s4"># Validate index selection</span>
        <span class="s0">if </span><span class="s1">index </span><span class="s0">not in </span><span class="s1">df:</span>
            <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                <span class="s2">&quot;Make sure you set the index &quot;</span>
                <span class="s2">&quot;input variable to one of the &quot;</span>
                <span class="s2">&quot;column names of your &quot;</span>
                <span class="s2">&quot;dataframe.&quot;</span>
            <span class="s1">)</span>
        <span class="s1">index_vals = df[index].values.tolist()</span>
        <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">df:</span>
            <span class="s0">if </span><span class="s1">name != index:</span>
                <span class="s1">headers.append(name)</span>
        <span class="s0">for </span><span class="s1">name </span><span class="s0">in </span><span class="s1">headers:</span>
            <span class="s1">dataframe.append(df[name].values.tolist())</span>

        <span class="s4"># check for same data-type in each df column</span>
        <span class="s1">utils.validate_dataframe(dataframe)</span>
        <span class="s1">utils.validate_index(index_vals)</span>

        <span class="s4"># check if all colormap keys are in the index</span>
        <span class="s4"># if colormap is a dictionary</span>
        <span class="s0">if </span><span class="s1">isinstance(colormap</span><span class="s0">, </span><span class="s1">dict):</span>
            <span class="s0">for </span><span class="s1">key </span><span class="s0">in </span><span class="s1">colormap:</span>
                <span class="s0">if not </span><span class="s1">all(index </span><span class="s0">in </span><span class="s1">colormap </span><span class="s0">for </span><span class="s1">index </span><span class="s0">in </span><span class="s1">index_vals):</span>
                    <span class="s0">raise </span><span class="s1">exceptions.PlotlyError(</span>
                        <span class="s2">&quot;If colormap is a &quot;</span>
                        <span class="s2">&quot;dictionary, all the &quot;</span>
                        <span class="s2">&quot;names in the index &quot;</span>
                        <span class="s2">&quot;must be keys.&quot;</span>
                    <span class="s1">)</span>
            <span class="s1">figure = scatterplot_dict(</span>
                <span class="s1">dataframe</span><span class="s0">,</span>
                <span class="s1">headers</span><span class="s0">,</span>
                <span class="s1">diag</span><span class="s0">,</span>
                <span class="s1">size</span><span class="s0">,</span>
                <span class="s1">height</span><span class="s0">,</span>
                <span class="s1">width</span><span class="s0">,</span>
                <span class="s1">title</span><span class="s0">,</span>
                <span class="s1">index</span><span class="s0">,</span>
                <span class="s1">index_vals</span><span class="s0">,</span>
                <span class="s1">endpts</span><span class="s0">,</span>
                <span class="s1">colormap</span><span class="s0">,</span>
                <span class="s1">colormap_type</span><span class="s0">,</span>
                <span class="s1">**kwargs</span>
            <span class="s1">)</span>
            <span class="s0">return </span><span class="s1">figure</span>

        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">figure = scatterplot_theme(</span>
                <span class="s1">dataframe</span><span class="s0">,</span>
                <span class="s1">headers</span><span class="s0">,</span>
                <span class="s1">diag</span><span class="s0">,</span>
                <span class="s1">size</span><span class="s0">,</span>
                <span class="s1">height</span><span class="s0">,</span>
                <span class="s1">width</span><span class="s0">,</span>
                <span class="s1">title</span><span class="s0">,</span>
                <span class="s1">index</span><span class="s0">,</span>
                <span class="s1">index_vals</span><span class="s0">,</span>
                <span class="s1">endpts</span><span class="s0">,</span>
                <span class="s1">colormap</span><span class="s0">,</span>
                <span class="s1">colormap_type</span><span class="s0">,</span>
                <span class="s1">**kwargs</span>
            <span class="s1">)</span>
            <span class="s0">return </span><span class="s1">figure</span>
</pre>
</body>
</html>