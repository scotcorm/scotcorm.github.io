<html>
<head>
<title>test_deprecated.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #629755; font-style: italic;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_deprecated.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">datetime</span><span class="s0">,</span>
    <span class="s1">timedelta</span><span class="s0">,</span>
<span class="s1">)</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">DataFrame</span><span class="s0">,</span>
    <span class="s1">Series</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">import </span><span class="s1">pandas._testing </span><span class="s0">as </span><span class="s1">tm</span>
<span class="s0">from </span><span class="s1">pandas.core.indexes.datetimes </span><span class="s0">import </span><span class="s1">date_range</span>
<span class="s0">from </span><span class="s1">pandas.core.indexes.period </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">PeriodIndex</span><span class="s0">,</span>
    <span class="s1">period_range</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">from </span><span class="s1">pandas.core.indexes.timedeltas </span><span class="s0">import </span><span class="s1">timedelta_range</span>

<span class="s0">from </span><span class="s1">pandas.tseries.offsets </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">BDay</span><span class="s0">,</span>
    <span class="s1">Minute</span><span class="s0">,</span>
<span class="s1">)</span>

<span class="s1">DATE_RANGE = (date_range</span><span class="s0">, </span><span class="s2">&quot;dti&quot;</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2005</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2005</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
<span class="s1">PERIOD_RANGE = (period_range</span><span class="s0">, </span><span class="s2">&quot;pi&quot;</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2005</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s3">2005</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">10</span><span class="s1">))</span>
<span class="s1">TIMEDELTA_RANGE = (timedelta_range</span><span class="s0">, </span><span class="s2">&quot;tdi&quot;</span><span class="s0">, </span><span class="s2">&quot;1 day&quot;</span><span class="s0">, </span><span class="s2">&quot;10 day&quot;</span><span class="s1">)</span>

<span class="s1">all_ts = pytest.mark.parametrize(</span>
    <span class="s2">&quot;_index_factory,_series_name,_index_start,_index_end&quot;</span><span class="s0">,</span>
    <span class="s1">[DATE_RANGE</span><span class="s0">, </span><span class="s1">PERIOD_RANGE</span><span class="s0">, </span><span class="s1">TIMEDELTA_RANGE]</span><span class="s0">,</span>
<span class="s1">)</span>


<span class="s1">@pytest.fixture()</span>
<span class="s0">def </span><span class="s1">_index_factory():</span>
    <span class="s0">return </span><span class="s1">period_range</span>


<span class="s1">@pytest.fixture</span>
<span class="s0">def </span><span class="s1">create_index(_index_factory):</span>
    <span class="s0">def </span><span class="s1">_create_index(*args</span><span class="s0">, </span><span class="s1">**kwargs):</span>
        <span class="s4">&quot;&quot;&quot;return the _index_factory created using the args, kwargs&quot;&quot;&quot;</span>
        <span class="s0">return </span><span class="s1">_index_factory(*args</span><span class="s0">, </span><span class="s1">**kwargs)</span>

    <span class="s0">return </span><span class="s1">_create_index</span>


<span class="s5"># new test to check that all FutureWarning are triggered</span>
<span class="s0">def </span><span class="s1">test_deprecating_on_loffset_and_base():</span>
    <span class="s5"># GH 31809</span>

    <span class="s1">idx = date_range(</span><span class="s2">&quot;2001-01-01&quot;</span><span class="s0">, </span><span class="s1">periods=</span><span class="s3">4</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;T&quot;</span><span class="s1">)</span>
    <span class="s1">df = DataFrame(data=</span><span class="s3">4 </span><span class="s1">* [range(</span><span class="s3">2</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">index=idx</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">])</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">pd.Grouper(freq=</span><span class="s2">&quot;10s&quot;</span><span class="s0">, </span><span class="s1">base=</span><span class="s3">0</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">pd.Grouper(freq=</span><span class="s2">&quot;10s&quot;</span><span class="s0">, </span><span class="s1">loffset=</span><span class="s2">&quot;0s&quot;</span><span class="s1">)</span>

    <span class="s5"># not checking the stacklevel for .groupby().resample() because it's complicated to</span>
    <span class="s5"># reconcile it with the stacklevel for Series.resample() and DataFrame.resample();</span>
    <span class="s5"># see GH #37603</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">df.groupby(</span><span class="s2">&quot;a&quot;</span><span class="s1">).resample(</span><span class="s2">&quot;3T&quot;</span><span class="s0">, </span><span class="s1">base=</span><span class="s3">0</span><span class="s1">).sum()</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">df.groupby(</span><span class="s2">&quot;a&quot;</span><span class="s1">).resample(</span><span class="s2">&quot;3T&quot;</span><span class="s0">, </span><span class="s1">loffset=</span><span class="s2">&quot;0s&quot;</span><span class="s1">).sum()</span>
    <span class="s1">msg = </span><span class="s2">&quot;'offset' and 'base' cannot be present at the same time&quot;</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
            <span class="s1">df.groupby(</span><span class="s2">&quot;a&quot;</span><span class="s1">).resample(</span><span class="s2">&quot;3T&quot;</span><span class="s0">, </span><span class="s1">base=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">offset=</span><span class="s3">0</span><span class="s1">).sum()</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">df.resample(</span><span class="s2">&quot;3T&quot;</span><span class="s0">, </span><span class="s1">base=</span><span class="s3">0</span><span class="s1">).sum()</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">df.resample(</span><span class="s2">&quot;3T&quot;</span><span class="s0">, </span><span class="s1">loffset=</span><span class="s2">&quot;0s&quot;</span><span class="s1">).sum()</span>


<span class="s1">@all_ts</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;arg&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;mean&quot;</span><span class="s0">, </span><span class="s1">{</span><span class="s2">&quot;value&quot;</span><span class="s1">: </span><span class="s2">&quot;mean&quot;</span><span class="s1">}</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;mean&quot;</span><span class="s1">]])</span>
<span class="s0">def </span><span class="s1">test_resample_loffset_arg_type(frame</span><span class="s0">, </span><span class="s1">create_index</span><span class="s0">, </span><span class="s1">arg):</span>
    <span class="s5"># GH 13218, 15002</span>
    <span class="s1">df = frame</span>
    <span class="s1">expected_means = [df.values[i : i + </span><span class="s3">2</span><span class="s1">].mean() </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">len(df.values)</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)]</span>
    <span class="s1">expected_index = create_index(df.index[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">periods=len(df.index) / </span><span class="s3">2</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;2D&quot;</span><span class="s1">)</span>

    <span class="s5"># loffset coerces PeriodIndex to DateTimeIndex</span>
    <span class="s0">if </span><span class="s1">isinstance(expected_index</span><span class="s0">, </span><span class="s1">PeriodIndex):</span>
        <span class="s1">expected_index = expected_index.to_timestamp()</span>

    <span class="s1">expected_index += timedelta(hours=</span><span class="s3">2</span><span class="s1">)</span>
    <span class="s1">expected = DataFrame({</span><span class="s2">&quot;value&quot;</span><span class="s1">: expected_means}</span><span class="s0">, </span><span class="s1">index=expected_index)</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">result_agg = df.resample(</span><span class="s2">&quot;2D&quot;</span><span class="s0">, </span><span class="s1">loffset=</span><span class="s2">&quot;2H&quot;</span><span class="s1">).agg(arg)</span>

    <span class="s0">if </span><span class="s1">isinstance(arg</span><span class="s0">, </span><span class="s1">list):</span>
        <span class="s1">expected.columns = pd.MultiIndex.from_tuples([(</span><span class="s2">&quot;value&quot;</span><span class="s0">, </span><span class="s2">&quot;mean&quot;</span><span class="s1">)])</span>

    <span class="s1">tm.assert_frame_equal(result_agg</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;loffset&quot;</span><span class="s0">, </span><span class="s1">[timedelta(minutes=</span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;1min&quot;</span><span class="s0">, </span><span class="s1">Minute(</span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.timedelta64(</span><span class="s3">1</span><span class="s0">, </span><span class="s2">&quot;m&quot;</span><span class="s1">)]</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_resample_loffset(loffset):</span>
    <span class="s5"># GH 7687</span>
    <span class="s1">rng = date_range(</span><span class="s2">&quot;1/1/2000 00:00:00&quot;</span><span class="s0">, </span><span class="s2">&quot;1/1/2000 00:13:00&quot;</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;min&quot;</span><span class="s1">)</span>
    <span class="s1">s = Series(np.random.randn(</span><span class="s3">14</span><span class="s1">)</span><span class="s0">, </span><span class="s1">index=rng)</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">result = s.resample(</span>
            <span class="s2">&quot;5min&quot;</span><span class="s0">, </span><span class="s1">closed=</span><span class="s2">&quot;right&quot;</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;right&quot;</span><span class="s0">, </span><span class="s1">loffset=loffset</span>
        <span class="s1">).mean()</span>
    <span class="s1">idx = date_range(</span><span class="s2">&quot;1/1/2000&quot;</span><span class="s0">, </span><span class="s1">periods=</span><span class="s3">4</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;5min&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series(</span>
        <span class="s1">[s[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s[</span><span class="s3">1</span><span class="s1">:</span><span class="s3">6</span><span class="s1">].mean()</span><span class="s0">, </span><span class="s1">s[</span><span class="s3">6</span><span class="s1">:</span><span class="s3">11</span><span class="s1">].mean()</span><span class="s0">, </span><span class="s1">s[</span><span class="s3">11</span><span class="s1">:].mean()]</span><span class="s0">,</span>
        <span class="s1">index=idx + timedelta(minutes=</span><span class="s3">1</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">result.index.freq == Minute(</span><span class="s3">5</span><span class="s1">)</span>

    <span class="s5"># from daily</span>
    <span class="s1">dti = date_range(start=datetime(</span><span class="s3">2005</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">end=datetime(</span><span class="s3">2005</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;D&quot;</span><span class="s1">)</span>
    <span class="s1">ser = Series(np.random.rand(len(dti))</span><span class="s0">, </span><span class="s1">dti)</span>

    <span class="s5"># to weekly</span>
    <span class="s1">result = ser.resample(</span><span class="s2">&quot;w-sun&quot;</span><span class="s1">).last()</span>
    <span class="s1">business_day_offset = BDay()</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">expected = ser.resample(</span><span class="s2">&quot;w-sun&quot;</span><span class="s0">, </span><span class="s1">loffset=-business_day_offset).last()</span>
    <span class="s0">assert </span><span class="s1">result.index[</span><span class="s3">0</span><span class="s1">] - business_day_offset == expected.index[</span><span class="s3">0</span><span class="s1">]</span>


<span class="s0">def </span><span class="s1">test_resample_loffset_upsample():</span>
    <span class="s5"># GH 20744</span>
    <span class="s1">rng = date_range(</span><span class="s2">&quot;1/1/2000 00:00:00&quot;</span><span class="s0">, </span><span class="s2">&quot;1/1/2000 00:13:00&quot;</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;min&quot;</span><span class="s1">)</span>
    <span class="s1">s = Series(np.random.randn(</span><span class="s3">14</span><span class="s1">)</span><span class="s0">, </span><span class="s1">index=rng)</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">result = s.resample(</span>
            <span class="s2">&quot;5min&quot;</span><span class="s0">, </span><span class="s1">closed=</span><span class="s2">&quot;right&quot;</span><span class="s0">, </span><span class="s1">label=</span><span class="s2">&quot;right&quot;</span><span class="s0">, </span><span class="s1">loffset=timedelta(minutes=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">).ffill()</span>
    <span class="s1">idx = date_range(</span><span class="s2">&quot;1/1/2000&quot;</span><span class="s0">, </span><span class="s1">periods=</span><span class="s3">4</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;5min&quot;</span><span class="s1">)</span>
    <span class="s1">expected = Series([s[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s[</span><span class="s3">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s[</span><span class="s3">10</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s[-</span><span class="s3">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">index=idx + timedelta(minutes=</span><span class="s3">1</span><span class="s1">))</span>

    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_resample_loffset_count():</span>
    <span class="s5"># GH 12725</span>
    <span class="s1">start_time = </span><span class="s2">&quot;1/1/2000 00:00:00&quot;</span>
    <span class="s1">rng = date_range(start_time</span><span class="s0">, </span><span class="s1">periods=</span><span class="s3">100</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;S&quot;</span><span class="s1">)</span>
    <span class="s1">ts = Series(np.random.randn(len(rng))</span><span class="s0">, </span><span class="s1">index=rng)</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">result = ts.resample(</span><span class="s2">&quot;10S&quot;</span><span class="s0">, </span><span class="s1">loffset=</span><span class="s2">&quot;1s&quot;</span><span class="s1">).count()</span>

    <span class="s1">expected_index = date_range(start_time</span><span class="s0">, </span><span class="s1">periods=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;10S&quot;</span><span class="s1">) + timedelta(</span>
        <span class="s1">seconds=</span><span class="s3">1</span>
    <span class="s1">)</span>
    <span class="s1">expected = Series(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">index=expected_index)</span>

    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s5"># Same issue should apply to .size() since it goes through</span>
    <span class="s5">#   same code path</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">result = ts.resample(</span><span class="s2">&quot;10S&quot;</span><span class="s0">, </span><span class="s1">loffset=</span><span class="s2">&quot;1s&quot;</span><span class="s1">).size()</span>

    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_resample_base():</span>
    <span class="s1">rng = date_range(</span><span class="s2">&quot;1/1/2000 00:00:00&quot;</span><span class="s0">, </span><span class="s2">&quot;1/1/2000 02:00&quot;</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;s&quot;</span><span class="s1">)</span>
    <span class="s1">ts = Series(np.random.randn(len(rng))</span><span class="s0">, </span><span class="s1">index=rng)</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">resampled = ts.resample(</span><span class="s2">&quot;5min&quot;</span><span class="s0">, </span><span class="s1">base=</span><span class="s3">2</span><span class="s1">).mean()</span>
    <span class="s1">exp_rng = date_range(</span><span class="s2">&quot;12/31/1999 23:57:00&quot;</span><span class="s0">, </span><span class="s2">&quot;1/1/2000 01:57&quot;</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;5min&quot;</span><span class="s1">)</span>
    <span class="s1">tm.assert_index_equal(resampled.index</span><span class="s0">, </span><span class="s1">exp_rng)</span>


<span class="s0">def </span><span class="s1">test_resample_float_base():</span>
    <span class="s5"># GH25161</span>
    <span class="s1">dt = pd.to_datetime(</span>
        <span class="s1">[</span><span class="s2">&quot;2018-11-26 16:17:43.51&quot;</span><span class="s0">, </span><span class="s2">&quot;2018-11-26 16:17:44.51&quot;</span><span class="s0">, </span><span class="s2">&quot;2018-11-26 16:17:45.51&quot;</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">s = Series(np.arange(</span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">index=dt)</span>

    <span class="s1">base = </span><span class="s3">17 </span><span class="s1">+ </span><span class="s3">43.51 </span><span class="s1">/ </span><span class="s3">60</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">result = s.resample(</span><span class="s2">&quot;3min&quot;</span><span class="s0">, </span><span class="s1">base=base).size()</span>
    <span class="s1">expected = Series(</span>
        <span class="s3">3</span><span class="s0">, </span><span class="s1">index=pd.DatetimeIndex([</span><span class="s2">&quot;2018-11-26 16:17:43.51&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;3min&quot;</span><span class="s1">)</span>
    <span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;kind&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;period&quot;</span><span class="s0">, None, </span><span class="s2">&quot;timestamp&quot;</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;agg_arg&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;mean&quot;</span><span class="s0">, </span><span class="s1">{</span><span class="s2">&quot;value&quot;</span><span class="s1">: </span><span class="s2">&quot;mean&quot;</span><span class="s1">}</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;mean&quot;</span><span class="s1">]])</span>
<span class="s0">def </span><span class="s1">test_loffset_returns_datetimeindex(frame</span><span class="s0">, </span><span class="s1">kind</span><span class="s0">, </span><span class="s1">agg_arg):</span>
    <span class="s5"># make sure passing loffset returns DatetimeIndex in all cases</span>
    <span class="s5"># basic method taken from Base.test_resample_loffset_arg_type()</span>
    <span class="s1">df = frame</span>
    <span class="s1">expected_means = [df.values[i : i + </span><span class="s3">2</span><span class="s1">].mean() </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">len(df.values)</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)]</span>
    <span class="s1">expected_index = period_range(df.index[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">periods=len(df.index) / </span><span class="s3">2</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;2D&quot;</span><span class="s1">)</span>

    <span class="s5"># loffset coerces PeriodIndex to DateTimeIndex</span>
    <span class="s1">expected_index = expected_index.to_timestamp()</span>
    <span class="s1">expected_index += timedelta(hours=</span><span class="s3">2</span><span class="s1">)</span>
    <span class="s1">expected = DataFrame({</span><span class="s2">&quot;value&quot;</span><span class="s1">: expected_means}</span><span class="s0">, </span><span class="s1">index=expected_index)</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">result_agg = df.resample(</span><span class="s2">&quot;2D&quot;</span><span class="s0">, </span><span class="s1">loffset=</span><span class="s2">&quot;2H&quot;</span><span class="s0">, </span><span class="s1">kind=kind).agg(agg_arg)</span>
    <span class="s0">if </span><span class="s1">isinstance(agg_arg</span><span class="s0">, </span><span class="s1">list):</span>
        <span class="s1">expected.columns = pd.MultiIndex.from_tuples([(</span><span class="s2">&quot;value&quot;</span><span class="s0">, </span><span class="s2">&quot;mean&quot;</span><span class="s1">)])</span>
    <span class="s1">tm.assert_frame_equal(result_agg</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;start,end,start_freq,end_freq,base,offset&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s2">&quot;19910905&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 03:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 23:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 10:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 10:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 10:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 10:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 03:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">34</span><span class="s0">, </span><span class="s2">&quot;34H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;17H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;17H&quot;</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s2">&quot;3H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905 12:00&quot;</span><span class="s0">, </span><span class="s2">&quot;19910909 1:00&quot;</span><span class="s0">, </span><span class="s2">&quot;H&quot;</span><span class="s0">, </span><span class="s2">&quot;M&quot;</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s2">&quot;3H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905&quot;</span><span class="s0">, </span><span class="s2">&quot;19910913 06:00&quot;</span><span class="s0">, </span><span class="s2">&quot;2H&quot;</span><span class="s0">, </span><span class="s2">&quot;24H&quot;</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s2">&quot;10H&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905&quot;</span><span class="s0">, </span><span class="s2">&quot;19910905 01:39&quot;</span><span class="s0">, </span><span class="s2">&quot;Min&quot;</span><span class="s0">, </span><span class="s2">&quot;5Min&quot;</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s2">&quot;3Min&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;19910905&quot;</span><span class="s0">, </span><span class="s2">&quot;19910905 03:18&quot;</span><span class="s0">, </span><span class="s2">&quot;2Min&quot;</span><span class="s0">, </span><span class="s2">&quot;5Min&quot;</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s2">&quot;3Min&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_resample_with_non_zero_base(start</span><span class="s0">, </span><span class="s1">end</span><span class="s0">, </span><span class="s1">start_freq</span><span class="s0">, </span><span class="s1">end_freq</span><span class="s0">, </span><span class="s1">base</span><span class="s0">, </span><span class="s1">offset):</span>
    <span class="s5"># GH 23882</span>
    <span class="s1">s = Series(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">index=period_range(start</span><span class="s0">, </span><span class="s1">end</span><span class="s0">, </span><span class="s1">freq=start_freq))</span>
    <span class="s1">s = s + np.arange(len(s))</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">result = s.resample(end_freq</span><span class="s0">, </span><span class="s1">base=base).mean()</span>
    <span class="s1">result = result.to_timestamp(end_freq)</span>

    <span class="s5"># test that the replacement argument 'offset' works</span>
    <span class="s1">result_offset = s.resample(end_freq</span><span class="s0">, </span><span class="s1">offset=offset).mean()</span>
    <span class="s1">result_offset = result_offset.to_timestamp(end_freq)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">result_offset)</span>

    <span class="s5"># to_timestamp casts 24H -&gt; D</span>
    <span class="s1">result = result.asfreq(end_freq) </span><span class="s0">if </span><span class="s1">end_freq == </span><span class="s2">&quot;24H&quot; </span><span class="s0">else </span><span class="s1">result</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">expected = s.to_timestamp().resample(end_freq</span><span class="s0">, </span><span class="s1">base=base).mean()</span>
    <span class="s0">if </span><span class="s1">end_freq == </span><span class="s2">&quot;M&quot;</span><span class="s1">:</span>
        <span class="s5"># TODO: is non-tick the relevant characteristic? (GH 33815)</span>
        <span class="s1">expected.index = expected.index._with_freq(</span><span class="s0">None</span><span class="s1">)</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_resample_base_with_timedeltaindex():</span>
    <span class="s5"># GH 10530</span>
    <span class="s1">rng = timedelta_range(start=</span><span class="s2">&quot;0s&quot;</span><span class="s0">, </span><span class="s1">periods=</span><span class="s3">25</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;s&quot;</span><span class="s1">)</span>
    <span class="s1">ts = Series(np.random.randn(len(rng))</span><span class="s0">, </span><span class="s1">index=rng)</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning):</span>
        <span class="s1">with_base = ts.resample(</span><span class="s2">&quot;2s&quot;</span><span class="s0">, </span><span class="s1">base=</span><span class="s3">5</span><span class="s1">).mean()</span>
    <span class="s1">without_base = ts.resample(</span><span class="s2">&quot;2s&quot;</span><span class="s1">).mean()</span>

    <span class="s1">exp_without_base = timedelta_range(start=</span><span class="s2">&quot;0s&quot;</span><span class="s0">, </span><span class="s1">end=</span><span class="s2">&quot;25s&quot;</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;2s&quot;</span><span class="s1">)</span>
    <span class="s1">exp_with_base = timedelta_range(start=</span><span class="s2">&quot;5s&quot;</span><span class="s0">, </span><span class="s1">end=</span><span class="s2">&quot;29s&quot;</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;2s&quot;</span><span class="s1">)</span>

    <span class="s1">tm.assert_index_equal(without_base.index</span><span class="s0">, </span><span class="s1">exp_without_base)</span>
    <span class="s1">tm.assert_index_equal(with_base.index</span><span class="s0">, </span><span class="s1">exp_with_base)</span>


<span class="s0">def </span><span class="s1">test_interpolate_posargs_deprecation():</span>
    <span class="s5"># GH 41485</span>
    <span class="s1">idx = pd.to_datetime([</span><span class="s2">&quot;1992-08-27 07:46:48&quot;</span><span class="s0">, </span><span class="s2">&quot;1992-08-27 07:46:59&quot;</span><span class="s1">])</span>
    <span class="s1">s = Series([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">index=idx)</span>

    <span class="s1">msg = (</span>
        <span class="s2">r&quot;In a future version of pandas all arguments of Resampler\.interpolate &quot;</span>
        <span class="s2">r&quot;except for the argument 'method' will be keyword-only&quot;</span>
    <span class="s1">)</span>

    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">result = s.resample(</span><span class="s2">&quot;3s&quot;</span><span class="s1">).interpolate(</span><span class="s2">&quot;linear&quot;</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>

    <span class="s1">idx = pd.to_datetime(</span>
        <span class="s1">[</span>
            <span class="s2">&quot;1992-08-27 07:46:48&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;1992-08-27 07:46:51&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;1992-08-27 07:46:54&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;1992-08-27 07:46:57&quot;</span><span class="s0">,</span>
        <span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">expected = Series([</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">index=idx)</span>

    <span class="s1">expected.index._data.freq = </span><span class="s2">&quot;3s&quot;</span>
    <span class="s1">tm.assert_series_equal(result</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">def </span><span class="s1">test_pad_backfill_deprecation():</span>
    <span class="s5"># GH 33396</span>
    <span class="s1">s = Series([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">index=date_range(</span><span class="s2">&quot;20180101&quot;</span><span class="s0">, </span><span class="s1">periods=</span><span class="s3">3</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;h&quot;</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">&quot;backfill&quot;</span><span class="s1">):</span>
        <span class="s1">s.resample(</span><span class="s2">&quot;30min&quot;</span><span class="s1">).backfill()</span>
    <span class="s0">with </span><span class="s1">tm.assert_produces_warning(FutureWarning</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">&quot;pad&quot;</span><span class="s1">):</span>
        <span class="s1">s.resample(</span><span class="s2">&quot;30min&quot;</span><span class="s1">).pad()</span>
</pre>
</body>
</html>