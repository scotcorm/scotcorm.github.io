<html>
<head>
<title>test_packbits.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6897bb;}
.s4 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_packbits.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">assert_array_equal</span><span class="s0">, </span><span class="s1">assert_equal</span><span class="s0">, </span><span class="s1">assert_raises</span>
<span class="s0">import </span><span class="s1">pytest</span>
<span class="s0">from </span><span class="s1">itertools </span><span class="s0">import </span><span class="s1">chain</span>

<span class="s0">def </span><span class="s1">test_packbits():</span>
    <span class="s2"># Copied from the docstring.</span>
    <span class="s1">a = [[[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]]</span><span class="s0">,</span>
         <span class="s1">[[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]]</span>
    <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s4">'?bBhHiIlLqQ'</span><span class="s1">:</span>
        <span class="s1">arr = np.array(a</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
        <span class="s1">b = np.packbits(arr</span><span class="s0">, </span><span class="s1">axis=-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">np.array([[[</span><span class="s3">160</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">64</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">192</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">32</span><span class="s1">]]]))</span>

    <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.packbits</span><span class="s0">, </span><span class="s1">np.array(a</span><span class="s0">, </span><span class="s1">dtype=float))</span>


<span class="s0">def </span><span class="s1">test_packbits_empty():</span>
    <span class="s1">shapes = [</span>
        <span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s4">'?bBhHiIlLqQ'</span><span class="s1">:</span>
        <span class="s0">for </span><span class="s1">shape </span><span class="s0">in </span><span class="s1">shapes:</span>
            <span class="s1">a = np.empty(shape</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">b = np.packbits(a)</span>
            <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
            <span class="s1">assert_equal(b.shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>


<span class="s0">def </span><span class="s1">test_packbits_empty_with_axis():</span>
    <span class="s2"># Original shapes and lists of packed shapes for different axes.</span>
    <span class="s1">shapes = [</span>
        <span class="s1">((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)])</span><span class="s0">,</span>
        <span class="s1">((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)])</span><span class="s0">,</span>
        <span class="s1">((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)])</span><span class="s0">,</span>
        <span class="s1">((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)])</span><span class="s0">,</span>
        <span class="s1">((</span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)])</span><span class="s0">,</span>
        <span class="s1">((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)])</span><span class="s0">,</span>
        <span class="s1">((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)])</span><span class="s0">,</span>
        <span class="s1">((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)])</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s4">'?bBhHiIlLqQ'</span><span class="s1">:</span>
        <span class="s0">for </span><span class="s1">in_shape</span><span class="s0">, </span><span class="s1">out_shapes </span><span class="s0">in </span><span class="s1">shapes:</span>
            <span class="s0">for </span><span class="s1">ax</span><span class="s0">, </span><span class="s1">out_shape </span><span class="s0">in </span><span class="s1">enumerate(out_shapes):</span>
                <span class="s1">a = np.empty(in_shape</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
                <span class="s1">b = np.packbits(a</span><span class="s0">, </span><span class="s1">axis=ax)</span>
                <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
                <span class="s1">assert_equal(b.shape</span><span class="s0">, </span><span class="s1">out_shape)</span>

<span class="s1">@pytest.mark.parametrize(</span><span class="s4">'bitorder'</span><span class="s0">, </span><span class="s1">(</span><span class="s4">'little'</span><span class="s0">, </span><span class="s4">'big'</span><span class="s1">))</span>
<span class="s0">def </span><span class="s1">test_packbits_large(bitorder):</span>
    <span class="s2"># test data large enough for 16 byte vectorization</span>
    <span class="s1">a = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">,</span>
                  <span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
                  <span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">,</span>
                  <span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">,</span>
                  <span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
    <span class="s1">a = a.repeat(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s0">for </span><span class="s1">dtype </span><span class="s0">in </span><span class="s4">'?bBhHiIlLqQ'</span><span class="s1">:</span>
        <span class="s1">arr = np.array(a</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">b = np.packbits(arr</span><span class="s0">, </span><span class="s1">axis=</span><span class="s0">None, </span><span class="s1">bitorder=bitorder)</span>
        <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">r = [</span><span class="s3">252</span><span class="s0">, </span><span class="s3">127</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">254</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">31</span><span class="s0">, </span><span class="s3">240</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">252</span><span class="s0">,</span>
             <span class="s3">113</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">126</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">127</span><span class="s0">, </span><span class="s3">255</span><span class="s0">,</span>
             <span class="s3">227</span><span class="s0">, </span><span class="s3">142</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">31</span><span class="s0">, </span><span class="s3">142</span><span class="s0">, </span><span class="s3">63</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">126</span><span class="s0">, </span><span class="s3">56</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">240</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">63</span><span class="s0">,</span>
             <span class="s3">224</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s3">56</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">112</span><span class="s0">, </span><span class="s3">56</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">240</span><span class="s0">, </span><span class="s3">56</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">112</span><span class="s0">,</span>
             <span class="s3">63</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">199</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">31</span><span class="s0">, </span><span class="s3">143</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">199</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">,</span>
             <span class="s3">255</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">126</span><span class="s0">, </span><span class="s3">63</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s3">63</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">15</span><span class="s0">,</span>
             <span class="s3">199</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">56</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">142</span><span class="s0">, </span><span class="s3">56</span><span class="s0">, </span><span class="s3">227</span><span class="s0">,</span>
             <span class="s3">129</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">129</span><span class="s0">, </span><span class="s3">199</span><span class="s0">, </span><span class="s3">31</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span>
        <span class="s0">if </span><span class="s1">bitorder == </span><span class="s4">'big'</span><span class="s1">:</span>
            <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">r)</span>
        <span class="s2"># equal for size being multiple of 8</span>
        <span class="s1">assert_array_equal(np.unpackbits(b</span><span class="s0">, </span><span class="s1">bitorder=bitorder)[:-</span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">a)</span>

        <span class="s2"># check last byte of different remainders (16 byte vectorization)</span>
        <span class="s1">b = [np.packbits(arr[:-i]</span><span class="s0">, </span><span class="s1">axis=</span><span class="s0">None</span><span class="s1">)[-</span><span class="s3">1</span><span class="s1">] </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">16</span><span class="s1">)]</span>
        <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">[</span><span class="s3">128</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">31</span><span class="s0">, </span><span class="s3">30</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">24</span><span class="s0">, </span><span class="s3">16</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">199</span><span class="s0">,</span>
                               <span class="s3">198</span><span class="s0">, </span><span class="s3">196</span><span class="s0">, </span><span class="s3">192</span><span class="s1">])</span>


        <span class="s1">arr = arr.reshape(</span><span class="s3">36</span><span class="s0">, </span><span class="s3">25</span><span class="s1">)</span>
        <span class="s1">b = np.packbits(arr</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">190</span><span class="s0">, </span><span class="s3">186</span><span class="s0">, </span><span class="s3">178</span><span class="s0">, </span><span class="s3">178</span><span class="s0">, </span><span class="s3">150</span><span class="s0">, </span><span class="s3">215</span><span class="s0">, </span><span class="s3">87</span><span class="s0">, </span><span class="s3">83</span><span class="s0">, </span><span class="s3">83</span><span class="s0">, </span><span class="s3">195</span><span class="s0">,</span>
                                <span class="s3">199</span><span class="s0">, </span><span class="s3">206</span><span class="s0">, </span><span class="s3">204</span><span class="s0">, </span><span class="s3">204</span><span class="s0">, </span><span class="s3">140</span><span class="s0">, </span><span class="s3">140</span><span class="s0">, </span><span class="s3">136</span><span class="s0">, </span><span class="s3">136</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">40</span><span class="s0">, </span><span class="s3">105</span><span class="s0">,</span>
                                <span class="s3">107</span><span class="s0">, </span><span class="s3">75</span><span class="s0">, </span><span class="s3">74</span><span class="s0">, </span><span class="s3">88</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">72</span><span class="s0">, </span><span class="s3">216</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">195</span><span class="s0">, </span><span class="s3">202</span><span class="s0">, </span><span class="s3">90</span><span class="s0">, </span><span class="s3">90</span><span class="s0">, </span><span class="s3">83</span><span class="s0">,</span>
                                <span class="s3">83</span><span class="s0">, </span><span class="s3">119</span><span class="s0">, </span><span class="s3">127</span><span class="s0">, </span><span class="s3">109</span><span class="s0">, </span><span class="s3">73</span><span class="s0">, </span><span class="s3">64</span><span class="s0">, </span><span class="s3">208</span><span class="s0">, </span><span class="s3">244</span><span class="s0">, </span><span class="s3">189</span><span class="s0">, </span><span class="s3">45</span><span class="s0">,</span>
                                <span class="s3">41</span><span class="s0">, </span><span class="s3">104</span><span class="s0">, </span><span class="s3">122</span><span class="s0">, </span><span class="s3">90</span><span class="s0">, </span><span class="s3">18</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">113</span><span class="s0">, </span><span class="s3">120</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">216</span><span class="s0">, </span><span class="s3">152</span><span class="s0">, </span><span class="s3">24</span><span class="s0">, </span><span class="s3">60</span><span class="s0">, </span><span class="s3">52</span><span class="s0">, </span><span class="s3">182</span><span class="s0">, </span><span class="s3">150</span><span class="s0">,</span>
                                <span class="s3">150</span><span class="s0">, </span><span class="s3">150</span><span class="s0">, </span><span class="s3">146</span><span class="s0">, </span><span class="s3">210</span><span class="s0">, </span><span class="s3">210</span><span class="s0">, </span><span class="s3">246</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">223</span><span class="s0">,</span>
                                <span class="s3">151</span><span class="s0">, </span><span class="s3">21</span><span class="s0">, </span><span class="s3">17</span><span class="s0">, </span><span class="s3">17</span><span class="s0">, </span><span class="s3">131</span><span class="s0">, </span><span class="s3">163</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">214</span><span class="s0">, </span><span class="s3">210</span><span class="s0">, </span><span class="s3">210</span><span class="s0">, </span><span class="s3">64</span><span class="s0">, </span><span class="s3">68</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">72</span><span class="s0">, </span><span class="s3">88</span><span class="s0">, </span><span class="s3">92</span><span class="s0">,</span>
                                <span class="s3">92</span><span class="s0">, </span><span class="s3">78</span><span class="s0">, </span><span class="s3">110</span><span class="s0">, </span><span class="s3">39</span><span class="s0">, </span><span class="s3">181</span><span class="s0">, </span><span class="s3">149</span><span class="s0">, </span><span class="s3">220</span><span class="s0">, </span><span class="s3">222</span><span class="s0">, </span><span class="s3">218</span><span class="s0">, </span><span class="s3">218</span><span class="s0">,</span>
                                <span class="s3">202</span><span class="s0">, </span><span class="s3">234</span><span class="s0">, </span><span class="s3">170</span><span class="s0">, </span><span class="s3">168</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">80</span><span class="s0">, </span><span class="s3">112</span><span class="s0">, </span><span class="s3">48</span><span class="s0">, </span><span class="s3">160</span><span class="s0">, </span><span class="s3">160</span><span class="s0">, </span><span class="s3">224</span><span class="s0">,</span>
                                <span class="s3">240</span><span class="s0">, </span><span class="s3">208</span><span class="s0">, </span><span class="s3">144</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">160</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">240</span><span class="s0">, </span><span class="s3">208</span><span class="s0">, </span><span class="s3">144</span><span class="s0">,</span>
                                <span class="s3">144</span><span class="s0">, </span><span class="s3">176</span><span class="s0">, </span><span class="s3">240</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]])</span>

        <span class="s1">b = np.packbits(arr</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">252</span><span class="s0">, </span><span class="s3">127</span><span class="s0">, </span><span class="s3">192</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">7</span><span class="s0">, </span><span class="s3">252</span><span class="s0">,  </span><span class="s3">15</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">240</span><span class="s0">,   </span><span class="s3">0</span><span class="s0">,  </span><span class="s3">28</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">255</span><span class="s0">, </span><span class="s3">128</span><span class="s0">,   </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">192</span><span class="s0">,  </span><span class="s3">31</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">142</span><span class="s0">,  </span><span class="s3">63</span><span class="s0">,   </span><span class="s3">0</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">255</span><span class="s0">, </span><span class="s3">240</span><span class="s0">,   </span><span class="s3">7</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">7</span><span class="s0">, </span><span class="s3">224</span><span class="s0">,  </span><span class="s3">14</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">126</span><span class="s0">,   </span><span class="s3">0</span><span class="s0">, </span><span class="s3">224</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">255</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">199</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">56</span><span class="s0">,  </span><span class="s3">28</span><span class="s0">, </span><span class="s3">126</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">113</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">227</span><span class="s0">, </span><span class="s3">142</span><span class="s0">,  </span><span class="s3">63</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">0</span><span class="s0">,  </span><span class="s3">28</span><span class="s0">, </span><span class="s3">112</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">15</span><span class="s0">, </span><span class="s3">248</span><span class="s0">,   </span><span class="s3">3</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">28</span><span class="s0">, </span><span class="s3">126</span><span class="s0">,  </span><span class="s3">56</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">56</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">240</span><span class="s0">,   </span><span class="s3">7</span><span class="s0">, </span><span class="s3">224</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">227</span><span class="s0">, </span><span class="s3">129</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">255</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">254</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">126</span><span class="s0">,   </span><span class="s3">0</span><span class="s0">, </span><span class="s3">224</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">3</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">248</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">0</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">128</span><span class="s0">,   </span><span class="s3">0</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">224</span><span class="s0">,   </span><span class="s3">1</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">248</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">126</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">0</span><span class="s0">,   </span><span class="s3">7</span><span class="s0">,   </span><span class="s3">3</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">224</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">248</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">0</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">127</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">142</span><span class="s0">,  </span><span class="s3">63</span><span class="s0">, </span><span class="s3">224</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">224</span><span class="s0">,  </span><span class="s3">14</span><span class="s0">,  </span><span class="s3">63</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">7</span><span class="s0">,   </span><span class="s3">3</span><span class="s0">, </span><span class="s3">128</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">113</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">28</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">199</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">7</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">142</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">14</span><span class="s0">,  </span><span class="s3">56</span><span class="s0">, </span><span class="s3">252</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]])</span>

        <span class="s1">arr = arr.T.copy()</span>
        <span class="s1">b = np.packbits(arr</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">252</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">240</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">142</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">126</span><span class="s0">, </span><span class="s3">255</span><span class="s0">,</span>
                                <span class="s3">56</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">56</span><span class="s0">, </span><span class="s3">240</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">255</span><span class="s0">,</span>
                                <span class="s3">126</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">142</span><span class="s0">, </span><span class="s3">224</span><span class="s0">,</span>
                                <span class="s3">7</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">14</span><span class="s1">]</span><span class="s0">,</span>
                                <span class="s1">[</span><span class="s3">127</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">31</span><span class="s0">, </span><span class="s3">63</span><span class="s0">, </span><span class="s3">240</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">255</span><span class="s0">,</span>
                                 <span class="s3">28</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">142</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">126</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">129</span><span class="s0">, </span><span class="s3">255</span><span class="s0">,</span>
                                 <span class="s3">0</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">252</span><span class="s0">, </span><span class="s3">63</span><span class="s0">, </span><span class="s3">14</span><span class="s0">,</span>
                                 <span class="s3">3</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">56</span><span class="s1">]</span><span class="s0">,</span>
                                <span class="s1">[</span><span class="s3">192</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s3">28</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">199</span><span class="s0">, </span><span class="s3">126</span><span class="s0">,</span>
                                 <span class="s3">227</span><span class="s0">, </span><span class="s3">63</span><span class="s0">, </span><span class="s3">112</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">56</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">192</span><span class="s0">, </span><span class="s3">254</span><span class="s0">, </span><span class="s3">224</span><span class="s0">,</span>
                                 <span class="s3">248</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">126</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">127</span><span class="s0">, </span><span class="s3">224</span><span class="s0">, </span><span class="s3">63</span><span class="s0">,</span>
                                 <span class="s3">128</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">199</span><span class="s0">, </span><span class="s3">142</span><span class="s0">, </span><span class="s3">252</span><span class="s1">]</span><span class="s0">,</span>
                                <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">,</span>
                                 <span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">128</span><span class="s0">,</span>
                                 <span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">128</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]])</span>

        <span class="s1">b = np.packbits(arr</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">190</span><span class="s0">,  </span><span class="s3">72</span><span class="s0">, </span><span class="s3">113</span><span class="s0">, </span><span class="s3">214</span><span class="s0">,   </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">186</span><span class="s0">, </span><span class="s3">216</span><span class="s0">, </span><span class="s3">120</span><span class="s0">, </span><span class="s3">210</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">178</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">248</span><span class="s0">, </span><span class="s3">210</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">178</span><span class="s0">, </span><span class="s3">241</span><span class="s0">, </span><span class="s3">216</span><span class="s0">,  </span><span class="s3">64</span><span class="s0">, </span><span class="s3">192</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">150</span><span class="s0">, </span><span class="s3">227</span><span class="s0">, </span><span class="s3">152</span><span class="s0">,  </span><span class="s3">68</span><span class="s0">,  </span><span class="s3">80</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">215</span><span class="s0">, </span><span class="s3">195</span><span class="s0">,  </span><span class="s3">24</span><span class="s0">,   </span><span class="s3">5</span><span class="s0">, </span><span class="s3">112</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">87</span><span class="s0">, </span><span class="s3">202</span><span class="s0">,  </span><span class="s3">60</span><span class="s0">,   </span><span class="s3">5</span><span class="s0">,  </span><span class="s3">48</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">83</span><span class="s0">,  </span><span class="s3">90</span><span class="s0">,  </span><span class="s3">52</span><span class="s0">,   </span><span class="s3">1</span><span class="s0">, </span><span class="s3">160</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">83</span><span class="s0">,  </span><span class="s3">90</span><span class="s0">, </span><span class="s3">182</span><span class="s0">,  </span><span class="s3">72</span><span class="s0">, </span><span class="s3">160</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">195</span><span class="s0">,  </span><span class="s3">83</span><span class="s0">, </span><span class="s3">150</span><span class="s0">,  </span><span class="s3">88</span><span class="s0">, </span><span class="s3">224</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">199</span><span class="s0">,  </span><span class="s3">83</span><span class="s0">, </span><span class="s3">150</span><span class="s0">,  </span><span class="s3">92</span><span class="s0">, </span><span class="s3">240</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">206</span><span class="s0">, </span><span class="s3">119</span><span class="s0">, </span><span class="s3">150</span><span class="s0">,  </span><span class="s3">92</span><span class="s0">, </span><span class="s3">208</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">204</span><span class="s0">, </span><span class="s3">127</span><span class="s0">, </span><span class="s3">146</span><span class="s0">,  </span><span class="s3">78</span><span class="s0">, </span><span class="s3">144</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">204</span><span class="s0">, </span><span class="s3">109</span><span class="s0">, </span><span class="s3">210</span><span class="s0">, </span><span class="s3">110</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">140</span><span class="s0">,  </span><span class="s3">73</span><span class="s0">, </span><span class="s3">210</span><span class="s0">,  </span><span class="s3">39</span><span class="s0">, </span><span class="s3">160</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">140</span><span class="s0">,  </span><span class="s3">64</span><span class="s0">, </span><span class="s3">246</span><span class="s0">, </span><span class="s3">181</span><span class="s0">, </span><span class="s3">224</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">136</span><span class="s0">, </span><span class="s3">208</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">149</span><span class="s0">, </span><span class="s3">240</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">136</span><span class="s0">, </span><span class="s3">244</span><span class="s0">, </span><span class="s3">255</span><span class="s0">, </span><span class="s3">220</span><span class="s0">, </span><span class="s3">208</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[  </span><span class="s3">8</span><span class="s0">, </span><span class="s3">189</span><span class="s0">, </span><span class="s3">223</span><span class="s0">, </span><span class="s3">222</span><span class="s0">, </span><span class="s3">144</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">40</span><span class="s0">,  </span><span class="s3">45</span><span class="s0">, </span><span class="s3">151</span><span class="s0">, </span><span class="s3">218</span><span class="s0">, </span><span class="s3">144</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">105</span><span class="s0">,  </span><span class="s3">41</span><span class="s0">,  </span><span class="s3">21</span><span class="s0">, </span><span class="s3">218</span><span class="s0">, </span><span class="s3">176</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[</span><span class="s3">107</span><span class="s0">, </span><span class="s3">104</span><span class="s0">,  </span><span class="s3">17</span><span class="s0">, </span><span class="s3">202</span><span class="s0">, </span><span class="s3">240</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">75</span><span class="s0">, </span><span class="s3">122</span><span class="s0">,  </span><span class="s3">17</span><span class="s0">, </span><span class="s3">234</span><span class="s0">, </span><span class="s3">224</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">74</span><span class="s0">,  </span><span class="s3">90</span><span class="s0">, </span><span class="s3">131</span><span class="s0">, </span><span class="s3">170</span><span class="s0">, </span><span class="s3">192</span><span class="s1">]</span><span class="s0">,</span>
                               <span class="s1">[ </span><span class="s3">88</span><span class="s0">,  </span><span class="s3">18</span><span class="s0">, </span><span class="s3">163</span><span class="s0">, </span><span class="s3">168</span><span class="s0">, </span><span class="s3">128</span><span class="s1">]])</span>


    <span class="s2"># result is the same if input is multiplied with a nonzero value</span>
    <span class="s0">for </span><span class="s1">dtype </span><span class="s0">in </span><span class="s4">'bBhHiIlLqQ'</span><span class="s1">:</span>
        <span class="s1">arr = np.array(a</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">rnd = np.random.randint(low=np.iinfo(dtype).min</span><span class="s0">,</span>
                                <span class="s1">high=np.iinfo(dtype).max</span><span class="s0">, </span><span class="s1">size=arr.size</span><span class="s0">,</span>
                                <span class="s1">dtype=dtype)</span>
        <span class="s1">rnd[rnd == </span><span class="s3">0</span><span class="s1">] = </span><span class="s3">1</span>
        <span class="s1">arr *= rnd.astype(dtype)</span>
        <span class="s1">b = np.packbits(arr</span><span class="s0">, </span><span class="s1">axis=-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(np.unpackbits(b)[:-</span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">a)</span>

    <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.packbits</span><span class="s0">, </span><span class="s1">np.array(a</span><span class="s0">, </span><span class="s1">dtype=float))</span>


<span class="s0">def </span><span class="s1">test_packbits_very_large():</span>
    <span class="s2"># test some with a larger arrays gh-8637</span>
    <span class="s2"># code is covered earlier but larger array makes crash on bug more likely</span>
    <span class="s0">for </span><span class="s1">s </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">950</span><span class="s0">, </span><span class="s3">1050</span><span class="s1">):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s4">'?bBhHiIlLqQ'</span><span class="s1">:</span>
            <span class="s1">x = np.ones((</span><span class="s3">200</span><span class="s0">, </span><span class="s1">s)</span><span class="s0">, </span><span class="s1">dtype=bool)</span>
            <span class="s1">np.packbits(x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_unpackbits():</span>
    <span class="s2"># Copied from the docstring.</span>
    <span class="s1">a = np.array([[</span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">7</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">23</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
    <span class="s1">b = np.unpackbits(a</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
    <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">np.array([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                                    <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                                    <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]))</span>

<span class="s0">def </span><span class="s1">test_pack_unpack_order():</span>
    <span class="s1">a = np.array([[</span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">7</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">23</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
    <span class="s1">b = np.unpackbits(a</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
    <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
    <span class="s1">b_little = np.unpackbits(a</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">bitorder=</span><span class="s4">'little'</span><span class="s1">)</span>
    <span class="s1">b_big = np.unpackbits(a</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">bitorder=</span><span class="s4">'big'</span><span class="s1">)</span>
    <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">b_big)</span>
    <span class="s1">assert_array_equal(a</span><span class="s0">, </span><span class="s1">np.packbits(b_little</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">bitorder=</span><span class="s4">'little'</span><span class="s1">))</span>
    <span class="s1">assert_array_equal(b[:</span><span class="s0">,</span><span class="s1">::-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">b_little)</span>
    <span class="s1">assert_array_equal(a</span><span class="s0">, </span><span class="s1">np.packbits(b_big</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">bitorder=</span><span class="s4">'big'</span><span class="s1">))</span>
    <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.unpackbits</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">bitorder=</span><span class="s4">'r'</span><span class="s1">)</span>
    <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">np.unpackbits</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">bitorder=</span><span class="s3">10</span><span class="s1">)</span>



<span class="s0">def </span><span class="s1">test_unpackbits_empty():</span>
    <span class="s1">a = np.empty((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
    <span class="s1">b = np.unpackbits(a)</span>
    <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
    <span class="s1">assert_array_equal(b</span><span class="s0">, </span><span class="s1">np.empty((</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)))</span>


<span class="s0">def </span><span class="s1">test_unpackbits_empty_with_axis():</span>
    <span class="s2"># Lists of packed shapes for different axes and unpacked shapes.</span>
    <span class="s1">shapes = [</span>
        <span class="s1">([(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span><span class="s0">,</span>
        <span class="s1">([(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">16</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">16</span><span class="s0">, </span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">(</span><span class="s3">16</span><span class="s0">, </span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s1">))</span><span class="s0">,</span>
        <span class="s1">([(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">16</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">16</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">(</span><span class="s3">16</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s1">))</span><span class="s0">,</span>
        <span class="s1">([(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">16</span><span class="s0">, </span><span class="s3">24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">16</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">16</span><span class="s0">, </span><span class="s3">24</span><span class="s1">))</span><span class="s0">,</span>
        <span class="s1">([(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">(</span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">))</span><span class="s0">,</span>
        <span class="s1">([(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s0">, </span><span class="s3">0</span><span class="s1">))</span><span class="s0">,</span>
        <span class="s1">([(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">24</span><span class="s1">))</span><span class="s0">,</span>
        <span class="s1">([(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">))</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s0">for </span><span class="s1">in_shapes</span><span class="s0">, </span><span class="s1">out_shape </span><span class="s0">in </span><span class="s1">shapes:</span>
        <span class="s0">for </span><span class="s1">ax</span><span class="s0">, </span><span class="s1">in_shape </span><span class="s0">in </span><span class="s1">enumerate(in_shapes):</span>
            <span class="s1">a = np.empty(in_shape</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
            <span class="s1">b = np.unpackbits(a</span><span class="s0">, </span><span class="s1">axis=ax)</span>
            <span class="s1">assert_equal(b.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
            <span class="s1">assert_equal(b.shape</span><span class="s0">, </span><span class="s1">out_shape)</span>


<span class="s0">def </span><span class="s1">test_unpackbits_large():</span>
    <span class="s2"># test all possible numbers via comparison to already tested packbits</span>
    <span class="s1">d = np.arange(</span><span class="s3">277</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
    <span class="s1">assert_array_equal(np.packbits(np.unpackbits(d))</span><span class="s0">, </span><span class="s1">d)</span>
    <span class="s1">assert_array_equal(np.packbits(np.unpackbits(d[::</span><span class="s3">2</span><span class="s1">]))</span><span class="s0">, </span><span class="s1">d[::</span><span class="s3">2</span><span class="s1">])</span>
    <span class="s1">d = np.tile(d</span><span class="s0">, </span><span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
    <span class="s1">assert_array_equal(np.packbits(np.unpackbits(d</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">d)</span>
    <span class="s1">d = d.T.copy()</span>
    <span class="s1">assert_array_equal(np.packbits(np.unpackbits(d</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">d)</span>


<span class="s0">class </span><span class="s1">TestCount():</span>
    <span class="s1">x = np.array([</span>
        <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
    <span class="s1">padded1 = np.zeros(</span><span class="s3">57</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
    <span class="s1">padded1[:</span><span class="s3">49</span><span class="s1">] = x.ravel()</span>
    <span class="s1">padded1b = np.zeros(</span><span class="s3">57</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
    <span class="s1">padded1b[:</span><span class="s3">49</span><span class="s1">] = x[::-</span><span class="s3">1</span><span class="s1">].copy().ravel()</span>
    <span class="s1">padded2 = np.zeros((</span><span class="s3">9</span><span class="s0">, </span><span class="s3">9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=np.uint8)</span>
    <span class="s1">padded2[:</span><span class="s3">7</span><span class="s0">, </span><span class="s1">:</span><span class="s3">7</span><span class="s1">] = x</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">'bitorder'</span><span class="s0">, </span><span class="s1">(</span><span class="s4">'little'</span><span class="s0">, </span><span class="s4">'big'</span><span class="s1">))</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">'count'</span><span class="s0">, </span><span class="s1">chain(range(</span><span class="s3">58</span><span class="s1">)</span><span class="s0">, </span><span class="s1">range(-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">57</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)))</span>
    <span class="s0">def </span><span class="s1">test_roundtrip(self</span><span class="s0">, </span><span class="s1">bitorder</span><span class="s0">, </span><span class="s1">count):</span>
        <span class="s0">if </span><span class="s1">count &lt; </span><span class="s3">0</span><span class="s1">:</span>
            <span class="s2"># one extra zero of padding</span>
            <span class="s1">cutoff = count - </span><span class="s3">1</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">cutoff = count</span>
        <span class="s2"># test complete invertibility of packbits and unpackbits with count</span>
        <span class="s1">packed = np.packbits(self.x</span><span class="s0">, </span><span class="s1">bitorder=bitorder)</span>
        <span class="s1">unpacked = np.unpackbits(packed</span><span class="s0">, </span><span class="s1">count=count</span><span class="s0">, </span><span class="s1">bitorder=bitorder)</span>
        <span class="s1">assert_equal(unpacked.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(unpacked</span><span class="s0">, </span><span class="s1">self.padded1[:cutoff])</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">'kwargs'</span><span class="s0">, </span><span class="s1">[</span>
                    <span class="s1">{}</span><span class="s0">, </span><span class="s1">{</span><span class="s4">'count'</span><span class="s1">: </span><span class="s0">None</span><span class="s1">}</span><span class="s0">,</span>
                    <span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_count(self</span><span class="s0">, </span><span class="s1">kwargs):</span>
        <span class="s1">packed = np.packbits(self.x)</span>
        <span class="s1">unpacked = np.unpackbits(packed</span><span class="s0">, </span><span class="s1">**kwargs)</span>
        <span class="s1">assert_equal(unpacked.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(unpacked</span><span class="s0">, </span><span class="s1">self.padded1[:-</span><span class="s3">1</span><span class="s1">])</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">'bitorder'</span><span class="s0">, </span><span class="s1">(</span><span class="s4">'little'</span><span class="s0">, </span><span class="s4">'big'</span><span class="s1">))</span>
    <span class="s2"># delta==-1 when count&lt;0 because one extra zero of padding</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">'count'</span><span class="s0">, </span><span class="s1">chain(range(</span><span class="s3">8</span><span class="s1">)</span><span class="s0">, </span><span class="s1">range(-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">9</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)))</span>
    <span class="s0">def </span><span class="s1">test_roundtrip_axis(self</span><span class="s0">, </span><span class="s1">bitorder</span><span class="s0">, </span><span class="s1">count):</span>
        <span class="s0">if </span><span class="s1">count &lt; </span><span class="s3">0</span><span class="s1">:</span>
            <span class="s2"># one extra zero of padding</span>
            <span class="s1">cutoff = count - </span><span class="s3">1</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">cutoff = count</span>
        <span class="s1">packed0 = np.packbits(self.x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">bitorder=bitorder)</span>
        <span class="s1">unpacked0 = np.unpackbits(packed0</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">count=count</span><span class="s0">,</span>
                                  <span class="s1">bitorder=bitorder)</span>
        <span class="s1">assert_equal(unpacked0.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(unpacked0</span><span class="s0">, </span><span class="s1">self.padded2[:cutoff</span><span class="s0">, </span><span class="s1">:self.x.shape[</span><span class="s3">1</span><span class="s1">]])</span>

        <span class="s1">packed1 = np.packbits(self.x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">bitorder=bitorder)</span>
        <span class="s1">unpacked1 = np.unpackbits(packed1</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">count=count</span><span class="s0">,</span>
                                  <span class="s1">bitorder=bitorder)</span>
        <span class="s1">assert_equal(unpacked1.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s1">assert_array_equal(unpacked1</span><span class="s0">, </span><span class="s1">self.padded2[:self.x.shape[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">:cutoff])</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s4">'kwargs'</span><span class="s0">, </span><span class="s1">[</span>
                    <span class="s1">{}</span><span class="s0">, </span><span class="s1">{</span><span class="s4">'count'</span><span class="s1">: </span><span class="s0">None</span><span class="s1">}</span><span class="s0">,</span>
                    <span class="s1">{</span><span class="s4">'bitorder' </span><span class="s1">: </span><span class="s4">'little'</span><span class="s1">}</span><span class="s0">,</span>
                    <span class="s1">{</span><span class="s4">'bitorder'</span><span class="s1">: </span><span class="s4">'little'</span><span class="s0">, </span><span class="s4">'count'</span><span class="s1">: </span><span class="s0">None</span><span class="s1">}</span><span class="s0">,</span>
                    <span class="s1">{</span><span class="s4">'bitorder' </span><span class="s1">: </span><span class="s4">'big'</span><span class="s1">}</span><span class="s0">,</span>
                    <span class="s1">{</span><span class="s4">'bitorder'</span><span class="s1">: </span><span class="s4">'big'</span><span class="s0">, </span><span class="s4">'count'</span><span class="s1">: </span><span class="s0">None</span><span class="s1">}</span><span class="s0">,</span>
                    <span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_axis_count(self</span><span class="s0">, </span><span class="s1">kwargs):</span>
        <span class="s1">packed0 = np.packbits(self.x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">unpacked0 = np.unpackbits(packed0</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">**kwargs)</span>
        <span class="s1">assert_equal(unpacked0.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s0">if </span><span class="s1">kwargs.get(</span><span class="s4">'bitorder'</span><span class="s0">, </span><span class="s4">'big'</span><span class="s1">) == </span><span class="s4">'big'</span><span class="s1">:</span>
            <span class="s1">assert_array_equal(unpacked0</span><span class="s0">, </span><span class="s1">self.padded2[:-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">:self.x.shape[</span><span class="s3">1</span><span class="s1">]])</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_array_equal(unpacked0[::-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">:]</span><span class="s0">, </span><span class="s1">self.padded2[:-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">:self.x.shape[</span><span class="s3">1</span><span class="s1">]])</span>

        <span class="s1">packed1 = np.packbits(self.x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">unpacked1 = np.unpackbits(packed1</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">**kwargs)</span>
        <span class="s1">assert_equal(unpacked1.dtype</span><span class="s0">, </span><span class="s1">np.uint8)</span>
        <span class="s0">if </span><span class="s1">kwargs.get(</span><span class="s4">'bitorder'</span><span class="s0">, </span><span class="s4">'big'</span><span class="s1">) == </span><span class="s4">'big'</span><span class="s1">:</span>
            <span class="s1">assert_array_equal(unpacked1</span><span class="s0">, </span><span class="s1">self.padded2[:self.x.shape[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">:-</span><span class="s3">1</span><span class="s1">])</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_array_equal(unpacked1[:</span><span class="s0">, </span><span class="s1">::-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">self.padded2[:self.x.shape[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">:-</span><span class="s3">1</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_bad_count(self):</span>
        <span class="s1">packed0 = np.packbits(self.x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.unpackbits</span><span class="s0">, </span><span class="s1">packed0</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">count=-</span><span class="s3">9</span><span class="s1">)</span>
        <span class="s1">packed1 = np.packbits(self.x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.unpackbits</span><span class="s0">, </span><span class="s1">packed1</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">count=-</span><span class="s3">9</span><span class="s1">)</span>
        <span class="s1">packed = np.packbits(self.x)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">np.unpackbits</span><span class="s0">, </span><span class="s1">packed</span><span class="s0">, </span><span class="s1">count=-</span><span class="s3">57</span><span class="s1">)</span>
</pre>
</body>
</html>