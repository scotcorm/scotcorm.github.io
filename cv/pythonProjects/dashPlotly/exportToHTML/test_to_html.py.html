<html>
<head>
<title>test_to_html.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #629755; font-style: italic;}
.s4 { color: #6897bb;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_to_html.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">datetime </span><span class="s0">import </span><span class="s1">datetime</span>
<span class="s0">from </span><span class="s1">io </span><span class="s0">import </span><span class="s1">StringIO</span>
<span class="s0">import </span><span class="s1">re</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">from </span><span class="s1">pandas </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">DataFrame</span><span class="s0">,</span>
    <span class="s1">Index</span><span class="s0">,</span>
    <span class="s1">MultiIndex</span><span class="s0">,</span>
    <span class="s1">option_context</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">import </span><span class="s1">pandas._testing </span><span class="s0">as </span><span class="s1">tm</span>

<span class="s0">import </span><span class="s1">pandas.io.formats.format </span><span class="s0">as </span><span class="s1">fmt</span>

<span class="s1">lorem_ipsum = (</span>
    <span class="s2">&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod &quot;</span>
    <span class="s2">&quot;tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim &quot;</span>
    <span class="s2">&quot;veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex &quot;</span>
    <span class="s2">&quot;ea commodo consequat. Duis aute irure dolor in reprehenderit in &quot;</span>
    <span class="s2">&quot;voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur &quot;</span>
    <span class="s2">&quot;sint occaecat cupidatat non proident, sunt in culpa qui officia &quot;</span>
    <span class="s2">&quot;deserunt mollit anim id est laborum.&quot;</span>
<span class="s1">)</span>


<span class="s0">def </span><span class="s1">expected_html(datapath</span><span class="s0">, </span><span class="s1">name):</span>
    <span class="s3">&quot;&quot;&quot; 
    Read HTML file from formats data directory. 
 
    Parameters 
    ---------- 
    datapath : pytest fixture 
        The datapath fixture injected into a test by pytest. 
    name : str 
        The name of the HTML file without the suffix. 
 
    Returns 
    ------- 
    str : contents of HTML file. 
    &quot;&quot;&quot;</span>
    <span class="s1">filename = </span><span class="s2">&quot;.&quot;</span><span class="s1">.join([name</span><span class="s0">, </span><span class="s2">&quot;html&quot;</span><span class="s1">])</span>
    <span class="s1">filepath = datapath(</span><span class="s2">&quot;io&quot;</span><span class="s0">, </span><span class="s2">&quot;formats&quot;</span><span class="s0">, </span><span class="s2">&quot;data&quot;</span><span class="s0">, </span><span class="s2">&quot;html&quot;</span><span class="s0">, </span><span class="s1">filename)</span>
    <span class="s0">with </span><span class="s1">open(filepath</span><span class="s0">, </span><span class="s1">encoding=</span><span class="s2">&quot;utf-8&quot;</span><span class="s1">) </span><span class="s0">as </span><span class="s1">f:</span>
        <span class="s1">html = f.read()</span>
    <span class="s0">return </span><span class="s1">html.rstrip()</span>


<span class="s1">@pytest.fixture(params=[</span><span class="s2">&quot;mixed&quot;</span><span class="s0">, </span><span class="s2">&quot;empty&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">biggie_df_fixture(request):</span>
    <span class="s3">&quot;&quot;&quot;Fixture for a big mixed Dataframe and an empty Dataframe&quot;&quot;&quot;</span>
    <span class="s0">if </span><span class="s1">request.param == </span><span class="s2">&quot;mixed&quot;</span><span class="s1">:</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span><span class="s2">&quot;A&quot;</span><span class="s1">: np.random.randn(</span><span class="s4">200</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">: tm.makeStringIndex(</span><span class="s4">200</span><span class="s1">)}</span><span class="s0">,</span>
            <span class="s1">index=np.arange(</span><span class="s4">200</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">)</span>
        <span class="s1">df.loc[:</span><span class="s4">20</span><span class="s0">, </span><span class="s2">&quot;A&quot;</span><span class="s1">] = np.nan</span>
        <span class="s1">df.loc[:</span><span class="s4">20</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">] = np.nan</span>
        <span class="s0">return </span><span class="s1">df</span>
    <span class="s0">elif </span><span class="s1">request.param == </span><span class="s2">&quot;empty&quot;</span><span class="s1">:</span>
        <span class="s1">df = DataFrame(index=np.arange(</span><span class="s4">200</span><span class="s1">))</span>
        <span class="s0">return </span><span class="s1">df</span>


<span class="s1">@pytest.fixture(params=fmt._VALID_JUSTIFY_PARAMETERS)</span>
<span class="s0">def </span><span class="s1">justify(request):</span>
    <span class="s0">return </span><span class="s1">request.param</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;col_space&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s4">30</span><span class="s0">, </span><span class="s4">50</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_to_html_with_col_space(col_space):</span>
    <span class="s1">df = DataFrame(np.random.random(size=(</span><span class="s4">1</span><span class="s0">, </span><span class="s4">3</span><span class="s1">)))</span>
    <span class="s5"># check that col_space affects HTML generation</span>
    <span class="s5"># and be very brittle about it.</span>
    <span class="s1">result = df.to_html(col_space=col_space)</span>
    <span class="s1">hdrs = [x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">result.split(</span><span class="s2">r&quot;\n&quot;</span><span class="s1">) </span><span class="s0">if </span><span class="s1">re.search(</span><span class="s2">r&quot;&lt;th[&gt;\s]&quot;</span><span class="s0">, </span><span class="s1">x)]</span>
    <span class="s0">assert </span><span class="s1">len(hdrs) &gt; </span><span class="s4">0</span>
    <span class="s0">for </span><span class="s1">h </span><span class="s0">in </span><span class="s1">hdrs:</span>
        <span class="s0">assert </span><span class="s2">&quot;min-width&quot; </span><span class="s0">in </span><span class="s1">h</span>
        <span class="s0">assert </span><span class="s1">str(col_space) </span><span class="s0">in </span><span class="s1">h</span>


<span class="s0">def </span><span class="s1">test_to_html_with_column_specific_col_space_raises():</span>
    <span class="s1">df = DataFrame(np.random.random(size=(</span><span class="s4">3</span><span class="s0">, </span><span class="s4">3</span><span class="s1">))</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">])</span>

    <span class="s1">msg = (</span>
        <span class="s2">&quot;Col_space length</span><span class="s0">\\</span><span class="s2">(</span><span class="s0">\\</span><span class="s2">d+</span><span class="s0">\\</span><span class="s2">) should match &quot;</span>
        <span class="s2">&quot;DataFrame number of columns</span><span class="s0">\\</span><span class="s2">(</span><span class="s0">\\</span><span class="s2">d+</span><span class="s0">\\</span><span class="s2">)&quot;</span>
    <span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">df.to_html(col_space=[</span><span class="s4">30</span><span class="s0">, </span><span class="s4">40</span><span class="s1">])</span>

    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">df.to_html(col_space=[</span><span class="s4">30</span><span class="s0">, </span><span class="s4">40</span><span class="s0">, </span><span class="s4">50</span><span class="s0">, </span><span class="s4">60</span><span class="s1">])</span>

    <span class="s1">msg = </span><span class="s2">&quot;unknown column&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">df.to_html(col_space={</span><span class="s2">&quot;a&quot;</span><span class="s1">: </span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">: </span><span class="s4">23</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">: </span><span class="s4">34</span><span class="s1">})</span>


<span class="s0">def </span><span class="s1">test_to_html_with_column_specific_col_space():</span>
    <span class="s1">df = DataFrame(np.random.random(size=(</span><span class="s4">3</span><span class="s0">, </span><span class="s4">3</span><span class="s1">))</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">])</span>

    <span class="s1">result = df.to_html(col_space={</span><span class="s2">&quot;a&quot;</span><span class="s1">: </span><span class="s2">&quot;2em&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">: </span><span class="s4">23</span><span class="s1">})</span>
    <span class="s1">hdrs = [x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">result.split(</span><span class="s2">&quot;</span><span class="s0">\n</span><span class="s2">&quot;</span><span class="s1">) </span><span class="s0">if </span><span class="s1">re.search(</span><span class="s2">r&quot;&lt;th[&gt;\s]&quot;</span><span class="s0">, </span><span class="s1">x)]</span>
    <span class="s0">assert </span><span class="s2">'min-width: 2em;&quot;&gt;a&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs[</span><span class="s4">1</span><span class="s1">]</span>
    <span class="s0">assert </span><span class="s2">'min-width: 23px;&quot;&gt;b&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs[</span><span class="s4">2</span><span class="s1">]</span>
    <span class="s0">assert </span><span class="s2">&quot;&lt;th&gt;c&lt;/th&gt;&quot; </span><span class="s0">in </span><span class="s1">hdrs[</span><span class="s4">3</span><span class="s1">]</span>

    <span class="s1">result = df.to_html(col_space=[</span><span class="s2">&quot;1em&quot;</span><span class="s0">, </span><span class="s4">2</span><span class="s0">, </span><span class="s4">3</span><span class="s1">])</span>
    <span class="s1">hdrs = [x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">result.split(</span><span class="s2">&quot;</span><span class="s0">\n</span><span class="s2">&quot;</span><span class="s1">) </span><span class="s0">if </span><span class="s1">re.search(</span><span class="s2">r&quot;&lt;th[&gt;\s]&quot;</span><span class="s0">, </span><span class="s1">x)]</span>
    <span class="s0">assert </span><span class="s2">'min-width: 1em;&quot;&gt;a&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs[</span><span class="s4">1</span><span class="s1">]</span>
    <span class="s0">assert </span><span class="s2">'min-width: 2px;&quot;&gt;b&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs[</span><span class="s4">2</span><span class="s1">]</span>
    <span class="s0">assert </span><span class="s2">'min-width: 3px;&quot;&gt;c&lt;/th&gt;' </span><span class="s0">in </span><span class="s1">hdrs[</span><span class="s4">3</span><span class="s1">]</span>


<span class="s0">def </span><span class="s1">test_to_html_with_empty_string_label():</span>
    <span class="s5"># GH 3547, to_html regards empty string labels as repeated labels</span>
    <span class="s1">data = {</span><span class="s2">&quot;c1&quot;</span><span class="s1">: [</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;c2&quot;</span><span class="s1">: [</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;data&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]}</span>
    <span class="s1">df = DataFrame(data).set_index([</span><span class="s2">&quot;c1&quot;</span><span class="s0">, </span><span class="s2">&quot;c2&quot;</span><span class="s1">])</span>
    <span class="s1">result = df.to_html()</span>
    <span class="s0">assert </span><span class="s2">&quot;rowspan&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;df,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(DataFrame({</span><span class="s2">&quot;</span><span class="s0">\u03c3</span><span class="s2">&quot;</span><span class="s1">: np.arange(</span><span class="s4">10.0</span><span class="s1">)})</span><span class="s0">, </span><span class="s2">&quot;unicode_1&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(DataFrame({</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s2">&quot;</span><span class="s0">\u03c3</span><span class="s2">&quot;</span><span class="s1">]})</span><span class="s0">, </span><span class="s2">&quot;unicode_2&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_unicode(df</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">result = df.to_html()</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_encoding(float_frame</span><span class="s0">, </span><span class="s1">tmp_path):</span>
    <span class="s5"># GH 28663</span>
    <span class="s1">path = tmp_path / </span><span class="s2">&quot;test.html&quot;</span>
    <span class="s1">float_frame.to_html(path</span><span class="s0">, </span><span class="s1">encoding=</span><span class="s2">&quot;gbk&quot;</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">open(str(path)</span><span class="s0">, </span><span class="s1">encoding=</span><span class="s2">&quot;gbk&quot;</span><span class="s1">) </span><span class="s0">as </span><span class="s1">f:</span>
        <span class="s0">assert </span><span class="s1">float_frame.to_html() == f.read()</span>


<span class="s0">def </span><span class="s1">test_to_html_decimal(datapath):</span>
    <span class="s5"># GH 12031</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">6.0</span><span class="s0">, </span><span class="s4">3.1</span><span class="s0">, </span><span class="s4">2.2</span><span class="s1">]})</span>
    <span class="s1">result = df.to_html(decimal=</span><span class="s2">&quot;,&quot;</span><span class="s1">)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;gh12031_expected_output&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;kwargs,string,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">({}</span><span class="s0">, </span><span class="s2">&quot;&lt;type 'str'&gt;&quot;</span><span class="s0">, </span><span class="s2">&quot;escaped&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">({</span><span class="s2">&quot;escape&quot;</span><span class="s1">: </span><span class="s0">False</span><span class="s1">}</span><span class="s0">, </span><span class="s2">&quot;&lt;b&gt;bold&lt;/b&gt;&quot;</span><span class="s0">, </span><span class="s2">&quot;escape_disabled&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_escaped(kwargs</span><span class="s0">, </span><span class="s1">string</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s1">a = </span><span class="s2">&quot;str&lt;ing1 &amp;amp;&quot;</span>
    <span class="s1">b = </span><span class="s2">&quot;stri&gt;ng2 &amp;amp;&quot;</span>

    <span class="s1">test_dict = {</span><span class="s2">&quot;co&lt;l1&quot;</span><span class="s1">: {a: string</span><span class="s0">, </span><span class="s1">b: string}</span><span class="s0">, </span><span class="s2">&quot;co&gt;l2&quot;</span><span class="s1">: {a: string</span><span class="s0">, </span><span class="s1">b: string}}</span>
    <span class="s1">result = DataFrame(test_dict).to_html(**kwargs)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;index_is_named&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_to_html_multiindex_index_false(index_is_named</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s5"># GH 8452</span>
    <span class="s1">df = DataFrame(</span>
        <span class="s1">{</span><span class="s2">&quot;a&quot;</span><span class="s1">: range(</span><span class="s4">2</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">: range(</span><span class="s4">3</span><span class="s0">, </span><span class="s4">5</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">: range(</span><span class="s4">5</span><span class="s0">, </span><span class="s4">7</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">: range(</span><span class="s4">3</span><span class="s0">, </span><span class="s4">5</span><span class="s1">)}</span>
    <span class="s1">)</span>
    <span class="s1">df.columns = MultiIndex.from_product([[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">]])</span>
    <span class="s0">if </span><span class="s1">index_is_named:</span>
        <span class="s1">df.index = Index(df.index.values</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">&quot;idx&quot;</span><span class="s1">)</span>
    <span class="s1">result = df.to_html(index=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;gh8452_expected_output&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;multi_sparse,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s0">False, </span><span class="s2">&quot;multiindex_sparsify_false_multi_sparse_1&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s0">False, </span><span class="s2">&quot;multiindex_sparsify_false_multi_sparse_2&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s0">True, </span><span class="s2">&quot;multiindex_sparsify_1&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s0">True, </span><span class="s2">&quot;multiindex_sparsify_2&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_multiindex_sparsify(multi_sparse</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s1">index = MultiIndex.from_arrays([[</span><span class="s4">0</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, None</span><span class="s1">])</span>
    <span class="s1">df = DataFrame([[</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">2</span><span class="s0">, </span><span class="s4">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">4</span><span class="s0">, </span><span class="s4">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">6</span><span class="s0">, </span><span class="s4">7</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">index=index)</span>
    <span class="s0">if </span><span class="s1">expected.endswith(</span><span class="s2">&quot;2&quot;</span><span class="s1">):</span>
        <span class="s1">df.columns = index[::</span><span class="s4">2</span><span class="s1">]</span>
    <span class="s0">with </span><span class="s1">option_context(</span><span class="s2">&quot;display.multi_sparse&quot;</span><span class="s0">, </span><span class="s1">multi_sparse):</span>
        <span class="s1">result = df.to_html()</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;max_rows,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s4">60</span><span class="s0">, </span><span class="s2">&quot;gh14882_expected_output_1&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s5"># Test that ... appears in a middle level</span>
        <span class="s1">(</span><span class="s4">56</span><span class="s0">, </span><span class="s2">&quot;gh14882_expected_output_2&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_multiindex_odd_even_truncate(max_rows</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s5"># GH 14882 - Issue on truncation with odd length DataFrame</span>
    <span class="s1">index = MultiIndex.from_product(</span>
        <span class="s1">[[</span><span class="s4">100</span><span class="s0">, </span><span class="s4">200</span><span class="s0">, </span><span class="s4">300</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">10</span><span class="s0">, </span><span class="s4">20</span><span class="s0">, </span><span class="s4">30</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s0">, </span><span class="s4">3</span><span class="s0">, </span><span class="s4">4</span><span class="s0">, </span><span class="s4">5</span><span class="s0">, </span><span class="s4">6</span><span class="s0">, </span><span class="s4">7</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">]</span>
    <span class="s1">)</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;n&quot;</span><span class="s1">: range(len(index))}</span><span class="s0">, </span><span class="s1">index=index)</span>
    <span class="s1">result = df.to_html(max_rows=max_rows)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;df,formatters,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span>
            <span class="s1">DataFrame(</span>
                <span class="s1">[[</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">2</span><span class="s0">, </span><span class="s4">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">4</span><span class="s0">, </span><span class="s4">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">6</span><span class="s0">, </span><span class="s4">7</span><span class="s1">]]</span><span class="s0">,</span>
                <span class="s1">columns=[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, None</span><span class="s1">]</span><span class="s0">,</span>
                <span class="s1">index=np.arange(</span><span class="s4">4</span><span class="s1">)</span><span class="s0">,</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">&quot;__index__&quot;</span><span class="s1">: </span><span class="s0">lambda </span><span class="s1">x: </span><span class="s2">&quot;abcd&quot;</span><span class="s1">[x]}</span><span class="s0">,</span>
            <span class="s2">&quot;index_formatter&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">DataFrame({</span><span class="s2">&quot;months&quot;</span><span class="s1">: [datetime(</span><span class="s4">2016</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">datetime(</span><span class="s4">2016</span><span class="s0">, </span><span class="s4">2</span><span class="s0">, </span><span class="s4">2</span><span class="s1">)]})</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">&quot;months&quot;</span><span class="s1">: </span><span class="s0">lambda </span><span class="s1">x: x.strftime(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="s1">)}</span><span class="s0">,</span>
            <span class="s2">&quot;datetime64_monthformatter&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">DataFrame(</span>
                <span class="s1">{</span>
                    <span class="s2">&quot;hod&quot;</span><span class="s1">: pd.to_datetime(</span>
                        <span class="s1">[</span><span class="s2">&quot;10:10:10.100&quot;</span><span class="s0">, </span><span class="s2">&quot;12:12:12.120&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">format=</span><span class="s2">&quot;%H:%M:%S.%f&quot;</span>
                    <span class="s1">)</span>
                <span class="s1">}</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s1">{</span><span class="s2">&quot;hod&quot;</span><span class="s1">: </span><span class="s0">lambda </span><span class="s1">x: x.strftime(</span><span class="s2">&quot;%H:%M&quot;</span><span class="s1">)}</span><span class="s0">,</span>
            <span class="s2">&quot;datetime64_hourformatter&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">DataFrame(</span>
                <span class="s1">{</span>
                    <span class="s2">&quot;i&quot;</span><span class="s1">: pd.Series([</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">&quot;int64&quot;</span><span class="s1">)</span><span class="s0">,</span>
                    <span class="s2">&quot;f&quot;</span><span class="s1">: pd.Series([</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">&quot;float64&quot;</span><span class="s1">)</span><span class="s0">,</span>
                    <span class="s2">&quot;I&quot;</span><span class="s1">: pd.Series([</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">&quot;Int64&quot;</span><span class="s1">)</span><span class="s0">,</span>
                    <span class="s2">&quot;s&quot;</span><span class="s1">: pd.Series([</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">&quot;string&quot;</span><span class="s1">)</span><span class="s0">,</span>
                    <span class="s2">&quot;b&quot;</span><span class="s1">: pd.Series([</span><span class="s0">True, False</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">&quot;boolean&quot;</span><span class="s1">)</span><span class="s0">,</span>
                    <span class="s2">&quot;c&quot;</span><span class="s1">: pd.Series([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=pd.CategoricalDtype([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]))</span><span class="s0">,</span>
                    <span class="s2">&quot;o&quot;</span><span class="s1">: pd.Series([</span><span class="s4">1</span><span class="s0">, </span><span class="s2">&quot;2&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=object)</span><span class="s0">,</span>
                <span class="s1">}</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s0">lambda </span><span class="s1">x: </span><span class="s2">&quot;formatted&quot;</span><span class="s1">] * </span><span class="s4">7</span><span class="s0">,</span>
            <span class="s2">&quot;various_dtypes_formatted&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_formatters(df</span><span class="s0">, </span><span class="s1">formatters</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">result = df.to_html(formatters=formatters)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_regression_GH6098():</span>
    <span class="s1">df = DataFrame(</span>
        <span class="s1">{</span>
            <span class="s2">&quot;clé1&quot;</span><span class="s1">: [</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s2">&quot;clé2&quot;</span><span class="s1">: [</span><span class="s2">&quot;1er&quot;</span><span class="s0">, </span><span class="s2">&quot;2ème&quot;</span><span class="s0">, </span><span class="s2">&quot;1er&quot;</span><span class="s0">, </span><span class="s2">&quot;2ème&quot;</span><span class="s0">, </span><span class="s2">&quot;1er&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s2">&quot;données1&quot;</span><span class="s1">: np.random.randn(</span><span class="s4">5</span><span class="s1">)</span><span class="s0">,</span>
            <span class="s2">&quot;données2&quot;</span><span class="s1">: np.random.randn(</span><span class="s4">5</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">}</span>
    <span class="s1">)</span>

    <span class="s5"># it works</span>
    <span class="s1">df.pivot_table(index=[</span><span class="s2">&quot;clé1&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s2">&quot;clé2&quot;</span><span class="s1">])._repr_html_()</span>


<span class="s0">def </span><span class="s1">test_to_html_truncate(datapath):</span>
    <span class="s1">index = pd.date_range(start=</span><span class="s2">&quot;20010101&quot;</span><span class="s0">, </span><span class="s1">freq=</span><span class="s2">&quot;D&quot;</span><span class="s0">, </span><span class="s1">periods=</span><span class="s4">20</span><span class="s1">)</span>
    <span class="s1">df = DataFrame(index=index</span><span class="s0">, </span><span class="s1">columns=range(</span><span class="s4">20</span><span class="s1">))</span>
    <span class="s1">result = df.to_html(max_rows=</span><span class="s4">8</span><span class="s0">, </span><span class="s1">max_cols=</span><span class="s4">4</span><span class="s1">)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;truncate&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;size&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s4">1</span><span class="s0">, </span><span class="s4">5</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_html_invalid_formatters_arg_raises(size):</span>
    <span class="s5"># issue-28469</span>
    <span class="s1">df = DataFrame(columns=[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">])</span>
    <span class="s1">msg = </span><span class="s2">&quot;Formatters length({}) should match DataFrame number of columns(3)&quot;</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=re.escape(msg.format(size))):</span>
        <span class="s1">df.to_html(formatters=[</span><span class="s2">&quot;{}&quot;</span><span class="s1">.format] * size)</span>


<span class="s0">def </span><span class="s1">test_to_html_truncate_formatter(datapath):</span>
    <span class="s5"># issue-25955</span>
    <span class="s1">data = [</span>
        <span class="s1">{</span><span class="s2">&quot;A&quot;</span><span class="s1">: </span><span class="s4">1</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">: </span><span class="s4">2</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">: </span><span class="s4">3</span><span class="s0">, </span><span class="s2">&quot;D&quot;</span><span class="s1">: </span><span class="s4">4</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">&quot;A&quot;</span><span class="s1">: </span><span class="s4">5</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">: </span><span class="s4">6</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">: </span><span class="s4">7</span><span class="s0">, </span><span class="s2">&quot;D&quot;</span><span class="s1">: </span><span class="s4">8</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">&quot;A&quot;</span><span class="s1">: </span><span class="s4">9</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">: </span><span class="s4">10</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">: </span><span class="s4">11</span><span class="s0">, </span><span class="s2">&quot;D&quot;</span><span class="s1">: </span><span class="s4">12</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s1">{</span><span class="s2">&quot;A&quot;</span><span class="s1">: </span><span class="s4">13</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">: </span><span class="s4">14</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">: </span><span class="s4">15</span><span class="s0">, </span><span class="s2">&quot;D&quot;</span><span class="s1">: </span><span class="s4">16</span><span class="s1">}</span><span class="s0">,</span>
    <span class="s1">]</span>

    <span class="s1">df = DataFrame(data)</span>
    <span class="s1">fmt = </span><span class="s0">lambda </span><span class="s1">x: str(x) + </span><span class="s2">&quot;_mod&quot;</span>
    <span class="s1">formatters = [fmt</span><span class="s0">, </span><span class="s1">fmt</span><span class="s0">, None, None</span><span class="s1">]</span>
    <span class="s1">result = df.to_html(formatters=formatters</span><span class="s0">, </span><span class="s1">max_cols=</span><span class="s4">3</span><span class="s1">)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;truncate_formatter&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;sparsify,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[(</span><span class="s0">True, </span><span class="s2">&quot;truncate_multi_index&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s0">False, </span><span class="s2">&quot;truncate_multi_index_sparse_off&quot;</span><span class="s1">)]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_truncate_multi_index(sparsify</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s1">arrays = [</span>
        <span class="s1">[</span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s2">&quot;baz&quot;</span><span class="s0">, </span><span class="s2">&quot;baz&quot;</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;qux&quot;</span><span class="s0">, </span><span class="s2">&quot;qux&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s2">&quot;one&quot;</span><span class="s0">, </span><span class="s2">&quot;two&quot;</span><span class="s0">, </span><span class="s2">&quot;one&quot;</span><span class="s0">, </span><span class="s2">&quot;two&quot;</span><span class="s0">, </span><span class="s2">&quot;one&quot;</span><span class="s0">, </span><span class="s2">&quot;two&quot;</span><span class="s0">, </span><span class="s2">&quot;one&quot;</span><span class="s0">, </span><span class="s2">&quot;two&quot;</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s1">df = DataFrame(index=arrays</span><span class="s0">, </span><span class="s1">columns=arrays)</span>
    <span class="s1">result = df.to_html(max_rows=</span><span class="s4">7</span><span class="s0">, </span><span class="s1">max_cols=</span><span class="s4">7</span><span class="s0">, </span><span class="s1">sparsify=sparsify)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;option,result,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s0">None, lambda </span><span class="s1">df: df.to_html()</span><span class="s0">, </span><span class="s2">&quot;1&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s0">None, lambda </span><span class="s1">df: df.to_html(border=</span><span class="s4">0</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;0&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s4">0</span><span class="s0">, lambda </span><span class="s1">df: df.to_html()</span><span class="s0">, </span><span class="s2">&quot;0&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s4">0</span><span class="s0">, lambda </span><span class="s1">df: df._repr_html_()</span><span class="s0">, </span><span class="s2">&quot;0&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_border(option</span><span class="s0">, </span><span class="s1">result</span><span class="s0">, </span><span class="s1">expected):</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]})</span>
    <span class="s0">if </span><span class="s1">option </span><span class="s0">is None</span><span class="s1">:</span>
        <span class="s1">result = result(df)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">with </span><span class="s1">option_context(</span><span class="s2">&quot;display.html.border&quot;</span><span class="s0">, </span><span class="s1">option):</span>
            <span class="s1">result = result(df)</span>
    <span class="s1">expected = </span><span class="s2">f'border=&quot;</span><span class="s0">{</span><span class="s1">expected</span><span class="s0">}</span><span class="s2">&quot;'</span>
    <span class="s0">assert </span><span class="s1">expected </span><span class="s0">in </span><span class="s1">result</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;biggie_df_fixture&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;mixed&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">indirect=</span><span class="s0">True</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html(biggie_df_fixture):</span>
    <span class="s5"># TODO: split this test</span>
    <span class="s1">df = biggie_df_fixture</span>
    <span class="s1">s = df.to_html()</span>

    <span class="s1">buf = StringIO()</span>
    <span class="s1">retval = df.to_html(buf=buf)</span>
    <span class="s0">assert </span><span class="s1">retval </span><span class="s0">is None</span>
    <span class="s0">assert </span><span class="s1">buf.getvalue() == s</span>

    <span class="s0">assert </span><span class="s1">isinstance(s</span><span class="s0">, </span><span class="s1">str)</span>

    <span class="s1">df.to_html(columns=[</span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;A&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">col_space=</span><span class="s4">17</span><span class="s1">)</span>
    <span class="s1">df.to_html(columns=[</span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;A&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">formatters={</span><span class="s2">&quot;A&quot;</span><span class="s1">: </span><span class="s0">lambda </span><span class="s1">x: </span><span class="s2">f&quot;</span><span class="s0">{</span><span class="s1">x</span><span class="s0">:</span><span class="s2">.1f</span><span class="s0">}</span><span class="s2">&quot;</span><span class="s1">})</span>

    <span class="s1">df.to_html(columns=[</span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;A&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">float_format=str)</span>
    <span class="s1">df.to_html(columns=[</span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;A&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">col_space=</span><span class="s4">12</span><span class="s0">, </span><span class="s1">float_format=str)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;biggie_df_fixture&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;empty&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">indirect=</span><span class="s0">True</span><span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_empty_dataframe(biggie_df_fixture):</span>
    <span class="s1">df = biggie_df_fixture</span>
    <span class="s1">df.to_html()</span>


<span class="s0">def </span><span class="s1">test_to_html_filename(biggie_df_fixture</span><span class="s0">, </span><span class="s1">tmpdir):</span>
    <span class="s1">df = biggie_df_fixture</span>
    <span class="s1">expected = df.to_html()</span>
    <span class="s1">path = tmpdir.join(</span><span class="s2">&quot;test.html&quot;</span><span class="s1">)</span>
    <span class="s1">df.to_html(path)</span>
    <span class="s1">result = path.read()</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_with_no_bold():</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;x&quot;</span><span class="s1">: np.random.randn(</span><span class="s4">5</span><span class="s1">)})</span>
    <span class="s1">html = df.to_html(bold_rows=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">result = html[html.find(</span><span class="s2">&quot;&lt;/thead&gt;&quot;</span><span class="s1">)]</span>
    <span class="s0">assert </span><span class="s2">&quot;&lt;strong&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s0">def </span><span class="s1">test_to_html_columns_arg(float_frame):</span>
    <span class="s1">result = float_frame.to_html(columns=[</span><span class="s2">&quot;A&quot;</span><span class="s1">])</span>
    <span class="s0">assert </span><span class="s2">&quot;&lt;th&gt;B&lt;/th&gt;&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;columns,justify,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span>
            <span class="s1">MultiIndex.from_tuples(</span>
                <span class="s1">list(zip(np.arange(</span><span class="s4">2</span><span class="s1">).repeat(</span><span class="s4">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.mod(range(</span><span class="s4">4</span><span class="s1">)</span><span class="s0">, </span><span class="s4">2</span><span class="s1">)))</span><span class="s0">,</span>
                <span class="s1">names=[</span><span class="s2">&quot;CL0&quot;</span><span class="s0">, </span><span class="s2">&quot;CL1&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s2">&quot;left&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;multiindex_1&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">MultiIndex.from_tuples(list(zip(range(</span><span class="s4">4</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.mod(range(</span><span class="s4">4</span><span class="s1">)</span><span class="s0">, </span><span class="s4">2</span><span class="s1">))))</span><span class="s0">,</span>
            <span class="s2">&quot;right&quot;</span><span class="s0">,</span>
            <span class="s2">&quot;multiindex_2&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_multiindex(columns</span><span class="s0">, </span><span class="s1">justify</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s1">df = DataFrame([list(</span><span class="s2">&quot;abcd&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">list(</span><span class="s2">&quot;efgh&quot;</span><span class="s1">)]</span><span class="s0">, </span><span class="s1">columns=columns)</span>
    <span class="s1">result = df.to_html(justify=justify)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_justify(justify</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s1">df = DataFrame(</span>
        <span class="s1">{</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">6</span><span class="s0">, </span><span class="s4">30000</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s0">, </span><span class="s4">70000</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">: [</span><span class="s4">223442</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]}</span><span class="s0">,</span>
        <span class="s1">columns=[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">result = df.to_html(justify=justify)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;justify&quot;</span><span class="s1">).format(justify=justify)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;justify&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;super-right&quot;</span><span class="s0">, </span><span class="s2">&quot;small-left&quot;</span><span class="s0">, </span><span class="s2">&quot;noinherit&quot;</span><span class="s0">, </span><span class="s2">&quot;tiny&quot;</span><span class="s0">, </span><span class="s2">&quot;pandas&quot;</span><span class="s1">]</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_invalid_justify(justify):</span>
    <span class="s5"># GH 17527</span>
    <span class="s1">df = DataFrame()</span>
    <span class="s1">msg = </span><span class="s2">&quot;Invalid value for justify parameter&quot;</span>

    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">df.to_html(justify=justify)</span>


<span class="s0">class </span><span class="s1">TestHTMLIndex:</span>
    <span class="s1">@pytest.fixture</span>
    <span class="s0">def </span><span class="s1">df(self):</span>
        <span class="s1">index = [</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s2">&quot;baz&quot;</span><span class="s1">]</span>
        <span class="s1">df = DataFrame(</span>
            <span class="s1">{</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s0">, </span><span class="s4">3</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s1">: [</span><span class="s4">1.2</span><span class="s0">, </span><span class="s4">3.4</span><span class="s0">, </span><span class="s4">5.6</span><span class="s1">]</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">: [</span><span class="s2">&quot;one&quot;</span><span class="s0">, </span><span class="s2">&quot;two&quot;</span><span class="s0">, </span><span class="s1">np.nan]}</span><span class="s0">,</span>
            <span class="s1">columns=[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s2">&quot;B&quot;</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">index=index</span><span class="s0">,</span>
        <span class="s1">)</span>
        <span class="s0">return </span><span class="s1">df</span>

    <span class="s1">@pytest.fixture</span>
    <span class="s0">def </span><span class="s1">expected_without_index(self</span><span class="s0">, </span><span class="s1">datapath):</span>
        <span class="s0">return </span><span class="s1">expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;index_2&quot;</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_to_html_flat_index_without_name(</span>
        <span class="s1">self</span><span class="s0">, </span><span class="s1">datapath</span><span class="s0">, </span><span class="s1">df</span><span class="s0">, </span><span class="s1">expected_without_index</span>
    <span class="s1">):</span>
        <span class="s1">expected_with_index = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;index_1&quot;</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">df.to_html() == expected_with_index</span>

        <span class="s1">result = df.to_html(index=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">df.index:</span>
            <span class="s0">assert </span><span class="s1">i </span><span class="s0">not in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s1">result == expected_without_index</span>

    <span class="s0">def </span><span class="s1">test_to_html_flat_index_with_name(self</span><span class="s0">, </span><span class="s1">datapath</span><span class="s0">, </span><span class="s1">df</span><span class="s0">, </span><span class="s1">expected_without_index):</span>
        <span class="s1">df.index = Index([</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s2">&quot;baz&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">&quot;idx&quot;</span><span class="s1">)</span>
        <span class="s1">expected_with_index = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;index_3&quot;</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">df.to_html() == expected_with_index</span>
        <span class="s0">assert </span><span class="s1">df.to_html(index=</span><span class="s0">False</span><span class="s1">) == expected_without_index</span>

    <span class="s0">def </span><span class="s1">test_to_html_multiindex_without_names(</span>
        <span class="s1">self</span><span class="s0">, </span><span class="s1">datapath</span><span class="s0">, </span><span class="s1">df</span><span class="s0">, </span><span class="s1">expected_without_index</span>
    <span class="s1">):</span>
        <span class="s1">tuples = [(</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;car&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bike&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s2">&quot;car&quot;</span><span class="s1">)]</span>
        <span class="s1">df.index = MultiIndex.from_tuples(tuples)</span>

        <span class="s1">expected_with_index = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;index_4&quot;</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">df.to_html() == expected_with_index</span>

        <span class="s1">result = df.to_html(index=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s2">&quot;car&quot;</span><span class="s0">, </span><span class="s2">&quot;bike&quot;</span><span class="s1">]:</span>
            <span class="s0">assert </span><span class="s1">i </span><span class="s0">not in </span><span class="s1">result</span>
        <span class="s5"># must be the same result as normal index</span>
        <span class="s0">assert </span><span class="s1">result == expected_without_index</span>

    <span class="s0">def </span><span class="s1">test_to_html_multiindex_with_names(self</span><span class="s0">, </span><span class="s1">datapath</span><span class="s0">, </span><span class="s1">df</span><span class="s0">, </span><span class="s1">expected_without_index):</span>
        <span class="s1">tuples = [(</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;car&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bike&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;bar&quot;</span><span class="s0">, </span><span class="s2">&quot;car&quot;</span><span class="s1">)]</span>
        <span class="s1">df.index = MultiIndex.from_tuples(tuples</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;idx1&quot;</span><span class="s0">, </span><span class="s2">&quot;idx2&quot;</span><span class="s1">])</span>
        <span class="s1">expected_with_index = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;index_5&quot;</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">df.to_html() == expected_with_index</span>
        <span class="s0">assert </span><span class="s1">df.to_html(index=</span><span class="s0">False</span><span class="s1">) == expected_without_index</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;classes&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;sortable draggable&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;sortable&quot;</span><span class="s0">, </span><span class="s2">&quot;draggable&quot;</span><span class="s1">]])</span>
<span class="s0">def </span><span class="s1">test_to_html_with_classes(classes</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s1">df = DataFrame()</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;with_classes&quot;</span><span class="s1">)</span>
    <span class="s1">result = df.to_html(classes=classes)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_no_index_max_rows(datapath):</span>
    <span class="s5"># GH 14998</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s0">, </span><span class="s4">3</span><span class="s0">, </span><span class="s4">4</span><span class="s1">]})</span>
    <span class="s1">result = df.to_html(index=</span><span class="s0">False, </span><span class="s1">max_rows=</span><span class="s4">1</span><span class="s1">)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;gh14998_expected_output&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_multiindex_max_cols(datapath):</span>
    <span class="s5"># GH 6131</span>
    <span class="s1">index = MultiIndex(</span>
        <span class="s1">levels=[[</span><span class="s2">&quot;ba&quot;</span><span class="s0">, </span><span class="s2">&quot;bb&quot;</span><span class="s0">, </span><span class="s2">&quot;bc&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;ca&quot;</span><span class="s0">, </span><span class="s2">&quot;cb&quot;</span><span class="s0">, </span><span class="s2">&quot;cc&quot;</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">codes=[[</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">names=[</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">columns = MultiIndex(</span>
        <span class="s1">levels=[[</span><span class="s2">&quot;d&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;aa&quot;</span><span class="s0">, </span><span class="s2">&quot;ab&quot;</span><span class="s0">, </span><span class="s2">&quot;ac&quot;</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">codes=[[</span><span class="s4">0</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]]</span><span class="s0">,</span>
        <span class="s1">names=[</span><span class="s0">None, </span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">data = np.array(</span>
        <span class="s1">[[</span><span class="s4">1.0</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">, </span><span class="s1">[np.nan</span><span class="s0">, </span><span class="s4">2.0</span><span class="s0">, </span><span class="s1">np.nan]</span><span class="s0">, </span><span class="s1">[np.nan</span><span class="s0">, </span><span class="s1">np.nan</span><span class="s0">, </span><span class="s4">3.0</span><span class="s1">]]</span>
    <span class="s1">)</span>
    <span class="s1">df = DataFrame(data</span><span class="s0">, </span><span class="s1">index</span><span class="s0">, </span><span class="s1">columns)</span>
    <span class="s1">result = df.to_html(max_cols=</span><span class="s4">2</span><span class="s1">)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;gh6131_expected_output&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_multi_indexes_index_false(datapath):</span>
    <span class="s5"># GH 22579</span>
    <span class="s1">df = DataFrame(</span>
        <span class="s1">{</span><span class="s2">&quot;a&quot;</span><span class="s1">: range(</span><span class="s4">10</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">: range(</span><span class="s4">10</span><span class="s0">, </span><span class="s4">20</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">: range(</span><span class="s4">10</span><span class="s0">, </span><span class="s4">20</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">: range(</span><span class="s4">10</span><span class="s0">, </span><span class="s4">20</span><span class="s1">)}</span>
    <span class="s1">)</span>
    <span class="s1">df.columns = MultiIndex.from_product([[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">]])</span>
    <span class="s1">df.index = MultiIndex.from_product([[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s0">, </span><span class="s2">&quot;e&quot;</span><span class="s0">, </span><span class="s2">&quot;f&quot;</span><span class="s0">, </span><span class="s2">&quot;g&quot;</span><span class="s1">]])</span>
    <span class="s1">result = df.to_html(index=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;gh22579_expected_output&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;index_names&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;header&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;column_index, column_type&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(Index([</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">])</span><span class="s0">, </span><span class="s2">&quot;unnamed_standard&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(Index([</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">&quot;columns.name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;named_standard&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(MultiIndex.from_product([[</span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">]])</span><span class="s0">, </span><span class="s2">&quot;unnamed_multi&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">MultiIndex.from_product(</span>
                <span class="s1">[[</span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;columns.name.0&quot;</span><span class="s0">, </span><span class="s2">&quot;columns.name.1&quot;</span><span class="s1">]</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s2">&quot;named_multi&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;row_index, row_type&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(Index([</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">])</span><span class="s0">, </span><span class="s2">&quot;unnamed_standard&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(Index([</span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">&quot;index.name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;named_standard&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(MultiIndex.from_product([[</span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">]])</span><span class="s0">, </span><span class="s2">&quot;unnamed_multi&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">MultiIndex.from_product(</span>
                <span class="s1">[[</span><span class="s2">&quot;a&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s2">&quot;c&quot;</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;index.name.0&quot;</span><span class="s0">, </span><span class="s2">&quot;index.name.1&quot;</span><span class="s1">]</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s2">&quot;named_multi&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_basic_alignment(</span>
    <span class="s1">datapath</span><span class="s0">, </span><span class="s1">row_index</span><span class="s0">, </span><span class="s1">row_type</span><span class="s0">, </span><span class="s1">column_index</span><span class="s0">, </span><span class="s1">column_type</span><span class="s0">, </span><span class="s1">index</span><span class="s0">, </span><span class="s1">header</span><span class="s0">, </span><span class="s1">index_names</span>
<span class="s1">):</span>
    <span class="s5"># GH 22747, GH 22579</span>
    <span class="s1">df = DataFrame(np.zeros((</span><span class="s4">2</span><span class="s0">, </span><span class="s4">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=int)</span><span class="s0">, </span><span class="s1">index=row_index</span><span class="s0">, </span><span class="s1">columns=column_index)</span>
    <span class="s1">result = df.to_html(index=index</span><span class="s0">, </span><span class="s1">header=header</span><span class="s0">, </span><span class="s1">index_names=index_names)</span>

    <span class="s0">if not </span><span class="s1">index:</span>
        <span class="s1">row_type = </span><span class="s2">&quot;none&quot;</span>
    <span class="s0">elif not </span><span class="s1">index_names </span><span class="s0">and </span><span class="s1">row_type.startswith(</span><span class="s2">&quot;named&quot;</span><span class="s1">):</span>
        <span class="s1">row_type = </span><span class="s2">&quot;un&quot; </span><span class="s1">+ row_type</span>

    <span class="s0">if not </span><span class="s1">header:</span>
        <span class="s1">column_type = </span><span class="s2">&quot;none&quot;</span>
    <span class="s0">elif not </span><span class="s1">index_names </span><span class="s0">and </span><span class="s1">column_type.startswith(</span><span class="s2">&quot;named&quot;</span><span class="s1">):</span>
        <span class="s1">column_type = </span><span class="s2">&quot;un&quot; </span><span class="s1">+ column_type</span>

    <span class="s1">filename = </span><span class="s2">&quot;index_&quot; </span><span class="s1">+ row_type + </span><span class="s2">&quot;_columns_&quot; </span><span class="s1">+ column_type</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">filename)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;index_names&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;header&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;column_index, column_type&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(Index(np.arange(</span><span class="s4">8</span><span class="s1">))</span><span class="s0">, </span><span class="s2">&quot;unnamed_standard&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(Index(np.arange(</span><span class="s4">8</span><span class="s1">)</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">&quot;columns.name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;named_standard&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">MultiIndex.from_product([[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;e&quot;</span><span class="s0">, </span><span class="s2">&quot;f&quot;</span><span class="s1">]])</span><span class="s0">,</span>
            <span class="s2">&quot;unnamed_multi&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">MultiIndex.from_product(</span>
                <span class="s1">[[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;e&quot;</span><span class="s0">, </span><span class="s2">&quot;f&quot;</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, None, </span><span class="s2">&quot;baz&quot;</span><span class="s1">]</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s2">&quot;named_multi&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;row_index, row_type&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(Index(np.arange(</span><span class="s4">8</span><span class="s1">))</span><span class="s0">, </span><span class="s2">&quot;unnamed_standard&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(Index(np.arange(</span><span class="s4">8</span><span class="s1">)</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">&quot;index.name&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;named_standard&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">MultiIndex.from_product([[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;e&quot;</span><span class="s0">, </span><span class="s2">&quot;f&quot;</span><span class="s1">]])</span><span class="s0">,</span>
            <span class="s2">&quot;unnamed_multi&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span>
            <span class="s1">MultiIndex.from_product(</span>
                <span class="s1">[[</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;c&quot;</span><span class="s0">, </span><span class="s2">&quot;d&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;e&quot;</span><span class="s0">, </span><span class="s2">&quot;f&quot;</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">names=[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, None, </span><span class="s2">&quot;baz&quot;</span><span class="s1">]</span>
            <span class="s1">)</span><span class="s0">,</span>
            <span class="s2">&quot;named_multi&quot;</span><span class="s0">,</span>
        <span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_alignment_with_truncation(</span>
    <span class="s1">datapath</span><span class="s0">, </span><span class="s1">row_index</span><span class="s0">, </span><span class="s1">row_type</span><span class="s0">, </span><span class="s1">column_index</span><span class="s0">, </span><span class="s1">column_type</span><span class="s0">, </span><span class="s1">index</span><span class="s0">, </span><span class="s1">header</span><span class="s0">, </span><span class="s1">index_names</span>
<span class="s1">):</span>
    <span class="s5"># GH 22747, GH 22579</span>
    <span class="s1">df = DataFrame(np.arange(</span><span class="s4">64</span><span class="s1">).reshape(</span><span class="s4">8</span><span class="s0">, </span><span class="s4">8</span><span class="s1">)</span><span class="s0">, </span><span class="s1">index=row_index</span><span class="s0">, </span><span class="s1">columns=column_index)</span>
    <span class="s1">result = df.to_html(</span>
        <span class="s1">max_rows=</span><span class="s4">4</span><span class="s0">, </span><span class="s1">max_cols=</span><span class="s4">4</span><span class="s0">, </span><span class="s1">index=index</span><span class="s0">, </span><span class="s1">header=header</span><span class="s0">, </span><span class="s1">index_names=index_names</span>
    <span class="s1">)</span>

    <span class="s0">if not </span><span class="s1">index:</span>
        <span class="s1">row_type = </span><span class="s2">&quot;none&quot;</span>
    <span class="s0">elif not </span><span class="s1">index_names </span><span class="s0">and </span><span class="s1">row_type.startswith(</span><span class="s2">&quot;named&quot;</span><span class="s1">):</span>
        <span class="s1">row_type = </span><span class="s2">&quot;un&quot; </span><span class="s1">+ row_type</span>

    <span class="s0">if not </span><span class="s1">header:</span>
        <span class="s1">column_type = </span><span class="s2">&quot;none&quot;</span>
    <span class="s0">elif not </span><span class="s1">index_names </span><span class="s0">and </span><span class="s1">column_type.startswith(</span><span class="s2">&quot;named&quot;</span><span class="s1">):</span>
        <span class="s1">column_type = </span><span class="s2">&quot;un&quot; </span><span class="s1">+ column_type</span>

    <span class="s1">filename = </span><span class="s2">&quot;trunc_df_index_&quot; </span><span class="s1">+ row_type + </span><span class="s2">&quot;_columns_&quot; </span><span class="s1">+ column_type</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">filename)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">False, </span><span class="s4">0</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_to_html_truncation_index_false_max_rows(datapath</span><span class="s0">, </span><span class="s1">index):</span>
    <span class="s5"># GH 15019</span>
    <span class="s1">data = [</span>
        <span class="s1">[</span><span class="s4">1.764052</span><span class="s0">, </span><span class="s4">0.400157</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s4">0.978738</span><span class="s0">, </span><span class="s4">2.240893</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s4">1.867558</span><span class="s0">, </span><span class="s1">-</span><span class="s4">0.977278</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s4">0.950088</span><span class="s0">, </span><span class="s1">-</span><span class="s4">0.151357</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s4">0.103219</span><span class="s0">, </span><span class="s4">0.410599</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s1">df = DataFrame(data)</span>
    <span class="s1">result = df.to_html(max_rows=</span><span class="s4">4</span><span class="s0">, </span><span class="s1">index=index)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;gh15019_expected_output&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;index&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">False, </span><span class="s4">0</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;col_index_named, expected_output&quot;</span><span class="s0">,</span>
    <span class="s1">[(</span><span class="s0">False, </span><span class="s2">&quot;gh22783_expected_output&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s0">True, </span><span class="s2">&quot;gh22783_named_columns_index&quot;</span><span class="s1">)]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_truncation_index_false_max_cols(</span>
    <span class="s1">datapath</span><span class="s0">, </span><span class="s1">index</span><span class="s0">, </span><span class="s1">col_index_named</span><span class="s0">, </span><span class="s1">expected_output</span>
<span class="s1">):</span>
    <span class="s5"># GH 22783</span>
    <span class="s1">data = [</span>
        <span class="s1">[</span><span class="s4">1.764052</span><span class="s0">, </span><span class="s4">0.400157</span><span class="s0">, </span><span class="s4">0.978738</span><span class="s0">, </span><span class="s4">2.240893</span><span class="s0">, </span><span class="s4">1.867558</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[-</span><span class="s4">0.977278</span><span class="s0">, </span><span class="s4">0.950088</span><span class="s0">, </span><span class="s1">-</span><span class="s4">0.151357</span><span class="s0">, </span><span class="s1">-</span><span class="s4">0.103219</span><span class="s0">, </span><span class="s4">0.410599</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s1">df = DataFrame(data)</span>
    <span class="s0">if </span><span class="s1">col_index_named:</span>
        <span class="s1">df.columns.rename(</span><span class="s2">&quot;columns.name&quot;</span><span class="s0">, </span><span class="s1">inplace=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s1">result = df.to_html(max_cols=</span><span class="s4">4</span><span class="s0">, </span><span class="s1">index=index)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected_output)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;notebook&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_to_html_notebook_has_style(notebook):</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s0">, </span><span class="s4">3</span><span class="s1">]})</span>
    <span class="s1">result = df.to_html(notebook=notebook)</span>

    <span class="s0">if </span><span class="s1">notebook:</span>
        <span class="s0">assert </span><span class="s2">&quot;tbody tr th:only-of-type&quot; </span><span class="s0">in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s2">&quot;vertical-align: middle;&quot; </span><span class="s0">in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s2">&quot;thead th&quot; </span><span class="s0">in </span><span class="s1">result</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s0">assert </span><span class="s2">&quot;tbody tr th:only-of-type&quot; </span><span class="s0">not in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s2">&quot;vertical-align: middle;&quot; </span><span class="s0">not in </span><span class="s1">result</span>
        <span class="s0">assert </span><span class="s2">&quot;thead th&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s0">def </span><span class="s1">test_to_html_with_index_names_false():</span>
    <span class="s5"># GH 16493</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]}</span><span class="s0">, </span><span class="s1">index=Index([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">&quot;myindexname&quot;</span><span class="s1">))</span>
    <span class="s1">result = df.to_html(index_names=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s2">&quot;myindexname&quot; </span><span class="s0">not in </span><span class="s1">result</span>


<span class="s0">def </span><span class="s1">test_to_html_with_id():</span>
    <span class="s5"># GH 8496</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;A&quot;</span><span class="s1">: [</span><span class="s4">1</span><span class="s0">, </span><span class="s4">2</span><span class="s1">]}</span><span class="s0">, </span><span class="s1">index=Index([</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s2">&quot;b&quot;</span><span class="s1">]</span><span class="s0">, </span><span class="s1">name=</span><span class="s2">&quot;myindexname&quot;</span><span class="s1">))</span>
    <span class="s1">result = df.to_html(index_names=</span><span class="s0">False, </span><span class="s1">table_id=</span><span class="s2">&quot;TEST_ID&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s2">' id=&quot;TEST_ID&quot;' </span><span class="s0">in </span><span class="s1">result</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;value,float_format,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s4">0.19999</span><span class="s0">, </span><span class="s2">&quot;%.3f&quot;</span><span class="s0">, </span><span class="s2">&quot;gh21625_expected_output&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s4">100.0</span><span class="s0">, </span><span class="s2">&quot;%.0f&quot;</span><span class="s0">, </span><span class="s2">&quot;gh22270_expected_output&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_float_format_no_fixed_width(value</span><span class="s0">, </span><span class="s1">float_format</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s5"># GH 21625, GH 22270</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;x&quot;</span><span class="s1">: [value]})</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s1">result = df.to_html(float_format=float_format)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;render_links,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[(</span><span class="s0">True, </span><span class="s2">&quot;render_links_true&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s0">False, </span><span class="s2">&quot;render_links_false&quot;</span><span class="s1">)]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_to_html_render_links(render_links</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s5"># GH 2679</span>
    <span class="s1">data = [</span>
        <span class="s1">[</span><span class="s4">0</span><span class="s0">, </span><span class="s2">&quot;https://pandas.pydata.org/?q1=a&amp;q2=b&quot;</span><span class="s0">, </span><span class="s2">&quot;pydata.org&quot;</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">[</span><span class="s4">0</span><span class="s0">, </span><span class="s2">&quot;www.pydata.org&quot;</span><span class="s0">, </span><span class="s2">&quot;pydata.org&quot;</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">]</span>
    <span class="s1">df = DataFrame(data</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s2">&quot;foo&quot;</span><span class="s0">, </span><span class="s2">&quot;bar&quot;</span><span class="s0">, None</span><span class="s1">])</span>

    <span class="s1">result = df.to_html(render_links=render_links)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;method,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s1">(</span><span class="s2">&quot;to_html&quot;</span><span class="s0">, lambda </span><span class="s1">x: lorem_ipsum)</span><span class="s0">,</span>
        <span class="s1">(</span><span class="s2">&quot;_repr_html_&quot;</span><span class="s0">, lambda </span><span class="s1">x: lorem_ipsum[: x - </span><span class="s4">4</span><span class="s1">] + </span><span class="s2">&quot;...&quot;</span><span class="s1">)</span><span class="s0">,  </span><span class="s5"># regression case</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;max_colwidth&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s4">10</span><span class="s0">, </span><span class="s4">20</span><span class="s0">, </span><span class="s4">50</span><span class="s0">, </span><span class="s4">100</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_ignore_display_max_colwidth(method</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">max_colwidth):</span>
    <span class="s5"># see gh-17004</span>
    <span class="s1">df = DataFrame([lorem_ipsum])</span>
    <span class="s0">with </span><span class="s1">option_context(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="s0">, </span><span class="s1">max_colwidth):</span>
        <span class="s1">result = getattr(df</span><span class="s0">, </span><span class="s1">method)()</span>
    <span class="s1">expected = expected(max_colwidth)</span>
    <span class="s0">assert </span><span class="s1">expected </span><span class="s0">in </span><span class="s1">result</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;classes&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, </span><span class="s4">0</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_to_html_invalid_classes_type(classes):</span>
    <span class="s5"># GH 25608</span>
    <span class="s1">df = DataFrame()</span>
    <span class="s1">msg = </span><span class="s2">&quot;classes must be a string, list, or tuple&quot;</span>

    <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">df.to_html(classes=classes)</span>


<span class="s0">def </span><span class="s1">test_to_html_round_column_headers():</span>
    <span class="s5"># GH 17280</span>
    <span class="s1">df = DataFrame([</span><span class="s4">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">columns=[</span><span class="s4">0.55555</span><span class="s1">])</span>
    <span class="s0">with </span><span class="s1">option_context(</span><span class="s2">&quot;display.precision&quot;</span><span class="s0">, </span><span class="s4">3</span><span class="s1">):</span>
        <span class="s1">html = df.to_html(notebook=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">notebook = df.to_html(notebook=</span><span class="s0">True</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s2">&quot;0.55555&quot; </span><span class="s0">in </span><span class="s1">html</span>
    <span class="s0">assert </span><span class="s2">&quot;0.556&quot; </span><span class="s0">in </span><span class="s1">notebook</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;unit&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;100px&quot;</span><span class="s0">, </span><span class="s2">&quot;10%&quot;</span><span class="s0">, </span><span class="s2">&quot;5em&quot;</span><span class="s0">, </span><span class="s4">150</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_to_html_with_col_space_units(unit):</span>
    <span class="s5"># GH 25941</span>
    <span class="s1">df = DataFrame(np.random.random(size=(</span><span class="s4">1</span><span class="s0">, </span><span class="s4">3</span><span class="s1">)))</span>
    <span class="s1">result = df.to_html(col_space=unit)</span>
    <span class="s1">result = result.split(</span><span class="s2">&quot;tbody&quot;</span><span class="s1">)[</span><span class="s4">0</span><span class="s1">]</span>
    <span class="s1">hdrs = [x </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">result.split(</span><span class="s2">&quot;</span><span class="s0">\n</span><span class="s2">&quot;</span><span class="s1">) </span><span class="s0">if </span><span class="s1">re.search(</span><span class="s2">r&quot;&lt;th[&gt;\s]&quot;</span><span class="s0">, </span><span class="s1">x)]</span>
    <span class="s0">if </span><span class="s1">isinstance(unit</span><span class="s0">, </span><span class="s1">int):</span>
        <span class="s1">unit = str(unit) + </span><span class="s2">&quot;px&quot;</span>
    <span class="s0">for </span><span class="s1">h </span><span class="s0">in </span><span class="s1">hdrs:</span>
        <span class="s1">expected = </span><span class="s2">f'&lt;th style=&quot;min-width: </span><span class="s0">{</span><span class="s1">unit</span><span class="s0">}</span><span class="s2">;&quot;&gt;'</span>
        <span class="s0">assert </span><span class="s1">expected </span><span class="s0">in </span><span class="s1">h</span>


<span class="s0">def </span><span class="s1">test_html_repr_min_rows_default(datapath):</span>
    <span class="s5"># gh-27991</span>

    <span class="s5"># default setting no truncation even if above min_rows</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;a&quot;</span><span class="s1">: range(</span><span class="s4">20</span><span class="s1">)})</span>
    <span class="s1">result = df._repr_html_()</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;html_repr_min_rows_default_no_truncation&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>

    <span class="s5"># default of max_rows 60 triggers truncation if above</span>
    <span class="s1">df = DataFrame({</span><span class="s2">&quot;a&quot;</span><span class="s1">: range(</span><span class="s4">61</span><span class="s1">)})</span>
    <span class="s1">result = df._repr_html_()</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;html_repr_min_rows_default_truncated&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s1">@pytest.mark.parametrize(</span>
    <span class="s2">&quot;max_rows,min_rows,expected&quot;</span><span class="s0">,</span>
    <span class="s1">[</span>
        <span class="s5"># truncated after first two rows</span>
        <span class="s1">(</span><span class="s4">10</span><span class="s0">, </span><span class="s4">4</span><span class="s0">, </span><span class="s2">&quot;html_repr_max_rows_10_min_rows_4&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s5"># when set to None, follow value of max_rows</span>
        <span class="s1">(</span><span class="s4">12</span><span class="s0">, None, </span><span class="s2">&quot;html_repr_max_rows_12_min_rows_None&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s5"># when set value higher as max_rows, use the minimum</span>
        <span class="s1">(</span><span class="s4">10</span><span class="s0">, </span><span class="s4">12</span><span class="s0">, </span><span class="s2">&quot;html_repr_max_rows_10_min_rows_12&quot;</span><span class="s1">)</span><span class="s0">,</span>
        <span class="s5"># max_rows of None -&gt; never truncate</span>
        <span class="s1">(</span><span class="s0">None, </span><span class="s4">12</span><span class="s0">, </span><span class="s2">&quot;html_repr_max_rows_None_min_rows_12&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">]</span><span class="s0">,</span>
<span class="s1">)</span>
<span class="s0">def </span><span class="s1">test_html_repr_min_rows(datapath</span><span class="s0">, </span><span class="s1">max_rows</span><span class="s0">, </span><span class="s1">min_rows</span><span class="s0">, </span><span class="s1">expected):</span>
    <span class="s5"># gh-27991</span>

    <span class="s1">df = DataFrame({</span><span class="s2">&quot;a&quot;</span><span class="s1">: range(</span><span class="s4">61</span><span class="s1">)})</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s1">expected)</span>
    <span class="s0">with </span><span class="s1">option_context(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="s0">, </span><span class="s1">max_rows</span><span class="s0">, </span><span class="s2">&quot;display.min_rows&quot;</span><span class="s0">, </span><span class="s1">min_rows):</span>
        <span class="s1">result = df._repr_html_()</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_multilevel(multiindex_year_month_day_dataframe_random_data):</span>
    <span class="s1">ymd = multiindex_year_month_day_dataframe_random_data</span>

    <span class="s1">ymd.columns.name = </span><span class="s2">&quot;foo&quot;</span>
    <span class="s1">ymd.to_html()</span>
    <span class="s1">ymd.T.to_html()</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;na_rep&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;NaN&quot;</span><span class="s0">, </span><span class="s2">&quot;Ted&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_to_html_na_rep_and_float_format(na_rep</span><span class="s0">, </span><span class="s1">datapath):</span>
    <span class="s5"># https://github.com/pandas-dev/pandas/issues/13828</span>
    <span class="s1">df = DataFrame(</span>
        <span class="s1">[</span>
            <span class="s1">[</span><span class="s2">&quot;A&quot;</span><span class="s0">, </span><span class="s4">1.2225</span><span class="s1">]</span><span class="s0">,</span>
            <span class="s1">[</span><span class="s2">&quot;A&quot;</span><span class="s0">, None</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s1">]</span><span class="s0">,</span>
        <span class="s1">columns=[</span><span class="s2">&quot;Group&quot;</span><span class="s0">, </span><span class="s2">&quot;Data&quot;</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s1">)</span>
    <span class="s1">result = df.to_html(na_rep=na_rep</span><span class="s0">, </span><span class="s1">float_format=</span><span class="s2">&quot;{:.2f}&quot;</span><span class="s1">.format)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;gh13828_expected_output&quot;</span><span class="s1">)</span>
    <span class="s1">expected = expected.format(na_rep=na_rep)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>


<span class="s0">def </span><span class="s1">test_to_html_float_format_object_col(datapath):</span>
    <span class="s5"># GH#40024</span>
    <span class="s1">df = DataFrame(data={</span><span class="s2">&quot;x&quot;</span><span class="s1">: [</span><span class="s4">1000.0</span><span class="s0">, </span><span class="s2">&quot;test&quot;</span><span class="s1">]})</span>
    <span class="s1">result = df.to_html(float_format=</span><span class="s0">lambda </span><span class="s1">x: </span><span class="s2">f&quot;</span><span class="s0">{</span><span class="s1">x</span><span class="s0">:</span><span class="s2">,.0f</span><span class="s0">}</span><span class="s2">&quot;</span><span class="s1">)</span>
    <span class="s1">expected = expected_html(datapath</span><span class="s0">, </span><span class="s2">&quot;gh40024_expected_output&quot;</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">result == expected</span>
</pre>
</body>
</html>