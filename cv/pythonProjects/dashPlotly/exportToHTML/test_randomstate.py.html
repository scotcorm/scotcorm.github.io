<html>
<head>
<title>test_randomstate.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
.s5 { color: #a5c261;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_randomstate.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">hashlib</span>
<span class="s0">import </span><span class="s1">pickle</span>
<span class="s0">import </span><span class="s1">sys</span>
<span class="s0">import </span><span class="s1">warnings</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">pytest</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">(</span>
        <span class="s1">assert_</span><span class="s0">, </span><span class="s1">assert_raises</span><span class="s0">, </span><span class="s1">assert_equal</span><span class="s0">, </span><span class="s1">assert_warns</span><span class="s0">,</span>
        <span class="s1">assert_no_warnings</span><span class="s0">, </span><span class="s1">assert_array_equal</span><span class="s0">, </span><span class="s1">assert_array_almost_equal</span><span class="s0">,</span>
        <span class="s1">suppress_warnings</span>
        <span class="s1">)</span>

<span class="s0">from </span><span class="s1">numpy.random </span><span class="s0">import </span><span class="s1">MT19937</span><span class="s0">, </span><span class="s1">PCG64</span>
<span class="s0">from </span><span class="s1">numpy </span><span class="s0">import </span><span class="s1">random</span>

<span class="s1">INT_FUNCS = {</span><span class="s2">'binomial'</span><span class="s1">: (</span><span class="s3">100.0</span><span class="s0">, </span><span class="s3">0.6</span><span class="s1">)</span><span class="s0">,</span>
             <span class="s2">'geometric'</span><span class="s1">: (</span><span class="s3">.5</span><span class="s0">,</span><span class="s1">)</span><span class="s0">,</span>
             <span class="s2">'hypergeometric'</span><span class="s1">: (</span><span class="s3">20</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span><span class="s0">,</span>
             <span class="s2">'logseries'</span><span class="s1">: (</span><span class="s3">.5</span><span class="s0">,</span><span class="s1">)</span><span class="s0">,</span>
             <span class="s2">'multinomial'</span><span class="s1">: (</span><span class="s3">20</span><span class="s0">, </span><span class="s1">np.ones(</span><span class="s3">6</span><span class="s1">) / </span><span class="s3">6.0</span><span class="s1">)</span><span class="s0">,</span>
             <span class="s2">'negative_binomial'</span><span class="s1">: (</span><span class="s3">100</span><span class="s0">, </span><span class="s3">.5</span><span class="s1">)</span><span class="s0">,</span>
             <span class="s2">'poisson'</span><span class="s1">: (</span><span class="s3">10.0</span><span class="s0">,</span><span class="s1">)</span><span class="s0">,</span>
             <span class="s2">'zipf'</span><span class="s1">: (</span><span class="s3">2</span><span class="s0">,</span><span class="s1">)</span><span class="s0">,</span>
             <span class="s1">}</span>

<span class="s0">if </span><span class="s1">np.iinfo(int).max &lt; </span><span class="s3">2</span><span class="s1">**</span><span class="s3">32</span><span class="s1">:</span>
    <span class="s4"># Windows and some 32-bit platforms, e.g., ARM</span>
    <span class="s1">INT_FUNC_HASHES = {</span><span class="s2">'binomial'</span><span class="s1">: </span><span class="s2">'2fbead005fc63942decb5326d36a1f32fe2c9d32c904ee61e46866b88447c263'</span><span class="s0">,</span>
                       <span class="s2">'logseries'</span><span class="s1">: </span><span class="s2">'23ead5dcde35d4cfd4ef2c105e4c3d43304b45dc1b1444b7823b9ee4fa144ebb'</span><span class="s0">,</span>
                       <span class="s2">'geometric'</span><span class="s1">: </span><span class="s2">'0d764db64f5c3bad48c8c33551c13b4d07a1e7b470f77629bef6c985cac76fcf'</span><span class="s0">,</span>
                       <span class="s2">'hypergeometric'</span><span class="s1">: </span><span class="s2">'7b59bf2f1691626c5815cdcd9a49e1dd68697251d4521575219e4d2a1b8b2c67'</span><span class="s0">,</span>
                       <span class="s2">'multinomial'</span><span class="s1">: </span><span class="s2">'d754fa5b92943a38ec07630de92362dd2e02c43577fc147417dc5b9db94ccdd3'</span><span class="s0">,</span>
                       <span class="s2">'negative_binomial'</span><span class="s1">: </span><span class="s2">'8eb216f7cb2a63cf55605422845caaff002fddc64a7dc8b2d45acd477a49e824'</span><span class="s0">,</span>
                       <span class="s2">'poisson'</span><span class="s1">: </span><span class="s2">'70c891d76104013ebd6f6bcf30d403a9074b886ff62e4e6b8eb605bf1a4673b7'</span><span class="s0">,</span>
                       <span class="s2">'zipf'</span><span class="s1">: </span><span class="s2">'01f074f97517cd5d21747148ac6ca4074dde7fcb7acbaec0a936606fecacd93f'</span><span class="s0">,</span>
                       <span class="s1">}</span>
<span class="s0">else</span><span class="s1">:</span>
    <span class="s1">INT_FUNC_HASHES = {</span><span class="s2">'binomial'</span><span class="s1">: </span><span class="s2">'8626dd9d052cb608e93d8868de0a7b347258b199493871a1dc56e2a26cacb112'</span><span class="s0">,</span>
                       <span class="s2">'geometric'</span><span class="s1">: </span><span class="s2">'8edd53d272e49c4fc8fbbe6c7d08d563d62e482921f3131d0a0e068af30f0db9'</span><span class="s0">,</span>
                       <span class="s2">'hypergeometric'</span><span class="s1">: </span><span class="s2">'83496cc4281c77b786c9b7ad88b74d42e01603a55c60577ebab81c3ba8d45657'</span><span class="s0">,</span>
                       <span class="s2">'logseries'</span><span class="s1">: </span><span class="s2">'65878a38747c176bc00e930ebafebb69d4e1e16cd3a704e264ea8f5e24f548db'</span><span class="s0">,</span>
                       <span class="s2">'multinomial'</span><span class="s1">: </span><span class="s2">'7a984ae6dca26fd25374479e118b22f55db0aedccd5a0f2584ceada33db98605'</span><span class="s0">,</span>
                       <span class="s2">'negative_binomial'</span><span class="s1">: </span><span class="s2">'d636d968e6a24ae92ab52fe11c46ac45b0897e98714426764e820a7d77602a61'</span><span class="s0">,</span>
                       <span class="s2">'poisson'</span><span class="s1">: </span><span class="s2">'956552176f77e7c9cb20d0118fc9cf690be488d790ed4b4c4747b965e61b0bb4'</span><span class="s0">,</span>
                       <span class="s2">'zipf'</span><span class="s1">: </span><span class="s2">'f84ba7feffda41e606e20b28dfc0f1ea9964a74574513d4a4cbc98433a8bfa45'</span><span class="s0">,</span>
                       <span class="s1">}</span>


<span class="s1">@pytest.fixture(scope=</span><span class="s2">'module'</span><span class="s0">, </span><span class="s1">params=INT_FUNCS)</span>
<span class="s0">def </span><span class="s1">int_func(request):</span>
    <span class="s0">return </span><span class="s1">(request.param</span><span class="s0">, </span><span class="s1">INT_FUNCS[request.param]</span><span class="s0">,</span>
            <span class="s1">INT_FUNC_HASHES[request.param])</span>


<span class="s0">def </span><span class="s1">assert_mt19937_state_equal(a</span><span class="s0">, </span><span class="s1">b):</span>
    <span class="s1">assert_equal(a[</span><span class="s2">'bit_generator'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">b[</span><span class="s2">'bit_generator'</span><span class="s1">])</span>
    <span class="s1">assert_array_equal(a[</span><span class="s2">'state'</span><span class="s1">][</span><span class="s2">'key'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">b[</span><span class="s2">'state'</span><span class="s1">][</span><span class="s2">'key'</span><span class="s1">])</span>
    <span class="s1">assert_array_equal(a[</span><span class="s2">'state'</span><span class="s1">][</span><span class="s2">'pos'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">b[</span><span class="s2">'state'</span><span class="s1">][</span><span class="s2">'pos'</span><span class="s1">])</span>
    <span class="s1">assert_equal(a[</span><span class="s2">'has_gauss'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">b[</span><span class="s2">'has_gauss'</span><span class="s1">])</span>
    <span class="s1">assert_equal(a[</span><span class="s2">'gauss'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">b[</span><span class="s2">'gauss'</span><span class="s1">])</span>


<span class="s0">class </span><span class="s1">TestSeed:</span>
    <span class="s0">def </span><span class="s1">test_scalar(self):</span>
        <span class="s1">s = random.RandomState(</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">684</span><span class="s1">)</span>
        <span class="s1">s = random.RandomState(</span><span class="s3">4294967295</span><span class="s1">)</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">419</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_array(self):</span>
        <span class="s1">s = random.RandomState(range(</span><span class="s3">10</span><span class="s1">))</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">468</span><span class="s1">)</span>
        <span class="s1">s = random.RandomState(np.arange(</span><span class="s3">10</span><span class="s1">))</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">468</span><span class="s1">)</span>
        <span class="s1">s = random.RandomState([</span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">973</span><span class="s1">)</span>
        <span class="s1">s = random.RandomState([</span><span class="s3">4294967295</span><span class="s1">])</span>
        <span class="s1">assert_equal(s.randint(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">265</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_scalar(self):</span>
        <span class="s4"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.5</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_array(self):</span>
        <span class="s4"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">0.5</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">1</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4294967296</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4294967296</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s3">4294967296</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_invalid_array_shape(self):</span>
        <span class="s4"># gh-9832</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">np.array([]</span><span class="s0">,</span>
                                                               <span class="s1">dtype=np.int64))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                                                       <span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]])</span>

    <span class="s0">def </span><span class="s1">test_cannot_seed(self):</span>
        <span class="s1">rs = random.RandomState(PCG64(</span><span class="s3">0</span><span class="s1">))</span>
        <span class="s0">with </span><span class="s1">assert_raises(TypeError):</span>
            <span class="s1">rs.seed(</span><span class="s3">1234</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_initialization(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.RandomState</span><span class="s0">, </span><span class="s1">MT19937)</span>


<span class="s0">class </span><span class="s1">TestBinomial:</span>
    <span class="s0">def </span><span class="s1">test_n_zero(self):</span>
        <span class="s4"># Tests the corner case of n == 0 for the binomial distribution.</span>
        <span class="s4"># binomial(0, p) should be zero for any p in [0, 1].</span>
        <span class="s4"># This test addresses issue #3480.</span>
        <span class="s1">zeros = np.zeros(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'int'</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">p </span><span class="s0">in </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">.5</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]:</span>
            <span class="s1">assert_(random.binomial(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">p) == </span><span class="s3">0</span><span class="s1">)</span>
            <span class="s1">assert_array_equal(random.binomial(zeros</span><span class="s0">, </span><span class="s1">p)</span><span class="s0">, </span><span class="s1">zeros)</span>

    <span class="s0">def </span><span class="s1">test_p_is_nan(self):</span>
        <span class="s4"># Issue #4571.</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.binomial</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.nan)</span>


<span class="s0">class </span><span class="s1">TestMultinomial:</span>
    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">random.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_zero_probability(self):</span>
        <span class="s1">random.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_int_negative_interval(self):</span>
        <span class="s1">assert_(-</span><span class="s3">5 </span><span class="s1">&lt;= random.randint(-</span><span class="s3">5</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">) &lt; -</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">x = random.randint(-</span><span class="s3">5</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(-</span><span class="s3">5 </span><span class="s1">&lt;= x))</span>
        <span class="s1">assert_(np.all(x &lt; -</span><span class="s3">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_size(self):</span>
        <span class="s4"># gh-3173</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.array((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))).shape</span><span class="s0">,</span>
                     <span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>

        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">,</span>
                      <span class="s1">float(</span><span class="s3">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_invalid_prob(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s3">100</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1.1</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s3">100</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">.1</span><span class="s0">, </span><span class="s3">0.9</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_invalid_n(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_p_non_contiguous(self):</span>
        <span class="s1">p = np.arange(</span><span class="s3">15.</span><span class="s1">)</span>
        <span class="s1">p /= np.sum(p[</span><span class="s3">1</span><span class="s1">::</span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">pvals = p[</span><span class="s3">1</span><span class="s1">::</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">random.seed(</span><span class="s3">1432985819</span><span class="s1">)</span>
        <span class="s1">non_contig = random.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">pvals=pvals)</span>
        <span class="s1">random.seed(</span><span class="s3">1432985819</span><span class="s1">)</span>
        <span class="s1">contig = random.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">pvals=np.ascontiguousarray(pvals))</span>
        <span class="s1">assert_array_equal(non_contig</span><span class="s0">, </span><span class="s1">contig)</span>

    <span class="s0">def </span><span class="s1">test_multinomial_pvals_float32(self):</span>
        <span class="s1">x = np.array([</span><span class="s3">9.9e-01</span><span class="s0">, </span><span class="s3">9.9e-01</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">,</span>
                      <span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">pvals = x / x.sum()</span>
        <span class="s1">match = </span><span class="s2">r&quot;[\w\s]*pvals array is cast to 64-bit floating&quot;</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=match):</span>
            <span class="s1">random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">pvals)</span>


<span class="s0">class </span><span class="s1">TestSetState:</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s3">1234567890</span>
        <span class="s1">self.random_state = random.RandomState(self.seed)</span>
        <span class="s1">self.state = self.random_state.get_state()</span>

    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">old = self.random_state.tomaxint(</span><span class="s3">16</span><span class="s1">)</span>
        <span class="s1">self.random_state.set_state(self.state)</span>
        <span class="s1">new = self.random_state.tomaxint(</span><span class="s3">16</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(old == new))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset(self):</span>
        <span class="s4"># Make sure the cached every-other-Gaussian is reset.</span>
        <span class="s1">old = self.random_state.standard_normal(size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">self.random_state.set_state(self.state)</span>
        <span class="s1">new = self.random_state.standard_normal(size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(old == new))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset_in_media_res(self):</span>
        <span class="s4"># When the state is saved with a cached Gaussian, make sure the</span>
        <span class="s4"># cached Gaussian is restored.</span>

        <span class="s1">self.random_state.standard_normal()</span>
        <span class="s1">state = self.random_state.get_state()</span>
        <span class="s1">old = self.random_state.standard_normal(size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">self.random_state.set_state(state)</span>
        <span class="s1">new = self.random_state.standard_normal(size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(old == new))</span>

    <span class="s0">def </span><span class="s1">test_backwards_compatibility(self):</span>
        <span class="s4"># Make sure we can accept old state tuples that do not have the</span>
        <span class="s4"># cached Gaussian value.</span>
        <span class="s1">old_state = self.state[:-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">x1 = self.random_state.standard_normal(size=</span><span class="s3">16</span><span class="s1">)</span>
        <span class="s1">self.random_state.set_state(old_state)</span>
        <span class="s1">x2 = self.random_state.standard_normal(size=</span><span class="s3">16</span><span class="s1">)</span>
        <span class="s1">self.random_state.set_state(self.state)</span>
        <span class="s1">x3 = self.random_state.standard_normal(size=</span><span class="s3">16</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(x1 == x2))</span>
        <span class="s1">assert_(np.all(x1 == x3))</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s4"># Ensure that the negative binomial results take floating point</span>
        <span class="s4"># arguments without truncation.</span>
        <span class="s1">self.random_state.negative_binomial(</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_get_state_warning(self):</span>
        <span class="s1">rs = random.RandomState(PCG64())</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">w = sup.record(RuntimeWarning)</span>
            <span class="s1">state = rs.get_state()</span>
            <span class="s1">assert_(len(w) == </span><span class="s3">1</span><span class="s1">)</span>
            <span class="s0">assert </span><span class="s1">isinstance(state</span><span class="s0">, </span><span class="s1">dict)</span>
            <span class="s0">assert </span><span class="s1">state[</span><span class="s2">'bit_generator'</span><span class="s1">] == </span><span class="s2">'PCG64'</span>

    <span class="s0">def </span><span class="s1">test_invalid_legacy_state_setting(self):</span>
        <span class="s1">state = self.random_state.get_state()</span>
        <span class="s1">new_state = (</span><span class="s2">'Unknown'</span><span class="s0">, </span><span class="s1">) + state[</span><span class="s3">1</span><span class="s1">:]</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.random_state.set_state</span><span class="s0">, </span><span class="s1">new_state)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">self.random_state.set_state</span><span class="s0">,</span>
                      <span class="s1">np.array(new_state</span><span class="s0">, </span><span class="s1">dtype=object))</span>
        <span class="s1">state = self.random_state.get_state(legacy=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s0">del </span><span class="s1">state[</span><span class="s2">'bit_generator'</span><span class="s1">]</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.random_state.set_state</span><span class="s0">, </span><span class="s1">state)</span>

    <span class="s0">def </span><span class="s1">test_pickle(self):</span>
        <span class="s1">self.random_state.seed(</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">self.random_state.random_sample(</span><span class="s3">100</span><span class="s1">)</span>
        <span class="s1">self.random_state.standard_normal()</span>
        <span class="s1">pickled = self.random_state.get_state(legacy=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_equal(pickled[</span><span class="s2">'has_gauss'</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">rs_unpick = pickle.loads(pickle.dumps(self.random_state))</span>
        <span class="s1">unpickled = rs_unpick.get_state(legacy=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_mt19937_state_equal(pickled</span><span class="s0">, </span><span class="s1">unpickled)</span>

    <span class="s0">def </span><span class="s1">test_state_setting(self):</span>
        <span class="s1">attr_state = self.random_state.__getstate__()</span>
        <span class="s1">self.random_state.standard_normal()</span>
        <span class="s1">self.random_state.__setstate__(attr_state)</span>
        <span class="s1">state = self.random_state.get_state(legacy=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_mt19937_state_equal(attr_state</span><span class="s0">, </span><span class="s1">state)</span>

    <span class="s0">def </span><span class="s1">test_repr(self):</span>
        <span class="s0">assert </span><span class="s1">repr(self.random_state).startswith(</span><span class="s2">'RandomState(MT19937)'</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestRandint:</span>

    <span class="s1">rfunc = random.randint</span>

    <span class="s4"># valid integer/boolean types</span>
    <span class="s1">itype = [np.bool_</span><span class="s0">, </span><span class="s1">np.int8</span><span class="s0">, </span><span class="s1">np.uint8</span><span class="s0">, </span><span class="s1">np.int16</span><span class="s0">, </span><span class="s1">np.uint16</span><span class="s0">,</span>
             <span class="s1">np.int32</span><span class="s0">, </span><span class="s1">np.uint32</span><span class="s0">, </span><span class="s1">np.int64</span><span class="s0">, </span><span class="s1">np.uint64]</span>

    <span class="s0">def </span><span class="s1">test_unsupported_type(self):</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">dtype=float)</span>

    <span class="s0">def </span><span class="s1">test_bounds_checking(self):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">lbnd - </span><span class="s3">1</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">lbnd</span><span class="s0">, </span><span class="s1">ubnd + </span><span class="s3">1</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">lbnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">dtype=dt)</span>

    <span class="s0">def </span><span class="s1">test_rng_zero_and_extremes(self):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>

            <span class="s1">tgt = ubnd - </span><span class="s3">1</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + </span><span class="s3">1</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

            <span class="s1">tgt = lbnd</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + </span><span class="s3">1</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

            <span class="s1">tgt = (lbnd + ubnd)//</span><span class="s3">2</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + </span><span class="s3">1</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

    <span class="s0">def </span><span class="s1">test_full_range(self):</span>
        <span class="s4"># Test for ticket #1690</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>

            <span class="s0">try</span><span class="s1">:</span>
                <span class="s1">self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e:</span>
                <span class="s0">raise </span><span class="s1">AssertionError(</span><span class="s2">&quot;No error should have been raised, &quot;</span>
                                     <span class="s2">&quot;but one was with the following &quot;</span>
                                     <span class="s2">&quot;message:</span><span class="s0">\n\n</span><span class="s2">%s&quot; </span><span class="s1">% str(e))</span>

    <span class="s0">def </span><span class="s1">test_in_bounds_fuzz(self):</span>
        <span class="s4"># Don't use fixed seed</span>
        <span class="s1">random.seed()</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype[</span><span class="s3">1</span><span class="s1">:]:</span>
            <span class="s0">for </span><span class="s1">ubnd </span><span class="s0">in </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">16</span><span class="s1">]:</span>
                <span class="s1">vals = self.rfunc(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">2</span><span class="s1">**</span><span class="s3">16</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
                <span class="s1">assert_(vals.max() &lt; ubnd)</span>
                <span class="s1">assert_(vals.min() &gt;= </span><span class="s3">2</span><span class="s1">)</span>

        <span class="s1">vals = self.rfunc(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">2</span><span class="s1">**</span><span class="s3">16</span><span class="s0">, </span><span class="s1">dtype=np.bool_)</span>

        <span class="s1">assert_(vals.max() &lt; </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">assert_(vals.min() &gt;= </span><span class="s3">0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability(self):</span>
        <span class="s4"># We use a sha256 hash of generated sequences of 1000 samples</span>
        <span class="s4"># in the range [0, 6) for all but bool, where the range</span>
        <span class="s4"># is [0, 2). Hashes are for little endian numbers.</span>
        <span class="s1">tgt = {</span><span class="s2">'bool'</span><span class="s1">: </span><span class="s2">'509aea74d792fb931784c4b0135392c65aec64beee12b0cc167548a2c3d31e71'</span><span class="s0">,</span>
               <span class="s2">'int16'</span><span class="s1">: </span><span class="s2">'7b07f1a920e46f6d0fe02314155a2330bcfd7635e708da50e536c5ebb631a7d4'</span><span class="s0">,</span>
               <span class="s2">'int32'</span><span class="s1">: </span><span class="s2">'e577bfed6c935de944424667e3da285012e741892dcb7051a8f1ce68ab05c92f'</span><span class="s0">,</span>
               <span class="s2">'int64'</span><span class="s1">: </span><span class="s2">'0fbead0b06759df2cfb55e43148822d4a1ff953c7eb19a5b08445a63bb64fa9e'</span><span class="s0">,</span>
               <span class="s2">'int8'</span><span class="s1">: </span><span class="s2">'001aac3a5acb935a9b186cbe14a1ca064b8bb2dd0b045d48abeacf74d0203404'</span><span class="s0">,</span>
               <span class="s2">'uint16'</span><span class="s1">: </span><span class="s2">'7b07f1a920e46f6d0fe02314155a2330bcfd7635e708da50e536c5ebb631a7d4'</span><span class="s0">,</span>
               <span class="s2">'uint32'</span><span class="s1">: </span><span class="s2">'e577bfed6c935de944424667e3da285012e741892dcb7051a8f1ce68ab05c92f'</span><span class="s0">,</span>
               <span class="s2">'uint64'</span><span class="s1">: </span><span class="s2">'0fbead0b06759df2cfb55e43148822d4a1ff953c7eb19a5b08445a63bb64fa9e'</span><span class="s0">,</span>
               <span class="s2">'uint8'</span><span class="s1">: </span><span class="s2">'001aac3a5acb935a9b186cbe14a1ca064b8bb2dd0b045d48abeacf74d0203404'</span><span class="s1">}</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype[</span><span class="s3">1</span><span class="s1">:]:</span>
            <span class="s1">random.seed(</span><span class="s3">1234</span><span class="s1">)</span>

            <span class="s4"># view as little endian for hash</span>
            <span class="s0">if </span><span class="s1">sys.byteorder == </span><span class="s2">'little'</span><span class="s1">:</span>
                <span class="s1">val = self.rfunc(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">val = self.rfunc(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">dtype=dt).byteswap()</span>

            <span class="s1">res = hashlib.sha256(val.view(np.int8)).hexdigest()</span>
            <span class="s1">assert_(tgt[np.dtype(dt).name] == res)</span>

        <span class="s4"># bools do not depend on endianness</span>
        <span class="s1">random.seed(</span><span class="s3">1234</span><span class="s1">)</span>
        <span class="s1">val = self.rfunc(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">dtype=bool).view(np.int8)</span>
        <span class="s1">res = hashlib.sha256(val).hexdigest()</span>
        <span class="s1">assert_(tgt[np.dtype(bool).name] == res)</span>

    <span class="s1">@pytest.mark.skipif(np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max &lt; </span><span class="s3">2</span><span class="s1">**</span><span class="s3">32</span><span class="s0">,</span>
                        <span class="s1">reason=</span><span class="s2">'Cannot test with 32-bit C long'</span><span class="s1">)</span>
    <span class="s0">def </span><span class="s1">test_repeatability_32bit_boundary_broadcasting(self):</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">3992670689</span><span class="s0">, </span><span class="s3">2438360420</span><span class="s0">, </span><span class="s3">2557845020</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">4107320065</span><span class="s0">, </span><span class="s3">4142558326</span><span class="s0">, </span><span class="s3">3216529513</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1605979228</span><span class="s0">, </span><span class="s3">2807061240</span><span class="s0">,  </span><span class="s3">665605495</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">3211410639</span><span class="s0">, </span><span class="s3">4128781000</span><span class="s0">,  </span><span class="s3">457175120</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1712592594</span><span class="s0">, </span><span class="s3">1282922662</span><span class="s0">, </span><span class="s3">3081439808</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">3997822960</span><span class="s0">, </span><span class="s3">2008322436</span><span class="s0">, </span><span class="s3">1563495165</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">1398375547</span><span class="s0">, </span><span class="s3">4269260146</span><span class="s0">,  </span><span class="s3">115316740</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">3414372578</span><span class="s0">, </span><span class="s3">3437564012</span><span class="s0">, </span><span class="s3">2112038651</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">3572980305</span><span class="s0">, </span><span class="s3">2260248732</span><span class="s0">, </span><span class="s3">3908238631</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">2561372503</span><span class="s0">,  </span><span class="s3">223155946</span><span class="s0">, </span><span class="s3">3127879445</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">441282060</span><span class="s0">, </span><span class="s3">3514786552</span><span class="s0">, </span><span class="s3">2148440361</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1629275283</span><span class="s0">, </span><span class="s3">3479737011</span><span class="s0">, </span><span class="s3">3003195987</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[ </span><span class="s3">412181688</span><span class="s0">,  </span><span class="s3">940383289</span><span class="s0">, </span><span class="s3">3047321305</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">2978368172</span><span class="s0">,  </span><span class="s3">764731833</span><span class="s0">, </span><span class="s3">2282559898</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">105711276</span><span class="s0">,  </span><span class="s3">720447391</span><span class="s0">, </span><span class="s3">3596512484</span><span class="s1">]]])</span>
        <span class="s0">for </span><span class="s1">size </span><span class="s0">in </span><span class="s1">[</span><span class="s0">None, </span><span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)]:</span>
            <span class="s1">random.seed(</span><span class="s3">12345</span><span class="s1">)</span>
            <span class="s1">x = self.rfunc([[-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s1">**</span><span class="s3">32 </span><span class="s1">- </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">32</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">32 </span><span class="s1">+ </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                           <span class="s1">size=size)</span>
            <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">desired </span><span class="s0">if </span><span class="s1">size </span><span class="s0">is not None else </span><span class="s1">desired[</span><span class="s3">0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_int64_uint64_corner_case(self):</span>
        <span class="s4"># When stored in Numpy arrays, `lbnd` is casted</span>
        <span class="s4"># as np.int64, and `ubnd` is casted as np.uint64.</span>
        <span class="s4"># Checking whether `lbnd` &gt;= `ubnd` used to be</span>
        <span class="s4"># done solely via direct comparison, which is incorrect</span>
        <span class="s4"># because when Numpy tries to compare both numbers,</span>
        <span class="s4"># it casts both to np.float64 because there is</span>
        <span class="s4"># no integer superset of np.int64 and np.uint64. However,</span>
        <span class="s4"># `ubnd` is too large to be represented in np.float64,</span>
        <span class="s4"># causing it be round down to np.iinfo(np.int64).max,</span>
        <span class="s4"># leading to a ValueError because `lbnd` now equals</span>
        <span class="s4"># the new `ubnd`.</span>

        <span class="s1">dt = np.int64</span>
        <span class="s1">tgt = np.iinfo(np.int64).max</span>
        <span class="s1">lbnd = np.int64(np.iinfo(np.int64).max)</span>
        <span class="s1">ubnd = np.uint64(np.iinfo(np.int64).max + </span><span class="s3">1</span><span class="s1">)</span>

        <span class="s4"># None of these function calls should</span>
        <span class="s4"># generate a ValueError now.</span>
        <span class="s1">actual = random.randint(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">tgt)</span>

    <span class="s0">def </span><span class="s1">test_respect_dtype_singleton(self):</span>
        <span class="s4"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">np.bool_ </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>

            <span class="s1">sample = self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_equal(sample.dtype</span><span class="s0">, </span><span class="s1">np.dtype(dt))</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">(bool</span><span class="s0">, </span><span class="s1">int</span><span class="s0">, </span><span class="s1">np.compat.long):</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>

            <span class="s4"># gh-7284: Ensure that we get Python data types</span>
            <span class="s1">sample = self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">hasattr(sample</span><span class="s0">, </span><span class="s2">'dtype'</span><span class="s1">))</span>
            <span class="s1">assert_equal(type(sample)</span><span class="s0">, </span><span class="s1">dt)</span>


<span class="s0">class </span><span class="s1">TestRandomDist:</span>
    <span class="s4"># Make sure the random distribution returns the correct value for a</span>
    <span class="s4"># given seed</span>

    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s3">1234567890</span>

    <span class="s0">def </span><span class="s1">test_rand(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.rand(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.61879477158567997</span><span class="s0">, </span><span class="s3">0.59162362775974664</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.88868358904449662</span><span class="s0">, </span><span class="s3">0.89165480011560816</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.4575674820298663</span><span class="s0">, </span><span class="s3">0.7781880808593471</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rand_singleton(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.rand()</span>
        <span class="s1">desired = </span><span class="s3">0.61879477158567997</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_randn(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.randn(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.34016345771863121</span><span class="s0">, </span><span class="s3">1.73759122771936081</span><span class="s1">]</span><span class="s0">,</span>
                           <span class="s1">[</span><span class="s3">1.498988344300628</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.2286433324536169</span><span class="s1">]</span><span class="s0">,</span>
                           <span class="s1">[</span><span class="s3">2.031033998682787</span><span class="s0">, </span><span class="s3">2.17032494605655257</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.randn()</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_randint(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.randint(-</span><span class="s3">99</span><span class="s0">, </span><span class="s3">99</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">31</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">52</span><span class="s0">, </span><span class="s3">41</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">48</span><span class="s0">, </span><span class="s1">-</span><span class="s3">66</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_random_integers(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">w = sup.record(DeprecationWarning)</span>
            <span class="s1">actual = random.random_integers(-</span><span class="s3">99</span><span class="s0">, </span><span class="s3">99</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
            <span class="s1">assert_(len(w) == </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">31</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">52</span><span class="s0">, </span><span class="s3">41</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">48</span><span class="s0">, </span><span class="s1">-</span><span class="s3">66</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">w = sup.record(DeprecationWarning)</span>
            <span class="s1">actual = random.random_integers(</span><span class="s3">198</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
            <span class="s1">assert_(len(w) == </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired + </span><span class="s3">100</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_tomaxint(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">rs = random.RandomState(self.seed)</span>
        <span class="s1">actual = rs.tomaxint(size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s0">if </span><span class="s1">np.iinfo(int).max == </span><span class="s3">2147483647</span><span class="s1">:</span>
            <span class="s1">desired = np.array([[</span><span class="s3">1328851649</span><span class="s0">,  </span><span class="s3">731237375</span><span class="s1">]</span><span class="s0">,</span>
                                <span class="s1">[</span><span class="s3">1270502067</span><span class="s0">,  </span><span class="s3">320041495</span><span class="s1">]</span><span class="s0">,</span>
                                <span class="s1">[</span><span class="s3">1908433478</span><span class="s0">,  </span><span class="s3">499156889</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">desired = np.array([[</span><span class="s3">5707374374421908479</span><span class="s0">, </span><span class="s3">5456764827585442327</span><span class="s1">]</span><span class="s0">,</span>
                                <span class="s1">[</span><span class="s3">8196659375100692377</span><span class="s0">, </span><span class="s3">8224063923314595285</span><span class="s1">]</span><span class="s0">,</span>
                                <span class="s1">[</span><span class="s3">4220315081820346526</span><span class="s0">, </span><span class="s3">7177518203184491332</span><span class="s1">]]</span><span class="s0">,</span>
                               <span class="s1">dtype=np.int64)</span>

        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">rs.seed(self.seed)</span>
        <span class="s1">actual = rs.tomaxint()</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_random_integers_max_int(self):</span>
        <span class="s4"># Tests whether random_integers can generate the</span>
        <span class="s4"># maximum allowed Python int that can be converted</span>
        <span class="s4"># into a C long. Previous implementations of this</span>
        <span class="s4"># method have thrown an OverflowError when attempting</span>
        <span class="s4"># to generate this integer.</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">w = sup.record(DeprecationWarning)</span>
            <span class="s1">actual = random.random_integers(np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max</span><span class="s0">,</span>
                                            <span class="s1">np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max)</span>
            <span class="s1">assert_(len(w) == </span><span class="s3">1</span><span class="s1">)</span>

        <span class="s1">desired = np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">w = sup.record(DeprecationWarning)</span>
            <span class="s1">typer = np.dtype(</span><span class="s2">'l'</span><span class="s1">).type</span>
            <span class="s1">actual = random.random_integers(typer(np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max)</span><span class="s0">,</span>
                                            <span class="s1">typer(np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max))</span>
            <span class="s1">assert_(len(w) == </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_random_integers_deprecated(self):</span>
        <span class="s0">with </span><span class="s1">warnings.catch_warnings():</span>
            <span class="s1">warnings.simplefilter(</span><span class="s2">&quot;error&quot;</span><span class="s0">, </span><span class="s1">DeprecationWarning)</span>

            <span class="s4"># DeprecationWarning raised with high == None</span>
            <span class="s1">assert_raises(DeprecationWarning</span><span class="s0">,</span>
                          <span class="s1">random.random_integers</span><span class="s0">,</span>
                          <span class="s1">np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max)</span>

            <span class="s4"># DeprecationWarning raised with high != None</span>
            <span class="s1">assert_raises(DeprecationWarning</span><span class="s0">,</span>
                          <span class="s1">random.random_integers</span><span class="s0">,</span>
                          <span class="s1">np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max</span><span class="s0">, </span><span class="s1">np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max)</span>

    <span class="s0">def </span><span class="s1">test_random_sample(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.random_sample((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.61879477158567997</span><span class="s0">, </span><span class="s3">0.59162362775974664</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.88868358904449662</span><span class="s0">, </span><span class="s3">0.89165480011560816</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.4575674820298663</span><span class="s0">, </span><span class="s3">0.7781880808593471</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.random_sample()</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_replace(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_replace(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">p=[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_noreplace(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_noreplace(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=[</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>
        <span class="s1">desired = np.array([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_noninteger(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.choice([</span><span class="s2">'a'</span><span class="s0">, </span><span class="s2">'b'</span><span class="s0">, </span><span class="s2">'c'</span><span class="s0">, </span><span class="s2">'d'</span><span class="s1">]</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s2">'c'</span><span class="s0">, </span><span class="s2">'d'</span><span class="s0">, </span><span class="s2">'c'</span><span class="s0">, </span><span class="s2">'d'</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_exceptions(self):</span>
        <span class="s1">sample = random.choice</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s3">3.</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]]</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[]</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">,</span>
                      <span class="s1">p=[[</span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.25</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.25</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s3">1.1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.4</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s4"># gh-13087</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s3">2</span><span class="s0">,</span>
                      <span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_choice_return_shape(self):</span>
        <span class="s1">p = [</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.9</span><span class="s1">]</span>
        <span class="s4"># Check scalar</span>
        <span class="s1">assert_(np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)))</span>
        <span class="s1">assert_(np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(np.isscalar(random.choice([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(random.choice([</span><span class="s0">None</span><span class="s1">]</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">) </span><span class="s0">is None</span><span class="s1">)</span>
        <span class="s1">a = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">arr = np.empty(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">dtype=object)</span>
        <span class="s1">arr[</span><span class="s3">0</span><span class="s1">] = a</span>
        <span class="s1">assert_(random.choice(arr</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">) </span><span class="s0">is </span><span class="s1">a)</span>

        <span class="s4"># Check 0-d array</span>
        <span class="s1">s = tuple()</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(random.choice([</span><span class="s0">None</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).ndim == </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">a = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">arr = np.empty(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">dtype=object)</span>
        <span class="s1">arr[</span><span class="s3">0</span><span class="s1">] = a</span>
        <span class="s1">assert_(random.choice(arr</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).item() </span><span class="s0">is </span><span class="s1">a)</span>

        <span class="s4"># Check multi dimensional array</span>
        <span class="s1">s = (</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">p = [</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">]</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(random.choice(np.arange(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>

        <span class="s4"># Check zero-size</span>
        <span class="s1">assert_equal(random.randint(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.randint(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.randint(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.choice([]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.choice([</span><span class="s2">'a'</span><span class="s0">, </span><span class="s2">'b'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)).shape</span><span class="s0">,</span>
                     <span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.choice</span><span class="s0">, </span><span class="s1">[]</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nan_probabilities(self):</span>
        <span class="s1">a = np.array([</span><span class="s3">42</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">p = [</span><span class="s0">None, None, None</span><span class="s1">]</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.choice</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">p=p)</span>

    <span class="s0">def </span><span class="s1">test_choice_p_non_contiguous(self):</span>
        <span class="s1">p = np.ones(</span><span class="s3">10</span><span class="s1">) / </span><span class="s3">5</span>
        <span class="s1">p[</span><span class="s3">1</span><span class="s1">::</span><span class="s3">2</span><span class="s1">] = </span><span class="s3">3.0</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">non_contig = random.choice(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=p[::</span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">contig = random.choice(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=np.ascontiguousarray(p[::</span><span class="s3">2</span><span class="s1">]))</span>
        <span class="s1">assert_array_equal(non_contig</span><span class="s0">, </span><span class="s1">contig)</span>

    <span class="s0">def </span><span class="s1">test_bytes(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.bytes(</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">desired = </span><span class="s5">b'</span><span class="s0">\x82</span><span class="s5">Ui</span><span class="s0">\x9e\xff\x97</span><span class="s5">+Wf</span><span class="s0">\xa5</span><span class="s5">'</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_shuffle(self):</span>
        <span class="s4"># Test lists, arrays (of various dtypes), and multidimensional versions</span>
        <span class="s4"># of both, c-contiguous or not:</span>
        <span class="s0">for </span><span class="s1">conv </span><span class="s0">in </span><span class="s1">[</span><span class="s0">lambda </span><span class="s1">x: np.array([])</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: x</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.int8)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.float32)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.complex64)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(object)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: [(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray([[i</span><span class="s0">, </span><span class="s1">i] </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x])</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.vstack([x</span><span class="s0">, </span><span class="s1">x]).T</span><span class="s0">,</span>
                     <span class="s4"># gh-11442</span>
                     <span class="s0">lambda </span><span class="s1">x: (np.asarray([(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                                           <span class="s1">[(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">int)</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">int)])</span>
                                <span class="s1">.view(np.recarray))</span><span class="s0">,</span>
                     <span class="s4"># gh-4270</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray([(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                                          <span class="s1">[(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">object</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">))</span><span class="s0">,</span>
                                           <span class="s1">(</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.int32</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">))])]:</span>
            <span class="s1">random.seed(self.seed)</span>
            <span class="s1">alist = conv([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
            <span class="s1">random.shuffle(alist)</span>
            <span class="s1">actual = alist</span>
            <span class="s1">desired = conv([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
            <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_masked(self):</span>
        <span class="s4"># gh-3263</span>
        <span class="s1">a = np.ma.masked_values(np.reshape(range(</span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)) % </span><span class="s3">3 </span><span class="s1">- </span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">b = np.ma.masked_values(np.arange(</span><span class="s3">20</span><span class="s1">) % </span><span class="s3">3 </span><span class="s1">- </span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">a_orig = a.copy()</span>
        <span class="s1">b_orig = b.copy()</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">50</span><span class="s1">):</span>
            <span class="s1">random.shuffle(a)</span>
            <span class="s1">assert_equal(</span>
                <span class="s1">sorted(a.data[~a.mask])</span><span class="s0">, </span><span class="s1">sorted(a_orig.data[~a_orig.mask]))</span>
            <span class="s1">random.shuffle(b)</span>
            <span class="s1">assert_equal(</span>
                <span class="s1">sorted(b.data[~b.mask])</span><span class="s0">, </span><span class="s1">sorted(b_orig.data[~b_orig.mask]))</span>

        <span class="s0">def </span><span class="s1">test_shuffle_invalid_objects(self):</span>
            <span class="s1">x = np.array(</span><span class="s3">3</span><span class="s1">)</span>
            <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.shuffle</span><span class="s0">, </span><span class="s1">x)</span>

    <span class="s0">def </span><span class="s1">test_permutation(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">alist = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">actual = random.permutation(alist)</span>
        <span class="s1">desired = [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">arr_2d = np.atleast_2d([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]).T</span>
        <span class="s1">actual = random.permutation(arr_2d)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">np.atleast_2d(desired).T)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">bad_x_str = </span><span class="s2">&quot;abcd&quot;</span>
        <span class="s1">assert_raises(IndexError</span><span class="s0">, </span><span class="s1">random.permutation</span><span class="s0">, </span><span class="s1">bad_x_str)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">bad_x_float = </span><span class="s3">1.2</span>
        <span class="s1">assert_raises(IndexError</span><span class="s0">, </span><span class="s1">random.permutation</span><span class="s0">, </span><span class="s1">bad_x_float)</span>

        <span class="s1">integer_val = </span><span class="s3">10</span>
        <span class="s1">desired = [</span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.permutation(integer_val)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_beta(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.beta(</span><span class="s3">.1</span><span class="s0">, </span><span class="s3">.9</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array(</span>
                <span class="s1">[[</span><span class="s3">1.45341850513746058e-02</span><span class="s0">, </span><span class="s3">5.31297615662868145e-04</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s3">1.85366619058432324e-06</span><span class="s0">, </span><span class="s3">4.19214516800110563e-03</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s3">1.58405155108498093e-04</span><span class="s0">, </span><span class="s3">1.26252891949397652e-04</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_binomial(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.binomial(</span><span class="s3">100.123</span><span class="s0">, </span><span class="s3">.456</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">37</span><span class="s0">, </span><span class="s3">43</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">42</span><span class="s0">, </span><span class="s3">48</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">46</span><span class="s0">, </span><span class="s3">45</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.binomial(</span><span class="s3">100.123</span><span class="s0">, </span><span class="s3">.456</span><span class="s1">)</span>
        <span class="s1">desired = </span><span class="s3">37</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_chisquare(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.chisquare(</span><span class="s3">50</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">63.87858175501090585</span><span class="s0">, </span><span class="s3">68.68407748911370447</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">65.77116116901505904</span><span class="s0">, </span><span class="s3">47.09686762438974483</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">72.3828403199695174</span><span class="s0">, </span><span class="s3">74.18408615260374006</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">alpha = np.array([</span><span class="s3">51.72840233779265162</span><span class="s0">, </span><span class="s3">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">actual = random.dirichlet(alpha</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">0.54539444573611562</span><span class="s0">, </span><span class="s3">0.45460555426388438</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">0.62345816822039413</span><span class="s0">, </span><span class="s3">0.37654183177960598</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">0.55206000085785778</span><span class="s0">, </span><span class="s3">0.44793999914214233</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">0.58964023305154301</span><span class="s0">, </span><span class="s3">0.41035976694845688</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">0.59266909280647828</span><span class="s0">, </span><span class="s3">0.40733090719352177</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">0.56974431743975207</span><span class="s0">, </span><span class="s3">0.43025568256024799</span><span class="s1">]]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>
        <span class="s1">bad_alpha = np.array([</span><span class="s3">5.4e-01</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.0e-16</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">bad_alpha)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">alpha = np.array([</span><span class="s3">51.72840233779265162</span><span class="s0">, </span><span class="s3">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">actual = random.dirichlet(alpha)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_size(self):</span>
        <span class="s4"># gh-3173</span>
        <span class="s1">p = np.array([</span><span class="s3">51.72840233779265162</span><span class="s0">, </span><span class="s3">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.array((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>

        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">float(</span><span class="s3">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_bad_alpha(self):</span>
        <span class="s4"># gh-2089</span>
        <span class="s1">alpha = np.array([</span><span class="s3">5.4e-01</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.0e-16</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">alpha)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_alpha_non_contiguous(self):</span>
        <span class="s1">a = np.array([</span><span class="s3">51.72840233779265162</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">alpha = a[::</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">non_contig = random.dirichlet(alpha</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">contig = random.dirichlet(np.ascontiguousarray(alpha)</span><span class="s0">,</span>
                                  <span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_array_almost_equal(non_contig</span><span class="s0">, </span><span class="s1">contig)</span>

    <span class="s0">def </span><span class="s1">test_exponential(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.exponential(</span><span class="s3">1.1234</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.08342649775011624</span><span class="s0">, </span><span class="s3">1.00607889924557314</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2.46628830085216721</span><span class="s0">, </span><span class="s3">2.49668106809923884</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.68717433461363442</span><span class="s0">, </span><span class="s3">1.69175666993575979</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_exponential_0(self):</span>
        <span class="s1">assert_equal(random.exponential(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.exponential</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_f(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.f(</span><span class="s3">12</span><span class="s0">, </span><span class="s3">77</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.21975394418575878</span><span class="s0">, </span><span class="s3">1.75135759791559775</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.44803115017146489</span><span class="s0">, </span><span class="s3">1.22108959480396262</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.02176975757740629</span><span class="s0">, </span><span class="s3">1.34431827623300415</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.gamma(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">24.60509188649287182</span><span class="s0">, </span><span class="s3">28.54993563207210627</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">26.13476110204064184</span><span class="s0">, </span><span class="s3">12.56988482927716078</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">31.71863275789960568</span><span class="s0">, </span><span class="s3">33.30143302795922011</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma_0(self):</span>
        <span class="s1">assert_equal(random.gamma(shape=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.gamma</span><span class="s0">, </span><span class="s1">shape=-</span><span class="s3">0.</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_geometric(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.geometric(</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">8</span><span class="s0">, </span><span class="s3">7</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">17</span><span class="s0">, </span><span class="s3">17</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">12</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_geometric_exceptions(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s3">1.1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1.1</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">0.1</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.record(RuntimeWarning)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.gumbel(loc=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.19591898743416816</span><span class="s0">, </span><span class="s3">0.34405539668096674</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">1.4492522252274278</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.47374816298446865</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.10651090478803416</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.69535848626236174</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel_0(self):</span>
        <span class="s1">assert_equal(random.gumbel(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.gumbel</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.hypergeometric(</span><span class="s3">10.1</span><span class="s0">, </span><span class="s3">5.5</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">9</span><span class="s0">, </span><span class="s3">9</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s4"># Test nbad = 0</span>
        <span class="s1">actual = random.hypergeometric(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">actual = random.hypergeometric(</span><span class="s3">15</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">12</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s3">12</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s4"># Test ngood = 0</span>
        <span class="s1">actual = random.hypergeometric(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">actual = random.hypergeometric(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_laplace(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.laplace(loc=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.66599721112760157</span><span class="s0">, </span><span class="s3">0.52829452552221945</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3.12791959514407125</span><span class="s0">, </span><span class="s3">3.18202813572992005</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">0.05391065675859356</span><span class="s0">, </span><span class="s3">1.74901336242837324</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_laplace_0(self):</span>
        <span class="s1">assert_equal(random.laplace(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.laplace</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logistic(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.logistic(loc=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.09232835305011444</span><span class="s0">, </span><span class="s3">0.8648196662399954</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">4.27818590694950185</span><span class="s0">, </span><span class="s3">4.33897006346929714</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">0.21682183359214885</span><span class="s0">, </span><span class="s3">2.63373365386060332</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.lognormal(mean=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">sigma=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">16.50698631688883822</span><span class="s0">, </span><span class="s3">36.54846706092654784</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">22.67886599981281748</span><span class="s0">, </span><span class="s3">0.71617561058995771</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">65.72798501792723869</span><span class="s0">, </span><span class="s3">86.84341601437161273</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal_0(self):</span>
        <span class="s1">assert_equal(random.lognormal(sigma=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.lognormal</span><span class="s0">, </span><span class="s1">sigma=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logseries(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.logseries(p=</span><span class="s3">.923456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">6</span><span class="s0">, </span><span class="s3">17</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_logseries_exceptions(self):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.record(RuntimeWarning)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.logseries</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.logseries</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_multinomial(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.multinomial(</span><span class="s3">20</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6.</span><span class="s1">] * </span><span class="s3">6</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_multivariate_normal(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">mean = (</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">cov = [[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span>
        <span class="s1">size = (</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">actual = random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s1">size)</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">1.463620246718631</span><span class="s0">, </span><span class="s3">11.73759122771936</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1.622445133300628</span><span class="s0">, </span><span class="s3">9.771356667546383</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">2.154490787682787</span><span class="s0">, </span><span class="s3">12.170324946056553</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1.719909438201865</span><span class="s0">, </span><span class="s3">9.230548443648306</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">0.689515026297799</span><span class="s0">, </span><span class="s3">9.880729819607714</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[-</span><span class="s3">0.023054015651998</span><span class="s0">, </span><span class="s3">9.201096623542879</span><span class="s1">]]])</span>

        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

        <span class="s4"># Check for default size, was raising deprecation warning</span>
        <span class="s1">actual = random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov)</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.895289569463708</span><span class="s0">, </span><span class="s3">9.17180864067987</span><span class="s1">])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

        <span class="s4"># Check that non positive-semidefinite covariance warns with</span>
        <span class="s4"># RuntimeWarning</span>
        <span class="s1">mean = [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">cov = [[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span>
        <span class="s1">assert_warns(RuntimeWarning</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov)</span>

        <span class="s4"># and that it doesn't warn with RuntimeWarning check_valid='ignore'</span>
        <span class="s1">assert_no_warnings(random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                           <span class="s1">check_valid=</span><span class="s2">'ignore'</span><span class="s1">)</span>

        <span class="s4"># and that it raises with RuntimeWarning check_valid='raises'</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                      <span class="s1">check_valid=</span><span class="s2">'raise'</span><span class="s1">)</span>

        <span class="s1">cov = np.array([[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov)</span>
            <span class="s1">w = sup.record(RuntimeWarning)</span>
            <span class="s0">assert </span><span class="s1">len(w) == </span><span class="s3">0</span>

        <span class="s1">mu = np.zeros(</span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">cov = np.eye(</span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                      <span class="s1">check_valid=</span><span class="s2">'other'</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">,</span>
                      <span class="s1">np.zeros((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span><span class="s0">, </span><span class="s1">cov)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">,</span>
                      <span class="s1">mu</span><span class="s0">, </span><span class="s1">np.empty((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">,</span>
                      <span class="s1">mu</span><span class="s0">, </span><span class="s1">np.eye(</span><span class="s3">3</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.negative_binomial(n=</span><span class="s3">100</span><span class="s0">, </span><span class="s1">p=</span><span class="s3">.12345</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">848</span><span class="s0">, </span><span class="s3">841</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">892</span><span class="s0">, </span><span class="s3">611</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">779</span><span class="s0">, </span><span class="s3">647</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial_exceptions(self):</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.record(RuntimeWarning)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.negative_binomial</span><span class="s0">, </span><span class="s3">100</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.negative_binomial</span><span class="s0">, </span><span class="s3">100</span><span class="s0">,</span>
                          <span class="s1">[np.nan] * </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.noncentral_chisquare(df=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">23.91905354498517511</span><span class="s0">, </span><span class="s3">13.35324692733826346</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">31.22452661329736401</span><span class="s0">, </span><span class="s3">16.60047399466177254</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">5.03461598262724586</span><span class="s0">, </span><span class="s3">17.94973089023519464</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

        <span class="s1">actual = random.noncentral_chisquare(df=</span><span class="s3">.5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s3">.2</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.47145377828516666</span><span class="s0">,  </span><span class="s3">0.15052899268012659</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.00943803056963588</span><span class="s0">,  </span><span class="s3">1.02647251615666169</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.332334982684171</span><span class="s0">,  </span><span class="s3">0.15451287602753125</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.noncentral_chisquare(df=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">9.597154162763948</span><span class="s0">, </span><span class="s3">11.725484450296079</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">10.413711048138335</span><span class="s0">, </span><span class="s3">3.694475922923986</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">13.484222138963087</span><span class="s0">, </span><span class="s3">14.377255424602957</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.noncentral_f(dfnum=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">dfden=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s3">1</span><span class="s0">,</span>
                                     <span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.40598099674926669</span><span class="s0">, </span><span class="s3">0.34207973179285761</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3.57715069265772545</span><span class="s0">, </span><span class="s3">7.92632662577829805</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.43741599463544162</span><span class="s0">, </span><span class="s3">1.1774208752428319</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_nan(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.noncentral_f(dfnum=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">dfden=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">nonc=np.nan)</span>
        <span class="s0">assert </span><span class="s1">np.isnan(actual)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.normal(loc=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">2.80378370443726244</span><span class="s0">, </span><span class="s3">3.59863924443872163</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3.121433477601256</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.33382987590723379</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">4.18552478636557357</span><span class="s0">, </span><span class="s3">4.46410668111310471</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_normal_0(self):</span>
        <span class="s1">assert_equal(random.normal(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.normal</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_pareto(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.pareto(a=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array(</span>
                <span class="s1">[[</span><span class="s3">2.46852460439034849e+03</span><span class="s0">, </span><span class="s3">1.41286880810518346e+03</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s3">5.28287797029485181e+07</span><span class="s0">, </span><span class="s3">6.57720981047328785e+07</span><span class="s1">]</span><span class="s0">,</span>
                 <span class="s1">[</span><span class="s3">1.40840323350391515e+02</span><span class="s0">, </span><span class="s3">1.98390255135251704e+05</span><span class="s1">]])</span>
        <span class="s4"># For some reason on 32-bit x86 Ubuntu 12.10 the [1, 0] entry in this</span>
        <span class="s4"># matrix differs by 24 nulps. Discussion:</span>
        <span class="s4">#   https://mail.python.org/pipermail/numpy-discussion/2012-September/063801.html</span>
        <span class="s4"># Consensus is that this is probably some gcc quirk that affects</span>
        <span class="s4"># rounding but not in any important way, so we just use a looser</span>
        <span class="s4"># tolerance on this test:</span>
        <span class="s1">np.testing.assert_array_almost_equal_nulp(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">nulp=</span><span class="s3">30</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_poisson(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.poisson(lam=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_poisson_exceptions(self):</span>
        <span class="s1">lambig = np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max</span>
        <span class="s1">lamneg = -</span><span class="s3">1</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">lamneg)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">[lamneg] * </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">lambig)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">[lambig] * </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">sup.record(RuntimeWarning)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_power(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.power(a=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.02048932883240791</span><span class="s0">, </span><span class="s3">0.01424192241128213</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.38446073748535298</span><span class="s0">, </span><span class="s3">0.39499689943484395</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.00177699707563439</span><span class="s0">, </span><span class="s3">0.13115505880863756</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.rayleigh(scale=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">13.8882496494248393</span><span class="s0">, </span><span class="s3">13.383318339044731</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">20.95413364294492098</span><span class="s0">, </span><span class="s3">21.08285015800712614</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">11.06066537006854311</span><span class="s0">, </span><span class="s3">17.35468505778271009</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh_0(self):</span>
        <span class="s1">assert_equal(random.rayleigh(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.rayleigh</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_cauchy(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.standard_cauchy(size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.77127660196445336</span><span class="s0">, </span><span class="s1">-</span><span class="s3">6.55601161955910605</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.93582023391158309</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.07479293013759447</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">4.74601644297011926</span><span class="s0">, </span><span class="s3">0.18338989290760804</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.standard_exponential(size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.96441739162374596</span><span class="s0">, </span><span class="s3">0.89556604882105506</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2.1953785836319808</span><span class="s0">, </span><span class="s3">2.22243285392490542</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.6116915921431676</span><span class="s0">, </span><span class="s3">1.50592546727413201</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.standard_gamma(shape=</span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">5.50841531318455058</span><span class="s0">, </span><span class="s3">6.62953470301903103</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">5.93988484943779227</span><span class="s0">, </span><span class="s3">2.31044849402133989</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">7.54838614231317084</span><span class="s0">, </span><span class="s3">8.012756093271868</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_0(self):</span>
        <span class="s1">assert_equal(random.standard_gamma(shape=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.standard_gamma</span><span class="s0">, </span><span class="s1">shape=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.standard_normal(size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.34016345771863121</span><span class="s0">, </span><span class="s3">1.73759122771936081</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.498988344300628</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.2286433324536169</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2.031033998682787</span><span class="s0">, </span><span class="s3">2.17032494605655257</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_randn_singleton(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.randn()</span>
        <span class="s1">desired = np.array(</span><span class="s3">1.34016345771863121</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.standard_t(df=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.97140611862659965</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.08830486548450577</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.36311143689505321</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.55317463909867071</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">0.18473749069684214</span><span class="s0">, </span><span class="s3">0.61181537341755321</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_triangular(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.triangular(left=</span><span class="s3">5.12</span><span class="s0">, </span><span class="s1">mode=</span><span class="s3">10.23</span><span class="s0">, </span><span class="s1">right=</span><span class="s3">20.34</span><span class="s0">,</span>
                                   <span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">12.68117178949215784</span><span class="s0">, </span><span class="s3">12.4129206149193152</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">16.20131377335158263</span><span class="s0">, </span><span class="s3">16.25692138747600524</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">11.20400690911820263</span><span class="s0">, </span><span class="s3">14.4978144835829923</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uniform(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.uniform(low=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">high=</span><span class="s3">10.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">6.99097932346268003</span><span class="s0">, </span><span class="s3">6.73801597444323974</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">9.50364421400426274</span><span class="s0">, </span><span class="s3">9.53130618907631089</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">5.48995325769805476</span><span class="s0">, </span><span class="s3">8.47493103280052118</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uniform_range_bounds(self):</span>
        <span class="s1">fmin = np.finfo(</span><span class="s2">'float'</span><span class="s1">).min</span>
        <span class="s1">fmax = np.finfo(</span><span class="s2">'float'</span><span class="s1">).max</span>

        <span class="s1">func = random.uniform</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.inf)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">fmin</span><span class="s0">, </span><span class="s1">fmax)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">[-np.inf]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[np.inf])</span>

        <span class="s4"># (fmax / 1e17) - fmin is within range, so this should not throw</span>
        <span class="s4"># account for i386 extended precision DBL_MAX / 1e17 + DBL_MAX &gt;</span>
        <span class="s4"># DBL_MAX by increasing fmin a bit</span>
        <span class="s1">random.uniform(low=np.nextafter(fmin</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">high=fmax / </span><span class="s3">1e17</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_scalar_exception_propagation(self):</span>
        <span class="s4"># Tests that exceptions are correctly propagated in distributions</span>
        <span class="s4"># when called with objects that throw exceptions when converted to</span>
        <span class="s4"># scalars.</span>
        <span class="s4">#</span>
        <span class="s4"># Regression test for gh: 8865</span>

        <span class="s0">class </span><span class="s1">ThrowingFloat(np.ndarray):</span>
            <span class="s0">def </span><span class="s1">__float__(self):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_float = np.array(</span><span class="s3">1.0</span><span class="s1">).view(ThrowingFloat)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.uniform</span><span class="s0">, </span><span class="s1">throwing_float</span><span class="s0">,</span>
                      <span class="s1">throwing_float)</span>

        <span class="s0">class </span><span class="s1">ThrowingInteger(np.ndarray):</span>
            <span class="s0">def </span><span class="s1">__int__(self):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_int = np.array(</span><span class="s3">1</span><span class="s1">).view(ThrowingInteger)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">throwing_int</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.vonmises(mu=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">kappa=</span><span class="s3">1.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">2.28567572673902042</span><span class="s0">, </span><span class="s3">2.89163838442285037</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.38198375564286025</span><span class="s0">, </span><span class="s3">2.57638023113890746</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.19153771588353052</span><span class="s0">, </span><span class="s3">1.83509849681825354</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises_small(self):</span>
        <span class="s4"># check infinite loop, gh-4720</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">r = random.vonmises(mu=</span><span class="s3">0.</span><span class="s0">, </span><span class="s1">kappa=</span><span class="s3">1.1e-8</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">**</span><span class="s3">6</span><span class="s1">)</span>
        <span class="s1">assert_(np.isfinite(r).all())</span>

    <span class="s0">def </span><span class="s1">test_vonmises_large(self):</span>
        <span class="s4"># guard against changes in RandomState when Generator is fixed</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.vonmises(mu=</span><span class="s3">0.</span><span class="s0">, </span><span class="s1">kappa=</span><span class="s3">1e7</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">4.634253748521111e-04</span><span class="s0">,</span>
                            <span class="s3">3.558873596114509e-04</span><span class="s0">,</span>
                            <span class="s1">-</span><span class="s3">2.337119622577433e-04</span><span class="s1">])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">8</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises_nan(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">r = random.vonmises(mu=</span><span class="s3">0.</span><span class="s0">, </span><span class="s1">kappa=np.nan)</span>
        <span class="s1">assert_(np.isnan(r))</span>

    <span class="s0">def </span><span class="s1">test_wald(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.wald(mean=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">1.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">3.82935265715889983</span><span class="s0">, </span><span class="s3">5.13125249184285526</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.35045403618358717</span><span class="s0">, </span><span class="s3">1.50832396872003538</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.24124319895843183</span><span class="s0">, </span><span class="s3">0.22031101461955038</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.weibull(a=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.97097342648766727</span><span class="s0">, </span><span class="s3">0.91422896443565516</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.89517770034962929</span><span class="s0">, </span><span class="s3">1.91414357960479564</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.67057783752390987</span><span class="s0">, </span><span class="s3">1.39494046635066793</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull_0(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">assert_equal(random.weibull(a=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">12</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.zeros(</span><span class="s3">12</span><span class="s1">))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.weibull</span><span class="s0">, </span><span class="s1">a=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_zipf(self):</span>
        <span class="s1">random.seed(self.seed)</span>
        <span class="s1">actual = random.zipf(a=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">66</span><span class="s0">, </span><span class="s3">29</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">13</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>


<span class="s0">class </span><span class="s1">TestBroadcast:</span>
    <span class="s4"># tests that functions that broadcast behave</span>
    <span class="s4"># correctly when presented with non-scalar arguments</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s3">123456789</span>

    <span class="s0">def </span><span class="s1">set_seed(self):</span>
        <span class="s1">random.seed(self.seed)</span>

    <span class="s0">def </span><span class="s1">test_uniform(self):</span>
        <span class="s1">low = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">high = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">uniform = random.uniform</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.53283302478975902</span><span class="s0">,</span>
                            <span class="s3">0.53413660089041659</span><span class="s0">,</span>
                            <span class="s3">0.50955303552646702</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = uniform(low * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">high)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = uniform(low</span><span class="s0">, </span><span class="s1">high * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s1">loc = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">normal = random.normal</span>
        <span class="s1">desired = np.array([</span><span class="s3">2.2129019979039612</span><span class="s0">,</span>
                            <span class="s3">2.1283977976520019</span><span class="s0">,</span>
                            <span class="s3">1.8417114045748335</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = normal(loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">normal</span><span class="s0">, </span><span class="s1">loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = normal(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">normal</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_beta(self):</span>
        <span class="s1">a = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">b = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_b = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">beta = random.beta</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.19843558305989056</span><span class="s0">,</span>
                            <span class="s3">0.075230336409423643</span><span class="s0">,</span>
                            <span class="s3">0.24976865978980844</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = beta(a * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">b)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">b)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">a * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_b)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = beta(a</span><span class="s0">, </span><span class="s1">b * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">bad_a</span><span class="s0">, </span><span class="s1">b * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">bad_b * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_exponential(self):</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">exponential = random.exponential</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.76106853658845242</span><span class="s0">,</span>
                            <span class="s3">0.76386282278691653</span><span class="s0">,</span>
                            <span class="s3">0.71243813125891797</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = exponential(scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">exponential</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma(self):</span>
        <span class="s1">shape = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_shape = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">std_gamma = random.standard_gamma</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.76106853658845242</span><span class="s0">,</span>
                            <span class="s3">0.76386282278691653</span><span class="s0">,</span>
                            <span class="s3">0.71243813125891797</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = std_gamma(shape * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">std_gamma</span><span class="s0">, </span><span class="s1">bad_shape * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma(self):</span>
        <span class="s1">shape = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_shape = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">gamma = random.gamma</span>
        <span class="s1">desired = np.array([</span><span class="s3">1.5221370731769048</span><span class="s0">,</span>
                            <span class="s3">1.5277256455738331</span><span class="s0">,</span>
                            <span class="s3">1.4248762625178359</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = gamma(shape * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">bad_shape * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">shape * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = gamma(shape</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">bad_shape</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">shape</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_f(self):</span>
        <span class="s1">dfnum = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">dfden = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_dfnum = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_dfden = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">f = random.f</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.80038951638264799</span><span class="s0">,</span>
                            <span class="s3">0.86768719635363512</span><span class="s0">,</span>
                            <span class="s3">2.7251095168386801</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = f(dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">bad_dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_dfden)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = f(dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f(self):</span>
        <span class="s1">dfnum = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">dfden = [</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">nonc = [</span><span class="s3">4</span><span class="s1">]</span>
        <span class="s1">bad_dfnum = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">bad_dfden = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_nonc = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">nonc_f = random.noncentral_f</span>
        <span class="s1">desired = np.array([</span><span class="s3">9.1393943263705211</span><span class="s0">,</span>
                            <span class="s3">13.025456344595602</span><span class="s0">,</span>
                            <span class="s3">8.8018098359100545</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = nonc_f(dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">np.all(np.isnan(nonc_f(dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">3</span><span class="s1">)))</span>

        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = nonc_f(dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = nonc_f(dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">bad_nonc * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_small_df(self):</span>
        <span class="s1">self.set_seed()</span>
        <span class="s1">desired = np.array([</span><span class="s3">6.869638627492048</span><span class="s0">, </span><span class="s3">0.785880199263955</span><span class="s1">])</span>
        <span class="s1">actual = random.noncentral_f(</span><span class="s3">0.9</span><span class="s0">, </span><span class="s3">0.9</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare(self):</span>
        <span class="s1">df = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">chisquare = random.chisquare</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.57022801133088286</span><span class="s0">,</span>
                            <span class="s3">0.51947702108840776</span><span class="s0">,</span>
                            <span class="s3">0.1320969254923558</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = chisquare(df * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">chisquare</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare(self):</span>
        <span class="s1">df = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">nonc = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_nonc = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">nonc_chi = random.noncentral_chisquare</span>
        <span class="s1">desired = np.array([</span><span class="s3">9.0015599467913763</span><span class="s0">,</span>
                            <span class="s3">4.5804135049718742</span><span class="s0">,</span>
                            <span class="s3">6.0872302432834564</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = nonc_chi(df * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">df * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = nonc_chi(df</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">bad_df</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">df</span><span class="s0">, </span><span class="s1">bad_nonc * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t(self):</span>
        <span class="s1">df = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">t = random.standard_t</span>
        <span class="s1">desired = np.array([</span><span class="s3">3.0702872575217643</span><span class="s0">,</span>
                            <span class="s3">5.8560725167361607</span><span class="s0">,</span>
                            <span class="s3">1.0274791436474273</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = t(df * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">t</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.standard_t</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises(self):</span>
        <span class="s1">mu = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">kappa = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_kappa = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">vonmises = random.vonmises</span>
        <span class="s1">desired = np.array([</span><span class="s3">2.9883443664201312</span><span class="s0">,</span>
                            <span class="s1">-</span><span class="s3">2.7064099483995943</span><span class="s0">,</span>
                            <span class="s1">-</span><span class="s3">1.8672476700665914</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = vonmises(mu * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">kappa)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">vonmises</span><span class="s0">, </span><span class="s1">mu * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_kappa)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = vonmises(mu</span><span class="s0">, </span><span class="s1">kappa * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">vonmises</span><span class="s0">, </span><span class="s1">mu</span><span class="s0">, </span><span class="s1">bad_kappa * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_pareto(self):</span>
        <span class="s1">a = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">pareto = random.pareto</span>
        <span class="s1">desired = np.array([</span><span class="s3">1.1405622680198362</span><span class="s0">,</span>
                            <span class="s3">1.1465519762044529</span><span class="s0">,</span>
                            <span class="s3">1.0389564467453547</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = pareto(a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">pareto</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.pareto</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull(self):</span>
        <span class="s1">a = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">weibull = random.weibull</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.76106853658845242</span><span class="s0">,</span>
                            <span class="s3">0.76386282278691653</span><span class="s0">,</span>
                            <span class="s3">0.71243813125891797</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = weibull(a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">weibull</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.weibull</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_power(self):</span>
        <span class="s1">a = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">power = random.power</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.53283302478975902</span><span class="s0">,</span>
                            <span class="s3">0.53413660089041659</span><span class="s0">,</span>
                            <span class="s3">0.50955303552646702</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = power(a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">power</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.power</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_laplace(self):</span>
        <span class="s1">loc = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">laplace = random.laplace</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.067921356028507157</span><span class="s0">,</span>
                            <span class="s3">0.070715642226971326</span><span class="s0">,</span>
                            <span class="s3">0.019290950698972624</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = laplace(loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">laplace</span><span class="s0">, </span><span class="s1">loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = laplace(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">laplace</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel(self):</span>
        <span class="s1">loc = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">gumbel = random.gumbel</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.2730318639556768</span><span class="s0">,</span>
                            <span class="s3">0.26936705726291116</span><span class="s0">,</span>
                            <span class="s3">0.33906220393037939</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = gumbel(loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gumbel</span><span class="s0">, </span><span class="s1">loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = gumbel(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gumbel</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logistic(self):</span>
        <span class="s1">loc = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">logistic = random.logistic</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.13152135837586171</span><span class="s0">,</span>
                            <span class="s3">0.13675915696285773</span><span class="s0">,</span>
                            <span class="s3">0.038216792802833396</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = logistic(loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logistic</span><span class="s0">, </span><span class="s1">loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = logistic(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logistic</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_equal(random.logistic(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal(self):</span>
        <span class="s1">mean = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">sigma = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_sigma = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">lognormal = random.lognormal</span>
        <span class="s1">desired = np.array([</span><span class="s3">9.1422086044848427</span><span class="s0">,</span>
                            <span class="s3">8.4013952870126261</span><span class="s0">,</span>
                            <span class="s3">6.3073234116578671</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = lognormal(mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">sigma)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">lognormal</span><span class="s0">, </span><span class="s1">mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_sigma)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.lognormal</span><span class="s0">, </span><span class="s1">mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_sigma)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = lognormal(mean</span><span class="s0">, </span><span class="s1">sigma * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">lognormal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">bad_sigma * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.lognormal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">bad_sigma * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh(self):</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">rayleigh = random.rayleigh</span>
        <span class="s1">desired = np.array([</span><span class="s3">1.2337491937897689</span><span class="s0">,</span>
                            <span class="s3">1.2360119924878694</span><span class="s0">,</span>
                            <span class="s3">1.1936818095781789</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = rayleigh(scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">rayleigh</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_wald(self):</span>
        <span class="s1">mean = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_mean = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">wald = random.wald</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.11873681120271318</span><span class="s0">,</span>
                            <span class="s3">0.12450084820795027</span><span class="s0">,</span>
                            <span class="s3">0.9096122728408238</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = wald(mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s1">bad_mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s1">mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.wald</span><span class="s0">, </span><span class="s1">bad_mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.wald</span><span class="s0">, </span><span class="s1">mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = wald(mean</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s1">bad_mean</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">wald</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_triangular(self):</span>
        <span class="s1">left = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">right = [</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">mode = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_left_one = [</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">bad_mode_one = [</span><span class="s3">4</span><span class="s1">]</span>
        <span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two = right * </span><span class="s3">2</span>
        <span class="s1">triangular = random.triangular</span>
        <span class="s1">desired = np.array([</span><span class="s3">2.03339048710429</span><span class="s0">,</span>
                            <span class="s3">2.0347400359389356</span><span class="s0">,</span>
                            <span class="s3">2.0095991069536208</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = triangular(left * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_mode_one</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_mode_two</span><span class="s0">,</span>
                      <span class="s1">right)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = triangular(left</span><span class="s0">, </span><span class="s1">mode * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one</span><span class="s0">, </span><span class="s1">mode * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left</span><span class="s0">, </span><span class="s1">bad_mode_one * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two * </span><span class="s3">3</span><span class="s0">,</span>
                      <span class="s1">right)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = triangular(left</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left</span><span class="s0">, </span><span class="s1">bad_mode_one</span><span class="s0">, </span><span class="s1">right * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two</span><span class="s0">,</span>
                      <span class="s1">right * </span><span class="s3">3</span><span class="s1">)</span>

        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">0.</span><span class="s0">, </span><span class="s3">20.</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">25.</span><span class="s0">, </span><span class="s3">20.</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_binomial(self):</span>
        <span class="s1">n = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">bad_n = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s3">1.5</span><span class="s1">]</span>
        <span class="s1">binom = random.binomial</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = binom(n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">bad_n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_p_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_p_two)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = binom(n</span><span class="s0">, </span><span class="s1">p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">bad_n</span><span class="s0">, </span><span class="s1">p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s1">n = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">bad_n = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s3">1.5</span><span class="s1">]</span>
        <span class="s1">neg_binom = random.negative_binomial</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = neg_binom(n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">bad_n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_p_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_p_two)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = neg_binom(n</span><span class="s0">, </span><span class="s1">p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">bad_n</span><span class="s0">, </span><span class="s1">p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_poisson(self):</span>
        <span class="s1">max_lam = random.RandomState()._poisson_lam_max</span>

        <span class="s1">lam = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_lam_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_lam_two = [max_lam * </span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">poisson = random.poisson</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = poisson(lam * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">poisson</span><span class="s0">, </span><span class="s1">bad_lam_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">poisson</span><span class="s0">, </span><span class="s1">bad_lam_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_zipf(self):</span>
        <span class="s1">a = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_a = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">zipf = random.zipf</span>
        <span class="s1">desired = np.array([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = zipf(a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">np.errstate(invalid=</span><span class="s2">'ignore'</span><span class="s1">):</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.nan])</span>

    <span class="s0">def </span><span class="s1">test_geometric(self):</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s3">1.5</span><span class="s1">]</span>
        <span class="s1">geom = random.geometric</span>
        <span class="s1">desired = np.array([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = geom(p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">geom</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">geom</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric(self):</span>
        <span class="s1">ngood = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">nbad = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">nsample = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_ngood = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_nbad = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_nsample_one = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">bad_nsample_two = [</span><span class="s3">4</span><span class="s1">]</span>
        <span class="s1">hypergeom = random.hypergeometric</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = hypergeom(ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">bad_ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_two)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = hypergeom(ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">bad_ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">bad_nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nsample_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nsample_two)</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = hypergeom(ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">bad_ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">bad_nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_two * </span><span class="s3">3</span><span class="s1">)</span>

        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">25</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logseries(self):</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">logseries = random.logseries</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">self.set_seed()</span>
        <span class="s1">actual = logseries(p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logseries</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logseries</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s3">3</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestThread:</span>
    <span class="s4"># make sure each state produces the same sequence even in threads</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seeds = range(</span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">check_function(self</span><span class="s0">, </span><span class="s1">function</span><span class="s0">, </span><span class="s1">sz):</span>
        <span class="s0">from </span><span class="s1">threading </span><span class="s0">import </span><span class="s1">Thread</span>

        <span class="s1">out1 = np.empty((len(self.seeds)</span><span class="s0">,</span><span class="s1">) + sz)</span>
        <span class="s1">out2 = np.empty((len(self.seeds)</span><span class="s0">,</span><span class="s1">) + sz)</span>

        <span class="s4"># threaded generation</span>
        <span class="s1">t = [Thread(target=function</span><span class="s0">, </span><span class="s1">args=(random.RandomState(s)</span><span class="s0">, </span><span class="s1">o))</span>
             <span class="s0">for </span><span class="s1">s</span><span class="s0">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip(self.seeds</span><span class="s0">, </span><span class="s1">out1)]</span>
        <span class="s1">[x.start() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t]</span>
        <span class="s1">[x.join() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t]</span>

        <span class="s4"># the same serial</span>
        <span class="s0">for </span><span class="s1">s</span><span class="s0">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip(self.seeds</span><span class="s0">, </span><span class="s1">out2):</span>
            <span class="s1">function(random.RandomState(s)</span><span class="s0">, </span><span class="s1">o)</span>

        <span class="s4"># these platforms change x87 fpu precision mode in threads</span>
        <span class="s0">if </span><span class="s1">np.intp().dtype.itemsize == </span><span class="s3">4 </span><span class="s0">and </span><span class="s1">sys.platform == </span><span class="s2">&quot;win32&quot;</span><span class="s1">:</span>
            <span class="s1">assert_array_almost_equal(out1</span><span class="s0">, </span><span class="s1">out2)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_array_equal(out1</span><span class="s0">, </span><span class="s1">out2)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.normal(size=</span><span class="s3">10000</span><span class="s1">)</span>

        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s3">10000</span><span class="s0">,</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_exp(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.exponential(scale=np.ones((</span><span class="s3">100</span><span class="s0">, </span><span class="s3">1000</span><span class="s1">)))</span>

        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s3">100</span><span class="s0">, </span><span class="s3">1000</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_multinomial(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.multinomial(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6.</span><span class="s1">] * </span><span class="s3">6</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10000</span><span class="s1">)</span>

        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s3">10000</span><span class="s0">, </span><span class="s3">6</span><span class="s1">))</span>


<span class="s4"># See Issue #4263</span>
<span class="s0">class </span><span class="s1">TestSingleEltArrayInput:</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.argOne = np.array([</span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">self.argTwo = np.array([</span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">self.argThree = np.array([</span><span class="s3">4</span><span class="s1">])</span>
        <span class="s1">self.tgtShape = (</span><span class="s3">1</span><span class="s0">,</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_one_arg_funcs(self):</span>
        <span class="s1">funcs = (random.exponential</span><span class="s0">, </span><span class="s1">random.standard_gamma</span><span class="s0">,</span>
                 <span class="s1">random.chisquare</span><span class="s0">, </span><span class="s1">random.standard_t</span><span class="s0">,</span>
                 <span class="s1">random.pareto</span><span class="s0">, </span><span class="s1">random.weibull</span><span class="s0">,</span>
                 <span class="s1">random.power</span><span class="s0">, </span><span class="s1">random.rayleigh</span><span class="s0">,</span>
                 <span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">random.zipf</span><span class="s0">,</span>
                 <span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">random.logseries)</span>

        <span class="s1">probfuncs = (random.geometric</span><span class="s0">, </span><span class="s1">random.logseries)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs:  </span><span class="s4"># p &lt; 1.0</span>
                <span class="s1">out = func(np.array([</span><span class="s3">0.5</span><span class="s1">]))</span>

            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">out = func(self.argOne)</span>

            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

    <span class="s0">def </span><span class="s1">test_two_arg_funcs(self):</span>
        <span class="s1">funcs = (random.uniform</span><span class="s0">, </span><span class="s1">random.normal</span><span class="s0">,</span>
                 <span class="s1">random.beta</span><span class="s0">, </span><span class="s1">random.gamma</span><span class="s0">,</span>
                 <span class="s1">random.f</span><span class="s0">, </span><span class="s1">random.noncentral_chisquare</span><span class="s0">,</span>
                 <span class="s1">random.vonmises</span><span class="s0">, </span><span class="s1">random.laplace</span><span class="s0">,</span>
                 <span class="s1">random.gumbel</span><span class="s0">, </span><span class="s1">random.logistic</span><span class="s0">,</span>
                 <span class="s1">random.lognormal</span><span class="s0">, </span><span class="s1">random.wald</span><span class="s0">,</span>
                 <span class="s1">random.binomial</span><span class="s0">, </span><span class="s1">random.negative_binomial)</span>

        <span class="s1">probfuncs = (random.binomial</span><span class="s0">, </span><span class="s1">random.negative_binomial)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs:  </span><span class="s4"># p &lt;= 1</span>
                <span class="s1">argTwo = np.array([</span><span class="s3">0.5</span><span class="s1">])</span>

            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">argTwo = self.argTwo</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">argTwo)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">argTwo)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">argTwo[</span><span class="s3">0</span><span class="s1">])</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

    <span class="s0">def </span><span class="s1">test_three_arg_funcs(self):</span>
        <span class="s1">funcs = [random.noncentral_f</span><span class="s0">, </span><span class="s1">random.triangular</span><span class="s0">,</span>
                 <span class="s1">random.hypergeometric]</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">self.argTwo</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">self.argTwo</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">self.argTwo[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>


<span class="s4"># Ensure returned array dtype is correct for platform</span>
<span class="s0">def </span><span class="s1">test_integer_dtype(int_func):</span>
    <span class="s1">random.seed(</span><span class="s3">123456789</span><span class="s1">)</span>
    <span class="s1">fname</span><span class="s0">, </span><span class="s1">args</span><span class="s0">, </span><span class="s1">sha256 = int_func</span>
    <span class="s1">f = getattr(random</span><span class="s0">, </span><span class="s1">fname)</span>
    <span class="s1">actual = f(*args</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">2</span><span class="s1">)</span>
    <span class="s1">assert_(actual.dtype == np.dtype(</span><span class="s2">'l'</span><span class="s1">))</span>


<span class="s0">def </span><span class="s1">test_integer_repeat(int_func):</span>
    <span class="s1">random.seed(</span><span class="s3">123456789</span><span class="s1">)</span>
    <span class="s1">fname</span><span class="s0">, </span><span class="s1">args</span><span class="s0">, </span><span class="s1">sha256 = int_func</span>
    <span class="s1">f = getattr(random</span><span class="s0">, </span><span class="s1">fname)</span>
    <span class="s1">val = f(*args</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000000</span><span class="s1">)</span>
    <span class="s0">if </span><span class="s1">sys.byteorder != </span><span class="s2">'little'</span><span class="s1">:</span>
        <span class="s1">val = val.byteswap()</span>
    <span class="s1">res = hashlib.sha256(val.view(np.int8)).hexdigest()</span>
    <span class="s1">assert_(res == sha256)</span>


<span class="s0">def </span><span class="s1">test_broadcast_size_error():</span>
    <span class="s4"># GH-16833</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.binomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.7</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.binomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.binomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.7</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
</pre>
</body>
</html>