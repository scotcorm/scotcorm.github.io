<html>
<head>
<title>test_classes.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #808080;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_classes.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Test inter-conversion of different polynomial classes. 
 
This tests the convert and cast methods of all the polynomial classes. 
 
&quot;&quot;&quot;</span>
<span class="s2">import </span><span class="s1">operator </span><span class="s2">as </span><span class="s1">op</span>
<span class="s2">from </span><span class="s1">numbers </span><span class="s2">import </span><span class="s1">Number</span>

<span class="s2">import </span><span class="s1">pytest</span>
<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">from </span><span class="s1">numpy.polynomial </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">Polynomial</span><span class="s2">, </span><span class="s1">Legendre</span><span class="s2">, </span><span class="s1">Chebyshev</span><span class="s2">, </span><span class="s1">Laguerre</span><span class="s2">, </span><span class="s1">Hermite</span><span class="s2">, </span><span class="s1">HermiteE)</span>
<span class="s2">from </span><span class="s1">numpy.testing </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">assert_almost_equal</span><span class="s2">, </span><span class="s1">assert_raises</span><span class="s2">, </span><span class="s1">assert_equal</span><span class="s2">, </span><span class="s1">assert_</span><span class="s2">,</span>
    <span class="s1">)</span>
<span class="s2">from </span><span class="s1">numpy.polynomial.polyutils </span><span class="s2">import </span><span class="s1">RankWarning</span>

<span class="s3">#</span>
<span class="s3"># fixtures</span>
<span class="s3">#</span>

<span class="s1">classes = (</span>
    <span class="s1">Polynomial</span><span class="s2">, </span><span class="s1">Legendre</span><span class="s2">, </span><span class="s1">Chebyshev</span><span class="s2">, </span><span class="s1">Laguerre</span><span class="s2">,</span>
    <span class="s1">Hermite</span><span class="s2">, </span><span class="s1">HermiteE</span>
    <span class="s1">)</span>
<span class="s1">classids = tuple(cls.__name__ </span><span class="s2">for </span><span class="s1">cls </span><span class="s2">in </span><span class="s1">classes)</span>

<span class="s1">@pytest.fixture(params=classes</span><span class="s2">, </span><span class="s1">ids=classids)</span>
<span class="s2">def </span><span class="s1">Poly(request):</span>
    <span class="s2">return </span><span class="s1">request.param</span>

<span class="s3">#</span>
<span class="s3"># helper functions</span>
<span class="s3">#</span>
<span class="s1">random = np.random.random</span>


<span class="s2">def </span><span class="s1">assert_poly_almost_equal(p1</span><span class="s2">, </span><span class="s1">p2</span><span class="s2">, </span><span class="s1">msg=</span><span class="s4">&quot;&quot;</span><span class="s1">):</span>
    <span class="s2">try</span><span class="s1">:</span>
        <span class="s1">assert_(np.all(p1.domain == p2.domain))</span>
        <span class="s1">assert_(np.all(p1.window == p2.window))</span>
        <span class="s1">assert_almost_equal(p1.coef</span><span class="s2">, </span><span class="s1">p2.coef)</span>
    <span class="s2">except </span><span class="s1">AssertionError:</span>
        <span class="s1">msg = </span><span class="s4">f&quot;Result: </span><span class="s2">{</span><span class="s1">p1</span><span class="s2">}\n</span><span class="s4">Target: </span><span class="s2">{</span><span class="s1">p2</span><span class="s2">}</span><span class="s4">&quot;</span>
        <span class="s2">raise </span><span class="s1">AssertionError(msg)</span>


<span class="s3">#</span>
<span class="s3"># Test conversion methods that depend on combinations of two classes.</span>
<span class="s3">#</span>

<span class="s1">Poly1 = Poly</span>
<span class="s1">Poly2 = Poly</span>


<span class="s2">def </span><span class="s1">test_conversion(Poly1</span><span class="s2">, </span><span class="s1">Poly2):</span>
    <span class="s1">x = np.linspace(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">10</span><span class="s1">)</span>
    <span class="s1">coef = random((</span><span class="s5">3</span><span class="s2">,</span><span class="s1">))</span>

    <span class="s1">d1 = Poly1.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w1 = Poly1.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">p1 = Poly1(coef</span><span class="s2">, </span><span class="s1">domain=d1</span><span class="s2">, </span><span class="s1">window=w1)</span>

    <span class="s1">d2 = Poly2.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w2 = Poly2.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">p2 = p1.convert(kind=Poly2</span><span class="s2">, </span><span class="s1">domain=d2</span><span class="s2">, </span><span class="s1">window=w2)</span>

    <span class="s1">assert_almost_equal(p2.domain</span><span class="s2">, </span><span class="s1">d2)</span>
    <span class="s1">assert_almost_equal(p2.window</span><span class="s2">, </span><span class="s1">w2)</span>
    <span class="s1">assert_almost_equal(p2(x)</span><span class="s2">, </span><span class="s1">p1(x))</span>


<span class="s2">def </span><span class="s1">test_cast(Poly1</span><span class="s2">, </span><span class="s1">Poly2):</span>
    <span class="s1">x = np.linspace(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">10</span><span class="s1">)</span>
    <span class="s1">coef = random((</span><span class="s5">3</span><span class="s2">,</span><span class="s1">))</span>

    <span class="s1">d1 = Poly1.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w1 = Poly1.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">p1 = Poly1(coef</span><span class="s2">, </span><span class="s1">domain=d1</span><span class="s2">, </span><span class="s1">window=w1)</span>

    <span class="s1">d2 = Poly2.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w2 = Poly2.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">p2 = Poly2.cast(p1</span><span class="s2">, </span><span class="s1">domain=d2</span><span class="s2">, </span><span class="s1">window=w2)</span>

    <span class="s1">assert_almost_equal(p2.domain</span><span class="s2">, </span><span class="s1">d2)</span>
    <span class="s1">assert_almost_equal(p2.window</span><span class="s2">, </span><span class="s1">w2)</span>
    <span class="s1">assert_almost_equal(p2(x)</span><span class="s2">, </span><span class="s1">p1(x))</span>


<span class="s3">#</span>
<span class="s3"># test methods that depend on one class</span>
<span class="s3">#</span>


<span class="s2">def </span><span class="s1">test_identity(Poly):</span>
    <span class="s1">d = Poly.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w = Poly.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">x = np.linspace(d[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">d[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s5">11</span><span class="s1">)</span>
    <span class="s1">p = Poly.identity(domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">assert_equal(p.domain</span><span class="s2">, </span><span class="s1">d)</span>
    <span class="s1">assert_equal(p.window</span><span class="s2">, </span><span class="s1">w)</span>
    <span class="s1">assert_almost_equal(p(x)</span><span class="s2">, </span><span class="s1">x)</span>


<span class="s2">def </span><span class="s1">test_basis(Poly):</span>
    <span class="s1">d = Poly.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w = Poly.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">p = Poly.basis(</span><span class="s5">5</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">assert_equal(p.domain</span><span class="s2">, </span><span class="s1">d)</span>
    <span class="s1">assert_equal(p.window</span><span class="s2">, </span><span class="s1">w)</span>
    <span class="s1">assert_equal(p.coef</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s1">]*</span><span class="s5">5 </span><span class="s1">+ [</span><span class="s5">1</span><span class="s1">])</span>


<span class="s2">def </span><span class="s1">test_fromroots(Poly):</span>
    <span class="s3"># check that requested roots are zeros of a polynomial</span>
    <span class="s3"># of correct degree, domain, and window.</span>
    <span class="s1">d = Poly.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w = Poly.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">r = random((</span><span class="s5">5</span><span class="s2">,</span><span class="s1">))</span>
    <span class="s1">p1 = Poly.fromroots(r</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">assert_equal(p1.degree()</span><span class="s2">, </span><span class="s1">len(r))</span>
    <span class="s1">assert_equal(p1.domain</span><span class="s2">, </span><span class="s1">d)</span>
    <span class="s1">assert_equal(p1.window</span><span class="s2">, </span><span class="s1">w)</span>
    <span class="s1">assert_almost_equal(p1(r)</span><span class="s2">, </span><span class="s5">0</span><span class="s1">)</span>

    <span class="s3"># check that polynomial is monic</span>
    <span class="s1">pdom = Polynomial.domain</span>
    <span class="s1">pwin = Polynomial.window</span>
    <span class="s1">p2 = Polynomial.cast(p1</span><span class="s2">, </span><span class="s1">domain=pdom</span><span class="s2">, </span><span class="s1">window=pwin)</span>
    <span class="s1">assert_almost_equal(p2.coef[-</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">test_bad_conditioned_fit(Poly):</span>

    <span class="s1">x = [</span><span class="s5">0.</span><span class="s2">, </span><span class="s5">0.</span><span class="s2">, </span><span class="s5">1.</span><span class="s1">]</span>
    <span class="s1">y = [</span><span class="s5">1.</span><span class="s2">, </span><span class="s5">2.</span><span class="s2">, </span><span class="s5">3.</span><span class="s1">]</span>

    <span class="s3"># check RankWarning is raised</span>
    <span class="s2">with </span><span class="s1">pytest.warns(RankWarning) </span><span class="s2">as </span><span class="s1">record:</span>
        <span class="s1">Poly.fit(x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span>
    <span class="s2">assert </span><span class="s1">record[</span><span class="s5">0</span><span class="s1">].message.args[</span><span class="s5">0</span><span class="s1">] == </span><span class="s4">&quot;The fit may be poorly conditioned&quot;</span>


<span class="s2">def </span><span class="s1">test_fit(Poly):</span>

    <span class="s2">def </span><span class="s1">f(x):</span>
        <span class="s2">return </span><span class="s1">x*(x - </span><span class="s5">1</span><span class="s1">)*(x - </span><span class="s5">2</span><span class="s1">)</span>
    <span class="s1">x = np.linspace(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
    <span class="s1">y = f(x)</span>

    <span class="s3"># check default value of domain and window</span>
    <span class="s1">p = Poly.fit(x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
    <span class="s1">assert_almost_equal(p.domain</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">assert_almost_equal(p(x)</span><span class="s2">, </span><span class="s1">y)</span>
    <span class="s1">assert_equal(p.degree()</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>

    <span class="s3"># check with given domains and window</span>
    <span class="s1">d = Poly.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w = Poly.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">p = Poly.fit(x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">assert_almost_equal(p(x)</span><span class="s2">, </span><span class="s1">y)</span>
    <span class="s1">assert_almost_equal(p.domain</span><span class="s2">, </span><span class="s1">d)</span>
    <span class="s1">assert_almost_equal(p.window</span><span class="s2">, </span><span class="s1">w)</span>
    <span class="s1">p = Poly.fit(x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">assert_almost_equal(p(x)</span><span class="s2">, </span><span class="s1">y)</span>
    <span class="s1">assert_almost_equal(p.domain</span><span class="s2">, </span><span class="s1">d)</span>
    <span class="s1">assert_almost_equal(p.window</span><span class="s2">, </span><span class="s1">w)</span>

    <span class="s3"># check with class domain default</span>
    <span class="s1">p = Poly.fit(x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">[])</span>
    <span class="s1">assert_equal(p.domain</span><span class="s2">, </span><span class="s1">Poly.domain)</span>
    <span class="s1">assert_equal(p.window</span><span class="s2">, </span><span class="s1">Poly.window)</span>
    <span class="s1">p = Poly.fit(x</span><span class="s2">, </span><span class="s1">y</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">[])</span>
    <span class="s1">assert_equal(p.domain</span><span class="s2">, </span><span class="s1">Poly.domain)</span>
    <span class="s1">assert_equal(p.window</span><span class="s2">, </span><span class="s1">Poly.window)</span>

    <span class="s3"># check that fit accepts weights.</span>
    <span class="s1">w = np.zeros_like(x)</span>
    <span class="s1">z = y + random(y.shape)*</span><span class="s5">.25</span>
    <span class="s1">w[::</span><span class="s5">2</span><span class="s1">] = </span><span class="s5">1</span>
    <span class="s1">p1 = Poly.fit(x[::</span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">z[::</span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
    <span class="s1">p2 = Poly.fit(x</span><span class="s2">, </span><span class="s1">z</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s1">w=w)</span>
    <span class="s1">p3 = Poly.fit(x</span><span class="s2">, </span><span class="s1">z</span><span class="s2">, </span><span class="s1">[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">w=w)</span>
    <span class="s1">assert_almost_equal(p1(x)</span><span class="s2">, </span><span class="s1">p2(x))</span>
    <span class="s1">assert_almost_equal(p2(x)</span><span class="s2">, </span><span class="s1">p3(x))</span>


<span class="s2">def </span><span class="s1">test_equal(Poly):</span>
    <span class="s1">p1 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">p2 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">p3 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">p4 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
    <span class="s1">assert_(p1 == p1)</span>
    <span class="s1">assert_(</span><span class="s2">not </span><span class="s1">p1 == p2)</span>
    <span class="s1">assert_(</span><span class="s2">not </span><span class="s1">p1 == p3)</span>
    <span class="s1">assert_(</span><span class="s2">not </span><span class="s1">p1 == p4)</span>


<span class="s2">def </span><span class="s1">test_not_equal(Poly):</span>
    <span class="s1">p1 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">p2 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">p3 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=[</span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">p4 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
    <span class="s1">assert_(</span><span class="s2">not </span><span class="s1">p1 != p1)</span>
    <span class="s1">assert_(p1 != p2)</span>
    <span class="s1">assert_(p1 != p3)</span>
    <span class="s1">assert_(p1 != p4)</span>


<span class="s2">def </span><span class="s1">test_add(Poly):</span>
    <span class="s3"># This checks commutation, not numerical correctness</span>
    <span class="s1">c1 = list(random((</span><span class="s5">4</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c2 = list(random((</span><span class="s5">3</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">p1 = Poly(c1)</span>
    <span class="s1">p2 = Poly(c2)</span>
    <span class="s1">p3 = p1 + p2</span>
    <span class="s1">assert_poly_almost_equal(p2 + p1</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 + c2</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(c2 + p1</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 + tuple(c2)</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(tuple(c2) + p1</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 + np.array(c2)</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(np.array(c2) + p1</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.add</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=Poly.domain + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.add</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=Poly.window + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s2">if </span><span class="s1">Poly </span><span class="s2">is </span><span class="s1">Polynomial:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.add</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Chebyshev([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.add</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Polynomial([</span><span class="s5">0</span><span class="s1">]))</span>


<span class="s2">def </span><span class="s1">test_sub(Poly):</span>
    <span class="s3"># This checks commutation, not numerical correctness</span>
    <span class="s1">c1 = list(random((</span><span class="s5">4</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c2 = list(random((</span><span class="s5">3</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">p1 = Poly(c1)</span>
    <span class="s1">p2 = Poly(c2)</span>
    <span class="s1">p3 = p1 - p2</span>
    <span class="s1">assert_poly_almost_equal(p2 - p1</span><span class="s2">, </span><span class="s1">-p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 - c2</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(c2 - p1</span><span class="s2">, </span><span class="s1">-p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 - tuple(c2)</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(tuple(c2) - p1</span><span class="s2">, </span><span class="s1">-p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 - np.array(c2)</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(np.array(c2) - p1</span><span class="s2">, </span><span class="s1">-p3)</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.sub</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=Poly.domain + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.sub</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=Poly.window + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s2">if </span><span class="s1">Poly </span><span class="s2">is </span><span class="s1">Polynomial:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.sub</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Chebyshev([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.sub</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Polynomial([</span><span class="s5">0</span><span class="s1">]))</span>


<span class="s2">def </span><span class="s1">test_mul(Poly):</span>
    <span class="s1">c1 = list(random((</span><span class="s5">4</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c2 = list(random((</span><span class="s5">3</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">p1 = Poly(c1)</span>
    <span class="s1">p2 = Poly(c2)</span>
    <span class="s1">p3 = p1 * p2</span>
    <span class="s1">assert_poly_almost_equal(p2 * p1</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 * c2</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(c2 * p1</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 * tuple(c2)</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(tuple(c2) * p1</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 * np.array(c2)</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(np.array(c2) * p1</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p1 * </span><span class="s5">2</span><span class="s2">, </span><span class="s1">p1 * Poly([</span><span class="s5">2</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(</span><span class="s5">2 </span><span class="s1">* p1</span><span class="s2">, </span><span class="s1">p1 * Poly([</span><span class="s5">2</span><span class="s1">]))</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.mul</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=Poly.domain + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.mul</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=Poly.window + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s2">if </span><span class="s1">Poly </span><span class="s2">is </span><span class="s1">Polynomial:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.mul</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Chebyshev([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.mul</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Polynomial([</span><span class="s5">0</span><span class="s1">]))</span>


<span class="s2">def </span><span class="s1">test_floordiv(Poly):</span>
    <span class="s1">c1 = list(random((</span><span class="s5">4</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c2 = list(random((</span><span class="s5">3</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c3 = list(random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">p1 = Poly(c1)</span>
    <span class="s1">p2 = Poly(c2)</span>
    <span class="s1">p3 = Poly(c3)</span>
    <span class="s1">p4 = p1 * p2 + p3</span>
    <span class="s1">c4 = list(p4.coef)</span>
    <span class="s1">assert_poly_almost_equal(p4 // p2</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(p4 // c2</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(c4 // p2</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(p4 // tuple(c2)</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(tuple(c4) // p2</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(p4 // np.array(c2)</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(np.array(c4) // p2</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(</span><span class="s5">2 </span><span class="s1">// p2</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(p2 // </span><span class="s5">2</span><span class="s2">, </span><span class="s5">0.5</span><span class="s1">*p2)</span>
    <span class="s1">assert_raises(</span>
        <span class="s1">TypeError</span><span class="s2">, </span><span class="s1">op.floordiv</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=Poly.domain + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">assert_raises(</span>
        <span class="s1">TypeError</span><span class="s2">, </span><span class="s1">op.floordiv</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=Poly.window + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s2">if </span><span class="s1">Poly </span><span class="s2">is </span><span class="s1">Polynomial:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.floordiv</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Chebyshev([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.floordiv</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Polynomial([</span><span class="s5">0</span><span class="s1">]))</span>


<span class="s2">def </span><span class="s1">test_truediv(Poly):</span>
    <span class="s3"># true division is valid only if the denominator is a Number and</span>
    <span class="s3"># not a python bool.</span>
    <span class="s1">p1 = Poly([</span><span class="s5">1</span><span class="s2">,</span><span class="s5">2</span><span class="s2">,</span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">p2 = p1 * </span><span class="s5">5</span>

    <span class="s2">for </span><span class="s1">stype </span><span class="s2">in </span><span class="s1">np.ScalarType:</span>
        <span class="s2">if not </span><span class="s1">issubclass(stype</span><span class="s2">, </span><span class="s1">Number) </span><span class="s2">or </span><span class="s1">issubclass(stype</span><span class="s2">, </span><span class="s1">bool):</span>
            <span class="s2">continue</span>
        <span class="s1">s = stype(</span><span class="s5">5</span><span class="s1">)</span>
        <span class="s1">assert_poly_almost_equal(op.truediv(p2</span><span class="s2">, </span><span class="s1">s)</span><span class="s2">, </span><span class="s1">p1)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.truediv</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s2">for </span><span class="s1">stype </span><span class="s2">in </span><span class="s1">(int</span><span class="s2">, </span><span class="s1">float):</span>
        <span class="s1">s = stype(</span><span class="s5">5</span><span class="s1">)</span>
        <span class="s1">assert_poly_almost_equal(op.truediv(p2</span><span class="s2">, </span><span class="s1">s)</span><span class="s2">, </span><span class="s1">p1)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.truediv</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s2">for </span><span class="s1">stype </span><span class="s2">in </span><span class="s1">[complex]:</span>
        <span class="s1">s = stype(</span><span class="s5">5</span><span class="s2">, </span><span class="s5">0</span><span class="s1">)</span>
        <span class="s1">assert_poly_almost_equal(op.truediv(p2</span><span class="s2">, </span><span class="s1">s)</span><span class="s2">, </span><span class="s1">p1)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.truediv</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s2">for </span><span class="s1">s </span><span class="s2">in </span><span class="s1">[tuple()</span><span class="s2">, </span><span class="s1">list()</span><span class="s2">, </span><span class="s1">dict()</span><span class="s2">, </span><span class="s1">bool()</span><span class="s2">, </span><span class="s1">np.array([</span><span class="s5">1</span><span class="s1">])]:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.truediv</span><span class="s2">, </span><span class="s1">p2</span><span class="s2">, </span><span class="s1">s)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.truediv</span><span class="s2">, </span><span class="s1">s</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s2">for </span><span class="s1">ptype </span><span class="s2">in </span><span class="s1">classes:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.truediv</span><span class="s2">, </span><span class="s1">p2</span><span class="s2">, </span><span class="s1">ptype(</span><span class="s5">1</span><span class="s1">))</span>


<span class="s2">def </span><span class="s1">test_mod(Poly):</span>
    <span class="s3"># This checks commutation, not numerical correctness</span>
    <span class="s1">c1 = list(random((</span><span class="s5">4</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c2 = list(random((</span><span class="s5">3</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c3 = list(random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">p1 = Poly(c1)</span>
    <span class="s1">p2 = Poly(c2)</span>
    <span class="s1">p3 = Poly(c3)</span>
    <span class="s1">p4 = p1 * p2 + p3</span>
    <span class="s1">c4 = list(p4.coef)</span>
    <span class="s1">assert_poly_almost_equal(p4 % p2</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p4 % c2</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(c4 % p2</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p4 % tuple(c2)</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(tuple(c4) % p2</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(p4 % np.array(c2)</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(np.array(c4) % p2</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">assert_poly_almost_equal(</span><span class="s5">2 </span><span class="s1">% p2</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">2</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(p2 % </span><span class="s5">2</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.mod</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=Poly.domain + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.mod</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=Poly.window + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s2">if </span><span class="s1">Poly </span><span class="s2">is </span><span class="s1">Polynomial:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.mod</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Chebyshev([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">op.mod</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Polynomial([</span><span class="s5">0</span><span class="s1">]))</span>


<span class="s2">def </span><span class="s1">test_divmod(Poly):</span>
    <span class="s3"># This checks commutation, not numerical correctness</span>
    <span class="s1">c1 = list(random((</span><span class="s5">4</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c2 = list(random((</span><span class="s5">3</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">c3 = list(random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">)) + </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">p1 = Poly(c1)</span>
    <span class="s1">p2 = Poly(c2)</span>
    <span class="s1">p3 = Poly(c3)</span>
    <span class="s1">p4 = p1 * p2 + p3</span>
    <span class="s1">c4 = list(p4.coef)</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(p4</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(p4</span><span class="s2">, </span><span class="s1">c2)</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(c4</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(p4</span><span class="s2">, </span><span class="s1">tuple(c2))</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(tuple(c4)</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(p4</span><span class="s2">, </span><span class="s1">np.array(c2))</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(np.array(c4)</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s1">p1)</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">p3)</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(p2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s5">0.5</span><span class="s1">*p2)</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s1">quo</span><span class="s2">, </span><span class="s1">rem = divmod(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">p2)</span>
    <span class="s1">assert_poly_almost_equal(quo</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(rem</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">2</span><span class="s1">]))</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">divmod</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=Poly.domain + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">divmod</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Poly([</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">window=Poly.window + </span><span class="s5">1</span><span class="s1">))</span>
    <span class="s2">if </span><span class="s1">Poly </span><span class="s2">is </span><span class="s1">Polynomial:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">divmod</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Chebyshev([</span><span class="s5">0</span><span class="s1">]))</span>
    <span class="s2">else</span><span class="s1">:</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">divmod</span><span class="s2">, </span><span class="s1">p1</span><span class="s2">, </span><span class="s1">Polynomial([</span><span class="s5">0</span><span class="s1">]))</span>


<span class="s2">def </span><span class="s1">test_roots(Poly):</span>
    <span class="s1">d = Poly.domain * </span><span class="s5">1.25 </span><span class="s1">+ </span><span class="s5">.25</span>
    <span class="s1">w = Poly.window</span>
    <span class="s1">tgt = np.linspace(d[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">d[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)</span>
    <span class="s1">res = np.sort(Poly.fromroots(tgt</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w).roots())</span>
    <span class="s1">assert_almost_equal(res</span><span class="s2">, </span><span class="s1">tgt)</span>
    <span class="s3"># default domain and window</span>
    <span class="s1">res = np.sort(Poly.fromroots(tgt).roots())</span>
    <span class="s1">assert_almost_equal(res</span><span class="s2">, </span><span class="s1">tgt)</span>


<span class="s2">def </span><span class="s1">test_degree(Poly):</span>
    <span class="s1">p = Poly.basis(</span><span class="s5">5</span><span class="s1">)</span>
    <span class="s1">assert_equal(p.degree()</span><span class="s2">, </span><span class="s5">5</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">test_copy(Poly):</span>
    <span class="s1">p1 = Poly.basis(</span><span class="s5">5</span><span class="s1">)</span>
    <span class="s1">p2 = p1.copy()</span>
    <span class="s1">assert_(p1 == p2)</span>
    <span class="s1">assert_(p1 </span><span class="s2">is not </span><span class="s1">p2)</span>
    <span class="s1">assert_(p1.coef </span><span class="s2">is not </span><span class="s1">p2.coef)</span>
    <span class="s1">assert_(p1.domain </span><span class="s2">is not </span><span class="s1">p2.domain)</span>
    <span class="s1">assert_(p1.window </span><span class="s2">is not </span><span class="s1">p2.window)</span>


<span class="s2">def </span><span class="s1">test_integ(Poly):</span>
    <span class="s1">P = Polynomial</span>
    <span class="s3"># Check defaults</span>
    <span class="s1">p0 = Poly.cast(P([</span><span class="s5">1</span><span class="s1">*</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">*</span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s1">*</span><span class="s5">4</span><span class="s1">]))</span>
    <span class="s1">p1 = P.cast(p0.integ())</span>
    <span class="s1">p2 = P.cast(p0.integ(</span><span class="s5">2</span><span class="s1">))</span>
    <span class="s1">assert_poly_almost_equal(p1</span><span class="s2">, </span><span class="s1">P([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(p2</span><span class="s2">, </span><span class="s1">P([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span>
    <span class="s3"># Check with k</span>
    <span class="s1">p0 = Poly.cast(P([</span><span class="s5">1</span><span class="s1">*</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">*</span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s1">*</span><span class="s5">4</span><span class="s1">]))</span>
    <span class="s1">p1 = P.cast(p0.integ(k=</span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">p2 = P.cast(p0.integ(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">k=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(p1</span><span class="s2">, </span><span class="s1">P([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(p2</span><span class="s2">, </span><span class="s1">P([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span>
    <span class="s3"># Check with lbnd</span>
    <span class="s1">p0 = Poly.cast(P([</span><span class="s5">1</span><span class="s1">*</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">*</span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s1">*</span><span class="s5">4</span><span class="s1">]))</span>
    <span class="s1">p1 = P.cast(p0.integ(lbnd=</span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">p2 = P.cast(p0.integ(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">lbnd=</span><span class="s5">1</span><span class="s1">))</span>
    <span class="s1">assert_poly_almost_equal(p1</span><span class="s2">, </span><span class="s1">P([-</span><span class="s5">9</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(p2</span><span class="s2">, </span><span class="s1">P([</span><span class="s5">6</span><span class="s2">, </span><span class="s1">-</span><span class="s5">9</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span>
    <span class="s3"># Check scaling</span>
    <span class="s1">d = </span><span class="s5">2</span><span class="s1">*Poly.domain</span>
    <span class="s1">p0 = Poly.cast(P([</span><span class="s5">1</span><span class="s1">*</span><span class="s5">2</span><span class="s2">, </span><span class="s5">2</span><span class="s1">*</span><span class="s5">3</span><span class="s2">, </span><span class="s5">3</span><span class="s1">*</span><span class="s5">4</span><span class="s1">])</span><span class="s2">, </span><span class="s1">domain=d)</span>
    <span class="s1">p1 = P.cast(p0.integ())</span>
    <span class="s1">p2 = P.cast(p0.integ(</span><span class="s5">2</span><span class="s1">))</span>
    <span class="s1">assert_poly_almost_equal(p1</span><span class="s2">, </span><span class="s1">P([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s2">, </span><span class="s5">4</span><span class="s1">]))</span>
    <span class="s1">assert_poly_almost_equal(p2</span><span class="s2">, </span><span class="s1">P([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]))</span>


<span class="s2">def </span><span class="s1">test_deriv(Poly):</span>
    <span class="s3"># Check that the derivative is the inverse of integration. It is</span>
    <span class="s3"># assumes that the integration has been checked elsewhere.</span>
    <span class="s1">d = Poly.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w = Poly.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">p1 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">p2 = p1.integ(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">k=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
    <span class="s1">p3 = p1.integ(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">k=[</span><span class="s5">1</span><span class="s1">])</span>
    <span class="s1">assert_almost_equal(p2.deriv(</span><span class="s5">1</span><span class="s1">).coef</span><span class="s2">, </span><span class="s1">p3.coef)</span>
    <span class="s1">assert_almost_equal(p2.deriv(</span><span class="s5">2</span><span class="s1">).coef</span><span class="s2">, </span><span class="s1">p1.coef)</span>
    <span class="s3"># default domain and window</span>
    <span class="s1">p1 = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">p2 = p1.integ(</span><span class="s5">2</span><span class="s2">, </span><span class="s1">k=[</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
    <span class="s1">p3 = p1.integ(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">k=[</span><span class="s5">1</span><span class="s1">])</span>
    <span class="s1">assert_almost_equal(p2.deriv(</span><span class="s5">1</span><span class="s1">).coef</span><span class="s2">, </span><span class="s1">p3.coef)</span>
    <span class="s1">assert_almost_equal(p2.deriv(</span><span class="s5">2</span><span class="s1">).coef</span><span class="s2">, </span><span class="s1">p1.coef)</span>


<span class="s2">def </span><span class="s1">test_linspace(Poly):</span>
    <span class="s1">d = Poly.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w = Poly.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">p = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s3"># check default domain</span>
    <span class="s1">xtgt = np.linspace(d[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">d[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s5">20</span><span class="s1">)</span>
    <span class="s1">ytgt = p(xtgt)</span>
    <span class="s1">xres</span><span class="s2">, </span><span class="s1">yres = p.linspace(</span><span class="s5">20</span><span class="s1">)</span>
    <span class="s1">assert_almost_equal(xres</span><span class="s2">, </span><span class="s1">xtgt)</span>
    <span class="s1">assert_almost_equal(yres</span><span class="s2">, </span><span class="s1">ytgt)</span>
    <span class="s3"># check specified domain</span>
    <span class="s1">xtgt = np.linspace(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">20</span><span class="s1">)</span>
    <span class="s1">ytgt = p(xtgt)</span>
    <span class="s1">xres</span><span class="s2">, </span><span class="s1">yres = p.linspace(</span><span class="s5">20</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s1">])</span>
    <span class="s1">assert_almost_equal(xres</span><span class="s2">, </span><span class="s1">xtgt)</span>
    <span class="s1">assert_almost_equal(yres</span><span class="s2">, </span><span class="s1">ytgt)</span>


<span class="s2">def </span><span class="s1">test_pow(Poly):</span>
    <span class="s1">d = Poly.domain + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">w = Poly.window + random((</span><span class="s5">2</span><span class="s2">,</span><span class="s1">))*</span><span class="s5">.25</span>
    <span class="s1">tgt = Poly([</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">tst = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s5">5</span><span class="s1">):</span>
        <span class="s1">assert_poly_almost_equal(tst**i</span><span class="s2">, </span><span class="s1">tgt)</span>
        <span class="s1">tgt = tgt * tst</span>
    <span class="s3"># default domain and window</span>
    <span class="s1">tgt = Poly([</span><span class="s5">1</span><span class="s1">])</span>
    <span class="s1">tst = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s2">for </span><span class="s1">i </span><span class="s2">in </span><span class="s1">range(</span><span class="s5">5</span><span class="s1">):</span>
        <span class="s1">assert_poly_almost_equal(tst**i</span><span class="s2">, </span><span class="s1">tgt)</span>
        <span class="s1">tgt = tgt * tst</span>
    <span class="s3"># check error for invalid powers</span>
    <span class="s1">assert_raises(ValueError</span><span class="s2">, </span><span class="s1">op.pow</span><span class="s2">, </span><span class="s1">tgt</span><span class="s2">, </span><span class="s5">1.5</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s2">, </span><span class="s1">op.pow</span><span class="s2">, </span><span class="s1">tgt</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">test_call(Poly):</span>
    <span class="s1">P = Polynomial</span>
    <span class="s1">d = Poly.domain</span>
    <span class="s1">x = np.linspace(d[</span><span class="s5">0</span><span class="s1">]</span><span class="s2">, </span><span class="s1">d[</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s5">11</span><span class="s1">)</span>

    <span class="s3"># Check defaults</span>
    <span class="s1">p = Poly.cast(P([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">]))</span>
    <span class="s1">tgt = </span><span class="s5">1 </span><span class="s1">+ x*(</span><span class="s5">2 </span><span class="s1">+ </span><span class="s5">3</span><span class="s1">*x)</span>
    <span class="s1">res = p(x)</span>
    <span class="s1">assert_almost_equal(res</span><span class="s2">, </span><span class="s1">tgt)</span>


<span class="s2">def </span><span class="s1">test_cutdeg(Poly):</span>
    <span class="s1">p = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s2">, </span><span class="s1">p.cutdeg</span><span class="s2">, </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s2">, </span><span class="s1">p.cutdeg</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)</span>
    <span class="s1">assert_equal(len(p.cutdeg(</span><span class="s5">3</span><span class="s1">))</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
    <span class="s1">assert_equal(len(p.cutdeg(</span><span class="s5">2</span><span class="s1">))</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
    <span class="s1">assert_equal(len(p.cutdeg(</span><span class="s5">1</span><span class="s1">))</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span>
    <span class="s1">assert_equal(len(p.cutdeg(</span><span class="s5">0</span><span class="s1">))</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">test_truncate(Poly):</span>
    <span class="s1">p = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">assert_raises(ValueError</span><span class="s2">, </span><span class="s1">p.truncate</span><span class="s2">, </span><span class="s5">.5</span><span class="s1">)</span>
    <span class="s1">assert_raises(ValueError</span><span class="s2">, </span><span class="s1">p.truncate</span><span class="s2">, </span><span class="s5">0</span><span class="s1">)</span>
    <span class="s1">assert_equal(len(p.truncate(</span><span class="s5">4</span><span class="s1">))</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
    <span class="s1">assert_equal(len(p.truncate(</span><span class="s5">3</span><span class="s1">))</span><span class="s2">, </span><span class="s5">3</span><span class="s1">)</span>
    <span class="s1">assert_equal(len(p.truncate(</span><span class="s5">2</span><span class="s1">))</span><span class="s2">, </span><span class="s5">2</span><span class="s1">)</span>
    <span class="s1">assert_equal(len(p.truncate(</span><span class="s5">1</span><span class="s1">))</span><span class="s2">, </span><span class="s5">1</span><span class="s1">)</span>


<span class="s2">def </span><span class="s1">test_trim(Poly):</span>
    <span class="s1">c = [</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1e-6</span><span class="s2">, </span><span class="s5">1e-12</span><span class="s2">, </span><span class="s5">0</span><span class="s1">]</span>
    <span class="s1">p = Poly(c)</span>
    <span class="s1">assert_equal(p.trim().coef</span><span class="s2">, </span><span class="s1">c[:</span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.trim(</span><span class="s5">1e-10</span><span class="s1">).coef</span><span class="s2">, </span><span class="s1">c[:</span><span class="s5">2</span><span class="s1">])</span>
    <span class="s1">assert_equal(p.trim(</span><span class="s5">1e-5</span><span class="s1">).coef</span><span class="s2">, </span><span class="s1">c[:</span><span class="s5">1</span><span class="s1">])</span>


<span class="s2">def </span><span class="s1">test_mapparms(Poly):</span>
    <span class="s3"># check with defaults. Should be identity.</span>
    <span class="s1">d = Poly.domain</span>
    <span class="s1">w = Poly.window</span>
    <span class="s1">p = Poly([</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">assert_almost_equal([</span><span class="s5">0</span><span class="s2">, </span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">p.mapparms())</span>
    <span class="s3">#</span>
    <span class="s1">w = </span><span class="s5">2</span><span class="s1">*d + </span><span class="s5">1</span>
    <span class="s1">p = Poly([</span><span class="s5">1</span><span class="s1">]</span><span class="s2">, </span><span class="s1">domain=d</span><span class="s2">, </span><span class="s1">window=w)</span>
    <span class="s1">assert_almost_equal([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">p.mapparms())</span>


<span class="s2">def </span><span class="s1">test_ufunc_override(Poly):</span>
    <span class="s1">p = Poly([</span><span class="s5">1</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">3</span><span class="s1">])</span>
    <span class="s1">x = np.ones(</span><span class="s5">3</span><span class="s1">)</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">np.add</span><span class="s2">, </span><span class="s1">p</span><span class="s2">, </span><span class="s1">x)</span>
    <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">np.add</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">p)</span>


<span class="s3">#</span>
<span class="s3"># Test class method that only exists for some classes</span>
<span class="s3">#</span>


<span class="s2">class </span><span class="s1">TestInterpolate:</span>

    <span class="s2">def </span><span class="s1">f(self</span><span class="s2">, </span><span class="s1">x):</span>
        <span class="s2">return </span><span class="s1">x * (x - </span><span class="s5">1</span><span class="s1">) * (x - </span><span class="s5">2</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_raises(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s2">, </span><span class="s1">Chebyshev.interpolate</span><span class="s2">, </span><span class="s1">self.f</span><span class="s2">, </span><span class="s1">-</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s2">, </span><span class="s1">Chebyshev.interpolate</span><span class="s2">, </span><span class="s1">self.f</span><span class="s2">, </span><span class="s5">10.</span><span class="s1">)</span>

    <span class="s2">def </span><span class="s1">test_dimensions(self):</span>
        <span class="s2">for </span><span class="s1">deg </span><span class="s2">in </span><span class="s1">range(</span><span class="s5">1</span><span class="s2">, </span><span class="s5">5</span><span class="s1">):</span>
            <span class="s1">assert_(Chebyshev.interpolate(self.f</span><span class="s2">, </span><span class="s1">deg).degree() == deg)</span>

    <span class="s2">def </span><span class="s1">test_approximation(self):</span>

        <span class="s2">def </span><span class="s1">powx(x</span><span class="s2">, </span><span class="s1">p):</span>
            <span class="s2">return </span><span class="s1">x**p</span>

        <span class="s1">x = np.linspace(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s2">, </span><span class="s5">10</span><span class="s1">)</span>
        <span class="s2">for </span><span class="s1">deg </span><span class="s2">in </span><span class="s1">range(</span><span class="s5">0</span><span class="s2">, </span><span class="s5">10</span><span class="s1">):</span>
            <span class="s2">for </span><span class="s1">t </span><span class="s2">in </span><span class="s1">range(</span><span class="s5">0</span><span class="s2">, </span><span class="s1">deg + </span><span class="s5">1</span><span class="s1">):</span>
                <span class="s1">p = Chebyshev.interpolate(powx</span><span class="s2">, </span><span class="s1">deg</span><span class="s2">, </span><span class="s1">domain=[</span><span class="s5">0</span><span class="s2">, </span><span class="s5">2</span><span class="s1">]</span><span class="s2">, </span><span class="s1">args=(t</span><span class="s2">,</span><span class="s1">))</span>
                <span class="s1">assert_almost_equal(p(x)</span><span class="s2">, </span><span class="s1">powx(x</span><span class="s2">, </span><span class="s1">t)</span><span class="s2">, </span><span class="s1">decimal=</span><span class="s5">11</span><span class="s1">)</span>
</pre>
</body>
</html>