<html>
<head>
<title>test_generator_mt19937.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #6897bb;}
.s4 { color: #808080;}
.s5 { color: #a5c261;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_generator_mt19937.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">sys</span>
<span class="s0">import </span><span class="s1">hashlib</span>

<span class="s0">import </span><span class="s1">pytest</span>

<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">from </span><span class="s1">numpy.linalg </span><span class="s0">import </span><span class="s1">LinAlgError</span>
<span class="s0">from </span><span class="s1">numpy.testing </span><span class="s0">import </span><span class="s1">(</span>
    <span class="s1">assert_</span><span class="s0">, </span><span class="s1">assert_raises</span><span class="s0">, </span><span class="s1">assert_equal</span><span class="s0">, </span><span class="s1">assert_allclose</span><span class="s0">,</span>
    <span class="s1">assert_warns</span><span class="s0">, </span><span class="s1">assert_no_warnings</span><span class="s0">, </span><span class="s1">assert_array_equal</span><span class="s0">,</span>
    <span class="s1">assert_array_almost_equal</span><span class="s0">, </span><span class="s1">suppress_warnings)</span>

<span class="s0">from </span><span class="s1">numpy.random </span><span class="s0">import </span><span class="s1">Generator</span><span class="s0">, </span><span class="s1">MT19937</span><span class="s0">, </span><span class="s1">SeedSequence</span><span class="s0">, </span><span class="s1">RandomState</span>

<span class="s1">random = Generator(MT19937())</span>

<span class="s1">JUMP_TEST_DATA = [</span>
    <span class="s1">{</span>
        <span class="s2">&quot;seed&quot;</span><span class="s1">: </span><span class="s3">0</span><span class="s0">,</span>
        <span class="s2">&quot;steps&quot;</span><span class="s1">: </span><span class="s3">10</span><span class="s0">,</span>
        <span class="s2">&quot;initial&quot;</span><span class="s1">: {</span><span class="s2">&quot;key_sha256&quot;</span><span class="s1">: </span><span class="s2">&quot;bb1636883c2707b51c5b7fc26c6927af4430f2e0785a8c7bc886337f919f9edf&quot;</span><span class="s0">, </span><span class="s2">&quot;pos&quot;</span><span class="s1">: </span><span class="s3">9</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s2">&quot;jumped&quot;</span><span class="s1">: {</span><span class="s2">&quot;key_sha256&quot;</span><span class="s1">: </span><span class="s2">&quot;ff682ac12bb140f2d72fba8d3506cf4e46817a0db27aae1683867629031d8d55&quot;</span><span class="s0">, </span><span class="s2">&quot;pos&quot;</span><span class="s1">: </span><span class="s3">598</span><span class="s1">}</span><span class="s0">,</span>
    <span class="s1">}</span><span class="s0">,</span>
    <span class="s1">{</span>
        <span class="s2">&quot;seed&quot;</span><span class="s1">:</span><span class="s3">384908324</span><span class="s0">,</span>
        <span class="s2">&quot;steps&quot;</span><span class="s1">:</span><span class="s3">312</span><span class="s0">,</span>
        <span class="s2">&quot;initial&quot;</span><span class="s1">: {</span><span class="s2">&quot;key_sha256&quot;</span><span class="s1">: </span><span class="s2">&quot;16b791a1e04886ccbbb4d448d6ff791267dc458ae599475d08d5cced29d11614&quot;</span><span class="s0">, </span><span class="s2">&quot;pos&quot;</span><span class="s1">: </span><span class="s3">311</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s2">&quot;jumped&quot;</span><span class="s1">: {</span><span class="s2">&quot;key_sha256&quot;</span><span class="s1">: </span><span class="s2">&quot;a0110a2cf23b56be0feaed8f787a7fc84bef0cb5623003d75b26bdfa1c18002c&quot;</span><span class="s0">, </span><span class="s2">&quot;pos&quot;</span><span class="s1">: </span><span class="s3">276</span><span class="s1">}</span><span class="s0">,</span>
    <span class="s1">}</span><span class="s0">,</span>
    <span class="s1">{</span>
        <span class="s2">&quot;seed&quot;</span><span class="s1">: [</span><span class="s3">839438204</span><span class="s0">, </span><span class="s3">980239840</span><span class="s0">, </span><span class="s3">859048019</span><span class="s0">, </span><span class="s3">821</span><span class="s1">]</span><span class="s0">,</span>
        <span class="s2">&quot;steps&quot;</span><span class="s1">: </span><span class="s3">511</span><span class="s0">,</span>
        <span class="s2">&quot;initial&quot;</span><span class="s1">: {</span><span class="s2">&quot;key_sha256&quot;</span><span class="s1">: </span><span class="s2">&quot;d306cf01314d51bd37892d874308200951a35265ede54d200f1e065004c3e9ea&quot;</span><span class="s0">, </span><span class="s2">&quot;pos&quot;</span><span class="s1">: </span><span class="s3">510</span><span class="s1">}</span><span class="s0">,</span>
        <span class="s2">&quot;jumped&quot;</span><span class="s1">: {</span><span class="s2">&quot;key_sha256&quot;</span><span class="s1">: </span><span class="s2">&quot;0e00ab449f01a5195a83b4aee0dfbc2ce8d46466a640b92e33977d2e42f777f8&quot;</span><span class="s0">, </span><span class="s2">&quot;pos&quot;</span><span class="s1">: </span><span class="s3">475</span><span class="s1">}</span><span class="s0">,</span>
    <span class="s1">}</span><span class="s0">,</span>
<span class="s1">]</span>

<span class="s1">@pytest.fixture(scope=</span><span class="s2">'module'</span><span class="s0">, </span><span class="s1">params=[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">endpoint(request):</span>
    <span class="s0">return </span><span class="s1">request.param</span>


<span class="s0">class </span><span class="s1">TestSeed:</span>
    <span class="s0">def </span><span class="s1">test_scalar(self):</span>
        <span class="s1">s = Generator(MT19937(</span><span class="s3">0</span><span class="s1">))</span>
        <span class="s1">assert_equal(s.integers(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">479</span><span class="s1">)</span>
        <span class="s1">s = Generator(MT19937(</span><span class="s3">4294967295</span><span class="s1">))</span>
        <span class="s1">assert_equal(s.integers(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">324</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_array(self):</span>
        <span class="s1">s = Generator(MT19937(range(</span><span class="s3">10</span><span class="s1">)))</span>
        <span class="s1">assert_equal(s.integers(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">465</span><span class="s1">)</span>
        <span class="s1">s = Generator(MT19937(np.arange(</span><span class="s3">10</span><span class="s1">)))</span>
        <span class="s1">assert_equal(s.integers(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">465</span><span class="s1">)</span>
        <span class="s1">s = Generator(MT19937([</span><span class="s3">0</span><span class="s1">]))</span>
        <span class="s1">assert_equal(s.integers(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">479</span><span class="s1">)</span>
        <span class="s1">s = Generator(MT19937([</span><span class="s3">4294967295</span><span class="s1">]))</span>
        <span class="s1">assert_equal(s.integers(</span><span class="s3">1000</span><span class="s1">)</span><span class="s0">, </span><span class="s3">324</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_seedsequence(self):</span>
        <span class="s1">s = MT19937(SeedSequence(</span><span class="s3">0</span><span class="s1">))</span>
        <span class="s1">assert_equal(s.random_raw(</span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s3">2058676884</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_scalar(self):</span>
        <span class="s4"># seed must be an unsigned 32 bit integer</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">MT19937</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.5</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">MT19937</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_array(self):</span>
        <span class="s4"># seed must be an unsigned integer</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">MT19937</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">0.5</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">MT19937</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">1</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">MT19937</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s3">4294967296</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_noninstantized_bitgen(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">Generator</span><span class="s0">, </span><span class="s1">MT19937)</span>


<span class="s0">class </span><span class="s1">TestBinomial:</span>
    <span class="s0">def </span><span class="s1">test_n_zero(self):</span>
        <span class="s4"># Tests the corner case of n == 0 for the binomial distribution.</span>
        <span class="s4"># binomial(0, p) should be zero for any p in [0, 1].</span>
        <span class="s4"># This test addresses issue #3480.</span>
        <span class="s1">zeros = np.zeros(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'int'</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">p </span><span class="s0">in </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">.5</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]:</span>
            <span class="s1">assert_(random.binomial(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">p) == </span><span class="s3">0</span><span class="s1">)</span>
            <span class="s1">assert_array_equal(random.binomial(zeros</span><span class="s0">, </span><span class="s1">p)</span><span class="s0">, </span><span class="s1">zeros)</span>

    <span class="s0">def </span><span class="s1">test_p_is_nan(self):</span>
        <span class="s4"># Issue #4571.</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.binomial</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.nan)</span>


<span class="s0">class </span><span class="s1">TestMultinomial:</span>
    <span class="s0">def </span><span class="s1">test_basic(self):</span>
        <span class="s1">random.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.8</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_zero_probability(self):</span>
        <span class="s1">random.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.2</span><span class="s0">, </span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_int_negative_interval(self):</span>
        <span class="s1">assert_(-</span><span class="s3">5 </span><span class="s1">&lt;= random.integers(-</span><span class="s3">5</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">) &lt; -</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">x = random.integers(-</span><span class="s3">5</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(-</span><span class="s3">5 </span><span class="s1">&lt;= x))</span>
        <span class="s1">assert_(np.all(x &lt; -</span><span class="s3">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_size(self):</span>
        <span class="s4"># gh-3173</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">np.array((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))).shape</span><span class="s0">,</span>
                     <span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>

        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">p</span><span class="s0">,</span>
                      <span class="s1">float(</span><span class="s3">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_invalid_prob(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s3">100</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1.1</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s3">100</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">.1</span><span class="s0">, </span><span class="s3">0.9</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_invalid_n(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">1</span><span class="s1">] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.8</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_p_non_contiguous(self):</span>
        <span class="s1">p = np.arange(</span><span class="s3">15.</span><span class="s1">)</span>
        <span class="s1">p /= np.sum(p[</span><span class="s3">1</span><span class="s1">::</span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">pvals = p[</span><span class="s3">1</span><span class="s1">::</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">random = Generator(MT19937(</span><span class="s3">1432985819</span><span class="s1">))</span>
        <span class="s1">non_contig = random.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">pvals=pvals)</span>
        <span class="s1">random = Generator(MT19937(</span><span class="s3">1432985819</span><span class="s1">))</span>
        <span class="s1">contig = random.multinomial(</span><span class="s3">100</span><span class="s0">, </span><span class="s1">pvals=np.ascontiguousarray(pvals))</span>
        <span class="s1">assert_array_equal(non_contig</span><span class="s0">, </span><span class="s1">contig)</span>

    <span class="s0">def </span><span class="s1">test_multinomial_pvals_float32(self):</span>
        <span class="s1">x = np.array([</span><span class="s3">9.9e-01</span><span class="s0">, </span><span class="s3">9.9e-01</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">,</span>
                      <span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s0">, </span><span class="s3">1.0e-09</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">pvals = x / x.sum()</span>
        <span class="s1">random = Generator(MT19937(</span><span class="s3">1432985819</span><span class="s1">))</span>
        <span class="s1">match = </span><span class="s2">r&quot;[\w\s]*pvals array is cast to 64-bit floating&quot;</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=match):</span>
            <span class="s1">random.multinomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">pvals)</span>

<span class="s0">class </span><span class="s1">TestMultivariateHypergeometric:</span>

    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s3">8675309</span>

    <span class="s0">def </span><span class="s1">test_argument_validation(self):</span>
        <span class="s4"># Error cases...</span>

        <span class="s4"># `colors` must be a 1-d sequence</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_hypergeometric</span><span class="s0">,</span>
                      <span class="s3">10</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>

        <span class="s4"># Negative nsample</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_hypergeometric</span><span class="s0">,</span>
                      <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>

        <span class="s4"># Negative color</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_hypergeometric</span><span class="s0">,</span>
                      <span class="s1">[-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>

        <span class="s4"># nsample exceeds sum(colors)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_hypergeometric</span><span class="s0">,</span>
                      <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>

        <span class="s4"># nsample exceeds sum(colors) (edge case of empty colors)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_hypergeometric</span><span class="s0">,</span>
                      <span class="s1">[]</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>

        <span class="s4"># Validation errors associated with very large values in colors.</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_hypergeometric</span><span class="s0">,</span>
                      <span class="s1">[</span><span class="s3">999999999</span><span class="s0">, </span><span class="s3">101</span><span class="s1">]</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s2">'marginals'</span><span class="s1">)</span>

        <span class="s1">int64_info = np.iinfo(np.int64)</span>
        <span class="s1">max_int64 = int64_info.max</span>
        <span class="s1">max_int64_index = max_int64 // int64_info.dtype.itemsize</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_hypergeometric</span><span class="s0">,</span>
                      <span class="s1">[max_int64_index - </span><span class="s3">100</span><span class="s0">, </span><span class="s3">101</span><span class="s1">]</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s2">'count'</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">'method'</span><span class="s0">, </span><span class="s1">[</span><span class="s2">'count'</span><span class="s0">, </span><span class="s2">'marginals'</span><span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_edge_cases(self</span><span class="s0">, </span><span class="s1">method):</span>
        <span class="s4"># Set the seed, but in fact, all the results in this test are</span>
        <span class="s4"># deterministic, so we don't really need this.</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>

        <span class="s1">x = random.multivariate_hypergeometric([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">method=method)</span>
        <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>

        <span class="s1">x = random.multivariate_hypergeometric([]</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">method=method)</span>
        <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">[])</span>

        <span class="s1">x = random.multivariate_hypergeometric([]</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">method=method)</span>
        <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">np.empty((</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=np.int64))</span>

        <span class="s1">x = random.multivariate_hypergeometric([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">method=method)</span>
        <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>

        <span class="s1">x = random.multivariate_hypergeometric([</span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">method=method)</span>
        <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>

        <span class="s1">colors = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">x = random.multivariate_hypergeometric(colors</span><span class="s0">, </span><span class="s1">sum(colors)</span><span class="s0">,</span>
                                               <span class="s1">method=method)</span>
        <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">colors)</span>

        <span class="s1">x = random.multivariate_hypergeometric([</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">3</span><span class="s0">,</span>
                                               <span class="s1">method=method)</span>
        <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]]*</span><span class="s3">3</span><span class="s1">)</span>

    <span class="s4"># Cases for nsample:</span>
    <span class="s4">#     nsample &lt; 10</span>
    <span class="s4">#     10 &lt;= nsample &lt; colors.sum()/2</span>
    <span class="s4">#     colors.sum()/2 &lt; nsample &lt; colors.sum() - 10</span>
    <span class="s4">#     colors.sum() - 10 &lt; nsample &lt; colors.sum()</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">'nsample'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">8</span><span class="s0">, </span><span class="s3">25</span><span class="s0">, </span><span class="s3">45</span><span class="s0">, </span><span class="s3">55</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">'method'</span><span class="s0">, </span><span class="s1">[</span><span class="s2">'count'</span><span class="s0">, </span><span class="s2">'marginals'</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">'size'</span><span class="s0">, </span><span class="s1">[</span><span class="s3">5</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span class="s3">150000</span><span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_typical_cases(self</span><span class="s0">, </span><span class="s1">nsample</span><span class="s0">, </span><span class="s1">method</span><span class="s0">, </span><span class="s1">size):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>

        <span class="s1">colors = np.array([</span><span class="s3">10</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">25</span><span class="s1">])</span>
        <span class="s1">sample = random.multivariate_hypergeometric(colors</span><span class="s0">, </span><span class="s1">nsample</span><span class="s0">, </span><span class="s1">size</span><span class="s0">,</span>
                                                    <span class="s1">method=method)</span>
        <span class="s0">if </span><span class="s1">isinstance(size</span><span class="s0">, </span><span class="s1">int):</span>
            <span class="s1">expected_shape = (size</span><span class="s0">,</span><span class="s1">) + colors.shape</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">expected_shape = size + colors.shape</span>
        <span class="s1">assert_equal(sample.shape</span><span class="s0">, </span><span class="s1">expected_shape)</span>
        <span class="s1">assert_((sample &gt;= </span><span class="s3">0</span><span class="s1">).all())</span>
        <span class="s1">assert_((sample &lt;= colors).all())</span>
        <span class="s1">assert_array_equal(sample.sum(axis=-</span><span class="s3">1</span><span class="s1">)</span><span class="s0">,</span>
                           <span class="s1">np.full(size</span><span class="s0">, </span><span class="s1">fill_value=nsample</span><span class="s0">, </span><span class="s1">dtype=int))</span>
        <span class="s0">if </span><span class="s1">isinstance(size</span><span class="s0">, </span><span class="s1">int) </span><span class="s0">and </span><span class="s1">size &gt;= </span><span class="s3">100000</span><span class="s1">:</span>
            <span class="s4"># This sample is large enough to compare its mean to</span>
            <span class="s4"># the expected values.</span>
            <span class="s1">assert_allclose(sample.mean(axis=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">,</span>
                            <span class="s1">nsample * colors / colors.sum()</span><span class="s0">,</span>
                            <span class="s1">rtol=</span><span class="s3">1e-3</span><span class="s0">, </span><span class="s1">atol=</span><span class="s3">0.005</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_repeatability1(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">sample = random.multivariate_hypergeometric([</span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">5</span><span class="s0">,</span>
                                                    <span class="s1">method=</span><span class="s2">'count'</span><span class="s1">)</span>
        <span class="s1">expected = np.array([[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(sample</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s0">def </span><span class="s1">test_repeatability2(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">sample = random.multivariate_hypergeometric([</span><span class="s3">20</span><span class="s0">, </span><span class="s3">30</span><span class="s0">, </span><span class="s3">50</span><span class="s1">]</span><span class="s0">, </span><span class="s3">50</span><span class="s0">,</span>
                                                    <span class="s1">size=</span><span class="s3">5</span><span class="s0">,</span>
                                                    <span class="s1">method=</span><span class="s2">'marginals'</span><span class="s1">)</span>
        <span class="s1">expected = np.array([[ </span><span class="s3">9</span><span class="s0">, </span><span class="s3">17</span><span class="s0">, </span><span class="s3">24</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">7</span><span class="s0">, </span><span class="s3">13</span><span class="s0">, </span><span class="s3">30</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">9</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s3">26</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">9</span><span class="s0">, </span><span class="s3">17</span><span class="s0">, </span><span class="s3">24</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">12</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s3">24</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(sample</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s0">def </span><span class="s1">test_repeatability3(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">sample = random.multivariate_hypergeometric([</span><span class="s3">20</span><span class="s0">, </span><span class="s3">30</span><span class="s0">, </span><span class="s3">50</span><span class="s1">]</span><span class="s0">, </span><span class="s3">12</span><span class="s0">,</span>
                                                    <span class="s1">size=</span><span class="s3">5</span><span class="s0">,</span>
                                                    <span class="s1">method=</span><span class="s2">'marginals'</span><span class="s1">)</span>
        <span class="s1">expected = np.array([[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">7</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(sample</span><span class="s0">, </span><span class="s1">expected)</span>


<span class="s0">class </span><span class="s1">TestSetState:</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s3">1234567890</span>
        <span class="s1">self.rg = Generator(MT19937(self.seed))</span>
        <span class="s1">self.bit_generator = self.rg.bit_generator</span>
        <span class="s1">self.state = self.bit_generator.state</span>
        <span class="s1">self.legacy_state = (self.state[</span><span class="s2">'bit_generator'</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">self.state[</span><span class="s2">'state'</span><span class="s1">][</span><span class="s2">'key'</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">self.state[</span><span class="s2">'state'</span><span class="s1">][</span><span class="s2">'pos'</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset(self):</span>
        <span class="s4"># Make sure the cached every-other-Gaussian is reset.</span>
        <span class="s1">old = self.rg.standard_normal(size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">self.bit_generator.state = self.state</span>
        <span class="s1">new = self.rg.standard_normal(size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(old == new))</span>

    <span class="s0">def </span><span class="s1">test_gaussian_reset_in_media_res(self):</span>
        <span class="s4"># When the state is saved with a cached Gaussian, make sure the</span>
        <span class="s4"># cached Gaussian is restored.</span>

        <span class="s1">self.rg.standard_normal()</span>
        <span class="s1">state = self.bit_generator.state</span>
        <span class="s1">old = self.rg.standard_normal(size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">self.bit_generator.state = state</span>
        <span class="s1">new = self.rg.standard_normal(size=</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(old == new))</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s4"># Ensure that the negative binomial results take floating point</span>
        <span class="s4"># arguments without truncation.</span>
        <span class="s1">self.rg.negative_binomial(</span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestIntegers:</span>
    <span class="s1">rfunc = random.integers</span>

    <span class="s4"># valid integer/boolean types</span>
    <span class="s1">itype = [bool</span><span class="s0">, </span><span class="s1">np.int8</span><span class="s0">, </span><span class="s1">np.uint8</span><span class="s0">, </span><span class="s1">np.int16</span><span class="s0">, </span><span class="s1">np.uint16</span><span class="s0">,</span>
             <span class="s1">np.int32</span><span class="s0">, </span><span class="s1">np.uint32</span><span class="s0">, </span><span class="s1">np.int64</span><span class="s0">, </span><span class="s1">np.uint64]</span>

    <span class="s0">def </span><span class="s1">test_unsupported_type(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=float)</span>

    <span class="s0">def </span><span class="s1">test_bounds_checking(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">lbnd - </span><span class="s3">1</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">lbnd</span><span class="s0">, </span><span class="s1">ubnd + </span><span class="s3">1</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">lbnd</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                          <span class="s1">dtype=dt)</span>

            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">[lbnd - </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">[lbnd]</span><span class="s0">, </span><span class="s1">[ubnd + </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">[ubnd]</span><span class="s0">, </span><span class="s1">[lbnd]</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>

    <span class="s0">def </span><span class="s1">test_bounds_checking_array(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + (</span><span class="s0">not </span><span class="s1">endpoint)</span>

            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">[lbnd - </span><span class="s3">1</span><span class="s1">] * </span><span class="s3">2</span><span class="s0">, </span><span class="s1">[ubnd] * </span><span class="s3">2</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">[lbnd] * </span><span class="s3">2</span><span class="s0">,</span>
                          <span class="s1">[ubnd + </span><span class="s3">1</span><span class="s1">] * </span><span class="s3">2</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">[lbnd] * </span><span class="s3">2</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">self.rfunc</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">] * </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">,</span>
                          <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>

    <span class="s0">def </span><span class="s1">test_rng_zero_and_extremes(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>
            <span class="s1">is_open = </span><span class="s0">not </span><span class="s1">endpoint</span>

            <span class="s1">tgt = ubnd - </span><span class="s3">1</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + is_open</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">,</span>
                                    <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc([tgt]</span><span class="s0">, </span><span class="s1">tgt + is_open</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">,</span>
                                    <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

            <span class="s1">tgt = lbnd</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + is_open</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">,</span>
                                    <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">[tgt + is_open]</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">,</span>
                                    <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

            <span class="s1">tgt = (lbnd + ubnd) // </span><span class="s3">2</span>
            <span class="s1">assert_equal(self.rfunc(tgt</span><span class="s0">, </span><span class="s1">tgt + is_open</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">,</span>
                                    <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc([tgt]</span><span class="s0">, </span><span class="s1">[tgt + is_open]</span><span class="s0">,</span>
                                    <span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">,</span>
                         <span class="s1">tgt)</span>

    <span class="s0">def </span><span class="s1">test_rng_zero_and_extremes_array(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s1">size = </span><span class="s3">1000</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s1">tgt = ubnd - </span><span class="s3">1</span>
            <span class="s1">assert_equal(self.rfunc([tgt]</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                                    <span class="s1">size=size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc(</span>
                <span class="s1">[tgt] * size</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">] * size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc(</span>
                <span class="s1">[tgt] * size</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">] * size</span><span class="s0">, </span><span class="s1">size=size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

            <span class="s1">tgt = lbnd</span>
            <span class="s1">assert_equal(self.rfunc([tgt]</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                                    <span class="s1">size=size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc(</span>
                <span class="s1">[tgt] * size</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">] * size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc(</span>
                <span class="s1">[tgt] * size</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">] * size</span><span class="s0">, </span><span class="s1">size=size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

            <span class="s1">tgt = (lbnd + ubnd) // </span><span class="s3">2</span>
            <span class="s1">assert_equal(self.rfunc([tgt]</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                                    <span class="s1">size=size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc(</span>
                <span class="s1">[tgt] * size</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">] * size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>
            <span class="s1">assert_equal(self.rfunc(</span>
                <span class="s1">[tgt] * size</span><span class="s0">, </span><span class="s1">[tgt + </span><span class="s3">1</span><span class="s1">] * size</span><span class="s0">, </span><span class="s1">size=size</span><span class="s0">, </span><span class="s1">dtype=dt)</span><span class="s0">, </span><span class="s1">tgt)</span>

    <span class="s0">def </span><span class="s1">test_full_range(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s4"># Test for ticket #1690</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s0">try</span><span class="s1">:</span>
                <span class="s1">self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e:</span>
                <span class="s0">raise </span><span class="s1">AssertionError(</span><span class="s2">&quot;No error should have been raised, &quot;</span>
                                     <span class="s2">&quot;but one was with the following &quot;</span>
                                     <span class="s2">&quot;message:</span><span class="s0">\n\n</span><span class="s2">%s&quot; </span><span class="s1">% str(e))</span>

    <span class="s0">def </span><span class="s1">test_full_range_array(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s4"># Test for ticket #1690</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s0">try</span><span class="s1">:</span>
                <span class="s1">self.rfunc([lbnd] * </span><span class="s3">2</span><span class="s0">, </span><span class="s1">[ubnd]</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e:</span>
                <span class="s0">raise </span><span class="s1">AssertionError(</span><span class="s2">&quot;No error should have been raised, &quot;</span>
                                     <span class="s2">&quot;but one was with the following &quot;</span>
                                     <span class="s2">&quot;message:</span><span class="s0">\n\n</span><span class="s2">%s&quot; </span><span class="s1">% str(e))</span>

    <span class="s0">def </span><span class="s1">test_in_bounds_fuzz(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s4"># Don't use fixed seed</span>
        <span class="s1">random = Generator(MT19937())</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype[</span><span class="s3">1</span><span class="s1">:]:</span>
            <span class="s0">for </span><span class="s1">ubnd </span><span class="s0">in </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">16</span><span class="s1">]:</span>
                <span class="s1">vals = self.rfunc(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">ubnd - endpoint</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">2 </span><span class="s1">** </span><span class="s3">16</span><span class="s0">,</span>
                                  <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
                <span class="s1">assert_(vals.max() &lt; ubnd)</span>
                <span class="s1">assert_(vals.min() &gt;= </span><span class="s3">2</span><span class="s1">)</span>

        <span class="s1">vals = self.rfunc(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">- endpoint</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">2 </span><span class="s1">** </span><span class="s3">16</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                          <span class="s1">dtype=bool)</span>
        <span class="s1">assert_(vals.max() &lt; </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">assert_(vals.min() &gt;= </span><span class="s3">0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_scalar_array_equiv(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s1">size = </span><span class="s3">1000</span>
            <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>
            <span class="s1">scalar = random.integers(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">size=size</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                                <span class="s1">dtype=dt)</span>

            <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>
            <span class="s1">scalar_array = random.integers([lbnd]</span><span class="s0">, </span><span class="s1">[ubnd]</span><span class="s0">, </span><span class="s1">size=size</span><span class="s0">,</span>
                                      <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>

            <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>
            <span class="s1">array = random.integers([lbnd] * size</span><span class="s0">, </span><span class="s1">[ubnd] *</span>
                               <span class="s1">size</span><span class="s0">, </span><span class="s1">size=size</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_array_equal(scalar</span><span class="s0">, </span><span class="s1">scalar_array)</span>
            <span class="s1">assert_array_equal(scalar</span><span class="s0">, </span><span class="s1">array)</span>

    <span class="s0">def </span><span class="s1">test_repeatability(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s4"># We use a sha256 hash of generated sequences of 1000 samples</span>
        <span class="s4"># in the range [0, 6) for all but bool, where the range</span>
        <span class="s4"># is [0, 2). Hashes are for little endian numbers.</span>
        <span class="s1">tgt = {</span><span class="s2">'bool'</span><span class="s1">:   </span><span class="s2">'053594a9b82d656f967c54869bc6970aa0358cf94ad469c81478459c6a90eee3'</span><span class="s0">,</span>
               <span class="s2">'int16'</span><span class="s1">:  </span><span class="s2">'54de9072b6ee9ff7f20b58329556a46a447a8a29d67db51201bf88baa6e4e5d4'</span><span class="s0">,</span>
               <span class="s2">'int32'</span><span class="s1">:  </span><span class="s2">'d3a0d5efb04542b25ac712e50d21f39ac30f312a5052e9bbb1ad3baa791ac84b'</span><span class="s0">,</span>
               <span class="s2">'int64'</span><span class="s1">:  </span><span class="s2">'14e224389ac4580bfbdccb5697d6190b496f91227cf67df60989de3d546389b1'</span><span class="s0">,</span>
               <span class="s2">'int8'</span><span class="s1">:   </span><span class="s2">'0e203226ff3fbbd1580f15da4621e5f7164d0d8d6b51696dd42d004ece2cbec1'</span><span class="s0">,</span>
               <span class="s2">'uint16'</span><span class="s1">: </span><span class="s2">'54de9072b6ee9ff7f20b58329556a46a447a8a29d67db51201bf88baa6e4e5d4'</span><span class="s0">,</span>
               <span class="s2">'uint32'</span><span class="s1">: </span><span class="s2">'d3a0d5efb04542b25ac712e50d21f39ac30f312a5052e9bbb1ad3baa791ac84b'</span><span class="s0">,</span>
               <span class="s2">'uint64'</span><span class="s1">: </span><span class="s2">'14e224389ac4580bfbdccb5697d6190b496f91227cf67df60989de3d546389b1'</span><span class="s0">,</span>
               <span class="s2">'uint8'</span><span class="s1">:  </span><span class="s2">'0e203226ff3fbbd1580f15da4621e5f7164d0d8d6b51696dd42d004ece2cbec1'</span><span class="s1">}</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype[</span><span class="s3">1</span><span class="s1">:]:</span>
            <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>

            <span class="s4"># view as little endian for hash</span>
            <span class="s0">if </span><span class="s1">sys.byteorder == </span><span class="s2">'little'</span><span class="s1">:</span>
                <span class="s1">val = random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">6 </span><span class="s1">- endpoint</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                                 <span class="s1">dtype=dt)</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">val = random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">6 </span><span class="s1">- endpoint</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                                 <span class="s1">dtype=dt).byteswap()</span>

            <span class="s1">res = hashlib.sha256(val).hexdigest()</span>
            <span class="s1">assert_(tgt[np.dtype(dt).name] == res)</span>

        <span class="s4"># bools do not depend on endianness</span>
        <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>
        <span class="s1">val = random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2 </span><span class="s1">- endpoint</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                         <span class="s1">dtype=bool).view(np.int8)</span>
        <span class="s1">res = hashlib.sha256(val).hexdigest()</span>
        <span class="s1">assert_(tgt[np.dtype(bool).name] == res)</span>

    <span class="s0">def </span><span class="s1">test_repeatability_broadcasting(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">(bool</span><span class="s0">, </span><span class="s1">np.bool_) </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">(bool</span><span class="s0">, </span><span class="s1">np.bool_) </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s4"># view as little endian for hash</span>
            <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>
            <span class="s1">val = random.integers(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">1000</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                             <span class="s1">dtype=dt)</span>

            <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>
            <span class="s1">val_bc = random.integers([lbnd] * </span><span class="s3">1000</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                                <span class="s1">dtype=dt)</span>

            <span class="s1">assert_array_equal(val</span><span class="s0">, </span><span class="s1">val_bc)</span>

            <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>
            <span class="s1">val_bc = random.integers([lbnd] * </span><span class="s3">1000</span><span class="s0">, </span><span class="s1">[ubnd] * </span><span class="s3">1000</span><span class="s0">,</span>
                                <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>

            <span class="s1">assert_array_equal(val</span><span class="s0">, </span><span class="s1">val_bc)</span>

    <span class="s1">@pytest.mark.parametrize(</span>
        <span class="s2">'bound, expected'</span><span class="s0">,</span>
        <span class="s1">[(</span><span class="s3">2</span><span class="s1">**</span><span class="s3">32 </span><span class="s1">- </span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">517043486</span><span class="s0">, </span><span class="s3">1364798665</span><span class="s0">, </span><span class="s3">1733884389</span><span class="s0">, </span><span class="s3">1353720612</span><span class="s0">,</span>
                               <span class="s3">3769704066</span><span class="s0">, </span><span class="s3">1170797179</span><span class="s0">, </span><span class="s3">4108474671</span><span class="s1">]))</span><span class="s0">,</span>
         <span class="s1">(</span><span class="s3">2</span><span class="s1">**</span><span class="s3">32</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">517043487</span><span class="s0">, </span><span class="s3">1364798666</span><span class="s0">, </span><span class="s3">1733884390</span><span class="s0">, </span><span class="s3">1353720613</span><span class="s0">,</span>
                           <span class="s3">3769704067</span><span class="s0">, </span><span class="s3">1170797180</span><span class="s0">, </span><span class="s3">4108474672</span><span class="s1">]))</span><span class="s0">,</span>
         <span class="s1">(</span><span class="s3">2</span><span class="s1">**</span><span class="s3">32 </span><span class="s1">+ </span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.array([</span><span class="s3">517043487</span><span class="s0">, </span><span class="s3">1733884390</span><span class="s0">, </span><span class="s3">3769704068</span><span class="s0">, </span><span class="s3">4108474673</span><span class="s0">,</span>
                               <span class="s3">1831631863</span><span class="s0">, </span><span class="s3">1215661561</span><span class="s0">, </span><span class="s3">3869512430</span><span class="s1">]))]</span>
    <span class="s1">)</span>
    <span class="s0">def </span><span class="s1">test_repeatability_32bit_boundary(self</span><span class="s0">, </span><span class="s1">bound</span><span class="s0">, </span><span class="s1">expected):</span>
        <span class="s0">for </span><span class="s1">size </span><span class="s0">in </span><span class="s1">[</span><span class="s0">None, </span><span class="s1">len(expected)]:</span>
            <span class="s1">random = Generator(MT19937(</span><span class="s3">1234</span><span class="s1">))</span>
            <span class="s1">x = random.integers(bound</span><span class="s0">, </span><span class="s1">size=size)</span>
            <span class="s1">assert_equal(x</span><span class="s0">, </span><span class="s1">expected </span><span class="s0">if </span><span class="s1">size </span><span class="s0">is not None else </span><span class="s1">expected[</span><span class="s3">0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_repeatability_32bit_boundary_broadcasting(self):</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">1622936284</span><span class="s0">, </span><span class="s3">3620788691</span><span class="s0">, </span><span class="s3">1659384060</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1417365545</span><span class="s0">,  </span><span class="s3">760222891</span><span class="s0">, </span><span class="s3">1909653332</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">3788118662</span><span class="s0">,  </span><span class="s3">660249498</span><span class="s0">, </span><span class="s3">4092002593</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">3625610153</span><span class="s0">, </span><span class="s3">2979601262</span><span class="s0">, </span><span class="s3">3844162757</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">685800658</span><span class="s0">,  </span><span class="s3">120261497</span><span class="s0">, </span><span class="s3">2694012896</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1207779440</span><span class="s0">, </span><span class="s3">1586594375</span><span class="s0">, </span><span class="s3">3854335050</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">3004074748</span><span class="s0">, </span><span class="s3">2310761796</span><span class="s0">, </span><span class="s3">3012642217</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">2067714190</span><span class="s0">, </span><span class="s3">2786677879</span><span class="s0">, </span><span class="s3">1363865881</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">791663441</span><span class="s0">, </span><span class="s3">1867303284</span><span class="s0">, </span><span class="s3">2169727960</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">1939603804</span><span class="s0">, </span><span class="s3">1250951100</span><span class="s0">,  </span><span class="s3">298950036</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1040128489</span><span class="s0">, </span><span class="s3">3791912209</span><span class="s0">, </span><span class="s3">3317053765</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">3155528714</span><span class="s0">,   </span><span class="s3">61360675</span><span class="s0">, </span><span class="s3">2305155588</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[ </span><span class="s3">817688762</span><span class="s0">, </span><span class="s3">1335621943</span><span class="s0">, </span><span class="s3">3288952434</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">1770890872</span><span class="s0">, </span><span class="s3">1102951817</span><span class="s0">, </span><span class="s3">1957607470</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">3099996017</span><span class="s0">,  </span><span class="s3">798043451</span><span class="s0">,   </span><span class="s3">48334215</span><span class="s1">]]])</span>
        <span class="s0">for </span><span class="s1">size </span><span class="s0">in </span><span class="s1">[</span><span class="s0">None, </span><span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)]:</span>
            <span class="s1">random = Generator(MT19937(</span><span class="s3">12345</span><span class="s1">))</span>
            <span class="s1">x = random.integers([[-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">]]</span><span class="s0">,</span>
                                <span class="s1">[</span><span class="s3">2</span><span class="s1">**</span><span class="s3">32 </span><span class="s1">- </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">32</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">32 </span><span class="s1">+ </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                                <span class="s1">size=size)</span>
            <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">desired </span><span class="s0">if </span><span class="s1">size </span><span class="s0">is not None else </span><span class="s1">desired[</span><span class="s3">0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_int64_uint64_broadcast_exceptions(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s1">configs = {np.uint64: ((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">65</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">62</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">))</span><span class="s0">,</span>
                   <span class="s1">np.int64: ((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">64</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(-(</span><span class="s3">2</span><span class="s1">**</span><span class="s3">64</span><span class="s1">)</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">62</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">9</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span><span class="s0">,</span>
                              <span class="s1">(-</span><span class="s3">2</span><span class="s1">**</span><span class="s3">63</span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s1">**</span><span class="s3">63</span><span class="s1">-</span><span class="s3">1</span><span class="s1">))}</span>
        <span class="s0">for </span><span class="s1">dtype </span><span class="s0">in </span><span class="s1">configs:</span>
            <span class="s0">for </span><span class="s1">config </span><span class="s0">in </span><span class="s1">configs[dtype]:</span>
                <span class="s1">low</span><span class="s0">, </span><span class="s1">high = config</span>
                <span class="s1">high = high - endpoint</span>
                <span class="s1">low_a = np.array([[low]*</span><span class="s3">10</span><span class="s1">])</span>
                <span class="s1">high_a = np.array([high] * </span><span class="s3">10</span><span class="s1">)</span>
                <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.integers</span><span class="s0">, </span><span class="s1">low</span><span class="s0">, </span><span class="s1">high</span><span class="s0">,</span>
                              <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
                <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.integers</span><span class="s0">, </span><span class="s1">low_a</span><span class="s0">, </span><span class="s1">high</span><span class="s0">,</span>
                              <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
                <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.integers</span><span class="s0">, </span><span class="s1">low</span><span class="s0">, </span><span class="s1">high_a</span><span class="s0">,</span>
                              <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
                <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.integers</span><span class="s0">, </span><span class="s1">low_a</span><span class="s0">, </span><span class="s1">high_a</span><span class="s0">,</span>
                              <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>

                <span class="s1">low_o = np.array([[low]*</span><span class="s3">10</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=object)</span>
                <span class="s1">high_o = np.array([high] * </span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=object)</span>
                <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.integers</span><span class="s0">, </span><span class="s1">low_o</span><span class="s0">, </span><span class="s1">high</span><span class="s0">,</span>
                              <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
                <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.integers</span><span class="s0">, </span><span class="s1">low</span><span class="s0">, </span><span class="s1">high_o</span><span class="s0">,</span>
                              <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
                <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.integers</span><span class="s0">, </span><span class="s1">low_o</span><span class="s0">, </span><span class="s1">high_o</span><span class="s0">,</span>
                              <span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>

    <span class="s0">def </span><span class="s1">test_int64_uint64_corner_case(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s4"># When stored in Numpy arrays, `lbnd` is casted</span>
        <span class="s4"># as np.int64, and `ubnd` is casted as np.uint64.</span>
        <span class="s4"># Checking whether `lbnd` &gt;= `ubnd` used to be</span>
        <span class="s4"># done solely via direct comparison, which is incorrect</span>
        <span class="s4"># because when Numpy tries to compare both numbers,</span>
        <span class="s4"># it casts both to np.float64 because there is</span>
        <span class="s4"># no integer superset of np.int64 and np.uint64. However,</span>
        <span class="s4"># `ubnd` is too large to be represented in np.float64,</span>
        <span class="s4"># causing it be round down to np.iinfo(np.int64).max,</span>
        <span class="s4"># leading to a ValueError because `lbnd` now equals</span>
        <span class="s4"># the new `ubnd`.</span>

        <span class="s1">dt = np.int64</span>
        <span class="s1">tgt = np.iinfo(np.int64).max</span>
        <span class="s1">lbnd = np.int64(np.iinfo(np.int64).max)</span>
        <span class="s1">ubnd = np.uint64(np.iinfo(np.int64).max + </span><span class="s3">1 </span><span class="s1">- endpoint)</span>

        <span class="s4"># None of these function calls should</span>
        <span class="s4"># generate a ValueError now.</span>
        <span class="s1">actual = random.integers(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">tgt)</span>

    <span class="s0">def </span><span class="s1">test_respect_dtype_singleton(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s4"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>
            <span class="s1">dt = np.bool_ </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">dt</span>

            <span class="s1">sample = self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_equal(sample.dtype</span><span class="s0">, </span><span class="s1">dt)</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">(bool</span><span class="s0">, </span><span class="s1">int</span><span class="s0">, </span><span class="s1">np.compat.long):</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>

            <span class="s4"># gh-7284: Ensure that we get Python data types</span>
            <span class="s1">sample = self.rfunc(lbnd</span><span class="s0">, </span><span class="s1">ubnd</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s0">assert not </span><span class="s1">hasattr(sample</span><span class="s0">, </span><span class="s2">'dtype'</span><span class="s1">)</span>
            <span class="s1">assert_equal(type(sample)</span><span class="s0">, </span><span class="s1">dt)</span>

    <span class="s0">def </span><span class="s1">test_respect_dtype_array(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s4"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">lbnd = </span><span class="s3">0 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).min</span>
            <span class="s1">ubnd = </span><span class="s3">2 </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">np.iinfo(dt).max + </span><span class="s3">1</span>
            <span class="s1">ubnd = ubnd - </span><span class="s3">1 </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s1">ubnd</span>
            <span class="s1">dt = np.bool_ </span><span class="s0">if </span><span class="s1">dt </span><span class="s0">is </span><span class="s1">bool </span><span class="s0">else </span><span class="s1">dt</span>

            <span class="s1">sample = self.rfunc([lbnd]</span><span class="s0">, </span><span class="s1">[ubnd]</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_equal(sample.dtype</span><span class="s0">, </span><span class="s1">dt)</span>
            <span class="s1">sample = self.rfunc([lbnd] * </span><span class="s3">2</span><span class="s0">, </span><span class="s1">[ubnd] * </span><span class="s3">2</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                                <span class="s1">dtype=dt)</span>
            <span class="s1">assert_equal(sample.dtype</span><span class="s0">, </span><span class="s1">dt)</span>

    <span class="s0">def </span><span class="s1">test_zero_size(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s4"># See gh-7203</span>
        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">self.itype:</span>
            <span class="s1">sample = self.rfunc(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s0">assert </span><span class="s1">sample.shape == (</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>
            <span class="s0">assert </span><span class="s1">sample.dtype == dt</span>
            <span class="s0">assert </span><span class="s1">self.rfunc(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">,</span>
                              <span class="s1">dtype=dt).shape == (</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)</span>
            <span class="s1">assert_equal(random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)).shape</span><span class="s0">,</span>
                         <span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
            <span class="s1">assert_equal(random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
            <span class="s1">assert_equal(random.integers(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_error_byteorder(self):</span>
        <span class="s1">other_byteord_dt = </span><span class="s2">'&lt;i4' </span><span class="s0">if </span><span class="s1">sys.byteorder == </span><span class="s2">'big' </span><span class="s0">else </span><span class="s2">'&gt;i4'</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s1">random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">200</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">dtype=other_byteord_dt)</span>

    <span class="s4"># chi2max is the maximum acceptable chi-squared value.</span>
    <span class="s1">@pytest.mark.slow</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">'sample_size,high,dtype,chi2max'</span><span class="s0">,</span>
        <span class="s1">[(</span><span class="s3">5000000</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s1">np.int8</span><span class="s0">, </span><span class="s3">125.0</span><span class="s1">)</span><span class="s0">,          </span><span class="s4"># p-value ~4.6e-25</span>
         <span class="s1">(</span><span class="s3">5000000</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s1">np.uint8</span><span class="s0">, </span><span class="s3">150.0</span><span class="s1">)</span><span class="s0">,         </span><span class="s4"># p-value ~7.7e-30</span>
         <span class="s1">(</span><span class="s3">10000000</span><span class="s0">, </span><span class="s3">2500</span><span class="s0">, </span><span class="s1">np.int16</span><span class="s0">, </span><span class="s3">3300.0</span><span class="s1">)</span><span class="s0">,    </span><span class="s4"># p-value ~3.0e-25</span>
         <span class="s1">(</span><span class="s3">50000000</span><span class="s0">, </span><span class="s3">5000</span><span class="s0">, </span><span class="s1">np.uint16</span><span class="s0">, </span><span class="s3">6500.0</span><span class="s1">)</span><span class="s0">,   </span><span class="s4"># p-value ~3.5e-25</span>
        <span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_integers_small_dtype_chisquared(self</span><span class="s0">, </span><span class="s1">sample_size</span><span class="s0">, </span><span class="s1">high</span><span class="s0">,</span>
                                             <span class="s1">dtype</span><span class="s0">, </span><span class="s1">chi2max):</span>
        <span class="s4"># Regression test for gh-14774.</span>
        <span class="s1">samples = random.integers(high</span><span class="s0">, </span><span class="s1">size=sample_size</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>

        <span class="s1">values</span><span class="s0">, </span><span class="s1">counts = np.unique(samples</span><span class="s0">, </span><span class="s1">return_counts=</span><span class="s0">True</span><span class="s1">)</span>
        <span class="s1">expected = sample_size / high</span>
        <span class="s1">chi2 = ((counts - expected)**</span><span class="s3">2 </span><span class="s1">/ expected).sum()</span>
        <span class="s0">assert </span><span class="s1">chi2 &lt; chi2max</span>


<span class="s0">class </span><span class="s1">TestRandomDist:</span>
    <span class="s4"># Make sure the random distribution returns the correct value for a</span>
    <span class="s4"># given seed</span>

    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s3">1234567890</span>

    <span class="s0">def </span><span class="s1">test_integers(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.integers(-</span><span class="s3">99</span><span class="s0">, </span><span class="s3">99</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[-</span><span class="s3">80</span><span class="s0">, </span><span class="s1">-</span><span class="s3">56</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">41</span><span class="s0">, </span><span class="s3">37</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">83</span><span class="s0">, </span><span class="s1">-</span><span class="s3">16</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_integers_masked(self):</span>
        <span class="s4"># Test masked rejection sampling algorithm to generate array of</span>
        <span class="s4"># uint32 in an interval.</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">99</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=np.uint32)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">9</span><span class="s0">, </span><span class="s3">21</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">70</span><span class="s0">, </span><span class="s3">68</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">8</span><span class="s0">, </span><span class="s3">41</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.uint32)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_integers_closed(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.integers(-</span><span class="s3">99</span><span class="s0">, </span><span class="s3">99</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">endpoint=</span><span class="s0">True</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[-</span><span class="s3">80</span><span class="s0">, </span><span class="s1">-</span><span class="s3">56</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[ </span><span class="s3">41</span><span class="s0">, </span><span class="s3">38</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">83</span><span class="s0">, </span><span class="s1">-</span><span class="s3">15</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_integers_max_int(self):</span>
        <span class="s4"># Tests whether integers with closed=True can generate the</span>
        <span class="s4"># maximum allowed Python int that can be converted</span>
        <span class="s4"># into a C long. Previous implementations of this</span>
        <span class="s4"># method have thrown an OverflowError when attempting</span>
        <span class="s4"># to generate this integer.</span>
        <span class="s1">actual = random.integers(np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max</span><span class="s0">, </span><span class="s1">np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max</span><span class="s0">,</span>
                                 <span class="s1">endpoint=</span><span class="s0">True</span><span class="s1">)</span>

        <span class="s1">desired = np.iinfo(</span><span class="s2">'l'</span><span class="s1">).max</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_random(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.random((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.096999199829214</span><span class="s0">, </span><span class="s3">0.707517457682192</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.084364834598269</span><span class="s0">, </span><span class="s3">0.767731206553125</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.665069021359413</span><span class="s0">, </span><span class="s3">0.715487190596693</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.random()</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_random_float(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.random((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.0969992 </span><span class="s0">, </span><span class="s3">0.70751746</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.08436483</span><span class="s0">, </span><span class="s3">0.76773121</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.66506902</span><span class="s0">, </span><span class="s3">0.71548719</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">7</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_random_float_scalar(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.random(dtype=np.float32)</span>
        <span class="s1">desired = </span><span class="s3">0.0969992</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">7</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">'dtype, uint_view_type'</span><span class="s0">,</span>
                             <span class="s1">[(np.float32</span><span class="s0">, </span><span class="s1">np.uint32)</span><span class="s0">,</span>
                              <span class="s1">(np.float64</span><span class="s0">, </span><span class="s1">np.uint64)])</span>
    <span class="s0">def </span><span class="s1">test_random_distribution_of_lsb(self</span><span class="s0">, </span><span class="s1">dtype</span><span class="s0">, </span><span class="s1">uint_view_type):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">sample = random.random(</span><span class="s3">100000</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
        <span class="s1">num_ones_in_lsb = np.count_nonzero(sample.view(uint_view_type) &amp; </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s4"># The probability of a 1 in the least significant bit is 0.25.</span>
        <span class="s4"># With a sample size of 100000, the probability that num_ones_in_lsb</span>
        <span class="s4"># is outside the following range is less than 5e-11.</span>
        <span class="s0">assert </span><span class="s3">24100 </span><span class="s1">&lt; num_ones_in_lsb &lt; </span><span class="s3">25900</span>

    <span class="s0">def </span><span class="s1">test_random_unsupported_type(self):</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.random</span><span class="s0">, </span><span class="s1">dtype=</span><span class="s2">'int32'</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_replace(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_replace(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">p=[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_uniform_noreplace(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">shuffle=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">desired = np.arange(</span><span class="s3">4</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_nonuniform_noreplace(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=[</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.5</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">])</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_noninteger(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.choice([</span><span class="s2">'a'</span><span class="s0">, </span><span class="s2">'b'</span><span class="s0">, </span><span class="s2">'c'</span><span class="s0">, </span><span class="s2">'d'</span><span class="s1">]</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s2">'a'</span><span class="s0">, </span><span class="s2">'a'</span><span class="s0">, </span><span class="s2">'c'</span><span class="s0">, </span><span class="s2">'c'</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_multidimensional_default_axis(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.choice([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">6</span><span class="s0">, </span><span class="s3">7</span><span class="s1">]]</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_multidimensional_custom_axis(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.choice([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">6</span><span class="s0">, </span><span class="s3">7</span><span class="s1">]]</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">6</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_choice_exceptions(self):</span>
        <span class="s1">sample = random.choice</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s3">3.</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[]</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">,</span>
                      <span class="s1">p=[[</span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.25</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.25</span><span class="s0">, </span><span class="s3">0.25</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s3">1.1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=[</span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.4</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s4"># gh-13087</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">1</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">(-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">sample</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s3">2</span><span class="s0">,</span>
                      <span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>

    <span class="s0">def </span><span class="s1">test_choice_return_shape(self):</span>
        <span class="s1">p = [</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.9</span><span class="s1">]</span>
        <span class="s4"># Check scalar</span>
        <span class="s1">assert_(np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)))</span>
        <span class="s1">assert_(np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(np.isscalar(random.choice([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(random.choice([</span><span class="s0">None</span><span class="s1">]</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">) </span><span class="s0">is None</span><span class="s1">)</span>
        <span class="s1">a = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">arr = np.empty(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">dtype=object)</span>
        <span class="s1">arr[</span><span class="s3">0</span><span class="s1">] = a</span>
        <span class="s1">assert_(random.choice(arr</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">) </span><span class="s0">is </span><span class="s1">a)</span>

        <span class="s4"># Check 0-d array</span>
        <span class="s1">s = tuple()</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice(</span><span class="s3">2</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p)))</span>
        <span class="s1">assert_(</span><span class="s0">not </span><span class="s1">np.isscalar(random.choice([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">)))</span>
        <span class="s1">assert_(random.choice([</span><span class="s0">None</span><span class="s1">]</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).ndim == </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">a = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">arr = np.empty(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">dtype=object)</span>
        <span class="s1">arr[</span><span class="s3">0</span><span class="s1">] = a</span>
        <span class="s1">assert_(random.choice(arr</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).item() </span><span class="s0">is </span><span class="s1">a)</span>

        <span class="s4"># Check multi dimensional array</span>
        <span class="s1">s = (</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">p = [</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">0.4</span><span class="s0">, </span><span class="s3">0.2</span><span class="s1">]</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True, </span><span class="s1">p=p).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">6</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False, </span><span class="s1">p=p).shape</span><span class="s0">, </span><span class="s1">s)</span>
        <span class="s1">assert_equal(random.choice(np.arange(</span><span class="s3">6</span><span class="s1">)</span><span class="s0">, </span><span class="s1">s</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">True</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">s)</span>

        <span class="s4"># Check zero-size</span>
        <span class="s1">assert_equal(random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.integers(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">-</span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.integers(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.choice(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">0</span><span class="s1">).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.choice([]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">0</span><span class="s0">,</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.choice([</span><span class="s2">'a'</span><span class="s0">, </span><span class="s2">'b'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)).shape</span><span class="s0">,</span>
                     <span class="s1">(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.choice</span><span class="s0">, </span><span class="s1">[]</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_choice_nan_probabilities(self):</span>
        <span class="s1">a = np.array([</span><span class="s3">42</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">p = [</span><span class="s0">None, None, None</span><span class="s1">]</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.choice</span><span class="s0">, </span><span class="s1">a</span><span class="s0">, </span><span class="s1">p=p)</span>

    <span class="s0">def </span><span class="s1">test_choice_p_non_contiguous(self):</span>
        <span class="s1">p = np.ones(</span><span class="s3">10</span><span class="s1">) / </span><span class="s3">5</span>
        <span class="s1">p[</span><span class="s3">1</span><span class="s1">::</span><span class="s3">2</span><span class="s1">] = </span><span class="s3">3.0</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">non_contig = random.choice(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=p[::</span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">contig = random.choice(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p=np.ascontiguousarray(p[::</span><span class="s3">2</span><span class="s1">]))</span>
        <span class="s1">assert_array_equal(non_contig</span><span class="s0">, </span><span class="s1">contig)</span>

    <span class="s0">def </span><span class="s1">test_choice_return_type(self):</span>
        <span class="s4"># gh 9867</span>
        <span class="s1">p = np.ones(</span><span class="s3">4</span><span class="s1">) / </span><span class="s3">4.</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">actual.dtype == np.int64</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">actual.dtype == np.int64</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">p=p)</span>
        <span class="s0">assert </span><span class="s1">actual.dtype == np.int64</span>
        <span class="s1">actual = random.choice(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">p=p</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">actual.dtype == np.int64</span>

    <span class="s0">def </span><span class="s1">test_choice_large_sample(self):</span>
        <span class="s1">choice_hash = </span><span class="s2">'4266599d12bfcfb815213303432341c06b4349f5455890446578877bb322e222'</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.choice(</span><span class="s3">10000</span><span class="s0">, </span><span class="s3">5000</span><span class="s0">, </span><span class="s1">replace=</span><span class="s0">False</span><span class="s1">)</span>
        <span class="s0">if </span><span class="s1">sys.byteorder != </span><span class="s2">'little'</span><span class="s1">:</span>
            <span class="s1">actual = actual.byteswap()</span>
        <span class="s1">res = hashlib.sha256(actual.view(np.int8)).hexdigest()</span>
        <span class="s1">assert_(choice_hash == res)</span>

    <span class="s0">def </span><span class="s1">test_bytes(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.bytes(</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">desired = </span><span class="s5">b'</span><span class="s0">\x86\xf0\xd4\x18\xe1\x81\t</span><span class="s5">8%</span><span class="s0">\xdd</span><span class="s5">'</span>
        <span class="s1">assert_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_shuffle(self):</span>
        <span class="s4"># Test lists, arrays (of various dtypes), and multidimensional versions</span>
        <span class="s4"># of both, c-contiguous or not:</span>
        <span class="s0">for </span><span class="s1">conv </span><span class="s0">in </span><span class="s1">[</span><span class="s0">lambda </span><span class="s1">x: np.array([])</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: x</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.int8)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.float32)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(np.complex64)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray(x).astype(object)</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: [(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray([[i</span><span class="s0">, </span><span class="s1">i] </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x])</span><span class="s0">,</span>
                     <span class="s0">lambda </span><span class="s1">x: np.vstack([x</span><span class="s0">, </span><span class="s1">x]).T</span><span class="s0">,</span>
                     <span class="s4"># gh-11442</span>
                     <span class="s0">lambda </span><span class="s1">x: (np.asarray([(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                                           <span class="s1">[(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">int)</span><span class="s0">, </span><span class="s1">(</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">int)])</span>
                                <span class="s1">.view(np.recarray))</span><span class="s0">,</span>
                     <span class="s4"># gh-4270</span>
                     <span class="s0">lambda </span><span class="s1">x: np.asarray([(i</span><span class="s0">, </span><span class="s1">i) </span><span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">x]</span><span class="s0">,</span>
                                          <span class="s1">[(</span><span class="s2">&quot;a&quot;</span><span class="s0">, </span><span class="s1">object</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">))</span><span class="s0">,</span>
                                           <span class="s1">(</span><span class="s2">&quot;b&quot;</span><span class="s0">, </span><span class="s1">np.int32</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">))])]:</span>
            <span class="s1">random = Generator(MT19937(self.seed))</span>
            <span class="s1">alist = conv([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
            <span class="s1">random.shuffle(alist)</span>
            <span class="s1">actual = alist</span>
            <span class="s1">desired = conv([</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">7</span><span class="s1">])</span>
            <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_custom_axis(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = np.arange(</span><span class="s3">16</span><span class="s1">).reshape((</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
        <span class="s1">random.shuffle(actual</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">0</span><span class="s0">,  </span><span class="s3">3</span><span class="s0">,  </span><span class="s3">1</span><span class="s0">,  </span><span class="s3">2</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">4</span><span class="s0">,  </span><span class="s3">7</span><span class="s0">,  </span><span class="s3">5</span><span class="s0">,  </span><span class="s3">6</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">8</span><span class="s0">, </span><span class="s3">11</span><span class="s0">,  </span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">12</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s3">13</span><span class="s0">, </span><span class="s3">14</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = np.arange(</span><span class="s3">16</span><span class="s1">).reshape((</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
        <span class="s1">random.shuffle(actual</span><span class="s0">, </span><span class="s1">axis=-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_custom_axis_empty(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">desired = np.array([]).reshape((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">6</span><span class="s1">))</span>
        <span class="s0">for </span><span class="s1">axis </span><span class="s0">in </span><span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">):</span>
            <span class="s1">actual = np.array([]).reshape((</span><span class="s3">0</span><span class="s0">, </span><span class="s3">6</span><span class="s1">))</span>
            <span class="s1">random.shuffle(actual</span><span class="s0">, </span><span class="s1">axis=axis)</span>
            <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_axis_nonsquare(self):</span>
        <span class="s1">y1 = np.arange(</span><span class="s3">20</span><span class="s1">).reshape(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">y2 = y1.copy()</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">random.shuffle(y1</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">random.shuffle(y2.T)</span>
        <span class="s1">assert_array_equal(y1</span><span class="s0">, </span><span class="s1">y2)</span>

    <span class="s0">def </span><span class="s1">test_shuffle_masked(self):</span>
        <span class="s4"># gh-3263</span>
        <span class="s1">a = np.ma.masked_values(np.reshape(range(</span><span class="s3">20</span><span class="s1">)</span><span class="s0">, </span><span class="s1">(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)) % </span><span class="s3">3 </span><span class="s1">- </span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">b = np.ma.masked_values(np.arange(</span><span class="s3">20</span><span class="s1">) % </span><span class="s3">3 </span><span class="s1">- </span><span class="s3">1</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">a_orig = a.copy()</span>
        <span class="s1">b_orig = b.copy()</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">50</span><span class="s1">):</span>
            <span class="s1">random.shuffle(a)</span>
            <span class="s1">assert_equal(</span>
                <span class="s1">sorted(a.data[~a.mask])</span><span class="s0">, </span><span class="s1">sorted(a_orig.data[~a_orig.mask]))</span>
            <span class="s1">random.shuffle(b)</span>
            <span class="s1">assert_equal(</span>
                <span class="s1">sorted(b.data[~b.mask])</span><span class="s0">, </span><span class="s1">sorted(b_orig.data[~b_orig.mask]))</span>

    <span class="s0">def </span><span class="s1">test_shuffle_exceptions(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">arr = np.arange(</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_raises(np.AxisError</span><span class="s0">, </span><span class="s1">random.shuffle</span><span class="s0">, </span><span class="s1">arr</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">arr = np.arange(</span><span class="s3">9</span><span class="s1">).reshape((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>
        <span class="s1">assert_raises(np.AxisError</span><span class="s0">, </span><span class="s1">random.shuffle</span><span class="s0">, </span><span class="s1">arr</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.shuffle</span><span class="s0">, </span><span class="s1">arr</span><span class="s0">, </span><span class="s1">slice(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, None</span><span class="s1">))</span>
        <span class="s1">arr = [[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]]</span>
        <span class="s1">assert_raises(NotImplementedError</span><span class="s0">, </span><span class="s1">random.shuffle</span><span class="s0">, </span><span class="s1">arr</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>

        <span class="s1">arr = np.array(</span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.shuffle</span><span class="s0">, </span><span class="s1">arr)</span>
        <span class="s1">arr = np.ones((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_raises(np.AxisError</span><span class="s0">, </span><span class="s1">random.shuffle</span><span class="s0">, </span><span class="s1">arr</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_permutation(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">alist = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">actual = random.permutation(alist)</span>
        <span class="s1">desired = [</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">7</span><span class="s1">]</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">arr_2d = np.atleast_2d([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]).T</span>
        <span class="s1">actual = random.permutation(arr_2d)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">np.atleast_2d(desired).T)</span>

        <span class="s1">bad_x_str = </span><span class="s2">&quot;abcd&quot;</span>
        <span class="s1">assert_raises(np.AxisError</span><span class="s0">, </span><span class="s1">random.permutation</span><span class="s0">, </span><span class="s1">bad_x_str)</span>

        <span class="s1">bad_x_float = </span><span class="s3">1.2</span>
        <span class="s1">assert_raises(np.AxisError</span><span class="s0">, </span><span class="s1">random.permutation</span><span class="s0">, </span><span class="s1">bad_x_float)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">integer_val = </span><span class="s3">10</span>
        <span class="s1">desired = [</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]</span>

        <span class="s1">actual = random.permutation(integer_val)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_permutation_custom_axis(self):</span>
        <span class="s1">a = np.arange(</span><span class="s3">16</span><span class="s1">).reshape((</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">0</span><span class="s0">,  </span><span class="s3">3</span><span class="s0">,  </span><span class="s3">1</span><span class="s0">,  </span><span class="s3">2</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">4</span><span class="s0">,  </span><span class="s3">7</span><span class="s0">,  </span><span class="s3">5</span><span class="s0">,  </span><span class="s3">6</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">8</span><span class="s0">, </span><span class="s3">11</span><span class="s0">,  </span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">12</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s3">13</span><span class="s0">, </span><span class="s3">14</span><span class="s1">]])</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.permutation(a</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.permutation(a</span><span class="s0">, </span><span class="s1">axis=-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_permutation_exceptions(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">arr = np.arange(</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_raises(np.AxisError</span><span class="s0">, </span><span class="s1">random.permutation</span><span class="s0">, </span><span class="s1">arr</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">arr = np.arange(</span><span class="s3">9</span><span class="s1">).reshape((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>
        <span class="s1">assert_raises(np.AxisError</span><span class="s0">, </span><span class="s1">random.permutation</span><span class="s0">, </span><span class="s1">arr</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.permutation</span><span class="s0">, </span><span class="s1">arr</span><span class="s0">, </span><span class="s1">slice(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, None</span><span class="s1">))</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;dtype&quot;</span><span class="s0">, </span><span class="s1">[int</span><span class="s0">, </span><span class="s1">object])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;axis, expected&quot;</span><span class="s0">,</span>
                             <span class="s1">[(</span><span class="s0">None, </span><span class="s1">np.array([[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">11</span><span class="s1">]</span><span class="s0">,</span>
                                               <span class="s1">[</span><span class="s3">8</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">5</span><span class="s0">,  </span><span class="s3">1</span><span class="s0">,  </span><span class="s3">6</span><span class="s1">]]))</span><span class="s0">,</span>
                              <span class="s1">(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.array([[</span><span class="s3">6</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">11</span><span class="s1">]</span><span class="s0">,</span>
                                            <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">3</span><span class="s0">,  </span><span class="s3">4</span><span class="s0">,  </span><span class="s3">5</span><span class="s1">]]))</span><span class="s0">,</span>
                              <span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">np.array([[ </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">,  </span><span class="s3">4</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                                            <span class="s1">[</span><span class="s3">11</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">7</span><span class="s1">]]))])</span>
    <span class="s0">def </span><span class="s1">test_permuted(self</span><span class="s0">, </span><span class="s1">dtype</span><span class="s0">, </span><span class="s1">axis</span><span class="s0">, </span><span class="s1">expected):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">x = np.arange(</span><span class="s3">12</span><span class="s1">).reshape(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">6</span><span class="s1">).astype(dtype)</span>
        <span class="s1">random.permuted(x</span><span class="s0">, </span><span class="s1">axis=axis</span><span class="s0">, </span><span class="s1">out=x)</span>
        <span class="s1">assert_array_equal(x</span><span class="s0">, </span><span class="s1">expected)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">x = np.arange(</span><span class="s3">12</span><span class="s1">).reshape(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">6</span><span class="s1">).astype(dtype)</span>
        <span class="s1">y = random.permuted(x</span><span class="s0">, </span><span class="s1">axis=axis)</span>
        <span class="s0">assert </span><span class="s1">y.dtype == dtype</span>
        <span class="s1">assert_array_equal(y</span><span class="s0">, </span><span class="s1">expected)</span>

    <span class="s0">def </span><span class="s1">test_permuted_with_strides(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">x0 = np.arange(</span><span class="s3">22</span><span class="s1">).reshape(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">11</span><span class="s1">)</span>
        <span class="s1">x1 = x0.copy()</span>
        <span class="s1">x = x0[:</span><span class="s0">, </span><span class="s1">::</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">y = random.permuted(x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">out=x)</span>
        <span class="s1">expected = np.array([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">9</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">14</span><span class="s0">, </span><span class="s3">20</span><span class="s0">, </span><span class="s3">11</span><span class="s0">, </span><span class="s3">17</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(y</span><span class="s0">, </span><span class="s1">expected)</span>
        <span class="s1">x1[:</span><span class="s0">, </span><span class="s1">::</span><span class="s3">3</span><span class="s1">] = expected</span>
        <span class="s4"># Verify that the original x0 was modified in-place as expected.</span>
        <span class="s1">assert_array_equal(x1</span><span class="s0">, </span><span class="s1">x0)</span>

    <span class="s0">def </span><span class="s1">test_permuted_empty(self):</span>
        <span class="s1">y = random.permuted([])</span>
        <span class="s1">assert_array_equal(y</span><span class="s0">, </span><span class="s1">[])</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">'outshape'</span><span class="s0">, </span><span class="s1">[(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span class="s3">5</span><span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_permuted_out_with_wrong_shape(self</span><span class="s0">, </span><span class="s1">outshape):</span>
        <span class="s1">a = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">out = np.zeros(outshape</span><span class="s0">, </span><span class="s1">dtype=a.dtype)</span>
        <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">'same shape'</span><span class="s1">):</span>
            <span class="s1">random.permuted(a</span><span class="s0">, </span><span class="s1">out=out)</span>

    <span class="s0">def </span><span class="s1">test_permuted_out_with_wrong_type(self):</span>
        <span class="s1">out = np.zeros((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">5</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=np.int32)</span>
        <span class="s1">x = np.ones((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">5</span><span class="s1">))</span>
        <span class="s0">with </span><span class="s1">pytest.raises(TypeError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">'Cannot cast'</span><span class="s1">):</span>
            <span class="s1">random.permuted(x</span><span class="s0">, </span><span class="s1">axis=</span><span class="s3">1</span><span class="s0">, </span><span class="s1">out=out)</span>

    <span class="s0">def </span><span class="s1">test_beta(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.beta(</span><span class="s3">.1</span><span class="s0">, </span><span class="s3">.9</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array(</span>
            <span class="s1">[[</span><span class="s3">1.083029353267698e-10</span><span class="s0">, </span><span class="s3">2.449965303168024e-11</span><span class="s1">]</span><span class="s0">,</span>
             <span class="s1">[</span><span class="s3">2.397085162969853e-02</span><span class="s0">, </span><span class="s3">3.590779671820755e-08</span><span class="s1">]</span><span class="s0">,</span>
             <span class="s1">[</span><span class="s3">2.830254190078299e-04</span><span class="s0">, </span><span class="s3">1.744709918330393e-01</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_binomial(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.binomial(</span><span class="s3">100.123</span><span class="s0">, </span><span class="s3">.456</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">42</span><span class="s0">, </span><span class="s3">41</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">42</span><span class="s0">, </span><span class="s3">48</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">44</span><span class="s0">, </span><span class="s3">50</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.binomial(</span><span class="s3">100.123</span><span class="s0">, </span><span class="s3">.456</span><span class="s1">)</span>
        <span class="s1">desired = </span><span class="s3">42</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_chisquare(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.chisquare(</span><span class="s3">50</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">32.9850547060149</span><span class="s0">, </span><span class="s3">39.0219480493301</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">56.2006134779419</span><span class="s0">, </span><span class="s3">57.3474165711485</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">55.4243733880198</span><span class="s0">, </span><span class="s3">55.4209797925213</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">alpha = np.array([</span><span class="s3">51.72840233779265162</span><span class="s0">, </span><span class="s3">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">actual = random.dirichlet(alpha</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">0.5439892869558927</span><span class="s0">,  </span><span class="s3">0.45601071304410745</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">0.5588917345860708</span><span class="s0">,  </span><span class="s3">0.4411082654139292 </span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">0.5632074165063435</span><span class="s0">,  </span><span class="s3">0.43679258349365657</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">0.54862581112627</span><span class="s0">,    </span><span class="s3">0.45137418887373015</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">0.49961831357047226</span><span class="s0">, </span><span class="s3">0.5003816864295278 </span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">0.52374806183482</span><span class="s0">,    </span><span class="s3">0.47625193816517997</span><span class="s1">]]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>
        <span class="s1">bad_alpha = np.array([</span><span class="s3">5.4e-01</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.0e-16</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">bad_alpha)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">alpha = np.array([</span><span class="s3">51.72840233779265162</span><span class="s0">, </span><span class="s3">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">actual = random.dirichlet(alpha)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_size(self):</span>
        <span class="s4"># gh-3173</span>
        <span class="s1">p = np.array([</span><span class="s3">51.72840233779265162</span><span class="s0">, </span><span class="s3">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.uint32(</span><span class="s3">1</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_equal(random.dirichlet(p</span><span class="s0">, </span><span class="s1">np.array((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))).shape</span><span class="s0">, </span><span class="s1">(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>

        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">p</span><span class="s0">, </span><span class="s1">float(</span><span class="s3">1</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_bad_alpha(self):</span>
        <span class="s4"># gh-2089</span>
        <span class="s1">alpha = np.array([</span><span class="s3">5.4e-01</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.0e-16</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">alpha)</span>

        <span class="s4"># gh-15876</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">[[[</span><span class="s3">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">5</span><span class="s1">]]])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.dirichlet</span><span class="s0">, </span><span class="s1">np.array([[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]]))</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_alpha_non_contiguous(self):</span>
        <span class="s1">a = np.array([</span><span class="s3">51.72840233779265162</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">39.74494232180943953</span><span class="s1">])</span>
        <span class="s1">alpha = a[::</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">non_contig = random.dirichlet(alpha</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">contig = random.dirichlet(np.ascontiguousarray(alpha)</span><span class="s0">,</span>
                                  <span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">assert_array_almost_equal(non_contig</span><span class="s0">, </span><span class="s1">contig)</span>

    <span class="s0">def </span><span class="s1">test_dirichlet_small_alpha(self):</span>
        <span class="s1">eps = </span><span class="s3">1.0e-9  </span><span class="s4"># 1.0e-10 -&gt; runtime x 10; 1e-11 -&gt; runtime x 200, etc.</span>
        <span class="s1">alpha = eps * np.array([</span><span class="s3">1.</span><span class="s0">, </span><span class="s3">1.0e-3</span><span class="s1">])</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.dirichlet(alpha</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">expected = np.array([</span>
            <span class="s1">[[</span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]</span><span class="s0">,</span>
             <span class="s1">[</span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]]</span><span class="s0">,</span>
            <span class="s1">[[</span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]</span><span class="s0">,</span>
             <span class="s1">[</span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]]</span><span class="s0">,</span>
            <span class="s1">[[</span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]</span><span class="s0">,</span>
             <span class="s1">[</span><span class="s3">1.</span><span class="s0">, </span><span class="s3">0.</span><span class="s1">]]</span>
        <span class="s1">])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">expected</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s1">@pytest.mark.slow</span>
    <span class="s0">def </span><span class="s1">test_dirichlet_moderately_small_alpha(self):</span>
        <span class="s4"># Use alpha.max() &lt; 0.1 to trigger stick breaking code path</span>
        <span class="s1">alpha = np.array([</span><span class="s3">0.02</span><span class="s0">, </span><span class="s3">0.04</span><span class="s0">, </span><span class="s3">0.03</span><span class="s1">])</span>
        <span class="s1">exact_mean = alpha / alpha.sum()</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">sample = random.dirichlet(alpha</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">20000000</span><span class="s1">)</span>
        <span class="s1">sample_mean = sample.mean(axis=</span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_allclose(sample_mean</span><span class="s0">, </span><span class="s1">exact_mean</span><span class="s0">, </span><span class="s1">rtol=</span><span class="s3">1e-3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_exponential(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.exponential(</span><span class="s3">1.1234</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.098845481066258</span><span class="s0">, </span><span class="s3">1.560752510746964</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.075730916041636</span><span class="s0">, </span><span class="s3">1.769098974710777</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.488602544592235</span><span class="s0">, </span><span class="s3">2.49684815275751 </span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_exponential_0(self):</span>
        <span class="s1">assert_equal(random.exponential(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.exponential</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_f(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.f(</span><span class="s3">12</span><span class="s0">, </span><span class="s3">77</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.461720027077085</span><span class="s0">, </span><span class="s3">1.100441958872451</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.100337455217484</span><span class="s0">, </span><span class="s3">0.91421736740018 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.500811891303113</span><span class="s0">, </span><span class="s3">0.826802454552058</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.gamma(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">5.03850858902096</span><span class="s0">,  </span><span class="s3">7.9228656732049 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">18.73983605132985</span><span class="s0">, </span><span class="s3">19.57961681699238</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">18.17897755150825</span><span class="s0">, </span><span class="s3">18.17653912505234</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma_0(self):</span>
        <span class="s1">assert_equal(random.gamma(shape=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.gamma</span><span class="s0">, </span><span class="s1">shape=-</span><span class="s3">0.</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_geometric(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.geometric(</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">11</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">12</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">11</span><span class="s0">, </span><span class="s3">17</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_geometric_exceptions(self):</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s3">1.1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1.1</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">0.1</span><span class="s1">] * </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">np.errstate(invalid=</span><span class="s2">'ignore'</span><span class="s1">):</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.gumbel(loc=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">4.688397515056245</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.289514845417841</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">4.981176042584683</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.633224272589149</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">0.055915275687488</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.333962478257953</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel_0(self):</span>
        <span class="s1">assert_equal(random.gumbel(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.gumbel</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.hypergeometric(</span><span class="s3">10.1</span><span class="s0">, </span><span class="s3">5.5</span><span class="s0">, </span><span class="s3">14</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">9</span><span class="s0">, </span><span class="s3">9</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">9</span><span class="s0">, </span><span class="s3">9</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">10</span><span class="s0">, </span><span class="s3">9</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s4"># Test nbad = 0</span>
        <span class="s1">actual = random.hypergeometric(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">actual = random.hypergeometric(</span><span class="s3">15</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">12</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s3">12</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s4"># Test ngood = 0</span>
        <span class="s1">actual = random.hypergeometric(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">actual = random.hypergeometric(</span><span class="s3">0</span><span class="s0">, </span><span class="s3">15</span><span class="s0">, </span><span class="s3">12</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_laplace(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.laplace(loc=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[-</span><span class="s3">3.156353949272393</span><span class="s0">,  </span><span class="s3">1.195863024830054</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">3.435458081645966</span><span class="s0">,  </span><span class="s3">1.656882398925444</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">0.924824032467446</span><span class="s0">,  </span><span class="s3">1.251116432209336</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_laplace_0(self):</span>
        <span class="s1">assert_equal(random.laplace(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.laplace</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logistic(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.logistic(loc=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[-</span><span class="s3">4.338584631510999</span><span class="s0">,  </span><span class="s3">1.890171436749954</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">4.64547787337966 </span><span class="s0">,  </span><span class="s3">2.514545562919217</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">1.495389489198666</span><span class="s0">,  </span><span class="s3">1.967827627577474</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.lognormal(mean=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">sigma=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">0.0268252166335</span><span class="s0">, </span><span class="s3">13.9534486483053</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">0.1204014788936</span><span class="s0">,  </span><span class="s3">2.2422077497792</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">4.2484199496128</span><span class="s0">, </span><span class="s3">12.0093343977523</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">13</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal_0(self):</span>
        <span class="s1">assert_equal(random.lognormal(sigma=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.lognormal</span><span class="s0">, </span><span class="s1">sigma=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logseries(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.logseries(p=</span><span class="s3">.923456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">14</span><span class="s0">, </span><span class="s3">17</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">18</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_logseries_exceptions(self):</span>
        <span class="s0">with </span><span class="s1">np.errstate(invalid=</span><span class="s2">'ignore'</span><span class="s1">):</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.logseries</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.logseries</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_multinomial(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.multinomial(</span><span class="s3">20</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6.</span><span class="s1">] * </span><span class="s3">6</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">7</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">6</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">5</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;method&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;svd&quot;</span><span class="s0">, </span><span class="s2">&quot;eigh&quot;</span><span class="s0">, </span><span class="s2">&quot;cholesky&quot;</span><span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_multivariate_normal(self</span><span class="s0">, </span><span class="s1">method):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">mean = (</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">cov = [[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span>
        <span class="s1">size = (</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">actual = random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s1">size</span><span class="s0">, </span><span class="s1">method=method)</span>
        <span class="s1">desired = np.array([[[-</span><span class="s3">1.747478062846581</span><span class="s0">,  </span><span class="s3">11.25613495182354  </span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[-</span><span class="s3">0.9967333370066214</span><span class="s0">, </span><span class="s3">10.342002097029821 </span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[ </span><span class="s3">0.7850019631242964</span><span class="s0">, </span><span class="s3">11.181113712443013 </span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">0.8901349653255224</span><span class="s0">,  </span><span class="s3">8.873825399642492 </span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[ </span><span class="s3">0.7130260107430003</span><span class="s0">,  </span><span class="s3">9.551628690083056 </span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">0.7127098726541128</span><span class="s0">, </span><span class="s3">11.991709234143173 </span><span class="s1">]]])</span>

        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

        <span class="s4"># Check for default size, was raising deprecation warning</span>
        <span class="s1">actual = random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s1">method=method)</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.233278563284287</span><span class="s0">, </span><span class="s3">9.424140804347195</span><span class="s1">])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>
        <span class="s4"># Check that non symmetric covariance input raises exception when</span>
        <span class="s4"># check_valid='raises' if using default svd method.</span>
        <span class="s1">mean = [</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">cov = [[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]]</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                      <span class="s1">check_valid=</span><span class="s2">'raise'</span><span class="s1">)</span>

        <span class="s4"># Check that non positive-semidefinite covariance warns with</span>
        <span class="s4"># RuntimeWarning</span>
        <span class="s1">cov = [[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span>
        <span class="s1">assert_warns(RuntimeWarning</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov)</span>
        <span class="s1">assert_warns(RuntimeWarning</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                     <span class="s1">method=</span><span class="s2">'eigh'</span><span class="s1">)</span>
        <span class="s1">assert_raises(LinAlgError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                      <span class="s1">method=</span><span class="s2">'cholesky'</span><span class="s1">)</span>

        <span class="s4"># and that it doesn't warn with RuntimeWarning check_valid='ignore'</span>
        <span class="s1">assert_no_warnings(random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                           <span class="s1">check_valid=</span><span class="s2">'ignore'</span><span class="s1">)</span>

        <span class="s4"># and that it raises with RuntimeWarning check_valid='raises'</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                      <span class="s1">check_valid=</span><span class="s2">'raise'</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                      <span class="s1">check_valid=</span><span class="s2">'raise'</span><span class="s0">, </span><span class="s1">method=</span><span class="s2">'eigh'</span><span class="s1">)</span>

        <span class="s4"># check degenerate samples from singular covariance matrix</span>
        <span class="s1">cov = [[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span>
        <span class="s0">if </span><span class="s1">method </span><span class="s0">in </span><span class="s1">(</span><span class="s2">'svd'</span><span class="s0">, </span><span class="s2">'eigh'</span><span class="s1">):</span>
            <span class="s1">samples = random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">,</span>
                                                 <span class="s1">method=method)</span>
            <span class="s1">assert_array_almost_equal(samples[...</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">samples[...</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                                      <span class="s1">decimal=</span><span class="s3">6</span><span class="s1">)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_raises(LinAlgError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                          <span class="s1">method=</span><span class="s2">'cholesky'</span><span class="s1">)</span>

        <span class="s1">cov = np.array([[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0.1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s0">with </span><span class="s1">suppress_warnings() </span><span class="s0">as </span><span class="s1">sup:</span>
            <span class="s1">random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s1">method=method)</span>
            <span class="s1">w = sup.record(RuntimeWarning)</span>
            <span class="s0">assert </span><span class="s1">len(w) == </span><span class="s3">0</span>

        <span class="s1">mu = np.zeros(</span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">cov = np.eye(</span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">,</span>
                      <span class="s1">check_valid=</span><span class="s2">'other'</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">,</span>
                      <span class="s1">np.zeros((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span><span class="s0">, </span><span class="s1">cov)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">,</span>
                      <span class="s1">mu</span><span class="s0">, </span><span class="s1">np.empty((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multivariate_normal</span><span class="s0">,</span>
                      <span class="s1">mu</span><span class="s0">, </span><span class="s1">np.eye(</span><span class="s3">3</span><span class="s1">))</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;method&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;svd&quot;</span><span class="s0">, </span><span class="s2">&quot;eigh&quot;</span><span class="s0">, </span><span class="s2">&quot;cholesky&quot;</span><span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_multivariate_normal_basic_stats(self</span><span class="s0">, </span><span class="s1">method):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">n_s = </span><span class="s3">1000</span>
        <span class="s1">mean = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">cov = np.array([[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]])</span>
        <span class="s1">s = random.multivariate_normal(mean</span><span class="s0">, </span><span class="s1">cov</span><span class="s0">, </span><span class="s1">size=(n_s</span><span class="s0">,</span><span class="s1">)</span><span class="s0">, </span><span class="s1">method=method)</span>
        <span class="s1">s_center = s - mean</span>
        <span class="s1">cov_emp = (s_center.T @ s_center) / (n_s - </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s4"># these are pretty loose and are only designed to detect major errors</span>
        <span class="s0">assert </span><span class="s1">np.all(np.abs(s_center.mean(-</span><span class="s3">2</span><span class="s1">)) &lt; </span><span class="s3">0.1</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">np.all(np.abs(cov_emp - cov) &lt; </span><span class="s3">0.2</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.negative_binomial(n=</span><span class="s3">100</span><span class="s0">, </span><span class="s1">p=</span><span class="s3">.12345</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">543</span><span class="s0">, </span><span class="s3">727</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">775</span><span class="s0">, </span><span class="s3">760</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">600</span><span class="s0">, </span><span class="s3">674</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial_exceptions(self):</span>
        <span class="s0">with </span><span class="s1">np.errstate(invalid=</span><span class="s2">'ignore'</span><span class="s1">):</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.negative_binomial</span><span class="s0">, </span><span class="s3">100</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.negative_binomial</span><span class="s0">, </span><span class="s3">100</span><span class="s0">,</span>
                          <span class="s1">[np.nan] * </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial_p0_exception(self):</span>
        <span class="s4"># Verify that p=0 raises an exception.</span>
        <span class="s0">with </span><span class="s1">assert_raises(ValueError):</span>
            <span class="s1">x = random.negative_binomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.noncentral_chisquare(df=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">1.70561552362133</span><span class="s0">, </span><span class="s3">15.97378184942111</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">13.71483425173724</span><span class="s0">, </span><span class="s3">20.17859633310629</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">11.3615477156643 </span><span class="s0">,  </span><span class="s3">3.67891108738029</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

        <span class="s1">actual = random.noncentral_chisquare(df=</span><span class="s3">.5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s3">.2</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">9.41427665607629e-04</span><span class="s0">, </span><span class="s3">1.70473157518850e-04</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.14554372041263e+00</span><span class="s0">, </span><span class="s3">1.38187755933435e-03</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.90659181905387e+00</span><span class="s0">, </span><span class="s3">1.21772577941822e+00</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.noncentral_chisquare(df=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.82947954590419</span><span class="s0">, </span><span class="s3">1.80139670767078</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">6.58720057417794</span><span class="s0">, </span><span class="s3">7.00491463609814</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">6.31101879073157</span><span class="s0">, </span><span class="s3">6.30982307753005</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.noncentral_f(dfnum=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">dfden=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">nonc=</span><span class="s3">1</span><span class="s0">,</span>
                                     <span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.060310671139  </span><span class="s0">, </span><span class="s3">0.23866058175939</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.86860246709073</span><span class="s0">, </span><span class="s3">0.2668510459738 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.23375780078364</span><span class="s0">, </span><span class="s3">1.88922102885943</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_nan(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.noncentral_f(dfnum=</span><span class="s3">5</span><span class="s0">, </span><span class="s1">dfden=</span><span class="s3">2</span><span class="s0">, </span><span class="s1">nonc=np.nan)</span>
        <span class="s0">assert </span><span class="s1">np.isnan(actual)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.normal(loc=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">2.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[-</span><span class="s3">3.618412914693162</span><span class="s0">,  </span><span class="s3">2.635726692647081</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">2.116923463013243</span><span class="s0">,  </span><span class="s3">0.807460983059643</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">1.446547137248593</span><span class="s0">,  </span><span class="s3">2.485684213886024</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_normal_0(self):</span>
        <span class="s1">assert_equal(random.normal(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.normal</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_pareto(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.pareto(a=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.0394926776069018e+00</span><span class="s0">, </span><span class="s3">7.7142534343505773e+04</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">7.2640150889064703e-01</span><span class="s0">, </span><span class="s3">3.4650454783825594e+05</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">4.5852344481994740e+04</span><span class="s0">, </span><span class="s3">6.5851383009539105e+07</span><span class="s1">]])</span>
        <span class="s4"># For some reason on 32-bit x86 Ubuntu 12.10 the [1, 0] entry in this</span>
        <span class="s4"># matrix differs by 24 nulps. Discussion:</span>
        <span class="s4">#   https://mail.python.org/pipermail/numpy-discussion/2012-September/063801.html</span>
        <span class="s4"># Consensus is that this is probably some gcc quirk that affects</span>
        <span class="s4"># rounding but not in any important way, so we just use a looser</span>
        <span class="s4"># tolerance on this test:</span>
        <span class="s1">np.testing.assert_array_almost_equal_nulp(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">nulp=</span><span class="s3">30</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_poisson(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.poisson(lam=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s0">def </span><span class="s1">test_poisson_exceptions(self):</span>
        <span class="s1">lambig = np.iinfo(</span><span class="s2">'int64'</span><span class="s1">).max</span>
        <span class="s1">lamneg = -</span><span class="s3">1</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">lamneg)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">[lamneg] * </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">lambig)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">[lambig] * </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">np.errstate(invalid=</span><span class="s2">'ignore'</span><span class="s1">):</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">10</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_power(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.power(a=</span><span class="s3">.123456789</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">1.977857368842754e-09</span><span class="s0">, </span><span class="s3">9.806792196620341e-02</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2.482442984543471e-10</span><span class="s0">, </span><span class="s3">1.527108843266079e-01</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">8.188283434244285e-02</span><span class="s0">, </span><span class="s3">3.950547209346948e-01</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.rayleigh(scale=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">4.19494429102666</span><span class="s0">, </span><span class="s3">16.66920198906598</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3.67184544902662</span><span class="s0">, </span><span class="s3">17.74695521962917</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">16.27935397855501</span><span class="s0">, </span><span class="s3">21.08355560691792</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh_0(self):</span>
        <span class="s1">assert_equal(random.rayleigh(scale=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.rayleigh</span><span class="s0">, </span><span class="s1">scale=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_cauchy(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.standard_cauchy(size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[-</span><span class="s3">1.489437778266206</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3.275389641569784</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">0.560102864910406</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.680780916282552</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">1.314912905226277</span><span class="s0">,  </span><span class="s3">0.295852965660225</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_exponential(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.standard_exponential(size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">method=</span><span class="s2">'inv'</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.102031839440643</span><span class="s0">, </span><span class="s3">1.229350298474972</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.088137284693098</span><span class="s0">, </span><span class="s3">1.459859985522667</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.093830802293668</span><span class="s0">, </span><span class="s3">1.256977002164613</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_expoential_type_error(self):</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.standard_exponential</span><span class="s0">, </span><span class="s1">dtype=np.int32)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.standard_gamma(shape=</span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.62970724056362</span><span class="s0">, </span><span class="s3">1.22379851271008</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3.899412530884  </span><span class="s0">, </span><span class="s3">4.12479964250139</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3.74994102464584</span><span class="s0">, </span><span class="s3">3.74929307690815</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gammma_scalar_float(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.standard_gamma(</span><span class="s3">3</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">desired = </span><span class="s3">2.9242148399353027</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">6</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_float(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.standard_gamma(shape=</span><span class="s3">3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.62971</span><span class="s0">, </span><span class="s3">1.2238 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3.89941</span><span class="s0">, </span><span class="s3">4.1248 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">3.74994</span><span class="s0">, </span><span class="s3">3.74929</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">5</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gammma_float_out(self):</span>
        <span class="s1">actual = np.zeros((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">random.standard_gamma(</span><span class="s3">10.0</span><span class="s0">, </span><span class="s1">out=actual</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">10.14987</span><span class="s0">,  </span><span class="s3">7.87012</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[ </span><span class="s3">9.46284</span><span class="s0">, </span><span class="s3">12.56832</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">13.82495</span><span class="s0">,  </span><span class="s3">7.81533</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">5</span><span class="s1">)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">random.standard_gamma(</span><span class="s3">10.0</span><span class="s0">, </span><span class="s1">out=actual</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=np.float32)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">5</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_unknown_type(self):</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.standard_gamma</span><span class="s0">, </span><span class="s3">1.</span><span class="s0">,</span>
                      <span class="s1">dtype=</span><span class="s2">'int32'</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_out_size_mismatch(self):</span>
        <span class="s1">out = np.zeros(</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.standard_gamma</span><span class="s0">, </span><span class="s3">10.0</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">20</span><span class="s0">,</span>
                      <span class="s1">out=out)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.standard_gamma</span><span class="s0">, </span><span class="s3">10.0</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">10</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">,</span>
                      <span class="s1">out=out)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma_0(self):</span>
        <span class="s1">assert_equal(random.standard_gamma(shape=</span><span class="s3">0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.standard_gamma</span><span class="s0">, </span><span class="s1">shape=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.standard_normal(size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[-</span><span class="s3">1.870934851846581</span><span class="s0">,  </span><span class="s3">1.25613495182354 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">1.120190126006621</span><span class="s0">,  </span><span class="s3">0.342002097029821</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">0.661545174124296</span><span class="s0">,  </span><span class="s3">1.181113712443012</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_normal_unsupported_type(self):</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.standard_normal</span><span class="s0">, </span><span class="s1">dtype=np.int32)</span>

    <span class="s0">def </span><span class="s1">test_standard_t(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.standard_t(df=</span><span class="s3">10</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[-</span><span class="s3">1.484666193042647</span><span class="s0">,  </span><span class="s3">0.30597891831161 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">1.056684299648085</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.407312602088507</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">0.130704414281157</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.038053410490321</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_triangular(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.triangular(left=</span><span class="s3">5.12</span><span class="s0">, </span><span class="s1">mode=</span><span class="s3">10.23</span><span class="s0">, </span><span class="s1">right=</span><span class="s3">20.34</span><span class="s0">,</span>
                                   <span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">7.86664070590917</span><span class="s0">, </span><span class="s3">13.6313848513185 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">7.68152445215983</span><span class="s0">, </span><span class="s3">14.36169131136546</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">13.16105603911429</span><span class="s0">, </span><span class="s3">13.72341621856971</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uniform(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.uniform(low=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">high=</span><span class="s3">10.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">2.13306255040998 </span><span class="s0">, </span><span class="s3">7.816987531021207</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2.015436610109887</span><span class="s0">, </span><span class="s3">8.377577533009589</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">7.421792588856135</span><span class="s0">, </span><span class="s3">7.891185744455209</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uniform_range_bounds(self):</span>
        <span class="s1">fmin = np.finfo(</span><span class="s2">'float'</span><span class="s1">).min</span>
        <span class="s1">fmax = np.finfo(</span><span class="s2">'float'</span><span class="s1">).max</span>

        <span class="s1">func = random.uniform</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">-np.inf</span><span class="s0">, </span><span class="s3">0</span><span class="s1">)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.inf)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">fmin</span><span class="s0">, </span><span class="s1">fmax)</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">[-np.inf]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s1">])</span>
        <span class="s1">assert_raises(OverflowError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[np.inf])</span>

        <span class="s4"># (fmax / 1e17) - fmin is within range, so this should not throw</span>
        <span class="s4"># account for i386 extended precision DBL_MAX / 1e17 + DBL_MAX &gt;</span>
        <span class="s4"># DBL_MAX by increasing fmin a bit</span>
        <span class="s1">random.uniform(low=np.nextafter(fmin</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">high=fmax / </span><span class="s3">1e17</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_uniform_zero_range(self):</span>
        <span class="s1">func = random.uniform</span>
        <span class="s1">result = func(</span><span class="s3">1.5</span><span class="s0">, </span><span class="s3">1.5</span><span class="s1">)</span>
        <span class="s1">assert_allclose(result</span><span class="s0">, </span><span class="s3">1.5</span><span class="s1">)</span>
        <span class="s1">result = func([</span><span class="s3">0.0</span><span class="s0">, </span><span class="s1">np.pi]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.0</span><span class="s0">, </span><span class="s1">np.pi])</span>
        <span class="s1">assert_allclose(result</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.0</span><span class="s0">, </span><span class="s1">np.pi])</span>
        <span class="s1">result = func([[</span><span class="s3">2145.12</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2145.12</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2145.12</span><span class="s0">, </span><span class="s3">2145.12</span><span class="s1">])</span>
        <span class="s1">assert_allclose(result</span><span class="s0">, </span><span class="s3">2145.12 </span><span class="s1">+ np.zeros((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)))</span>

    <span class="s0">def </span><span class="s1">test_uniform_neg_range(self):</span>
        <span class="s1">func = random.uniform</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">,  </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">func</span><span class="s0">,  </span><span class="s1">[[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span><span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]]</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_scalar_exception_propagation(self):</span>
        <span class="s4"># Tests that exceptions are correctly propagated in distributions</span>
        <span class="s4"># when called with objects that throw exceptions when converted to</span>
        <span class="s4"># scalars.</span>
        <span class="s4">#</span>
        <span class="s4"># Regression test for gh: 8865</span>

        <span class="s0">class </span><span class="s1">ThrowingFloat(np.ndarray):</span>
            <span class="s0">def </span><span class="s1">__float__(self):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_float = np.array(</span><span class="s3">1.0</span><span class="s1">).view(ThrowingFloat)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.uniform</span><span class="s0">, </span><span class="s1">throwing_float</span><span class="s0">,</span>
                      <span class="s1">throwing_float)</span>

        <span class="s0">class </span><span class="s1">ThrowingInteger(np.ndarray):</span>
            <span class="s0">def </span><span class="s1">__int__(self):</span>
                <span class="s0">raise </span><span class="s1">TypeError</span>

        <span class="s1">throwing_int = np.array(</span><span class="s3">1</span><span class="s1">).view(ThrowingInteger)</span>
        <span class="s1">assert_raises(TypeError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">throwing_int</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.vonmises(mu=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">kappa=</span><span class="s3">1.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[ </span><span class="s3">1.107972248690106</span><span class="s0">,  </span><span class="s3">2.841536476232361</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">1.832602376042457</span><span class="s0">,  </span><span class="s3">1.945511926976032</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[-</span><span class="s3">0.260147475776542</span><span class="s0">,  </span><span class="s3">2.058047492231698</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises_small(self):</span>
        <span class="s4"># check infinite loop, gh-4720</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">r = random.vonmises(mu=</span><span class="s3">0.</span><span class="s0">, </span><span class="s1">kappa=</span><span class="s3">1.1e-8</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">**</span><span class="s3">6</span><span class="s1">)</span>
        <span class="s1">assert_(np.isfinite(r).all())</span>

    <span class="s0">def </span><span class="s1">test_vonmises_nan(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">r = random.vonmises(mu=</span><span class="s3">0.</span><span class="s0">, </span><span class="s1">kappa=np.nan)</span>
        <span class="s1">assert_(np.isnan(r))</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;kappa&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1e4</span><span class="s0">, </span><span class="s3">1e15</span><span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_vonmises_large_kappa(self</span><span class="s0">, </span><span class="s1">kappa):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">rs = RandomState(random.bit_generator)</span>
        <span class="s1">state = random.bit_generator.state</span>

        <span class="s1">random_state_vals = rs.vonmises(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">kappa</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">random.bit_generator.state = state</span>
        <span class="s1">gen_vals = random.vonmises(</span><span class="s3">0</span><span class="s0">, </span><span class="s1">kappa</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10</span><span class="s1">)</span>
        <span class="s0">if </span><span class="s1">kappa &lt; </span><span class="s3">1e6</span><span class="s1">:</span>
            <span class="s1">assert_allclose(random_state_vals</span><span class="s0">, </span><span class="s1">gen_vals)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s0">assert </span><span class="s1">np.all(random_state_vals != gen_vals)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;mu&quot;</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">7.</span><span class="s0">, </span><span class="s1">-np.pi</span><span class="s0">, </span><span class="s1">-</span><span class="s3">3.1</span><span class="s0">, </span><span class="s1">np.pi</span><span class="s0">, </span><span class="s3">3.2</span><span class="s1">])</span>
    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;kappa&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1e-9</span><span class="s0">, </span><span class="s3">1e-6</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1e3</span><span class="s0">, </span><span class="s3">1e15</span><span class="s1">])</span>
    <span class="s0">def </span><span class="s1">test_vonmises_large_kappa_range(self</span><span class="s0">, </span><span class="s1">mu</span><span class="s0">, </span><span class="s1">kappa):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">r = random.vonmises(mu</span><span class="s0">, </span><span class="s1">kappa</span><span class="s0">, </span><span class="s3">50</span><span class="s1">)</span>
        <span class="s1">assert_(np.all(r &gt; -np.pi) </span><span class="s0">and </span><span class="s1">np.all(r &lt;= np.pi))</span>

    <span class="s0">def </span><span class="s1">test_wald(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.wald(mean=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">scale=</span><span class="s3">1.54</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.26871721804551</span><span class="s0">, </span><span class="s3">3.2233942732115 </span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2.20328374987066</span><span class="s0">, </span><span class="s3">2.40958405189353</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2.07093587449261</span><span class="s0">, </span><span class="s3">0.73073890064369</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.weibull(a=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0.138613914769468</span><span class="s0">, </span><span class="s3">1.306463419753191</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">0.111623365934763</span><span class="s0">, </span><span class="s3">1.446570494646721</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">1.257145775276011</span><span class="s0">, </span><span class="s3">1.914247725027957</span><span class="s1">]])</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">15</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull_0(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">assert_equal(random.weibull(a=</span><span class="s3">0</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">12</span><span class="s1">)</span><span class="s0">, </span><span class="s1">np.zeros(</span><span class="s3">12</span><span class="s1">))</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.weibull</span><span class="s0">, </span><span class="s1">a=-</span><span class="s3">0.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_zipf(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.zipf(a=</span><span class="s3">1.23</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[  </span><span class="s3">1</span><span class="s0">,   </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[ </span><span class="s3">10</span><span class="s0">, </span><span class="s3">867</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">354</span><span class="s0">,   </span><span class="s3">2</span><span class="s1">]])</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>


<span class="s0">class </span><span class="s1">TestBroadcast:</span>
    <span class="s4"># tests that functions that broadcast behave</span>
    <span class="s4"># correctly when presented with non-scalar arguments</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seed = </span><span class="s3">123456789</span>


    <span class="s0">def </span><span class="s1">test_uniform(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">low = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">high = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">uniform = random.uniform</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.16693771389729</span><span class="s0">, </span><span class="s3">0.19635129550675</span><span class="s0">, </span><span class="s3">0.75563050964095</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.uniform(low * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">high)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.uniform(low</span><span class="s0">, </span><span class="s1">high * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s1">loc = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">desired = np.array([-</span><span class="s3">0.38736406738527</span><span class="s0">,  </span><span class="s3">0.79594375042255</span><span class="s0">,  </span><span class="s3">0.0197076236097</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.normal(loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.normal</span><span class="s0">, </span><span class="s1">loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">normal = random.normal</span>
        <span class="s1">actual = normal(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">normal</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_beta(self):</span>
        <span class="s1">a = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">b = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_b = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.18719338682602</span><span class="s0">, </span><span class="s3">0.73234824491364</span><span class="s0">, </span><span class="s3">0.17928615186455</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">beta = random.beta</span>
        <span class="s1">actual = beta(a * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">b)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">b)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">beta</span><span class="s0">, </span><span class="s1">a * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_b)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.beta(a</span><span class="s0">, </span><span class="s1">b * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_exponential(self):</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.67245993212806</span><span class="s0">, </span><span class="s3">0.21380495318094</span><span class="s0">, </span><span class="s3">0.7177848928629</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.exponential(scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.exponential</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_gamma(self):</span>
        <span class="s1">shape = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_shape = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.67245993212806</span><span class="s0">, </span><span class="s3">0.21380495318094</span><span class="s0">, </span><span class="s3">0.7177848928629</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">std_gamma = random.standard_gamma</span>
        <span class="s1">actual = std_gamma(shape * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">std_gamma</span><span class="s0">, </span><span class="s1">bad_shape * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gamma(self):</span>
        <span class="s1">shape = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_shape = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">1.34491986425611</span><span class="s0">, </span><span class="s3">0.42760990636187</span><span class="s0">, </span><span class="s3">1.4355697857258</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">gamma = random.gamma</span>
        <span class="s1">actual = gamma(shape * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">bad_shape * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">shape * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">gamma = random.gamma</span>
        <span class="s1">actual = gamma(shape</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">bad_shape</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gamma</span><span class="s0">, </span><span class="s1">shape</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_f(self):</span>
        <span class="s1">dfnum = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">dfden = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_dfnum = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_dfden = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.07765056244107</span><span class="s0">, </span><span class="s3">7.72951397913186</span><span class="s0">, </span><span class="s3">0.05786093891763</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">f = random.f</span>
        <span class="s1">actual = f(dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">bad_dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_dfden)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">f = random.f</span>
        <span class="s1">actual = f(dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f(self):</span>
        <span class="s1">dfnum = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">dfden = [</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">nonc = [</span><span class="s3">4</span><span class="s1">]</span>
        <span class="s1">bad_dfnum = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">bad_dfden = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_nonc = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">2.02434240411421</span><span class="s0">, </span><span class="s3">12.91838601070124</span><span class="s0">, </span><span class="s3">1.24395160354629</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">nonc_f = random.noncentral_f</span>
        <span class="s1">actual = nonc_f(dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">np.all(np.isnan(nonc_f(dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">[np.nan] * </span><span class="s3">3</span><span class="s1">)))</span>

        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_dfden</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">nonc_f = random.noncentral_f</span>
        <span class="s1">actual = nonc_f(dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">dfden * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">nonc_f = random.noncentral_f</span>
        <span class="s1">actual = nonc_f(dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">bad_dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">bad_dfden</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_f</span><span class="s0">, </span><span class="s1">dfnum</span><span class="s0">, </span><span class="s1">dfden</span><span class="s0">, </span><span class="s1">bad_nonc * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_f_small_df(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.04714867120827</span><span class="s0">, </span><span class="s3">0.1239390327694</span><span class="s1">])</span>
        <span class="s1">actual = random.noncentral_f(</span><span class="s3">0.9</span><span class="s0">, </span><span class="s3">0.9</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_chisquare(self):</span>
        <span class="s1">df = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.05573640064251</span><span class="s0">, </span><span class="s3">1.47220224353539</span><span class="s0">, </span><span class="s3">2.9469379318589</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.chisquare(df * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.chisquare</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_noncentral_chisquare(self):</span>
        <span class="s1">df = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">nonc = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_nonc = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.07710766249436</span><span class="s0">, </span><span class="s3">5.27829115110304</span><span class="s0">, </span><span class="s3">0.630732147399</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">nonc_chi = random.noncentral_chisquare</span>
        <span class="s1">actual = nonc_chi(df * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nonc)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">df * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nonc)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">nonc_chi = random.noncentral_chisquare</span>
        <span class="s1">actual = nonc_chi(df</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">bad_df</span><span class="s0">, </span><span class="s1">nonc * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">nonc_chi</span><span class="s0">, </span><span class="s1">df</span><span class="s0">, </span><span class="s1">bad_nonc * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_standard_t(self):</span>
        <span class="s1">df = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_df = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([-</span><span class="s3">1.39498829447098</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.23058658835223</span><span class="s0">, </span><span class="s3">0.17207021065983</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.standard_t(df * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.standard_t</span><span class="s0">, </span><span class="s1">bad_df * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_vonmises(self):</span>
        <span class="s1">mu = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">kappa = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_kappa = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">2.25935584988528</span><span class="s0">, </span><span class="s3">2.23326261461399</span><span class="s0">, </span><span class="s1">-</span><span class="s3">2.84152146503326</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.vonmises(mu * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">kappa)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.vonmises</span><span class="s0">, </span><span class="s1">mu * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_kappa)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.vonmises(mu</span><span class="s0">, </span><span class="s1">kappa * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.vonmises</span><span class="s0">, </span><span class="s1">mu</span><span class="s0">, </span><span class="s1">bad_kappa * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_pareto(self):</span>
        <span class="s1">a = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.95905052946317</span><span class="s0">, </span><span class="s3">0.2383810889437 </span><span class="s0">, </span><span class="s3">1.04988745750013</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.pareto(a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.pareto</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_weibull(self):</span>
        <span class="s1">a = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.67245993212806</span><span class="s0">, </span><span class="s3">0.21380495318094</span><span class="s0">, </span><span class="s3">0.7177848928629</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.weibull(a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.weibull</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_power(self):</span>
        <span class="s1">a = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_a = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.48954864361052</span><span class="s0">, </span><span class="s3">0.19249412888486</span><span class="s0">, </span><span class="s3">0.51216834058807</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.power(a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.power</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_laplace(self):</span>
        <span class="s1">loc = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([-</span><span class="s3">1.09698732625119</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.93470271947368</span><span class="s0">, </span><span class="s3">0.71592671378202</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">laplace = random.laplace</span>
        <span class="s1">actual = laplace(loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">laplace</span><span class="s0">, </span><span class="s1">loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">laplace = random.laplace</span>
        <span class="s1">actual = laplace(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">laplace</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_gumbel(self):</span>
        <span class="s1">loc = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">1.70020068231762</span><span class="s0">, </span><span class="s3">1.52054354273631</span><span class="s0">, </span><span class="s1">-</span><span class="s3">0.34293267607081</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">gumbel = random.gumbel</span>
        <span class="s1">actual = gumbel(loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gumbel</span><span class="s0">, </span><span class="s1">loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">gumbel = random.gumbel</span>
        <span class="s1">actual = gumbel(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">gumbel</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logistic(self):</span>
        <span class="s1">loc = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([-</span><span class="s3">1.607487640433</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1.40925686003678</span><span class="s0">, </span><span class="s3">1.12887112820397</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.logistic(loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.logistic</span><span class="s0">, </span><span class="s1">loc * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.logistic(loc</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.logistic</span><span class="s0">, </span><span class="s1">loc</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_equal(random.logistic(</span><span class="s3">1.0</span><span class="s0">, </span><span class="s3">0.0</span><span class="s1">)</span><span class="s0">, </span><span class="s3">1.0</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_lognormal(self):</span>
        <span class="s1">mean = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">sigma = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_sigma = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.67884390500697</span><span class="s0">, </span><span class="s3">2.21653186290321</span><span class="s0">, </span><span class="s3">1.01990310084276</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">lognormal = random.lognormal</span>
        <span class="s1">actual = lognormal(mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">sigma)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">lognormal</span><span class="s0">, </span><span class="s1">mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_sigma)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.lognormal(mean</span><span class="s0">, </span><span class="s1">sigma * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.lognormal</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">bad_sigma * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_rayleigh(self):</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array(</span>
            <span class="s1">[</span><span class="s3">1.1597068009872629</span><span class="s0">,</span>
             <span class="s3">0.6539188836253857</span><span class="s0">,</span>
             <span class="s3">1.1981526554349398</span><span class="s1">]</span>
        <span class="s1">)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.rayleigh(scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.rayleigh</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_wald(self):</span>
        <span class="s1">mean = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">scale = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_mean = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">bad_scale = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0.38052407392905</span><span class="s0">, </span><span class="s3">0.50701641508592</span><span class="s0">, </span><span class="s3">0.484935249864</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.wald(mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.wald</span><span class="s0">, </span><span class="s1">bad_mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">scale)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.wald</span><span class="s0">, </span><span class="s1">mean * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_scale)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.wald(mean</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.wald</span><span class="s0">, </span><span class="s1">bad_mean</span><span class="s0">, </span><span class="s1">scale * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.wald</span><span class="s0">, </span><span class="s1">mean</span><span class="s0">, </span><span class="s1">bad_scale * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_triangular(self):</span>
        <span class="s1">left = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">right = [</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">mode = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_left_one = [</span><span class="s3">3</span><span class="s1">]</span>
        <span class="s1">bad_mode_one = [</span><span class="s3">4</span><span class="s1">]</span>
        <span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two = right * </span><span class="s3">2</span>
        <span class="s1">desired = np.array([</span><span class="s3">1.57781954604754</span><span class="s0">, </span><span class="s3">1.62665986867957</span><span class="s0">, </span><span class="s3">2.30090130831326</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">triangular = random.triangular</span>
        <span class="s1">actual = triangular(left * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_mode_one</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_mode_two</span><span class="s0">,</span>
                      <span class="s1">right)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">triangular = random.triangular</span>
        <span class="s1">actual = triangular(left</span><span class="s0">, </span><span class="s1">mode * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one</span><span class="s0">, </span><span class="s1">mode * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left</span><span class="s0">, </span><span class="s1">bad_mode_one * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">right)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two * </span><span class="s3">3</span><span class="s0">,</span>
                      <span class="s1">right)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">triangular = random.triangular</span>
        <span class="s1">actual = triangular(left</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_almost_equal(actual</span><span class="s0">, </span><span class="s1">desired</span><span class="s0">, </span><span class="s1">decimal=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_one</span><span class="s0">, </span><span class="s1">mode</span><span class="s0">, </span><span class="s1">right * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">left</span><span class="s0">, </span><span class="s1">bad_mode_one</span><span class="s0">, </span><span class="s1">right * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s1">bad_left_two</span><span class="s0">, </span><span class="s1">bad_mode_two</span><span class="s0">,</span>
                      <span class="s1">right * </span><span class="s3">3</span><span class="s1">)</span>

        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">0.</span><span class="s0">, </span><span class="s3">20.</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">25.</span><span class="s0">, </span><span class="s3">20.</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">triangular</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s0">, </span><span class="s3">10.</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_binomial(self):</span>
        <span class="s1">n = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">bad_n = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s3">1.5</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">binom = random.binomial</span>
        <span class="s1">actual = binom(n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">bad_n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_p_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_p_two)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.binomial(n</span><span class="s0">, </span><span class="s1">p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">bad_n</span><span class="s0">, </span><span class="s1">p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_negative_binomial(self):</span>
        <span class="s1">n = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">bad_n = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s3">1.5</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">neg_binom = random.negative_binomial</span>
        <span class="s1">actual = neg_binom(n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">bad_n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">p)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_p_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_p_two)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">neg_binom = random.negative_binomial</span>
        <span class="s1">actual = neg_binom(n</span><span class="s0">, </span><span class="s1">p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">bad_n</span><span class="s0">, </span><span class="s1">p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">neg_binom</span><span class="s0">, </span><span class="s1">n</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_poisson(self):</span>

        <span class="s1">lam = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_lam_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">max_lam = random._poisson_lam_max</span>
        <span class="s1">bad_lam_two = [max_lam * </span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">poisson = random.poisson</span>
        <span class="s1">actual = poisson(lam * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">poisson</span><span class="s0">, </span><span class="s1">bad_lam_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">poisson</span><span class="s0">, </span><span class="s1">bad_lam_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_zipf(self):</span>
        <span class="s1">a = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_a = [</span><span class="s3">0</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">8</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">zipf = random.zipf</span>
        <span class="s1">actual = zipf(a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">bad_a * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s0">with </span><span class="s1">np.errstate(invalid=</span><span class="s2">'ignore'</span><span class="s1">):</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">np.nan)</span>
            <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">zipf</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s1">np.nan])</span>

    <span class="s0">def </span><span class="s1">test_geometric(self):</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [</span><span class="s3">1.5</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">geometric = random.geometric</span>
        <span class="s1">actual = geometric(p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">geometric</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">geometric</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_hypergeometric(self):</span>
        <span class="s1">ngood = [</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">nbad = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">nsample = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_ngood = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_nbad = [-</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_nsample_one = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">bad_nsample_two = [</span><span class="s3">4</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.hypergeometric(ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">bad_ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nbad</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">ngood * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_two)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.hypergeometric(ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">bad_ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">bad_nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">nsample)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nsample_one)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.hypergeometric</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad * </span><span class="s3">3</span><span class="s0">, </span><span class="s1">bad_nsample_two)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">hypergeom = random.hypergeometric</span>
        <span class="s1">actual = hypergeom(ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">bad_ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">bad_nbad</span><span class="s0">, </span><span class="s1">nsample * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">ngood</span><span class="s0">, </span><span class="s1">nbad</span><span class="s0">, </span><span class="s1">bad_nsample_two * </span><span class="s3">3</span><span class="s1">)</span>

        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s1">-</span><span class="s3">1</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">25</span><span class="s1">)</span>

        <span class="s4"># ValueError for arguments that are too big.</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">30</span><span class="s0">, </span><span class="s3">10</span><span class="s0">, </span><span class="s3">20</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">999</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">31</span><span class="s0">, </span><span class="s3">50</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">hypergeom</span><span class="s0">, </span><span class="s3">999</span><span class="s0">, </span><span class="s1">[</span><span class="s3">2</span><span class="s1">**</span><span class="s3">29</span><span class="s0">, </span><span class="s3">2</span><span class="s1">**</span><span class="s3">30</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1000</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_logseries(self):</span>
        <span class="s1">p = [</span><span class="s3">0.5</span><span class="s1">]</span>
        <span class="s1">bad_p_one = [</span><span class="s3">2</span><span class="s1">]</span>
        <span class="s1">bad_p_two = [-</span><span class="s3">1</span><span class="s1">]</span>
        <span class="s1">desired = np.array([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">])</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">logseries = random.logseries</span>
        <span class="s1">actual = logseries(p * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logseries</span><span class="s0">, </span><span class="s1">bad_p_one * </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">logseries</span><span class="s0">, </span><span class="s1">bad_p_two * </span><span class="s3">3</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_multinomial(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.multinomial([</span><span class="s3">5</span><span class="s0">, </span><span class="s3">20</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6.</span><span class="s1">] * </span><span class="s3">6</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">))</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">7</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]]]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.multinomial([</span><span class="s3">5</span><span class="s0">, </span><span class="s3">20</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6.</span><span class="s1">] * </span><span class="s3">6</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.multinomial([</span><span class="s3">5</span><span class="s0">, </span><span class="s3">20</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6.</span><span class="s1">] * </span><span class="s3">6</span><span class="s1">] * </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                            <span class="s1">[</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.multinomial([[</span><span class="s3">5</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">20</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6.</span><span class="s1">] * </span><span class="s3">6</span><span class="s1">] * </span><span class="s3">2</span><span class="s1">)</span>
        <span class="s1">desired = np.array([[[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">0</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">0</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]]</span><span class="s0">,</span>
                            <span class="s1">[[</span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">3</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span><span class="s0">,</span>
                             <span class="s1">[</span><span class="s3">7</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">4</span><span class="s1">]]]</span><span class="s0">, </span><span class="s1">dtype=np.int64)</span>
        <span class="s1">assert_array_equal(actual</span><span class="s0">, </span><span class="s1">desired)</span>

    <span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;n&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s3">10</span><span class="s0">,</span>
                                   <span class="s1">np.array([</span><span class="s3">10</span><span class="s0">, </span><span class="s3">10</span><span class="s1">])</span><span class="s0">,</span>
                                   <span class="s1">np.array([[[</span><span class="s3">10</span><span class="s1">]]</span><span class="s0">, </span><span class="s1">[[</span><span class="s3">10</span><span class="s1">]]])</span>
                                   <span class="s1">]</span>
                             <span class="s1">)</span>
    <span class="s0">def </span><span class="s1">test_multinomial_pval_broadcast(self</span><span class="s0">, </span><span class="s1">n):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">pvals = np.array([</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">4</span><span class="s1">] * </span><span class="s3">4</span><span class="s1">)</span>
        <span class="s1">actual = random.multinomial(n</span><span class="s0">, </span><span class="s1">pvals)</span>
        <span class="s1">n_shape = tuple() </span><span class="s0">if </span><span class="s1">isinstance(n</span><span class="s0">, </span><span class="s1">int) </span><span class="s0">else </span><span class="s1">n.shape</span>
        <span class="s1">expected_shape = n_shape + (</span><span class="s3">4</span><span class="s0">,</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">actual.shape == expected_shape</span>
        <span class="s1">pvals = np.vstack([pvals</span><span class="s0">, </span><span class="s1">pvals])</span>
        <span class="s1">actual = random.multinomial(n</span><span class="s0">, </span><span class="s1">pvals)</span>
        <span class="s1">expected_shape = np.broadcast_shapes(n_shape</span><span class="s0">, </span><span class="s1">pvals.shape[:-</span><span class="s3">1</span><span class="s1">]) + (</span><span class="s3">4</span><span class="s0">,</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">actual.shape == expected_shape</span>

        <span class="s1">pvals = np.vstack([[pvals]</span><span class="s0">, </span><span class="s1">[pvals]])</span>
        <span class="s1">actual = random.multinomial(n</span><span class="s0">, </span><span class="s1">pvals)</span>
        <span class="s1">expected_shape = np.broadcast_shapes(n_shape</span><span class="s0">, </span><span class="s1">pvals.shape[:-</span><span class="s3">1</span><span class="s1">])</span>
        <span class="s0">assert </span><span class="s1">actual.shape == expected_shape + (</span><span class="s3">4</span><span class="s0">,</span><span class="s1">)</span>
        <span class="s1">actual = random.multinomial(n</span><span class="s0">, </span><span class="s1">pvals</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">) + expected_shape)</span>
        <span class="s0">assert </span><span class="s1">actual.shape == (</span><span class="s3">3</span><span class="s0">, </span><span class="s3">2</span><span class="s1">) + expected_shape + (</span><span class="s3">4</span><span class="s0">,</span><span class="s1">)</span>

        <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
            <span class="s4"># Ensure that size is not broadcast</span>
            <span class="s1">actual = random.multinomial(n</span><span class="s0">, </span><span class="s1">pvals</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">1</span><span class="s0">,</span><span class="s1">) * </span><span class="s3">6</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_invalid_pvals_broadcast(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">pvals = [[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6</span><span class="s1">] * </span><span class="s3">6</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">4</span><span class="s1">] * </span><span class="s3">6</span><span class="s1">]</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s1">pvals)</span>
        <span class="s1">assert_raises(ValueError</span><span class="s0">, </span><span class="s1">random.multinomial</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">0.5</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_empty_outputs(self):</span>
        <span class="s1">random = Generator(MT19937(self.seed))</span>
        <span class="s1">actual = random.multinomial(np.empty((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;i8&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6</span><span class="s1">] * </span><span class="s3">6</span><span class="s1">)</span>
        <span class="s0">assert </span><span class="s1">actual.shape == (</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">6</span><span class="s0">, </span><span class="s3">6</span><span class="s1">)</span>
        <span class="s1">actual = random.multinomial(</span><span class="s3">12</span><span class="s0">, </span><span class="s1">np.empty((</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)))</span>
        <span class="s0">assert </span><span class="s1">actual.shape == (</span><span class="s3">10</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">10</span><span class="s1">)</span>
        <span class="s1">actual = random.multinomial(np.empty((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s1">)</span><span class="s0">, </span><span class="s2">&quot;i8&quot;</span><span class="s1">)</span><span class="s0">,</span>
                                    <span class="s1">np.empty((</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)))</span>
        <span class="s0">assert </span><span class="s1">actual.shape == (</span><span class="s3">3</span><span class="s0">, </span><span class="s3">0</span><span class="s0">, </span><span class="s3">7</span><span class="s0">, </span><span class="s3">4</span><span class="s1">)</span>


<span class="s0">class </span><span class="s1">TestThread:</span>
    <span class="s4"># make sure each state produces the same sequence even in threads</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.seeds = range(</span><span class="s3">4</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">check_function(self</span><span class="s0">, </span><span class="s1">function</span><span class="s0">, </span><span class="s1">sz):</span>
        <span class="s0">from </span><span class="s1">threading </span><span class="s0">import </span><span class="s1">Thread</span>

        <span class="s1">out1 = np.empty((len(self.seeds)</span><span class="s0">,</span><span class="s1">) + sz)</span>
        <span class="s1">out2 = np.empty((len(self.seeds)</span><span class="s0">,</span><span class="s1">) + sz)</span>

        <span class="s4"># threaded generation</span>
        <span class="s1">t = [Thread(target=function</span><span class="s0">, </span><span class="s1">args=(Generator(MT19937(s))</span><span class="s0">, </span><span class="s1">o))</span>
             <span class="s0">for </span><span class="s1">s</span><span class="s0">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip(self.seeds</span><span class="s0">, </span><span class="s1">out1)]</span>
        <span class="s1">[x.start() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t]</span>
        <span class="s1">[x.join() </span><span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">t]</span>

        <span class="s4"># the same serial</span>
        <span class="s0">for </span><span class="s1">s</span><span class="s0">, </span><span class="s1">o </span><span class="s0">in </span><span class="s1">zip(self.seeds</span><span class="s0">, </span><span class="s1">out2):</span>
            <span class="s1">function(Generator(MT19937(s))</span><span class="s0">, </span><span class="s1">o)</span>

        <span class="s4"># these platforms change x87 fpu precision mode in threads</span>
        <span class="s0">if </span><span class="s1">np.intp().dtype.itemsize == </span><span class="s3">4 </span><span class="s0">and </span><span class="s1">sys.platform == </span><span class="s2">&quot;win32&quot;</span><span class="s1">:</span>
            <span class="s1">assert_array_almost_equal(out1</span><span class="s0">, </span><span class="s1">out2)</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">assert_array_equal(out1</span><span class="s0">, </span><span class="s1">out2)</span>

    <span class="s0">def </span><span class="s1">test_normal(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.normal(size=</span><span class="s3">10000</span><span class="s1">)</span>

        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s3">10000</span><span class="s0">,</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_exp(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.exponential(scale=np.ones((</span><span class="s3">100</span><span class="s0">, </span><span class="s3">1000</span><span class="s1">)))</span>

        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s3">100</span><span class="s0">, </span><span class="s3">1000</span><span class="s1">))</span>

    <span class="s0">def </span><span class="s1">test_multinomial(self):</span>
        <span class="s0">def </span><span class="s1">gen_random(state</span><span class="s0">, </span><span class="s1">out):</span>
            <span class="s1">out[...] = state.multinomial(</span><span class="s3">10</span><span class="s0">, </span><span class="s1">[</span><span class="s3">1 </span><span class="s1">/ </span><span class="s3">6.</span><span class="s1">] * </span><span class="s3">6</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">10000</span><span class="s1">)</span>

        <span class="s1">self.check_function(gen_random</span><span class="s0">, </span><span class="s1">sz=(</span><span class="s3">10000</span><span class="s0">, </span><span class="s3">6</span><span class="s1">))</span>


<span class="s4"># See Issue #4263</span>
<span class="s0">class </span><span class="s1">TestSingleEltArrayInput:</span>
    <span class="s0">def </span><span class="s1">setup(self):</span>
        <span class="s1">self.argOne = np.array([</span><span class="s3">2</span><span class="s1">])</span>
        <span class="s1">self.argTwo = np.array([</span><span class="s3">3</span><span class="s1">])</span>
        <span class="s1">self.argThree = np.array([</span><span class="s3">4</span><span class="s1">])</span>
        <span class="s1">self.tgtShape = (</span><span class="s3">1</span><span class="s0">,</span><span class="s1">)</span>

    <span class="s0">def </span><span class="s1">test_one_arg_funcs(self):</span>
        <span class="s1">funcs = (random.exponential</span><span class="s0">, </span><span class="s1">random.standard_gamma</span><span class="s0">,</span>
                 <span class="s1">random.chisquare</span><span class="s0">, </span><span class="s1">random.standard_t</span><span class="s0">,</span>
                 <span class="s1">random.pareto</span><span class="s0">, </span><span class="s1">random.weibull</span><span class="s0">,</span>
                 <span class="s1">random.power</span><span class="s0">, </span><span class="s1">random.rayleigh</span><span class="s0">,</span>
                 <span class="s1">random.poisson</span><span class="s0">, </span><span class="s1">random.zipf</span><span class="s0">,</span>
                 <span class="s1">random.geometric</span><span class="s0">, </span><span class="s1">random.logseries)</span>

        <span class="s1">probfuncs = (random.geometric</span><span class="s0">, </span><span class="s1">random.logseries)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs:  </span><span class="s4"># p &lt; 1.0</span>
                <span class="s1">out = func(np.array([</span><span class="s3">0.5</span><span class="s1">]))</span>

            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">out = func(self.argOne)</span>

            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

    <span class="s0">def </span><span class="s1">test_two_arg_funcs(self):</span>
        <span class="s1">funcs = (random.uniform</span><span class="s0">, </span><span class="s1">random.normal</span><span class="s0">,</span>
                 <span class="s1">random.beta</span><span class="s0">, </span><span class="s1">random.gamma</span><span class="s0">,</span>
                 <span class="s1">random.f</span><span class="s0">, </span><span class="s1">random.noncentral_chisquare</span><span class="s0">,</span>
                 <span class="s1">random.vonmises</span><span class="s0">, </span><span class="s1">random.laplace</span><span class="s0">,</span>
                 <span class="s1">random.gumbel</span><span class="s0">, </span><span class="s1">random.logistic</span><span class="s0">,</span>
                 <span class="s1">random.lognormal</span><span class="s0">, </span><span class="s1">random.wald</span><span class="s0">,</span>
                 <span class="s1">random.binomial</span><span class="s0">, </span><span class="s1">random.negative_binomial)</span>

        <span class="s1">probfuncs = (random.binomial</span><span class="s0">, </span><span class="s1">random.negative_binomial)</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s0">if </span><span class="s1">func </span><span class="s0">in </span><span class="s1">probfuncs:  </span><span class="s4"># p &lt;= 1</span>
                <span class="s1">argTwo = np.array([</span><span class="s3">0.5</span><span class="s1">])</span>

            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">argTwo = self.argTwo</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">argTwo)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">argTwo)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">argTwo[</span><span class="s3">0</span><span class="s1">])</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

    <span class="s0">def </span><span class="s1">test_integers(self</span><span class="s0">, </span><span class="s1">endpoint):</span>
        <span class="s1">itype = [np.bool_</span><span class="s0">, </span><span class="s1">np.int8</span><span class="s0">, </span><span class="s1">np.uint8</span><span class="s0">, </span><span class="s1">np.int16</span><span class="s0">, </span><span class="s1">np.uint16</span><span class="s0">,</span>
                 <span class="s1">np.int32</span><span class="s0">, </span><span class="s1">np.uint32</span><span class="s0">, </span><span class="s1">np.int64</span><span class="s0">, </span><span class="s1">np.uint64]</span>
        <span class="s1">func = random.integers</span>
        <span class="s1">high = np.array([</span><span class="s3">1</span><span class="s1">])</span>
        <span class="s1">low = np.array([</span><span class="s3">0</span><span class="s1">])</span>

        <span class="s0">for </span><span class="s1">dt </span><span class="s0">in </span><span class="s1">itype:</span>
            <span class="s1">out = func(low</span><span class="s0">, </span><span class="s1">high</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(low[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">high</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(low</span><span class="s0">, </span><span class="s1">high[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">endpoint=endpoint</span><span class="s0">, </span><span class="s1">dtype=dt)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

    <span class="s0">def </span><span class="s1">test_three_arg_funcs(self):</span>
        <span class="s1">funcs = [random.noncentral_f</span><span class="s0">, </span><span class="s1">random.triangular</span><span class="s0">,</span>
                 <span class="s1">random.hypergeometric]</span>

        <span class="s0">for </span><span class="s1">func </span><span class="s0">in </span><span class="s1">funcs:</span>
            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">self.argTwo</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">self.argTwo</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>

            <span class="s1">out = func(self.argOne</span><span class="s0">, </span><span class="s1">self.argTwo[</span><span class="s3">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">self.argThree)</span>
            <span class="s1">assert_equal(out.shape</span><span class="s0">, </span><span class="s1">self.tgtShape)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;config&quot;</span><span class="s0">, </span><span class="s1">JUMP_TEST_DATA)</span>
<span class="s0">def </span><span class="s1">test_jumped(config):</span>
    <span class="s4"># Each config contains the initial seed, a number of raw steps</span>
    <span class="s4"># the sha256 hashes of the initial and the final states' keys and</span>
    <span class="s4"># the position of of the initial and the final state.</span>
    <span class="s4"># These were produced using the original C implementation.</span>
    <span class="s1">seed = config[</span><span class="s2">&quot;seed&quot;</span><span class="s1">]</span>
    <span class="s1">steps = config[</span><span class="s2">&quot;steps&quot;</span><span class="s1">]</span>

    <span class="s1">mt19937 = MT19937(seed)</span>
    <span class="s4"># Burn step</span>
    <span class="s1">mt19937.random_raw(steps)</span>
    <span class="s1">key = mt19937.state[</span><span class="s2">&quot;state&quot;</span><span class="s1">][</span><span class="s2">&quot;key&quot;</span><span class="s1">]</span>
    <span class="s0">if </span><span class="s1">sys.byteorder == </span><span class="s2">'big'</span><span class="s1">:</span>
        <span class="s1">key = key.byteswap()</span>
    <span class="s1">sha256 = hashlib.sha256(key)</span>
    <span class="s0">assert </span><span class="s1">mt19937.state[</span><span class="s2">&quot;state&quot;</span><span class="s1">][</span><span class="s2">&quot;pos&quot;</span><span class="s1">] == config[</span><span class="s2">&quot;initial&quot;</span><span class="s1">][</span><span class="s2">&quot;pos&quot;</span><span class="s1">]</span>
    <span class="s0">assert </span><span class="s1">sha256.hexdigest() == config[</span><span class="s2">&quot;initial&quot;</span><span class="s1">][</span><span class="s2">&quot;key_sha256&quot;</span><span class="s1">]</span>

    <span class="s1">jumped = mt19937.jumped()</span>
    <span class="s1">key = jumped.state[</span><span class="s2">&quot;state&quot;</span><span class="s1">][</span><span class="s2">&quot;key&quot;</span><span class="s1">]</span>
    <span class="s0">if </span><span class="s1">sys.byteorder == </span><span class="s2">'big'</span><span class="s1">:</span>
        <span class="s1">key = key.byteswap()</span>
    <span class="s1">sha256 = hashlib.sha256(key)</span>
    <span class="s0">assert </span><span class="s1">jumped.state[</span><span class="s2">&quot;state&quot;</span><span class="s1">][</span><span class="s2">&quot;pos&quot;</span><span class="s1">] == config[</span><span class="s2">&quot;jumped&quot;</span><span class="s1">][</span><span class="s2">&quot;pos&quot;</span><span class="s1">]</span>
    <span class="s0">assert </span><span class="s1">sha256.hexdigest() == config[</span><span class="s2">&quot;jumped&quot;</span><span class="s1">][</span><span class="s2">&quot;key_sha256&quot;</span><span class="s1">]</span>


<span class="s0">def </span><span class="s1">test_broadcast_size_error():</span>
    <span class="s1">mu = np.ones(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">sigma = np.ones((</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>
    <span class="s1">size = (</span><span class="s3">10</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">2</span><span class="s1">)</span>
    <span class="s0">assert </span><span class="s1">random.normal(mu</span><span class="s0">, </span><span class="s1">sigma</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)).shape == (</span><span class="s3">5</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.normal(mu</span><span class="s0">, </span><span class="s1">sigma</span><span class="s0">, </span><span class="s1">size=size)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.normal(mu</span><span class="s0">, </span><span class="s1">sigma</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">1</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.normal(mu</span><span class="s0">, </span><span class="s1">sigma</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
    <span class="s4"># 1 arg</span>
    <span class="s1">shape = np.ones((</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.standard_gamma(shape</span><span class="s0">, </span><span class="s1">size=size)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.standard_gamma(shape</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">3</span><span class="s0">,</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.standard_gamma(shape</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s4"># Check out</span>
    <span class="s1">out = np.empty(size)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.standard_gamma(shape</span><span class="s0">, </span><span class="s1">out=out)</span>

    <span class="s4"># 2 arg</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.binomial(</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.7</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.binomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s3">0.3</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.binomial([</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">0.3</span><span class="s0">, </span><span class="s3">0.7</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.multinomial([</span><span class="s3">2</span><span class="s0">, </span><span class="s3">2</span><span class="s1">]</span><span class="s0">, </span><span class="s1">[</span><span class="s3">.3</span><span class="s0">, </span><span class="s3">.7</span><span class="s1">]</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">2</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>

    <span class="s4"># 3 arg</span>
    <span class="s1">a = random.chisquare(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">b = random.chisquare(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>
    <span class="s1">c = random.chisquare(</span><span class="s3">5</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">5</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">))</span>
    <span class="s0">assert </span><span class="s1">random.noncentral_f(a</span><span class="s0">, </span><span class="s1">b</span><span class="s0">, </span><span class="s1">c).shape == (</span><span class="s3">5</span><span class="s0">, </span><span class="s3">4</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">r&quot;Output size \(6, 5, 1, 1\) is&quot;</span><span class="s1">):</span>
        <span class="s1">random.noncentral_f(a</span><span class="s0">, </span><span class="s1">b</span><span class="s0">, </span><span class="s1">c</span><span class="s0">, </span><span class="s1">size=(</span><span class="s3">6</span><span class="s0">, </span><span class="s3">5</span><span class="s0">, </span><span class="s3">1</span><span class="s0">, </span><span class="s3">1</span><span class="s1">))</span>


<span class="s0">def </span><span class="s1">test_broadcast_size_scalar():</span>
    <span class="s1">mu = np.ones(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">sigma = np.ones(</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">random.normal(mu</span><span class="s0">, </span><span class="s1">sigma</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">3</span><span class="s1">)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError):</span>
        <span class="s1">random.normal(mu</span><span class="s0">, </span><span class="s1">sigma</span><span class="s0">, </span><span class="s1">size=</span><span class="s3">2</span><span class="s1">)</span>


<span class="s0">def </span><span class="s1">test_ragged_shuffle():</span>
    <span class="s4"># GH 18142</span>
    <span class="s1">seq = [[]</span><span class="s0">, </span><span class="s1">[]</span><span class="s0">, </span><span class="s3">1</span><span class="s1">]</span>
    <span class="s1">gen = Generator(MT19937(</span><span class="s3">0</span><span class="s1">))</span>
    <span class="s1">assert_no_warnings(gen.shuffle</span><span class="s0">, </span><span class="s1">seq)</span>
    <span class="s0">assert </span><span class="s1">seq == [</span><span class="s3">1</span><span class="s0">, </span><span class="s1">[]</span><span class="s0">, </span><span class="s1">[]]</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;high&quot;</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">2</span><span class="s0">, </span><span class="s1">[-</span><span class="s3">2</span><span class="s1">]])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;endpoint&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s0">True, False</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_single_arg_integer_exception(high</span><span class="s0">, </span><span class="s1">endpoint):</span>
    <span class="s4"># GH 14333</span>
    <span class="s1">gen = Generator(MT19937(</span><span class="s3">0</span><span class="s1">))</span>
    <span class="s1">msg = </span><span class="s2">'high &lt; 0' </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s2">'high &lt;= 0'</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">gen.integers(high</span><span class="s0">, </span><span class="s1">endpoint=endpoint)</span>
    <span class="s1">msg = </span><span class="s2">'low &gt; high' </span><span class="s0">if </span><span class="s1">endpoint </span><span class="s0">else </span><span class="s2">'low &gt;= high'</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">gen.integers(-</span><span class="s3">1</span><span class="s0">, </span><span class="s1">high</span><span class="s0">, </span><span class="s1">endpoint=endpoint)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=msg):</span>
        <span class="s1">gen.integers([-</span><span class="s3">1</span><span class="s1">]</span><span class="s0">, </span><span class="s1">high</span><span class="s0">, </span><span class="s1">endpoint=endpoint)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;dtype&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;f4&quot;</span><span class="s0">, </span><span class="s2">&quot;f8&quot;</span><span class="s1">])</span>
<span class="s0">def </span><span class="s1">test_c_contig_req_out(dtype):</span>
    <span class="s4"># GH 18704</span>
    <span class="s1">out = np.empty((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">order=</span><span class="s2">&quot;F&quot;</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
    <span class="s1">shape = [</span><span class="s3">1</span><span class="s0">, </span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">]</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">&quot;Supplied output array&quot;</span><span class="s1">):</span>
        <span class="s1">random.standard_gamma(shape</span><span class="s0">, </span><span class="s1">out=out</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
    <span class="s0">with </span><span class="s1">pytest.raises(ValueError</span><span class="s0">, </span><span class="s1">match=</span><span class="s2">&quot;Supplied output array&quot;</span><span class="s1">):</span>
        <span class="s1">random.standard_gamma(shape</span><span class="s0">, </span><span class="s1">out=out</span><span class="s0">, </span><span class="s1">size=out.shape</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>


<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;dtype&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;f4&quot;</span><span class="s0">, </span><span class="s2">&quot;f8&quot;</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;order&quot;</span><span class="s0">, </span><span class="s1">[</span><span class="s2">&quot;F&quot;</span><span class="s0">, </span><span class="s2">&quot;C&quot;</span><span class="s1">])</span>
<span class="s1">@pytest.mark.parametrize(</span><span class="s2">&quot;dist&quot;</span><span class="s0">, </span><span class="s1">[random.standard_normal</span><span class="s0">, </span><span class="s1">random.random])</span>
<span class="s0">def </span><span class="s1">test_contig_req_out(dist</span><span class="s0">, </span><span class="s1">order</span><span class="s0">, </span><span class="s1">dtype):</span>
    <span class="s4"># GH 18704</span>
    <span class="s1">out = np.empty((</span><span class="s3">2</span><span class="s0">, </span><span class="s3">3</span><span class="s1">)</span><span class="s0">, </span><span class="s1">dtype=dtype</span><span class="s0">, </span><span class="s1">order=order)</span>
    <span class="s1">variates = dist(out=out</span><span class="s0">, </span><span class="s1">dtype=dtype)</span>
    <span class="s0">assert </span><span class="s1">variates </span><span class="s0">is </span><span class="s1">out</span>
    <span class="s1">variates = dist(out=out</span><span class="s0">, </span><span class="s1">dtype=dtype</span><span class="s0">, </span><span class="s1">size=out.shape)</span>
    <span class="s0">assert </span><span class="s1">variates </span><span class="s0">is </span><span class="s1">out</span>
</pre>
</body>
</html>